!function(){"use strict";var e,t,i=Laya.View,a=Laya.Dialog,s=Laya.ClassUtils.regClass;!function(e){!function(e){class t extends a{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("carScene/godLife")}}e.godLifeUI=t,s("ui.carScene.godLifeUI",t);class o extends i{constructor(){super()}createChildren(){super.createChildren(),this.createView(o.uiView)}}o.uiView={type:"View",props:{width:149,runtime:"pageScript/HeadCellRuntime.ts",height:230},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"main/Ui_FrameHead2.png"},compId:3,child:[{type:"Image",props:{width:123,var:"playerHead",height:123,centerY:0,centerX:0},compId:4,child:[{type:"Sprite",props:{y:0,x:0,texture:"main/Ui_FrameHead3.png",renderType:"mask"},compId:13}]},{type:"Image",props:{y:120,x:-23.5,var:"nameFrame",skin:"main/Ui_FrameName1.png"},compId:7,child:[{type:"Label",props:{var:"playerName",text:"label",fontSize:25,centerY:-13,centerX:7},compId:8}]}]}],loadList:["main/Ui_FrameHead2.png","main/Ui_FrameHead3.png","main/Ui_FrameName1.png"],loadList3D:[]},e.headCellUI=o,s("ui.carScene.headCellUI",o);class n extends a{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("carScene/share")}}e.shareUI=n,s("ui.carScene.shareUI",n);class r extends i{constructor(){super()}createChildren(){super.createChildren(),this.createView(r.uiView)}}r.uiView={type:"View",props:{width:240,runtime:"pageScript/ShopCellRuntime.ts",height:372},compId:2,child:[{type:"Image",props:{y:305,x:35,var:"tag",skin:"shop/Btn_Unlock.png"},compId:4,child:[{type:"Image",props:{var:"videoUnlock",skin:"shop/Btn_Ad.png",centerY:-4,centerX:0},compId:8},{type:"Label",props:{var:"unlockCostLabel",text:"1000",stroke:2,fontSize:30,centerY:-2,centerX:10},compId:9,child:[{type:"Image",props:{x:-33,width:32,skin:"main/Ui_Money.png",height:32,centerY:-2},compId:10}]}]},{type:"Sprite",props:{y:0,x:0,texture:"shop/Ui_FrameSkin.png"},compId:3,child:[{type:"Image",props:{var:"goodsImage",centerY:0,centerX:0},compId:7},{type:"Image",props:{y:252,var:"goodsName",text:"label",scaleY:.75,scaleX:.75,centerX:0},compId:11}]},{type:"Sprite",props:{y:1,x:0,width:239,var:"lockMask",texture:"shop/Ui_Lock.png",height:295},compId:5}],loadList:["shop/Btn_Unlock.png","shop/Btn_Ad.png","main/Ui_Money.png","shop/Ui_FrameSkin.png","shop/Ui_Lock.png"],loadList3D:[]},e.shopCellUI=r,s("ui.carScene.shopCellUI",r);class h extends i{constructor(){super()}createChildren(){super.createChildren(),this.createView(h.uiView)}}h.uiView={type:"View",props:{width:254,runtime:"pageScript/SignCellRuntime.ts",height:235},compId:2,child:[{type:"Image",props:{x:0,var:"bg",skin:"sign/Ui_FrameQianDao6.png",centerX:0,bottom:0},compId:3,child:[{type:"Image",props:{var:"dayImage",skin:"sign/Ui_Day1.png",centerX:0,bottom:18},compId:6},{type:"Image",props:{skin:"sign/Ui_FrameQianDao4.png",centerX:0,bottom:106},compId:7,child:[{type:"Image",props:{y:57,x:65,width:100,var:"rewardImage",height:100,centerY:-2,centerX:-3,anchorY:.5,anchorX:.5},compId:8}]},{type:"Label",props:{var:"descLabel",text:"label",fontSize:30,color:"#000000",centerX:0,bottom:66,bold:!0},compId:9}]}],loadList:["sign/Ui_FrameQianDao6.png","sign/Ui_Day1.png","sign/Ui_FrameQianDao4.png"],loadList3D:[]},e.signCellUI=h,s("ui.carScene.signCellUI",h);class d extends a{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("carScene/suprise")}}e.supriseUI=d,s("ui.carScene.supriseUI",d);class l extends i{constructor(){super()}createChildren(){super.createChildren(),this.createView(l.uiView)}}l.uiView={type:"View",props:{width:656,runtime:"pageScript/TaskCellRuntime.ts",height:204},compId:2,child:[{type:"Image",props:{y:10,x:10,skin:"task/Ui_FrameTask3.png"},compId:3},{type:"Sprite",props:{y:132,x:0,var:"refreshBtn",texture:"task/Btn_Shuaxin.png"},compId:4},{type:"Sprite",props:{y:103,x:475,var:"receiveBtn",texture:"task/Btn_Get.png"},compId:5},{type:"Sprite",props:{y:103,x:431,var:"goBtn",texture:"task/Btn_GoToComplete.png"},compId:6},{type:"Sprite",props:{y:116.5,x:489,var:"received",texture:"task/Ui_Got.png"},compId:7},{type:"Label",props:{y:60,x:78,var:"taskDesc",text:"label",fontSize:30},compId:8},{type:"Label",props:{y:116.5,x:150,text:"/",fontSize:30},compId:9,child:[{type:"Label",props:{var:"goalLabel",text:"100",left:10,fontSize:30,centerY:0},compId:10},{type:"Label",props:{y:0,var:"finishLabel",text:"100",right:10,fontSize:30,centerY:0},compId:11}]}],loadList:["task/Ui_FrameTask3.png","task/Btn_Shuaxin.png","task/Btn_Get.png","task/Btn_GoToComplete.png","task/Ui_Got.png"],loadList3D:[]},e.taskCellUI=l,s("ui.carScene.taskCellUI",l);class c extends a{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("carScene/treasure")}}e.treasureUI=c,s("ui.carScene.treasureUI",c)}(e.carScene||(e.carScene={}))}(e||(e={}));class o extends e.carScene.godLifeUI{onAwake(){this.receiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick)}setSupriseType(e,t){this.buffImage.visible=!0,1==e?this.buffImage.skin="main/Ui_WordSpeed.png":2==e?this.buffImage.skin="main/Ui_WordSpeed2.png":3==e&&(this.buffImage.skin="main/Ui_Wordmoney.png"),this.buffUpLabel.text=100+3*(t+1)+"%"}onBtnClick(e){e.target==this.receiveBtn&&this.close()}}class n extends e.carScene.headCellUI{set dataSource(e){super.dataSource=e,e&&(this.playerHead.skin=e.head,this.playerName.text=e.name,this.nameFrame.skin=`main/Ui_FrameName${e.id+1}.png`)}}class r extends Laya.Script{constructor(){super(),this.EventDis=new Laya.EventDispatcher,this._eventPair=new Array}init(){window.EventManager=r.Instance}dispatchEvent(e,t){Laya.stage.event(e,[t])}addEvntListener(e,t,i,a){Laya.stage.on(e,t,i);var s=this.getClassName(t);t.name&&(s=t.name),s&&!this._eventPair[s]&&(this._eventPair[s]={}),this._eventPair[s][e]=i}delAllEvnt(e){var t=this.getClassName(e);if(e.name&&(t=e.name),this._eventPair[t])for(var i in this._eventPair[t]){var a=this._eventPair[t][i];a&&(Laya.stage.off(i,e,a),delete this._eventPair[t][i])}}delEvntName(e,t){var i=this.getClassName(t);if(t.name&&(i=t.name),this._eventPair[i]){var a=this._eventPair[i][e];a&&(Laya.stage.off(e,t,a),delete this._eventPair[i][e])}}getClassName(e){if(e&&e.constructor&&e.constructor.toString()){if(e.constructor.name)return e.constructor.name;var t=e.constructor.toString();if("["==t.charAt(0))var i=t.match(/\[\w+\s*(\w+)\]/);else i=t.match(/function\s*(\w+)/);if(i&&2==i.length)return i[1]}}}r.Instance=new r;class h{constructor(){this.stepID=0,this.judgeZ=0,this.shadow=null,this.playerList=[],this.tailList=[],this.obsList=[],this.groundBoxList=[],this.mapList=[],this.manList=[],this.enemyList=[],this.sceneList=[],this.numberList=[],this.specialList=[],this.specialList2=[],this.specialList3=[],this.specialListD3=[],this.specialList2D3=[],this.specialList3D3=[],this.specialInd=0,this.groundDataList=null,this.highLevel=null,this.middleLevel=null,this.lowLevel=null,this.SceneID=0,this.mainShow=null,this.boxNumber=25,this.playerGround=0,this.end=null,this.propList=[],this.buffFloat=null,this.buffFly=null,this.taskList=[]}init(){window.ResManager=h.Instance}LoadRes(){var e=["res/Car3D/Box1.lh","res/Car3D/Box2.lh","res/Car3D/Box3.lh","res/Car3D/Box4.lh","res/Car3D/Box5.lh","res/Car3D/Box6.lh","res/Car3D/Jump.lh","res/Car3D/EffectSmoke.lh","res/Car3D/EffectSpeed.lh","res/Car3D/Jump.lh","res/Car3D/Player1.lh","res/Car3D/Player2.lh","res/Car3D/Player3.lh","res/Car3D/Player4.lh","res/Car3D/Player5.lh","res/Car3D/Player6.lh","res/Car3D/Player7.lh","res/Car3D/Player8.lh","res/Car3D/Player9.lh","res/Car3D/Player10.lh","res/Car3D/Trail1.lh","res/Car3D/Trail2.lh","res/Car3D/Trail3.lh","res/Car3D/Trail4.lh","res/Car3D/Trail5.lh","res/Car3D/Trail6.lh","res/Car3D/Trail7.lh","res/Car3D/Trail8.lh","res/Car3D/Trail9.lh","res/Car3D/Trail10.lh","res/Car3D/Player11.lh","res/Car3D/Player12.lh","res/Car3D/Player13.lh","res/Car3D/Player14.lh","res/Car3D/Player15.lh","res/Car3D/Shadow.lh","res/Car3D/Speed.lh","res/Car3D/Level1.ls","res/Car3D/MainCamera.lh","res/Car3D/LevelMain.ls","res/Car3D/End.lh","res/Car3D/Gold.lh","res/Car3D/BuffFloat.lh","res/Car3D/BuffFly.lh","res/Car3D/Chest.lh","res/Car3D/Confetti.lh","res/config/level.json","res/Sound/bgm.mp3","res/Sound/buySuccess.mp3","res/Sound/Cheer1.mp3","res/Sound/Cheer2.mp3","res/Sound/click.mp3","res/Sound/CoinCollectible.mp3","res/Sound/Float.mp3","res/Sound/Fly.mp3","res/Sound/gameFail.mp3","res/Sound/gameSuccess.mp3","res/Sound/jump.mp3","res/Sound/mainBgm.mp3","res/Sound/speedUp.mp3"];Laya.loader.create(e,Laya.Handler.create(this,this.onLoadFinish))}onLoadFinish(){this.scene=Laya.loader.getRes("res/Car3D/Level1.ls"),this.camera=Laya.loader.getRes("res/Car3D/MainCamera.lh"),this.scene.addChild(this.camera),this.highLevel=new Laya.Sprite3D("highLevel"),this.middleLevel=new Laya.Sprite3D("middleLevel"),this.lowLevel=new Laya.Sprite3D("lowLevel"),this.scene.addChild(this.highLevel),this.scene.addChild(this.middleLevel),this.scene.addChild(this.lowLevel),this.light=this.scene.getChildByName("MainLight"),this.groundBoxList.push(Laya.Loader.getRes("res/Car3D/Box1.lh")),this.groundBoxList.push(Laya.Loader.getRes("res/Car3D/Box2.lh")),this.groundBoxList.push(Laya.Loader.getRes("res/Car3D/Box3.lh")),this.groundBoxList.push(Laya.Loader.getRes("res/Car3D/Box4.lh")),this.groundBoxList.push(Laya.Loader.getRes("res/Car3D/Box5.lh")),this.groundBoxList.push(Laya.Loader.getRes("res/Car3D/Box6.lh")),this.speedObs=Laya.Loader.getRes("res/Car3D/Speed.lh"),this.jumpObs=Laya.Loader.getRes("res/Car3D/Jump.lh"),this.player=Laya.Loader.getRes("res/Car3D/Player1.lh"),this.smokeEffect=Laya.Loader.getRes("res/Car3D/EffectSmoke.lh"),this.speedEffect=Laya.Loader.getRes("res/Car3D/EffectSpeed.lh"),this.shadow=Laya.Loader.getRes("res/Car3D/Shadow.lh"),this.end=Laya.Loader.getRes("res/Car3D/End.lh"),this.end.transform.position=new Laya.Vector3(0,0,580),this.scene.addChild(this.end),this.buffFloat=Laya.Loader.getRes("res/Car3D/BuffFloat.lh"),this.buffFly=Laya.Loader.getRes("res/Car3D/BuffFly.lh"),this.confetti=Laya.Loader.getRes("res/Car3D/Confetti.lh"),this.initBoxPool();for(let e=0;e<3;e++){let t=Laya.loader.getRes(`res/Car3D/${this.getPropName(e+1)}.lh`);this.propList.push(t)}for(let e=0;e<15;e++)this.playerList.push(Laya.loader.getRes(`res/Car3D/Player${e+1}.lh`));for(let e=0;e<10;e++)this.tailList.push(Laya.loader.getRes(`res/Car3D/Trail${e+1}.lh`));this.mainShow=Laya.Loader.getRes("res/Car3D/LevelMain.ls"),r.Instance.dispatchEvent("LoadResOver"),window.DataManager.onDataInit()}onCloneRole(e=!0,t=0){return this.playerList[window.DataManager.useSkinId].clone()}onCloneTail(e=!0){return e?this.tailList[window.DataManager.useTailId].clone():this.tailList[Math.floor(Math.random()*this.tailList.length)].clone()}onCloneTryRole(e){return this.playerList[e].clone()}onCloneTryTail(e){return this.tailList[e].clone()}onCloneEnemyRole(e=!0,t=0){return this.playerList[Math.floor(15*Math.random())].clone()}onCloneRole2(e=0,t=-1){return this.playerList[Math.floor(15*Math.random())].clone()}LoadScene(e=2,t=0){var i=[];if(2==e){if(this.numberList=[0,1,2],this.specialList=[],this.specialList2=[],this.specialList3=[],this.specialList3D3.length>0)for(let e=0;e<this.specialList3D3.length;e++){const t=this.specialList3D3[e];if(t&&t.length)for(let e=0;e<t.length;e++){const i=t[e];for(let e=0;e<i.length;e++){const t=i[e];null!=t&&(this.scene.removeChild(t),t.destroy())}}}if(this.specialList2D3.length>0)for(let e=0;e<this.specialList2D3.length;e++){const t=this.specialList2D3[e];if(t&&t.length)for(let e=0;e<t.length;e++){const i=t[e];for(let e=0;e<i.length;e++){const t=i[e];null!=t&&(this.scene.removeChild(t),t.destroy())}}}if(this.specialListD3.length>0)for(let e=0;e<this.specialListD3.length;e++){const t=this.specialListD3[e];if(t&&t.length)for(let e=0;e<t.length;e++){const i=t[e];for(let e=0;e<i.length;e++){const t=i[e];null!=t&&(this.scene.removeChild(t),t.destroy())}}}this.specialListD3=[],this.specialList2D3=[],this.specialList3D3=[],this.specialInd=0}i=[];var a=[];for(let c=0;c<3;c++){let g=this.highLevel;1==c?g=this.middleLevel:2==c&&(g=this.lowLevel);{const m=this.groundDataList[this.numberList[c]];var s=0-25*c;m.length<=e+10&&(window.GameManager.overZ=m.length);var o=(m[0].length+1)/2;this.judgeZ=o;var n=[],r=[];for(let i=e/2-1;i<e/2;i++){const e=m[i];if(e&&e.length>0){0==t&&n.push(e);for(let t=0;t<e.length;t++){const a=e[t];if(3==a||5==a||6==a||7==a||8==a){var h=null;let e=0;6==a?e=1:7==a?e=2:8==a&&(e=3),0==c?h=Math.random()<.1?this.createBox(2,e):this.createBox(1,e):1==c?h=Math.random()<.1?this.createBox(4,e):this.createBox(3,e):2==c&&(h=Math.random()<.1?this.createBox(6,e):this.createBox(5,e)),g.addChild(h),h.transform.position=new Laya.Vector3(2*(t-o),s,2*i),r.push(h)}else if(1==a){var d=this.speedObs.clone();g.addChild(d),d.transform.position=new Laya.Vector3(2*(t-o),s,2*i),r.push(d)}else if(2==a){var l=this.jumpObs.clone();g.addChild(l),l.transform.position=new Laya.Vector3(2*(t-o),s,2*i),r.push(l)}else r.push(void 0)}}}i.push(n),a.push(r)}}if(this.specialInd<this.boxNumber){if(this.specialList.push(i),this.specialListD3.push(a),this.specialInd=this.specialInd+1,this.specialInd==this.boxNumber&&(this.specialList2=[]),this.specialList2D3.length>0){const e=this.specialList2D3.shift();for(let t=0;t<e.length;t++){const i=e[t];for(let e=0;e<i.length;e++){const t=i[e];null!=t&&(this.scene.removeChild(t),t.destroy())}}}}else if(this.specialInd<2*this.boxNumber){if(this.specialList2.push(i),this.specialList2D3.push(a),this.specialInd=this.specialInd+1,this.specialInd==2*this.boxNumber&&(this.specialList3=[]),this.specialList3D3.length>0){const e=this.specialList3D3.shift();for(let t=0;t<e.length;t++){const i=e[t];for(let e=0;e<i.length;e++){const t=i[e];null!=t&&(this.scene.removeChild(t),t.destroy())}}}}else if(this.specialInd<3*this.boxNumber&&(this.specialList3.push(i),this.specialList3D3.push(a),this.specialInd=this.specialInd+1,this.specialInd==3*this.boxNumber&&(this.specialInd=0,this.specialList=[]),this.specialListD3.length>0)){const e=this.specialListD3.shift();for(let t=0;t<e.length;t++){const i=e[t];for(let e=0;e<i.length;e++){const t=i[e];null!=t&&(this.scene.removeChild(t),t.destroy())}}}return i}getRandom(e){return Math.floor(Math.random()*e)}getRandomList(e,t){var i=[],a=[];for(let e=0;e<t;e++)a.push(e);for(let t=0;t<e;t++){var s=Math.floor(Math.random()*a.length),o=a[s];i.push(o),a.splice(s,1)}return i}createBox(e,t=0){let i=Laya.Pool.getItem(`Box${e}`);if(i?i.transform.localRotationEuler=new Laya.Vector3(0,0,0):i=this.groundBoxList[e-1].clone(),t>0){let e=this.createProp(t);i.addChild(e),e.transform.localPosition=new Laya.Vector3(0,0,0)}return i}createProp(e){let t=Laya.Pool.getItem(this.getPropName(e));return t?t.transform.localRotationEuler=new Laya.Vector3(0,0,0):t=this.propList[e-1].clone(),t}getPropName(e){let t="Gold";return 2==e?t="Chest":3==e&&(t="Chest"),t}updateGroundDataList(){var e=window.DataManager.LevelData[0];let t=JSON.parse(JSON.stringify(e.high[this.getRandom(e.high.length)])),i=JSON.parse(JSON.stringify(e.middle[this.getRandom(e.middle.length)])),a=JSON.parse(JSON.stringify(e.low[this.getRandom(e.low.length)]));for(let e=0;e<5;e++)a.push("55555555555555555555");this.groundDataList=[t,i,a]}recoverySprite3D(e){if(e&&0==e.destroyed){let t=e.tween;t&&(t.recover(),e.tween=null,console.log("回收tween"));let i=e.getChildByName("Chest");i&&i.destroy();let a=e.getChildByName("Gold");a&&a.destroy(),e.removeSelf(),Laya.Pool.recover(e.name,e)}}initBoxPool(){for(let e=0;e<3;e++)for(let t=0;t<300;t++){let i=null;i=t<200?this.groundBoxList[2*e].clone():this.groundBoxList[2*e+1].clone(),Laya.Pool.recover(i.name,i)}}showGroundLevel(e){let t=[this.highLevel,this.middleLevel,this.lowLevel];for(let i=0;i<t.length;i++){let a=t[i];a.active=e==i}}}h.Instance=new h;class d extends Laya.Script{constructor(){super(),this.zipName="res",this.newVer="7.7"}init(){window.DataManager.platformT=0,window.DataManager.platformT=void 0!==window.wx?1:window.DataManager.platformT,window.DataManager.platformT=void 0!==window.qq?2:window.DataManager.platformT,window.DataManager.platformT=void 0!==window.tt?3:window.DataManager.platformT,window.DataManager.platformT=void 0!==window.swan?4:window.DataManager.platformT,h.Instance.LoadRes()}}d.Instance=new d;class l extends Laya.Script3D{constructor(){super(),this.type=0,this.per=0,this.moveSpeed=0,this.posNow=-.9,this.rotateNow=0,this.rotateAim=0,this.lastRotateAim=0,this.enemyID=-1,this.speed=0,this.loseNum=0,this.effectStartNum=0,this.modID=0,this.hurtNum=0,this.scaleNum=12,this.speedNum=.16,this.scaleNeed=1,this.heart=300,this.judgeZ=300,this.speedX=0,this.loseNow=!1,this.soundOn=!1,this.jumpNow=!1,this.jumpNum=0,this.g=.3,this.downSpeed=0,this.speedNow=!1,this.speedUpNum=0,this.heightInd=0,this.groundX=0,this.XMax=0,this.groundY=0,this.Max=20,this.boy=void 0,this.player=void 0,this.effect=void 0,this._outPos=new Laya.Vector3,this.smokeEffect=null,this.speedEffect=null,this.speedTime=0,this.lastPosY=0,this.nameLabel=null,this.roleData=null,this.headIcon=null,this.lastX=0,this.boxNumber=30,this.changeValue=[.2,2.5,3,1.6,.08,4,3800,2500,20],this.isDeath=!1,this.turnState=0,this.floatNow=!1,this.flyNow=!1,this.flyTime=0,this.flyFullTime=0,this.floatTime=0,this.floatFullTime=0,this.flyHeightTimestamp=0,this.flyStartHeight=0,this.lastFlyHeight=0,this.moneyNum=10,this.diamondNum=0,this.levelId=0}setAttr(){}onAwake(){this.changeValue[0]*=1+.03*window.homePage.speedUpTime,this.changeValue[1]*=1+.03*window.homePage.rushUpTime,this.changeValue[2]*=1+.03*window.homePage.rushUpTime,this.changeValue[8]=Math.floor(this.changeValue[8]*(1+.03*window.homePage.moneyUpTime)),this.boy=this.owner,this.posNow=0,this.RoleAni=this.boy.getComponent(Laya.Animator),this.judgeZ=window.ResManager.judgeZ,this.XMax=2*this.judgeZ+1,this.groundY=0,this.groundX=2*this.judgeZ-1-(this.XMax+Math.floor((0-this.XMax)/2)),this.Max=2*this.judgeZ-1,this.smokeEffect=window.ResManager.smokeEffect.clone(),this.speedEffect=window.ResManager.speedEffect.clone(),this.boy.addChild(window.ResManager.shadow.clone()),this.boy.addChild(this.smokeEffect),this.boy.addChild(this.speedEffect),this.playSmokeEffect(!1),this.playSpeedUpEffect(!1),this.boxNumber=window.ResManager.boxNumber,Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onMOUSEDOWN),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.onMOUSEMOVE),window.GameManager.isTryTail?(window.homePage.tryPlayerTail(this.boy,window.GameManager.tryTailId),window.GameManager.isTryTail=!1,window.GameManager.tryTailId=0):window.homePage.changePlayerTail(this.boy),this.speedNum=this.changeValue[0]}onEnable(){this.RoleAni.crossFade("Stand",.1,0,0)}onDisable(){}onMOUSEDOWN(e){this.lastX=e.stageX,this.turnState=0,this.rotateNow=this.rotateAim}onMOUSEMOVE(e){e.stageX<this.lastX?this.turnState=-1:e.stageX>this.lastX&&(this.turnState=1),this.lastX=e.stageX}onUpdate(){if(0!=window.GameManager.gameState||this.loseNow)return;var e=0;if(this.updateNamePos(),this.updateIconPos(),this.speedTime>0&&(this.speedTime-=Laya.timer.delta,this.speedTime<=0?(this.speedTime=0,this.playSpeedUpEffect(!1)):this.playSpeedUpEffect(!0)),this.jumpNow&&this.boy.transform.position.y<this.lastPosY){let e=this.RoleAni.getControllerLayer(0).getCurrentPlayState();this.isDeath||"Drop"==e.animatorState.name||this.RoleAni.crossFade("Drop",.1,0,0)}this.lastPosY=this.boy.transform.position.y,1==this.turnState?(this.rotateAim-=this.changeValue[3],this.rotateAim<=-45&&(this.rotateAim=-45)):-1==this.turnState&&(this.rotateAim+=this.changeValue[3],this.rotateAim>=45&&(this.rotateAim=45)),this.turnState=0,this.rotateNow!=this.rotateAim&&(this.rotateNow<this.rotateAim?(this.rotateNow+=this.changeValue[4]*Laya.timer.delta,this.rotateNow>this.rotateAim&&(this.rotateNow=this.rotateAim)):(this.rotateNow-=this.changeValue[4]*Laya.timer.delta,this.rotateNow<this.rotateAim&&(this.rotateNow=this.rotateAim))),this.boy.transform.localRotationEuler=new Laya.Vector3(0,this.rotateAim,0),this.posNow=this.boy.transform.position.z;var t=this.boy.transform.position.y,i=this.boy.transform.position.x,a=2*this.judgeZ-1-(this.XMax+Math.floor((i-this.XMax)/2)),s=Math.floor(this.posNow/2+.5);if(this.speedNow&&(this.speedUpNum+=1,this.speedUpNum>=120&&(this.speedNow=!1,this.speedUpNum=0,this.speedNum=this.changeValue[0])),this.floatNow&&(this.floatTime-=Laya.timer.delta,this.floatTime<=0&&(this.floatTime=0,this.floatNow=!1,this.floatFullTime=0,this.removeFloat(),this.jumpNow=!0,this.downSpeed=-5,this.RoleAni.crossFade("JumpL",.1,0,0),window.homePage.root.propSign.visible=!1),this.updatePropProgress(this.floatTime/this.floatFullTime)),this.flyNow&&(this.flyTime-=Laya.timer.delta,this.flyTime<=0&&(this.flyTime=0,this.flyFullTime=0,this.flyNow=!1,this.speedNum=this.changeValue[0],this.playSpeedUpEffect(!1),this.removeFly(),this.jumpNow=!0,this.downSpeed=-5,this.RoleAni.crossFade("JumpL",.1,0,0),window.homePage.root.propSign.visible=!1,Laya.SoundManager.stopSound("res/Sound/Fly.mp3")),this.updatePropProgress(this.flyTime/this.flyFullTime)),this.jumpNow){this.playSmokeEffect(!0);var o=this.downSpeed;if(e=o<0&&o+this.g>0?((this.g+o)*(this.g+o)-o*o)*this.g/2:(o*o-(this.g+o)*(this.g+o))*this.g/2,this.downSpeed=this.downSpeed+this.g,t>0&&t+e<0||t>-25&&t+e<-25||t>-50&&t+e<-50){var n=s%(3*this.boxNumber),r=window.ResManager.specialList,h=window.ResManager.specialListD3;if(n>=2*this.boxNumber){r=window.ResManager.specialList3;h=window.ResManager.specialList3D3}else if(n>=1*this.boxNumber){r=window.ResManager.specialList2;h=window.ResManager.specialList2D3}var d=0;t<-25?(this.heightInd=2,d=-50):t<0?(this.heightInd=1,d=-25):this.heightInd=0,window.ResManager.playerGround=this.heightInd,s=s<300?s:300;var l=(r=window.ResManager.groundDataList)[this.heightInd][s][this.Max-a];(a<1||a>20)&&(l=4);let i=null;if(h.length>0&&(i=this.dropBox(r,h,a,s))&&2==l&&this.playJumpBoxAni(i),5==l)return void this.playerFinish();if(1==l)this.speedNow?(this.speedNow=!0,this.speedUpNum=0,this.speedNum=this.changeValue[0]*this.changeValue[2]):(this.speedNow=!0,this.speedUpNum=0,this.speedNum=this.changeValue[0]*this.changeValue[1]),this.speedTime=2e3,window.DataManager.achieveSpeedNum++,localStorage.setItem("achieveSpeedNum",window.DataManager.achieveSpeedNum.toString()),this.jumpNow=!1,this.floatNow?this.RoleAni.crossFade("Float",.1,0,0):this.RoleAni.crossFade("Run",.1,0,0),this.openShadow(!0);else if(2==l)this.lastPosY=this.boy.transform.position.y,this.jumpNow=!0,window.homePage.soundStart("res/Sound/jump.mp3"),this.RoleAni.crossFade("JumpH",.1,0,0),window.DataManager.achieveJumpNum++,localStorage.setItem("achieveJumpNum",window.DataManager.achieveJumpNum.toString()),this.downSpeed=-16,Math.random()<.5&&Laya.timer.once(500,this,()=>{Math.random()<.5?window.homePage.soundStart("res/Sound/Cheer1.mp3"):window.homePage.soundStart("res/Sound/Cheer2.mp3")});else if(4==l)t+e<-50&&this.playerDie();else if(6==l){if(this.jumpNow=!1,this.floatNow?this.RoleAni.crossFade("Float",.1,0,0):this.RoleAni.crossFade("Run",.1,0,0),this.openShadow(!0),i){let e=i.getChildByName("Gold");e&&(window.ResManager.scene.addChild(e),this.eatGold(e))}}else if(7==l){if(this.jumpNow=!1,i){let e=i.getChildByName("Chest");e&&(e.destroy(),this.changePlayerState("Float")),window.homePage.soundStart("res/Sound/Float.mp3")}}else if(8==l){if(this.jumpNow=!1,i){let e=i.getChildByName("Chest");e&&(e.destroy(),this.changePlayerState("Fly"),this.playSpeedUpEffect(!0)),window.homePage.soundStart("res/Sound/Fly.mp3")}}else this.jumpNow=!1,this.floatNow?this.RoleAni.crossFade("Float",.1,0,0):this.RoleAni.crossFade("Run",.1,0,0),this.openShadow(!0);e=d-t,this.groundX=a,this.groundY=s}this.groundX=a,this.groundY=s}else if(this.flyNow){if(this.flyHeightTimestamp<500){this.flyHeightTimestamp+=Laya.timer.delta,this.flyHeightTimestamp>500&&(this.flyHeightTimestamp=500);let t=this.sinIn(this.flyHeightTimestamp,this.flyStartHeight,5,500);e=t-this.lastFlyHeight,this.lastFlyHeight=t}this.flyTime<=500&&(this.speedNum-=.03,this.speedNum=this.speedNum>this.changeValue[0]?this.speedNum:this.changeValue[0])}else if(a!=this.groundX||s!=this.groundY){this.playSmokeEffect(!1);n=s%(3*this.boxNumber),r=window.ResManager.specialList,h=window.ResManager.specialListD3;n>=2*this.boxNumber?(r=window.ResManager.specialList3,h=window.ResManager.specialList3D3):n>=1*this.boxNumber&&(r=window.ResManager.specialList2,h=window.ResManager.specialList2D3),s=s<300?s:300;l=(r=window.ResManager.groundDataList)[this.heightInd][s][this.Max-a];(a<1||a>20)&&(l=4);let e=null;if(h.length>0&&(e=this.dropBox(r,h,a,s))&&2==l&&this.playJumpBoxAni(e),5==l)return void this.playerFinish();if(1==l)this.speedNow?(this.speedNow=!0,this.speedUpNum=0,this.speedNum=this.changeValue[0]*this.changeValue[2]):(this.speedNow=!0,this.speedUpNum=0,this.speedNum=this.changeValue[0]*this.changeValue[1]),this.speedTime=2e3,window.DataManager.achieveSpeedNum++,localStorage.setItem("achieveSpeedNum",window.DataManager.achieveSpeedNum.toString());else if(2==l)this.jumpNow=!0,window.homePage.soundStart("res/Sound/jump.mp3"),this.RoleAni.crossFade("JumpH",.1,0,0),window.DataManager.achieveJumpNum++,localStorage.setItem("achieveJumpNum",window.DataManager.achieveJumpNum.toString()),this.downSpeed=-16,this.openShadow(!1);else if(4!=l||this.floatNow){if(6==l){if(e){let t=e.getChildByName("Gold");t&&(window.ResManager.scene.addChild(t),this.eatGold(t))}}else if(7==l){if(e){let t=e.getChildByName("Chest");t&&(t.destroy(),this.changePlayerState("Float"),this.jumpNow=!1),window.homePage.soundStart("res/Sound/Float.mp3")}}else if(8==l&&e){let t=e.getChildByName("Chest");t&&(t.destroy(),this.changePlayerState("Fly"),this.jumpNow=!1,this.playSpeedUpEffect(!0)),window.homePage.soundStart("res/Sound/Fly.mp3")}}else this.jumpNow=!0,window.homePage.soundStart("res/Sound/jump.mp3"),this.RoleAni.crossFade("JumpL",.1,0,0),this.downSpeed=-5,this.openShadow(!1);this.groundX=a,this.groundY=s}this.boy&&this.boy.transform&&this.boy.transform.translate(new Laya.Vector3(this.speedNum*Math.sin(this.rotateAim/180*Math.PI),e,this.speedNum*Math.cos(this.rotateAim/180*Math.PI)));let c=this.boy.transform.position.clone();window.ResManager.camera.transform.position=c,window.ResManager.camera.transform.localRotationEuler=new Laya.Vector3(0,this.rotateNow,0),this.boy.transform.position.x>=-20&&this.boy.transform.position.x<=20&&this.boy.transform.position.z>580?this.playerFinish():this.boy.transform.position.y<-60&&this.playerDie()}onDestroy(){this.nameLabel&&this.nameLabel.destroy(),this.headIcon&&this.headIcon.destroy(),Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.onMOUSEMOVE),Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onMOUSEDOWN)}moveStart(){this.RoleAni.crossFade("Run",.1,0,0),this.posNow=this.boy.transform.position.z;var e=this.boy.transform.position.x;this.groundX=2*this.judgeZ-1-(this.XMax+Math.floor((e-this.XMax)/2)),this.groundY=Math.floor(this.posNow/2+.5),this.lastPosY=this.boy.transform.position.y}dropBox(e,t,i,a){let s=a%this.boxNumber;if(!t[s=t.length-(this.boxNumber-s)]||!t[s][this.heightInd])return;let o=t[s][this.heightInd][this.Max-i];if(o){t[s][this.heightInd][this.Max-i]=void 0;let n=e[this.heightInd][a],r="";for(let e=0;e<n.length;e++)e==this.Max-i?r+="4":r+=n[e];e[this.heightInd][a]=r,window.homePage.tweenTo(o,{position:new Laya.Vector3(o.transform.position.x,o.transform.position.y-8,o.transform.position.z),localRotationEuler:new Laya.Vector3(o.transform.localRotationEuler.x+60,o.transform.localRotationEuler.y,o.transform.localRotationEuler.z+45)},800,Laya.Ease.sineIn,Laya.Handler.create(this,()=>{o.destroy()}))}return o}playJumpBoxAni(e){if(e.getChildByName("Jump")){e.getChildByName("Jump").getComponent(Laya.Animator).play("Jump",0,0)}}playSmokeEffect(e){if(!this.smokeEffect)return;let t=this.smokeEffect.getChildByName("Smoke");e?t.particleSystem.isEmitting||t.particleSystem.play():t.particleSystem.stop()}playSpeedUpEffect(e){if(!this.speedEffect)return;let t=this.speedEffect.getChildByName("Speed1"),i=this.speedEffect.getChildByName("Speed1").getChildByName("Speed2");e?(t.particleSystem.isEmitting||(t.particleSystem.play(),window.homePage.soundStart("res/Sound/speedUp.mp3")),i.particleSystem.isEmitting||i.particleSystem.play()):(t.particleSystem.stop(),i.particleSystem.stop())}openShadow(e){let t=this.owner.getChildByName("Shadow");t&&(t.active=e)}updateNamePos(){if(this.nameLabel){let e=window.ResManager.camera.getChildByName("Camera").getChildByName("Camera"),t=this.boy.transform.position.clone();t.y=t.y+3.5;let i=new Laya.Vector4,a=window.homePage.project(e,t,i);this.nameLabel.visible=a,this.nameLabel.x=i.x/Laya.stage.clientScaleX,this.nameLabel.y=i.y/Laya.stage.clientScaleY}}updateIconPos(){let e=this.boy.transform.position.z,t=window.homePage.root.roadLine.width,i=Math.floor(e/580*t);i=i<t?i:t,this.headIcon.x=i}setPlayerData(e){this.roleData=e,this.nameLabel=new Laya.Image("main/Ui_Me.png"),this.nameLabel.anchorX=.5,this.nameLabel.anchorY=1,window.homePage.root.nameBox.addChild(this.nameLabel),this.headIcon=new Laya.Image("main/Ui_Road3.png");let t=new Laya.Image(e.head);this.headIcon.addChild(t),this.headIcon.pivotX=26,this.headIcon.pivotY=76,t.x=8,t.y=8,t.width=t.height=35,this.headIcon.x=0,window.homePage.root.roadLine.addChild(this.headIcon),this.updateNamePos()}playerFinish(){if(this.isDeath)return;this.nameLabel.visible=!1,window.GameManager.gameState=1,this.loseNow=!0,window.GameManager.finishNum++;let e=window.ResManager.confetti.clone();this.boy.addChild(e);let t=1==window.GameManager.finishNum,i={localRotationEuler:new Laya.Vector3(0,0,0),position:this.boy.transform.position.clone()};i.position.y-=5,window.homePage.tweenTo(window.ResManager.camera,i,500,Laya.Ease.sineOut),window.ResManager.camera.getComponent(Laya.Animator).play("CameraWin",0,0),this.RoleAni.crossFade("Win",.1,0,0),window.DataManager.dayFinishNum++,localStorage.setItem("dayFinishNum",window.DataManager.dayFinishNum.toString()),window.DataManager.achieveFinishNum++,localStorage.setItem("achieveFinishNum",window.DataManager.achieveFinishNum.toString()),t&&(window.DataManager.dayWinNum++,localStorage.setItem("dayWinNum",window.DataManager.dayWinNum.toString()),window.DataManager.achieveWinNum++,localStorage.setItem("achieveWinNum",window.DataManager.achieveWinNum.toString())),Laya.timer.once(3e3,this,()=>{window.GameManager.countData={win:t,rank:window.GameManager.finishNum,moneyNum:this.moneyNum,diamondNum:this.diamondNum},t&&window.homePage.showRewardSkinBox(t,!1)||window.homePage.showCount(window.GameManager.countData)})}playerDie(){this.isDeath||(this.isDeath=!0,this.RoleAni.crossFade("Death",.1,0,0),Laya.timer.once(600,this,()=>{this.loseNow=!0,window.GameManager.gameState=1,window.GameManager.countData={win:!1,rank:5},window.homePage.showCount(window.GameManager.countData)}))}sinIn(e,t,i,a){return-i*Math.cos(e/a*(Math.PI/2))+i+t}changePlayerState(e){if("Float"==e){if(this.floatNow=!0,this.floatTime+=this.changeValue[6],this.floatFullTime+=this.changeValue[6],!this.boy.getChildByName("BuffFloat")){let e=window.ResManager.buffFloat.clone();e.transform.position=new Laya.Vector3(0,0,0),this.boy.addChild(e)}"Float"!=this.RoleAni.getControllerLayer(0).getCurrentPlayState().animatorState.name&&this.RoleAni.crossFade("Float",.1,0,0),this.openShadow(!1),this.showPropSign("Float")}else if("Fly"==e){if(this.floatNow&&(this.floatTime=0,this.floatFullTime=0,this.floatNow=!1,this.removeFloat()),this.speedNow=!1,this.speedUpNum=0,this.speedTime=0,this.flyNow=!0,this.flyTime+=this.changeValue[7],this.flyFullTime+=this.changeValue[7],!this.boy.getChildByName("BuffFly")){let e=window.ResManager.buffFly.clone();e.transform.localPosition=new Laya.Vector3(0,0,0),this.boy.addChild(e)}"Fly"!=this.RoleAni.getControllerLayer(0).getCurrentPlayState().animatorState.name&&this.RoleAni.crossFade("Fly",.1,0,0),this.speedNum=this.changeValue[0]*this.changeValue[5],this.flyHeightTimestamp=0,this.lastFlyHeight=this.boy.transform.position.y,this.flyStartHeight=this.boy.transform.position.y,this.openShadow(!1),this.showPropSign("Fly")}}removeFloat(){this.floatFullTime=0;let e=this.boy.getChildByName("BuffFloat");if(e){e.removeSelf(),window.ResManager.scene.addChild(e),e.transform.position=this.boy.transform.position.clone();let t=e.transform.position.clone();t.y+=50,window.homePage.tweenTo(e,{position:t},2e3,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{e.destroy()}))}}removeFly(){this.flyFullTime=0;let e=this.boy.getChildByName("BuffFly");if(e){e.removeSelf(),window.ResManager.scene.addChild(e),e.transform.position=this.boy.transform.position.clone(),e.transform.localRotationEuler=new Laya.Vector3(0,0,0);let t=e.transform.position.clone();t.z+=100,window.homePage.tweenTo(e,{position:t},2e3,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{e.destroy()}))}}eatGold(e){e.getComponent(Laya.Animator).play("GoldGet",0,0),this.moneyNum+=this.changeValue[8],Laya.timer.once(2e3,this,()=>{e.destroy()}),window.homePage.soundStart("res/Sound/CoinCollectible.mp3")}showPropSign(e){window.homePage.root.propSign.visible=!0,"Float"==e?window.homePage.root.propSign.skin="main/Ui_QiQiu.png":"Fly"==e&&(window.homePage.root.propSign.skin="main/Ui_HuoJian.png"),window.homePage.root.propProgressMask.width=180}updatePropProgress(e){window.homePage.root.propProgressMask.width=180*e}updateGroundLevel(){let e=0;this.boy.transform.position.y<-50||(this.boy.transform.position.y<-25?e=2:this.boy.transform.position.y<0&&(e=1)),this.levelId!=e&&(this.levelId=e,window.ResManager.showGroundLevel(this.levelId))}}class c extends Laya.Script3D{constructor(){super(),this.type=0,this.per=0,this.moveSpeed=0,this.posNow=-.9,this.rotateAim=0,this.turnNow=!1,this.fightNow=!1,this.loseNow=!1,this.Mon=!1,this.speed=0,this.turnNum=0,this.fightNumNow=0,this.fightNumNow2=0,this.effectStartNum=0,this.modID=0,this.enemyID=0,this.goNum=0,this.fightNumMax=100,this.heart=200,this.hurtNum=0,this.rotNum=0,this.scaleNum=12,this.speedNum=.16,this.scaleNeed=1,this.scaleStandard=1,this.heightStandard=2.7,this.soundOn=!1,this.boy=void 0,this.aim=void 0,this.player=void 0,this.effect=void 0,this._outPos=new Laya.Vector3,this.jumpNow=!1,this.speedX=0,this.judgeZ=300,this.XMax=0,this.groundY=0,this.g=.3,this.downSpeed=0,this.speedNow=!1,this.speedUpNum=0,this.heightInd=0,this.Max=20,this.groundX=0,this.findSpecialTime=0,this.moveNow=!0,this.moveX=0,this.smokeEffect=null,this.speedEffect=null,this.speedTime=0,this.lastPosY=0,this.nameLabel=null,this.roleData=null,this.headIcon=null,this.boxNumber=30,this.changeValue=[.2,2.5,3,1.6,.08,4,3800,2500,20],this.isDeath=!1,this.floatNow=!1,this.flyNow=!1,this.flyTime=0,this.flyFullTime=0,this.floatTime=0,this.floatFullTime=0,this.flyHeightTimestamp=0,this.flyStartHeight=0,this.lastFlyHeight=0,this.thinkTime=0,this.useFlyDis=40,this.actionId=0,this.isRunningAction=!1}setAttr(e=0){var t=this.boy.transform.position.x;this.groundX=2*this.judgeZ-1-(this.XMax+Math.floor((t-this.XMax)/2)),this.groundY=0,this.speedNum=this.changeValue[0]}onAwake(){this.boy=this.owner,this.posNow=0,this.RoleAni=this.boy.getComponent(Laya.Animator),this.judgeZ=window.ResManager.judgeZ,this.XMax=2*this.judgeZ+1,this.groundY=0,this.groundX=2*this.judgeZ-1-(this.XMax+Math.floor((0-this.XMax)/2)),this.Max=2*this.judgeZ-1,this.smokeEffect=window.ResManager.smokeEffect.clone(),this.speedEffect=window.ResManager.speedEffect.clone(),this.boy.addChild(this.smokeEffect),this.boy.addChild(this.speedEffect),this.playSmokeEffect(!1),this.playSpeedUpEffect(!1),this.boxNumber=window.ResManager.boxNumber,this.boy.addChild(window.ResManager.shadow.clone()),window.homePage.changePlayerTail(this.boy,!1)}onEnable(){this.RoleAni.crossFade("Stand",.1,0,0)}onDisable(){}onUpdate(){if(0==window.GameManager.gameState&&!this.loseNow){var e=0;if(this.updateNamePos(),this.updateIconPos(),this.aiLogic(),this.jumpNow&&this.boy.transform.position.y<this.lastPosY){let e=this.RoleAni.getControllerLayer(0).getCurrentPlayState();this.isDeath||"Drop"==e.animatorState.name||this.RoleAni.crossFade("Drop",.1,0,0)}this.lastPosY=this.boy.transform.position.y,this.boy.transform.localRotationEuler=new Laya.Vector3(0,this.rotateAim,0),this.posNow=this.boy.transform.position.z;var t=this.boy.transform.position.y,i=this.boy.transform.position.x,a=2*this.judgeZ-1-(this.XMax+Math.floor((i-this.XMax)/2)),s=Math.floor(this.posNow/2+.5);if(this.speedNow&&(this.speedUpNum+=1,this.speedUpNum>=120&&(this.speedNow=!1,this.speedUpNum=0,this.speedNum=this.changeValue[0])),this.speedTime>0&&(this.speedTime-=Laya.timer.delta,this.speedTime<=0?(this.speedTime=0,this.playSpeedUpEffect(!1)):this.playSpeedUpEffect(!0)),this.floatNow&&(this.floatTime-=Laya.timer.delta,this.floatTime<=0&&(this.floatTime=0,this.floatNow=!1,this.floatFullTime=0,this.removeFloat(),this.jumpNow=!0,this.downSpeed=-5,this.RoleAni.crossFade("JumpL",.1,0,0))),this.flyNow&&(this.flyTime-=Laya.timer.delta,this.flyTime<=0&&(this.flyTime=0,this.flyFullTime=0,this.flyNow=!1,this.speedNum=this.changeValue[0],this.playSpeedUpEffect(!1),this.removeFly(),this.jumpNow=!0,this.downSpeed=-5,this.RoleAni.crossFade("JumpL",.1,0,0))),this.jumpNow){this.playSmokeEffect(!0);var o=this.downSpeed;if(e=o<0&&o+this.g>0?((this.g+o)*(this.g+o)-o*o)*this.g/2:(o*o-(this.g+o)*(this.g+o))*this.g/2,this.downSpeed=this.downSpeed+this.g,t>0&&t+e<0||t>-25&&t+e<-25||t>-50&&t+e<-50){var n=s%(3*this.boxNumber),r=window.ResManager.specialList,h=window.ResManager.specialListD3;if(n>=2*this.boxNumber){r=window.ResManager.specialList3;h=window.ResManager.specialList3D3}else if(n>=1*this.boxNumber){r=window.ResManager.specialList2;h=window.ResManager.specialList2D3}var d=0;t<-25?(this.heightInd=2,d=-50):t<0?(this.heightInd=1,d=-25):this.heightInd=0,s=s<300?s:300;var l=(r=window.ResManager.groundDataList)[this.heightInd][s][this.Max-a];(a<1||a>20)&&(l=4);let i=null;if(h.length>0&&this.boy.transform.position.z>=window.GameManager.player.transform.position.z&&this.boy.transform.position.z<=window.GameManager.pathNum+2&&(i=this.dropBox(r,h,a,s))&&2==l&&this.playJumpBoxAni(i),5==l)return void this.playerFinish();if(1==l)this.speedNow?(this.speedNow=!0,this.speedUpNum=0,this.speedNum=this.changeValue[0]*this.changeValue[2]):(this.speedNow=!0,this.speedUpNum=0,this.speedNum=this.changeValue[0]*this.changeValue[1]),this.speedTime=2e3,this.jumpNow=!1,this.floatNow?this.RoleAni.crossFade("Float",.1,0,0):this.RoleAni.crossFade("Run",.1,0,0),this.openShadow(!0);else if(2==l)this.lastPosY=this.boy.transform.position.y,this.jumpNow=!0,this.RoleAni.crossFade("JumpH",.1,0,0),this.downSpeed=-16;else if(4==l)t+e<-50&&this.playerDie();else if(6==l){if(this.jumpNow=!1,this.floatNow?this.RoleAni.crossFade("Float",.1,0,0):this.RoleAni.crossFade("Run",.1,0,0),this.openShadow(!0),i){let e=i.getChildByName("Gold");e&&(window.ResManager.scene.addChild(e),this.eatGold(e))}}else if(7==l){if(this.jumpNow=!1,i){let e=i.getChildByName("Chest");e&&(e.destroy(),this.changePlayerState("Float"))}}else if(8==l){if(this.jumpNow=!1,i){let e=i.getChildByName("Chest");e&&(e.destroy(),this.changePlayerState("Fly"),this.playSpeedUpEffect(!0))}}else this.jumpNow=!1,this.floatNow?this.RoleAni.crossFade("Float",.1,0,0):this.RoleAni.crossFade("Run",.1,0,0),this.openShadow(!0);e=d-t,this.groundX=a,this.groundY=s}this.groundX=a,this.groundY=s}else if(this.flyNow){if(this.flyHeightTimestamp<500){this.flyHeightTimestamp+=Laya.timer.delta,this.flyHeightTimestamp>500&&(this.flyHeightTimestamp=500);let t=this.sinIn(this.flyHeightTimestamp,this.flyStartHeight,5,500);e=t-this.lastFlyHeight,this.lastFlyHeight=t}this.flyTime<=500&&(this.speedNum-=.03,this.speedNum=this.speedNum>this.changeValue[0]?this.speedNum:this.changeValue[0])}else if(a!=this.groundX||s!=this.groundY){this.playSmokeEffect(!1);n=s%(3*this.boxNumber),r=window.ResManager.specialList,h=window.ResManager.specialListD3;n>=2*this.boxNumber?(r=window.ResManager.specialList3,h=window.ResManager.specialList3D3):n>=1*this.boxNumber&&(r=window.ResManager.specialList2,h=window.ResManager.specialList2D3),s=s<300?s:300;l=(r=window.ResManager.groundDataList)[this.heightInd][s][this.Max-a];(a<1||a>20)&&(l=4);let e=null;if(h.length>0&&this.boy.transform.position.z>=window.GameManager.player.transform.position.z&&this.boy.transform.position.z<=window.GameManager.pathNum+2&&(e=this.dropBox(r,h,a,s))&&2==l&&this.playJumpBoxAni(e),5==l)return void this.playerFinish();if(1==l)this.speedNow?(this.speedNow=!0,this.speedUpNum=0,this.speedNum=this.changeValue[0]*this.changeValue[2]):(this.speedNow=!0,this.speedUpNum=0,this.speedNum=this.changeValue[0]*this.changeValue[1]),this.speedTime=2e3;else if(2==l)this.jumpNow=!0,this.RoleAni.crossFade("JumpH",.1,0,0),this.downSpeed=-16,this.openShadow(!1);else if(4!=l||this.floatNow){if(6==l){if(e){let t=e.getChildByName("Gold");t&&(window.ResManager.scene.addChild(t),this.eatGold(t))}}else if(7==l){if(e){let t=e.getChildByName("Chest");t&&(t.destroy(),this.changePlayerState("Float"),this.jumpNow=!1)}}else if(8==l&&e){let t=e.getChildByName("Chest");t&&(t.destroy(),this.changePlayerState("Fly"),this.jumpNow=!1,this.playSpeedUpEffect(!0))}}else this.jumpNow=!0,this.RoleAni.crossFade("JumpL",.1,0,0),this.downSpeed=-5,this.openShadow(!1);this.groundX=a,this.groundY=s}this.boy&&this.boy.transform&&this.boy.transform.translate(new Laya.Vector3(this.speedNum*Math.sin(this.rotateAim/180*Math.PI),e,this.speedNum*Math.cos(this.rotateAim/180*Math.PI))),this.boy.transform.position.x>=-20&&this.boy.transform.position.x<=20&&this.boy.transform.position.z>580?this.playerFinish():this.boy.transform.position.y<-60&&this.playerDie()}}onDestroy(){this.nameLabel&&this.nameLabel.destroy(),this.headIcon&&this.headIcon.destroy()}moveStart(){this.RoleAni.crossFade("Run",.1,0,0),this.posNow=this.boy.transform.position.z,this.lastPosY=this.boy.transform.position.y,this.thinkTime=this.getRandom(2e3,4e3)}findSpecialBox(e,t){let i=0,a=t+3<20?t+3:20;for(let s=t-3>1?t-3:1;s<=a;s++)if("1"==e[this.XMax-s]||"2"==e[this.XMax-s]){i=s;break}return i}dropBox(e,t,i,a){let s=a%this.boxNumber;if((s=t.length-(this.boxNumber-s))<0||!t[s]||!t[s][this.heightInd])return;let o=t[s][this.heightInd][this.Max-i];if(o){t[s][this.heightInd][this.Max-i]=void 0;let n=e[this.heightInd][a],r="";for(let e=0;e<n.length;e++)e==this.Max-i?r+="4":r+=n[e];e[this.heightInd][a]=r,window.homePage.tweenTo(o,{position:new Laya.Vector3(o.transform.position.x,o.transform.position.y-8,o.transform.position.z),localRotationEuler:new Laya.Vector3(o.transform.localRotationEuler.x+60,o.transform.localRotationEuler.y,o.transform.localRotationEuler.z+45)},800,Laya.Ease.sineIn,Laya.Handler.create(this,()=>{o.destroy()}))}return o}playJumpBoxAni(e){if(e.getChildByName("Jump")){e.getChildByName("Jump").getComponent(Laya.Animator).play("Jump",0,0)}}playSmokeEffect(e){if(!this.smokeEffect)return;let t=this.smokeEffect.getChildByName("Smoke");e?t.particleSystem.isEmitting||t.particleSystem.play():t.particleSystem.stop()}playSpeedUpEffect(e){if(!this.speedEffect)return;let t=this.speedEffect.getChildByName("Speed1"),i=this.speedEffect.getChildByName("Speed1").getChildByName("Speed2");e?(t.particleSystem.isEmitting||t.particleSystem.play(),i.particleSystem.isEmitting||i.particleSystem.play()):(t.particleSystem.stop(),i.particleSystem.stop())}openShadow(e){let t=this.owner.getChildByName("Shadow");t&&(t.active=e)}updateNamePos(){if(this.nameLabel){let e=window.ResManager.camera.getChildByName("Camera").getChildByName("Camera"),t=this.boy.transform.position.clone();t.y=t.y+3.5;let i=new Laya.Vector4,a=window.homePage.project(e,t,i);this.nameLabel.visible=a,this.nameLabel.x=i.x/Laya.stage.clientScaleX,this.nameLabel.y=i.y/Laya.stage.clientScaleY}}updateIconPos(){let e=this.boy.transform.position.z,t=window.homePage.root.roadLine.width,i=Math.floor(e/580*t);i=i<t?i:t,this.headIcon.x=i}setPlayerData(e){this.roleData=e,this.nameLabel=new Laya.Image("main/Ui_EnemyName.png"),this.nameLabel.anchorX=.5,this.nameLabel.anchorY=1;let t=new Laya.Label;t.text=e.name,t.centerX=0,t.centerY=-8,t.fontSize=20,t.stroke=2,t.strokeColor="#111111",this.nameLabel.addChild(t),window.homePage.root.nameBox.addChild(this.nameLabel),this.headIcon=new Laya.Image("main/Ui_Road2.png");let i=new Laya.Image(e.head);this.headIcon.addChild(i),this.headIcon.pivotX=18,this.headIcon.pivotY=55,i.x=2,i.y=2.5,i.width=i.height=28,this.headIcon.x=0,window.homePage.root.roadLine.addChild(this.headIcon),this.updateNamePos()}changePlayerState(e){if("Float"==e){if(this.floatNow=!0,this.floatTime+=this.changeValue[6],this.floatFullTime+=this.changeValue[6],!this.boy.getChildByName("BuffFloat")){let e=window.ResManager.buffFloat.clone();e.transform.position=new Laya.Vector3(0,0,0),this.boy.addChild(e)}"Float"!=this.RoleAni.getControllerLayer(0).getCurrentPlayState().animatorState.name&&this.RoleAni.crossFade("Float",.1,0,0),this.openShadow(!1)}else if("Fly"==e){if(this.floatNow&&(this.floatTime=0,this.floatFullTime=0,this.floatNow=!1,this.removeFloat()),this.speedNow=!1,this.speedUpNum=0,this.speedTime=0,this.flyNow=!0,this.flyTime+=this.changeValue[7],this.flyFullTime+=this.changeValue[7],!this.boy.getChildByName("BuffFly")){let e=window.ResManager.buffFly.clone();e.transform.localPosition=new Laya.Vector3(0,0,0),this.boy.addChild(e)}"Fly"!=this.RoleAni.getControllerLayer(0).getCurrentPlayState().animatorState.name&&this.RoleAni.crossFade("Fly",.1,0,0),this.speedNum=this.changeValue[0]*this.changeValue[5],this.flyHeightTimestamp=0,this.lastFlyHeight=this.boy.transform.position.y,this.flyStartHeight=this.boy.transform.position.y,this.openShadow(!1)}}removeFloat(){this.floatFullTime=0;let e=this.boy.getChildByName("BuffFloat");if(e){e.removeSelf(),window.ResManager.scene.addChild(e),e.transform.position=this.boy.transform.position.clone();let t=e.transform.position.clone();t.y+=50,window.homePage.tweenTo(e,{position:t},2e3,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{e.destroy()}))}}removeFly(){this.flyFullTime=0;let e=this.boy.getChildByName("BuffFly");if(e){e.removeSelf(),window.ResManager.scene.addChild(e),e.transform.position=this.boy.transform.position.clone(),e.transform.localRotationEuler=new Laya.Vector3(0,0,0);let t=e.transform.position.clone();t.z+=100,window.homePage.tweenTo(e,{position:t},2e3,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{e.destroy()}))}}eatGold(e){e.getComponent(Laya.Animator).play("GoldGet",0,0),Laya.timer.once(2e3,this,()=>{e.destroy()})}sinIn(e,t,i,a){return-i*Math.cos(e/a*(Math.PI/2))+i+t}playerFinish(){this.nameLabel.visible=!1,this.loseNow=!0,window.GameManager.finishNum++,Laya.timer.frameOnce(1,this,()=>{this.boy.destroy()})}playerDie(){this.isDeath=!0,this.RoleAni.crossFade("Death",.1,0,0),Laya.timer.once(600,this,()=>{this.loseNow=!0,Laya.timer.frameOnce(1,this,()=>{this.boy.destroy()})})}aiLogic(){if(this.isRunningAction&&3==this.actionId){let e=this.boy.transform.position,t=window.GameManager.player.transform.position;e.z>=t.z-20&&(this.isRunningAction=!1,this.flyTime=500)}if(this.thinkTime>0&&!this.isRunningAction&&(this.thinkTime-=Laya.timer.delta,this.thinkTime<=0))if(this.thinkTime=this.getRandom(2e3,4e3),this.actionId=this.getActionId(),1==this.actionId){let e={angle:0},t=Laya.Handler.create(this,()=>{this.rotateAim=e.angle});Laya.Tween.to(e,{angle:45,update:t},1500,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{Laya.Tween.to(e,{angle:0,update:t},1500,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{this.isRunningAction=!1}))})),this.isRunningAction=!0}else if(2==this.actionId){let e={angle:0},t=Laya.Handler.create(this,()=>{this.rotateAim=e.angle});Laya.Tween.to(e,{angle:-45,update:t},1500,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{Laya.Tween.to(e,{angle:0,update:t},1500,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{this.isRunningAction=!1}))})),this.isRunningAction=!0}else 3==this.actionId&&(this.changePlayerState("Fly"),this.playSpeedUpEffect(!0),this.flyTime=1e4,this.isRunningAction=!0)}getActionId(){let e=this.boy.transform.position,t=window.GameManager.player.transform.position;if(e.z>t.z)return this.getRandom(0,2);return t.z-e.z>=this.useFlyDis&&t.z<=500?3:this.getRandom(0,2)}getRandom(e,t){return Math.floor(e+Math.random()*(t-e+1))}}class g extends Laya.Script3D{constructor(){super(),this.camera=void 0,this.posAim=[0,2.44,-15.48],this.shockNum=4,this.shockPoint=[[.2,0,.2],[0,.2,.2],[.2,.2,0],[0,0,.2],[0,0,0]]}onSetAttr(){}onAwake(){this.camera=this.owner,this.posAim=[]}onEnable(){}onDisable(){}onUpdate(){if(0==window.GameManager.gameState&&window.GameManager&&window.GameManager.player&&window.GameManager.player.transform&&!window.GameManager.roleScript.loseNow){let e=window.ResManager.scene.getChildByName("Background");e&&(e.transform.position=new Laya.Vector3(0,this.camera.transform.position.y-15,16+this.camera.transform.position.z))}}shockFun(){}}class m extends Laya.Script{constructor(){super(),this.gameState=-10,this.CameraScript=void 0,this.roleScript=void 0,this.enemyScriptList=[],this.enemyList=[],this.enemyList2=[],this.roleList=[],this.obsList=[],this.effectPreList=[],this.enemyPreList=[],this.effectList=[],this.onsNumList=[],this.enemyNumList=[],this.killNumList=[],this.deadNumList=[],this.moveNow=!1,this.gameOver=!1,this.player=void 0,this.player2=void 0,this.movePos=[0,0],this.enemyNum=8,this.pathNum=0,this.overZ=0,this.finishNum=0,this.lineNum=60,this.lastIndex=0,this.headerLine=[50,70,100,140,180,200,220,250],this.headerDis=20,this.idList=[],this.countData=null,this.brandInBlackList=!1,this.boxFrontNum=0,this.isTryTail=!1,this.tryTailId=0,this.isTrySkin=!1,this.trySkinId=0}init(){window.GameManager=m.Instance,this.blackTest(),this.brandInBlackList?(this.boxFrontNum=15,window.ResManager.boxNumber=15):(this.boxFrontNum=30,window.ResManager.boxNumber=25)}onMakeScene(e,t=!1){Laya.timer.clear(this,this.effectDeal),this.player&&(window.ResManager.scene.removeChild(this.player),this.player.destroy());for(let e=0;e<this.enemyList.length;e++){const t=this.enemyList[e];window.ResManager.scene.removeChild(t),t.destroy()}for(let e=0;e<this.enemyList2.length;e++){const t=this.enemyList2[e];window.ResManager.scene.removeChild(t),t.destroy()}for(let e=0;e<this.roleList.length;e++){const t=this.roleList[e];window.ResManager.scene.removeChild(t),t.destroy()}for(let e=0;e<this.obsList.length;e++){const t=this.obsList[e];window.ResManager.scene.removeChild(t),t.destroy()}for(let e=0;e<this.effectPreList.length;e++){const t=this.effectPreList[e];window.ResManager.scene.removeChild(t),t.destroy()}for(let e=0;e<this.enemyPreList.length;e++){const t=this.enemyPreList[e];window.ResManager.scene.removeChild(t),t.destroy()}for(let e=0;e<this.effectList.length;e++){const t=this.effectList[e];window.ResManager.scene.removeChild(t),t.destroy()}if(window.GameManager.finishNum=0,this.lastIndex=0,this.isTrySkin){var i=window.ResManager.onCloneTryRole(this.trySkinId);this.isTrySkin=!1,this.trySkinId=0}else i=window.ResManager.onCloneRole();if(window.ResManager.scene.addChild(i),i.transform.position=new Laya.Vector3(0,0,10),this.player=i,this.enemyList=[],this.enemyList2=[],this.enemyNumList=[],this.enemyScriptList=[],this.enemyPreList=[],this.obsList=[],this.onsNumList=[],window.ResManager.playerGround=0,window.ResManager.updateGroundDataList(),window.ResManager.taskList=[],window.ResManager.LoadScene(2),this.pathNum=2,this.overZ=0,null==this.CameraScript){var a=window.ResManager.camera.addComponent(g);this.CameraScript=a}window.ResManager.camera.transform.position=i.transform.position.clone(),window.ResManager.camera.transform.localRotationEuler=new Laya.Vector3(0,0,0),window.ResManager.camera.getComponent(Laya.Animator).play("CameraStand",0,0);var s=i.addComponent(l);i.name="player",this.roleScript=s,Laya.timer.once(2e3,this,()=>{this.roleScript.setPlayerData({id:2,name:"主角名字",head:"main/Ui_FrameHead2.png"})});let o=window.ResManager.scene.getChildByName("Background");o&&(o.transform.position=new Laya.Vector3(0,this.CameraScript.owner.transform.position.y-13.3,12+this.CameraScript.owner.transform.position.z)),Laya.timer.frameLoop(1,this,this.effectDeal)}createRole(e){var t=[10,5,0,-5,-10],i=window.ResManager.onCloneEnemyRole();window.ResManager.scene.addChild(i),i.transform.position=new Laya.Vector3(t[e.id],0,10),console.log(t[e.id],e),this.enemyList.push(i);var a=i.addComponent(c);a.setPlayerData(e),a.setAttr(t[e.id]),this.enemyScriptList.push(a)}createRole2(e,t){var i=[10,5,0,-5,-10],a=window.ResManager.onCloneEnemyRole();window.ResManager.scene.addChild(a);let s=5+t;for(let t=0;t<3;t++){let n=this.findPosition(t,s);if(n){a.transform.position=new Laya.Vector3(n.x,n.y,2*s),this.enemyList.push(a);var o=a.addComponent(c);return o.setPlayerData(e),o.setAttr(i[e.id]),this.enemyScriptList.push(o),void o.moveStart()}}}getRoleId(){return this.idList.splice(this.randomIndex(this.idList.length),1)[0]}randomIndex(e){return Math.floor(Math.random()*e)}findPosition(e,t){let i=window.ResManager.groundDataList[e][t];for(let t=0;t<i.length;t++){if("3"==i[t])return new Laya.Vector2(19-2*(t+10),-25*e)}return null}refreshHeaderRole(){if(this.headerLine.length>0){let e=this.headerLine[0];if(2*e-window.GameManager.player.transform.position.z<2*this.headerDis){let t=Laya.loader.getRes("res/AiImage/name.json"),i=this.getRoleId(),a={name:t.name[i],head:`res/AiImage/Ai${i+1}.png`};this.createRole2(a,e),this.headerLine.shift()}}}initIdList(){this.headerLine=[50,70,100,140,180,200,220],this.idList=[];for(let e=0;e<50;e++)this.idList.push(e)}blackTest(){let e="";this.brandInBlackList=!1,window.wx?e=wx.getSystemInfoSync().model:window.qg&&(e=qg.getSystemInfoSync().model);-1!=["OPPO A77","OPPO R9s","OPPO A73","OPPO R9m","OPPO A57","OPPO A37t"].indexOf(e)&&(this.brandInBlackList=!0)}effectDeal(){this.roleScript.posNow>this.pathNum-this.boxFrontNum&&(window.ResManager.LoadScene(this.pathNum+2,0),this.pathNum=this.pathNum+2),this.refreshHeaderRole()}gameStart(){this.roleScript.moveStart();for(let e=0;e<this.enemyScriptList.length;e++){this.enemyScriptList[e].moveStart()}}createEffect(e){var t=window.ResManager.effect1.clone();window.ResManager.scene.addChild(t),this.effectPreList.push(t),t.transform.position=new Laya.Vector3(e.x,0,e.z)}loseFun(){this.gameState=-1,this.gameOver=!0,Laya.SoundManager.stopSound("res/Sound/Ju.mp3")}loseObs(e=0,t=0){var i,a=[[0,1,2,0,1,2,1,0],[4],[3],[4]],s=(window.DataManager.stageNum-1)%4;if(0==s)var o=a[0][t];else o=a[s][0];-1==e?(i=this.roleScript,Laya.SoundManager.playSound("res/Sound/Boom.mp3",1)):i=this.enemyScriptList[e];var n=(i.rotateNow+360)%360;if(n>67.5&&n<112.5||n>247.5&&n<292.5)var r=window.ResManager.obsList[o][1].clone();else if(n>157.5&&n<202.5||n>337.5||n<22.5)r=window.ResManager.obsList[o][2].clone();else if(n>22.5&&n<67.5||n>202.5&&n<247.5)r=window.ResManager.obsList[o][3].clone();else r=window.ResManager.obsList[o][4].clone();0==s&&r.transform.setWorldLossyScale(new Laya.Vector3(2.5,2.5,2.5));var h=this.obsList[t].transform.position.x,d=this.obsList[t].transform.position.z;window.ResManager.scene.removeChild(this.obsList[t]),window.ResManager.scene.addChild(r),r.transform.position=new Laya.Vector3(h,0,d),this.enemyList2.push(r)}onGameStart(){console.log("游戏开始^_^"),this.gameState=0}changePlayer(){}onGameEnd(){console.log("游戏结算"),this.gameState=1}onGameOver(){console.log("游戏结束"),this.gameState=-1}onGamePause(){console.log("游戏暂停"),this.gameState=5}onGameResume(){console.log("游戏继续"),this.gameState=0}musicStart(e="",t=1){1==window.DataManager.soundOpen&&Laya.SoundManager.playSound(e,t)}}m.Instance=new m;class p extends Laya.Script{constructor(){super(),this.loginJudge=!1,this.loginOver=!1,this.useUrl="https://clb-yssn.8zy.com/music_tt/",this.logUrl="http://openapi.jiegames.com/logger/logInfoUpload",this.normalVer="1",this.token="",this.userId=""}init(){window.NetManager=p.Instance}static send(e,t,i,a=null,s="get",o="text",n=null){let r=new Laya.HttpRequest;return r.once(Laya.Event.COMPLETE,this,e=>{t&&t(e?JSON.parse(e):null)},r.data),r.once(Laya.Event.ERROR,this,t=>{console.error("接口错误",e,a,s),i&&i(a||null)}),r.send(e,a,s,o,n),r}onShare(e,t){if(window.tt){var i=Math.floor(5*Math.random()),a=Math.floor(10*Math.random());window.tt.shareAppMessage({imageUrl:["https://cdn-yssn.8zy.com/speedPackageDown/TTsrc/TTImg/TT1.png","https://cdn-yssn.8zy.com/speedPackageDown/TTsrc/TTImg/TT2.png","https://cdn-yssn.8zy.com/speedPackageDown/TTsrc/TTImg/TT3.png","https://cdn-yssn.8zy.com/speedPackageDown/TTsrc/TTImg/TT4.png","https://cdn-yssn.8zy.com/speedPackageDown/TTsrc/TTImg/TT5.png"][i],title:"音速少女",desc:["来跟着萌妹子们一起听歌打怪兽吧！","这..这节奏！根本停不下来！","不会吧，不会吧？难道有人比我更懂踩点？","除了萌和可爱..我..我还有Music！","别烦我！我在和萌娘们跳舞打怪！","主人主人，音速少女们等你收集！","踩住音乐节点，和音速少女跳舞吧！","音速少女，你没见过的音乐节奏游戏！","卡点谁最强！我可是全部卡中哦！","终于出现啦！这才是我要的音乐游戏！"][a],query:"",success(){console.log("分享成功"),window.shareBack(),r.Instance.dispatchEvent("WXShow")},fail(e){console.log("分享失败"),window.shareBack2(),r.Instance.dispatchEvent("WXShow")}})}}regFun(){if(Laya.Browser.onWeiXin){var e={appid:"wx9dda2433abd20d38",openid:wx.mmmsdk.openid,pf:"wechatgame",zoneid:1,zonename:"1区",roleid:123,rolename:window.DataManager.userName};this.connect2("https://report.8zy.com/rpt/regchar",e,e=>{console.log(e)})}}loginFun(){if(Laya.Browser.onWeiXin){var e="scene=",t=wx.getLaunchOptionsSync();if(e+=t.scene,t.query)for(const i in t.query)if(Object.prototype.hasOwnProperty.call(t,i)){e=e+"&"+i+"="+t[i]}var i={appid:"wx9dda2433abd20d38",openid:wx.mmmsdk.openid,pf:"wechatgame",via:e};this.connect2("https://report.8zy.com/rpt/login",i,e=>{console.log(e)})}}regFunOnce(){if(window.tt){var e="scene=",t=window.tt.getLaunchOptionsSync();if(e+=t.scene,t.query)for(const i in t.query)if(Object.prototype.hasOwnProperty.call(t,i)){e=e+"&"+i+"="+t[i]}window.any_openid=localStorage.getItem("any_openid");var i=1;Laya.Browser.onIOS&&(i=2);var a=window.tt.getSystemInfoSync(),s={appid:"tta90adfb73630dc98",openid:window.any_openid,pf:"ttgame",via:e,mobile:a.brand,mobiletype:a.model,os:i};this.connect2("https://report.8zy.com/rpt/regaccount",s,e=>{console.log(e)})}}loginJudgeFun(){0==this.loginOver&&(this.loginOver=!0,this.loginJudge?this.loginFun():this.regFun())}DecodeMessage(e){}onHttpRequestError(e){console.log(e)}onHttpRequestProgress(e){}connect(e,t){this.callBack=t,this.hr=new Laya.HttpRequest,this.hr.once(Laya.Event.PROGRESS,this,this.onHttpRequestProgress),this.hr.once(Laya.Event.COMPLETE,this,this.onHttpRequestComplete),this.hr.once(Laya.Event.ERROR,this,this.onHttpRequestError),console.log("http Send:",e),this.hr.send(e,null,"get","text")}connect3(e,t){this.callBack=t,this.hr3=new Laya.HttpRequest,this.hr3.once(Laya.Event.PROGRESS,this,this.onHttpRequestProgress),this.hr3.once(Laya.Event.COMPLETE,this,this.onHttpRequestComplete),this.hr3.once(Laya.Event.ERROR,this,this.onHttpRequestError),console.log("http Send:",e),this.hr3.send(e,null,"get","text")}connect2(e,t,i){this.callBack=i,this.hr2=new Laya.HttpRequest,this.hr2.once(Laya.Event.PROGRESS,this,this.onHttpRequestProgress),this.hr2.once(Laya.Event.COMPLETE,this,this.onHttpRequestComplete),this.hr2.once(Laya.Event.ERROR,this,this.onHttpRequestError),console.log("http Send:",e),this.hr2.send(e,JSON.stringify(t),"post","text",["content-type","application/json;charset=UTF-8"])}onHttpRequestComplete(e){if(this.hr&&this.hr.data){var t=JSON.parse(this.hr.data);if(!t)return;this.callBack&&this.callBack(t)}}getCodeNowHttpUrl(e="",t=""){return window.tt?this.useUrl+"GetOpenId?code="+e+"&channel=1&anonymous_code="+t:this.useUrl+"GetOpenId?code="+Math.floor(1e7*Math.random())+"&channel=-1&anonymous_code="+t}getImgUpdateHttpUrl(e){var t=this.userId;return this.useUrl+"bindAccount?uuid="+t+"&rawData="+encodeURI(e)}UpdateVideoID(e=""){this.userId;var t=window.DataManager.dayStr[window.ResManager.stepID],i=["-新手","-普通","-大师"][window.DataManager.chooseList[window.ResManager.stepID]];return this.useUrl+"updateVideoList_t?videoid="+e+"&&uuid="+this.userId+"&&usr_name="+window.DataManager.userName+"&&head_url="+encodeURI(window.DataManager.headImg)+"&&sound_name="+(t+i)+"&&music_score="+window.gamePage.score}GetVideoID(){this.userId;return this.useUrl+"queryVideoList_t"}getUpdateHttpUrl(e,t,i,a){var s=this.userId;return this.useUrl+"Update?uuid="+s+"&action=music&id="+t+"&type="+i+"&value="+e+"&count="+a}getListHttpUrl(e,t,i,a){var s=this.userId;return e?this.useUrl+"Query?uuid="+s+"&action=music&id="+t+"&type="+i:this.useUrl+"Query?uuid="+s+"&action=rank"}}p.Instance=new p;class w{constructor(){this.RoleID=0,this.SceneID=0,this.MachineID=0,this.RoleLevel=0,this.stageNum=1,this.resUrl="res/",this.money=0,this.diamond=0,this.musicOpen=1,this.soundOpen=1,this.vibrateOpen=1,this.useSkinId=0,this.useTailId=0,this.skinUnlockRecord=[1,0,0,0,0,0,0,0,0,0],this.tailUnlockRecord=[1,0,0,0,0,0,0,0,0,0],this.dayFinishNum=0,this.dayMoneyNum=0,this.dayWinNum=0,this.dayUnlockNum=0,this.dayTimeStamp=0,this.dayTaskRecord=[0,0,0],this.dayTaskId=[],this.dayTaskRefreshRecord=[0,0,0],this.achieveJumpNum=0,this.achieveSpeedNum=0,this.achieveFinishNum=0,this.achieveWinNum=0,this.achieveUnlockNum=1,this.achieveMoneyNum=0,this.achieveTaskRecord=[0,0,0,0,0,0],this.achieveTaskStage=[0,0,0,0,0,0],this.signTimeStamp=0,this.signDay=0,this.signRecord=[0,0,0,0,0,0,0],this.freeLotteryUseTimestamp=0,this.rewardSkinId=1,this.rewardSkinProgress=0,this.rewardTailId=1,this.rewardTailProgress=0,this.rewardType=0,this.rewardCount=0,this.userId=null,this.userName=null,this.LevelData=[],this.LevelData2=[],this.LevelData3=[]}onGetRandom(e,t){return Math.floor(Math.random()*(t-e+1)+e)}init(){window.DataManager=w.Instance,p.Instance.init(),this.onInitLocalStorage()}onInitLocalStorage(){var e=localStorage.getItem("userId");e?(this.userId=e,this.userName=e):(this.userId=Date.now()+Math.floor(1e3*Math.random()).toString(),this.userName=this.userId);var t=localStorage.getItem("RoleID_CarFight");t&&(this.RoleID=Number(t));var i=localStorage.getItem("SceneID_CarFight");i&&(this.SceneID=Number(i));var a=localStorage.getItem("MachineID_CarFight");a&&(this.MachineID=Number(a));var s=localStorage.getItem("RoleLevel_CarFight");s&&(this.RoleLevel=Number(s));var o=localStorage.getItem("stageNum_CarFight");o&&(this.stageNum=Number(o));var n=localStorage.getItem("money");n&&(this.money=Number(n));var r=localStorage.getItem("diamond");r&&(this.diamond=Number(r));var h=localStorage.getItem("musicOpen");h&&(this.musicOpen=Number(h));var d=localStorage.getItem("soundOpen");d&&(this.soundOpen=Number(d));var l=localStorage.getItem("vibrateOpen");l&&(this.vibrateOpen=Number(l));var c=localStorage.getItem("skinUnlockRecord");c&&(this.skinUnlockRecord=JSON.parse(c));var g=localStorage.getItem("tailUnlockRecord");g&&(this.tailUnlockRecord=JSON.parse(g));var m=localStorage.getItem("useSkinId");m&&(this.useSkinId=Number(m));var p=localStorage.getItem("useTailId");p&&(this.useTailId=Number(p));var w=localStorage.getItem("dayFinishNum");w&&(this.dayFinishNum=Number(w));var u=localStorage.getItem("dayMoneyNum");u&&(this.dayMoneyNum=Number(u));var y=localStorage.getItem("dayWinNum");y&&(this.dayWinNum=Number(y));var f=localStorage.getItem("dayUnlockNum");f&&(this.dayUnlockNum=Number(f));var v=localStorage.getItem("dayTimeStamp");v&&(this.dayTimeStamp=Number(v));var S=localStorage.getItem("dayTaskRecord");S&&(this.dayTaskRecord=JSON.parse(S));var b=localStorage.getItem("dayTaskRefreshRecord");b&&(this.dayTaskRefreshRecord=JSON.parse(b));var L=localStorage.getItem("dayTaskId");if(L&&(this.dayTaskId=JSON.parse(L)),0==this.dayTimeStamp||Date.now()-this.dayTimeStamp>864e5){this.dayTimeStamp=Date.now(),localStorage.setItem("dayTimeStamp",this.dayTimeStamp.toString()),this.dayFinishNum=0,localStorage.setItem("dayFinishNum","0"),this.dayMoneyNum=0,localStorage.setItem("dayMoneyNum","0"),this.dayWinNum=0,localStorage.setItem("dayWinNum","0"),this.dayUnlockNum=0,localStorage.setItem("dayUnlockNum","0"),this.dayTaskRecord=[0,0,0],localStorage.setItem("dayTaskRecord",JSON.stringify(this.dayTaskRecord)),this.dayTaskRefreshRecord=[0,0,0],localStorage.setItem("dayTaskRefreshRecord",JSON.stringify(this.dayTaskRecord));let e=[0,1,2,3];this.dayTaskRecord=[],this.dayTaskId.push(e.splice(this.randomIndex(e.length),1)[0]),this.dayTaskId.push(e.splice(this.randomIndex(e.length),1)[0]),this.dayTaskId.push(e.splice(this.randomIndex(e.length),1)[0]),this.dayTaskId.sort((e,t)=>e-t),localStorage.setItem("dayTaskId",JSON.stringify(this.dayTaskId))}var I=localStorage.getItem("achieveJumpNum");I&&(this.achieveJumpNum=Number(I));var C=localStorage.getItem("achieveSpeedNum");C&&(this.achieveSpeedNum=Number(C));var k=localStorage.getItem("achieveFinishNum");k&&(this.achieveFinishNum=Number(k));var N=localStorage.getItem("achieveWinNum");N&&(this.achieveWinNum=Number(N));var M=localStorage.getItem("achieveUnlockNum");M&&(this.achieveUnlockNum=Number(M));var D=localStorage.getItem("achieveMoneyNum");D&&(this.achieveMoneyNum=Number(D));var T=localStorage.getItem("achieveTaskRecord");T&&(this.achieveTaskRecord=JSON.parse(T));var B=localStorage.getItem("achieveTaskStage");B&&(this.achieveTaskStage=JSON.parse(B));var R=localStorage.getItem("signTimeStamp");R&&(this.signTimeStamp=Number(R));var P=localStorage.getItem("signDay");P&&(this.signDay=Number(P));var x=localStorage.getItem("signRecord");x&&(this.signRecord=JSON.parse(x)),0!=this.signTimeStamp&&Date.now()-this.signTimeStamp>864e5&&(6==this.signDay?1==this.signRecord[this.signDay]&&(this.signDay=0,this.signRecord=[0,0,0,0,0,0,0],localStorage.setItem("signDay",this.signDay.toString()),localStorage.setItem("signRecord",JSON.stringify(this.signRecord))):1==this.signRecord[this.signDay]&&(this.signDay++,localStorage.setItem("signDay",this.signDay.toString())));var A=localStorage.getItem("freeLotteryUseTimestamp");A&&(this.freeLotteryUseTimestamp=Number(A));var U=localStorage.getItem("rewardSkinId");U&&(this.rewardSkinId=Number(U));var _=localStorage.getItem("rewardSkinProgress");_&&(this.rewardSkinProgress=Number(_));var E=localStorage.getItem("rewardTailId");E&&(this.rewardTailId=Number(E));var O=localStorage.getItem("rewardTailProgress");O&&(this.rewardTailProgress=Number(O));var F=localStorage.getItem("rewardType");F&&(this.rewardType=Number(F));var V=localStorage.getItem("rewardCount");V&&(this.rewardCount=Number(V)),window.loadPage.init()}randomIndex(e){return Math.floor(Math.random()*e)}loadJson(e){return Laya.Loader.getRes("res/config/"+e+".json")}onDataInit(){var e=this.loadJson("level");this.LevelData.push(e)}}w.Instance=new w,function(e){e.unknown="unknown",e.qq="qq",e.wechat="wx",e.tt="tt",e.oppo="oppo",e.vivo="vivo",e.editor="editor"}(t||(t={}));class u{constructor(){this.platform=t.unknown,this.adUnitId_Config={wx:{bannerId:"adunit-83215d8b1a2f38eb",videoId:"adunit-b4de8f4a9aede4eb",interstitialId:"adunit-9d7d6675ccfc7d20"},qq:{bannerId:"ad2918d389e3686713d15e9dd4aa85b2",videoId:"f643227e68419423ff634b594dc139a8",appBoxId:["8795f01ae515971a67967322f0a8bbfe","e7543f1deacad96dff7ad9a1d919c7bf"],blockId:"89bd30f53749f7b662ab31b5e8ee7614",interstitialId:"fc02726f82ae326434122b8d01664d58"},tt:{bannerId:"1keoma3rxfsdkiaf20",videoId:"6stdfb5dk4v4aa9gg7",interstitialId:"798h1ke04a2d2278qt"},oppo:{appId:"30593425",nativeId:["359518","359520"],videoId:"359517",bannerId:"359516",interstitialId:null,boxId:null},vivo:{appId:"100012178",nativeId:["fa3581708725480992aa5885d48a8a4c","c19765a97fef4481b9eaffd06d033fd4","29beaf0e15d0413b8b593cddd36c283c","a28c6641cdc34f4299513f829ccc6c04","5bad1eae21d547c9bb0ab28979b3d13b","48be9800f7da4cbc80bee9cfa0dd9323","94b31ba1dd614c28835f34e6fee80501","4d4d53ee56b54ac789c2f4ac04702cbf","a592cb77f0314063ac30acd8703c147e","181f8927cad849af82b7bb886ed7f494"],videoId:"081915e69c89445698fa91eb33a14442",bannerId:"0b2a4a8ed49d4b63897237331c9c5e19",interstitialId:"72e488c74a584e028551f6c8ecd6dc55"}},this.recommendConfig=[{name:"我冲的贼快",appId:"30444933",pkgName:"com.wcdzk.xxtch.nearme.gamecenter"},{name:"兽王争霸",appId:"30428233",pkgName:"com.monsterking.xxtch.nearme.gamecenter"},{name:"撞飞糖豆人",appId:"30439515",pkgName:"com.zftdr.xxtch.nearme.gamecenter"},{name:"音速少女",appId:"30348185",pkgName:"com.speedgirl.xxtch.nearme.gamecenter"},{name:"肥仔大冲撞",appId:"30439517",pkgName:"com.fzdcz.xxtch.nearme.gamecenter"},{name:"剁手狂欢",appId:"30439516",pkgName:"com.xx.cutmyhand.nearme.gamecenter"}],this.adUnitId_Banner=null,this.adUnitId_Video=null,this.adUnitId_AppBox=null,this.adUnitId_BlockAd=null,this.adUnitId_Interstitial=null,this.adUnitId_Native=null,this.adUnitId_OppoBox=null,this.rewardedVideoAd=null,this.bannerAd=null,this.interstitialAd=null,this.appBoxs=null,this.blockAd=null,this.nativeAd=[],this.nativeAdData=[],this.boxAdSelf=null,this.boxAdOfficial=null,this.banner_Width=300,this.banner_Height=120,this.margin_Bottom=0,this.nativeLoadTime=0,this.video_OnLoad_Callback=null,this.video_OnClose_Callback=null,this.native_OnLoad_Callback=null,this.adList=[],this.noAd=!1,this.isCheat=0,this.isShowNative=0,this.exchangeTime=0,this.delayTime=0,this.defaultOpen=0,this.oppoLimit=0,this.oppoShowBanner=0,this.boxTimeLimit=4,this.boxType=0,this.isOfficial=1,this.freeTry=1,this.showVideoEventId=0,this.isOld=0,this.forceAd=0,this.forceTimeDelay=18e4,this.forceTimeLeft=1,this.tryDelayTime=0,this.packDelayTime=0,this.reportShowPer=[],this.reportShowTimeLeft=2,this.refreshNativeTimeDelay=[],this.nativePer=[100,10,100,50,50,1],this.isNativeInsertShow=!1,this.mistakeSwitch=0,this.mistakeTimeDelay=0,this.pullTimeDelay=60,this.secondReportPer=0,this.thirdReportPer=0,this.nativeRefreshTimeDelay=10,this.thirdNativeBelong=0,this.improveExpPer=.3,this.rewardPurplePer=.02,this.moneyGodPer=0,this.isGD=!1,this.superBtnPer=[0,0],this.closeAd=0,this.isTestNative=!1,this.nativeRePullTime=1,this.testNativeTime=2e4,this.areaCode=0,this.atkControl=1,this.insertAdShowGap=60,this.isShowTreasureClose=0,this.isShowTreasurePage=0,this.closeAreaList=[[440300,440399],[510100,510199],[5e5,501e3],[440100,440199],[441900,441999],[44e4]],this.nativeTestData={adId:"89fa5398-56a5-47cf-bafb-f1079ea6aec7",clickBtnTxt:"立即下载",creativeType:3,desc:"抖音极速版，有红包可以领！",iconUrlList:["https://store.heytapimage.com/img/202107/28/95e271c68c4a28a3395bd3d89c58e0c8.png"],icon:"https://store.heytapimage.com/img/202107/28/95e271c68c4a28a3395bd3d89c58e0c8.png",interactionType:3,logoUrl:"https://adsfs.heytapimage.com/union/adlogo/o_1512387525231.png",title:"抖音极速版",imgUrlList:[]},this._retryInitBannerAdLeft=0,this._retryInitInterstitialAdTimeLeft=0}static get Instance(){return null==this._instance&&(this._instance=new u),window.AllPlatformAdMgr=this._instance,this._instance}getPlatform(){if(window.wx)this.platform=t.wechat,window.tt&&(this.platform=t.tt),window.qq&&(this.platform=t.qq);else if(window.qg){let e=qg.getSystemInfoSync();"OPPO"==e.brand?this.platform=t.oppo:"vivo"==e.brand&&(this.platform=t.vivo)}else this.platform=t.editor,this.isTestNative=!0}init(){this.getPlatform(),this.initAdId(),this.initAdComponent(),this.getCheatState().then(()=>{this.initAdComponent()})}updateIsGD(){var e=this.closeAreaList,t=this.areaCode,i=!1;for(let a=0;a<e.length;a++){const s=e[a];if(2==s.length){if(t>=s[0]&&t<s[1]){i=!0;break}}else if(t==s[0]){i=!0;break}}i&&(this.isGD=!0)}initAdId(){switch(this.platform){case t.wechat:this.adUnitId_Video=this.adUnitId_Config.wx.videoId,this.adUnitId_Banner=this.adUnitId_Config.wx.bannerId,this.adUnitId_Interstitial=this.adUnitId_Config.wx.interstitialId;break;case t.qq:this.adUnitId_Video=this.adUnitId_Config.qq.videoId,this.adUnitId_Banner=this.adUnitId_Config.qq.bannerId,this.adUnitId_AppBox=this.adUnitId_Config.qq.appBoxId,this.adUnitId_BlockAd=this.adUnitId_Config.qq.blockId,this.adUnitId_Interstitial=this.adUnitId_Config.qq.interstitialId;break;case t.tt:this.adUnitId_Video=this.adUnitId_Config.tt.videoId,this.adUnitId_Banner=this.adUnitId_Config.tt.bannerId,this.adUnitId_Interstitial=this.adUnitId_Config.tt.interstitialId;break;case t.oppo:this.adUnitId_Video=this.adUnitId_Config.oppo.videoId,this.adUnitId_Interstitial=this.adUnitId_Config.oppo.interstitialId,this.adUnitId_Native=this.adUnitId_Config.oppo.nativeId,this.adUnitId_Banner=this.adUnitId_Config.oppo.bannerId,this.adUnitId_OppoBox=this.adUnitId_Config.oppo.boxId;break;case t.vivo:this.adUnitId_Video=this.adUnitId_Config.vivo.videoId,this.adUnitId_Interstitial=this.adUnitId_Config.vivo.interstitialId,this.adUnitId_Native=this.adUnitId_Config.vivo.nativeId,this.adUnitId_Banner=this.adUnitId_Config.vivo.bannerId}}initAdComponent(){switch(this.platform){case t.wechat:this.initVideoAd(),this.initBannerAd(),this.initInterstitialAd();break;case t.qq:this.initVideoAd(),this.initBannerAd(),this.initAppBox(),this.initBlockAd(),this.initInterstitialAd();break;case t.tt:this.initVideoAd();break;case t.oppo:this.initVideoAd(),this.initBannerAd(),this.initNativeAd(),this.testNative(),this.initBox(),this.updateReportShowTimeLeft();break;case t.vivo:this.initVideoAd(),this.initBannerAd(),this.initNativeAd(),this.initInterstitialAd(),this.updateReportShowTimeLeft()}}getCheatState(){return new Promise(e=>{let t=this.getAdconfigUrl();Laya.loader.load(t,Laya.Handler.create(this,t=>{t&&(this.isCheat=t.isCheat,this.isShowNative=t.isShowNative,this.exchangeTime=t.exchangeTime,this.delayTime=t.delayTime,this.defaultOpen=t.defaultOpen,this.oppoLimit=t.oppoLimit,this.oppoShowBanner=t.oppoShowBanner,this.isOfficial=t.isOfficial,this.freeTry=t.freeTry?t.freeTry:0,this.isOld=t.isOld?t.isOld:0,this.forceAd=t.forceAd?t.forceAd:0,this.tryDelayTime=t.tryDelayTime?t.tryDelayTime:0,this.mistakeSwitch=t.mistakeSwitch?t.mistakeSwitch:0,this.mistakeTimeDelay=t.mistakeTimeDelay?t.mistakeTimeDelay:0,this.packDelayTime=t.packDelayTime?t.packDelayTime:0,this.forceAd&&Laya.timer.once(12e4,this,()=>{this.forceTimeDelay=0}),this.reportShowPer=t.reportShowPer?t.reportShowPer:this.reportShowPer,this.refreshNativeTimeDelay=t.refreshNativeTimeDelay?t.refreshNativeTimeDelay:this.refreshNativeTimeDelay,this.nativePer=t.nativePer?t.nativePer:this.nativePer,this.pullTimeDelay=t.pullTimeDelay?t.pullTimeDelay:this.pullTimeDelay,this.secondReportPer=t.secondReportPer?t.secondReportPer:this.secondReportPer,this.thirdReportPer=t.thirdReportPer?t.thirdReportPer:this.thirdReportPer,this.nativeRefreshTimeDelay=t.nativeRefreshTimeDelay?t.nativeRefreshTimeDelay:this.nativeRefreshTimeDelay,this.thirdNativeBelong=t.thirdNativeBelong?t.thirdNativeBelong:this.thirdNativeBelong,this.adUnitId_Native=t.nativeId?t.nativeId:this.adUnitId_Native,this.improveExpPer=t.improveExpPer?t.improveExpPer:this.improveExpPer,this.rewardPurplePer=t.rewardPurplePer?t.rewardPurplePer:this.rewardPurplePer,this.moneyGodPer=t.moneyGodPer?t.moneyGodPer:this.moneyGodPer,this.superBtnPer=t.superBtnPer?t.superBtnPer:this.superBtnPer,this.closeAd=t.closeAd?t.closeAd:this.closeAd,this.testNativeTime=t.testNativeTime?t.testNativeTime:this.testNativeTime,this.closeAreaList=t.closeAreaList?t.closeAreaList:this.closeAreaList,this.atkControl=t.atkControl?t.atkControl:1,this.isShowTreasureClose=t.isShowTreasureClose?t.isShowTreasureClose:0,this.isShowTreasurePage=t.isShowTreasurePage?t.isShowTreasurePage:0,this.insertAdShowGap=t.insertAdShowGap?t.insertAdShowGap:60,e())}))})}getAdconfigUrl(){return`https://demo.xxtch.com/BoxRun/adconfig/adconfig_${this.platform}_1.0.json?ran=${Math.floor(1e6*Math.random())}`}initBox(){if(this.adUnitId_OppoBox&&this.platform===t.oppo){Laya.timer.once(60*this.boxTimeLimit*1e3,this,()=>{this.boxTimeLimit=0}),this.boxAdSelf=new Laya.Image("ads/Ui_Commontuijian.png"),this.boxAdSelf.width=Laya.stage.width,this.boxAdSelf.height=275;for(let e=0;e<this.recommendConfig.length;e++){let t=this.recommendConfig[e];if(t.appId==this.adUnitId_Config.oppo.appId){let i=new Laya.Image("ads/icon"+t.appId+".png");i.anchorY=.5,i.y=168,i.width=i.height=128,i.x=52+148*e,i.on(Laya.Event.CLICK,this,()=>{qg.navigateToMiniGame({pkgName:t.pkgName})}),this.boxAdSelf.addChild(i)}}qg.getSystemInfoSync().platformVersionCode>=1076&&(this.boxAdOfficial=qg.createGameBannerAd({adUnitId:this.adUnitId_OppoBox}),this.boxAdOfficial.onError(e=>{console.error(e)}),this.boxAdOfficial.onLoad(e=>{console.log(e)}))}}showBox(){(this.boxAdSelf||this.boxAdOfficial)&&(this.isOfficial&&this.boxAdOfficial?this.boxAdOfficial.show():(this.boxAdSelf.x=0,this.boxAdSelf.y=Laya.stage.height-this.boxAdSelf.height,Laya.stage.addChild(this.boxAdSelf)))}hideBox(){(this.boxAdSelf||this.boxAdOfficial)&&(this.isOfficial&&this.boxAdOfficial?this.boxAdOfficial.hide():Laya.stage.removeChild(this.boxAdSelf))}initBlockAd(){if(this.adUnitId_BlockAd&&this.platform===t.qq){let e=this.blockAd;e&&e.destroy();let t=qq.getSystemInfoSync();this.blockAd=qq.createBlockAd({adUnitId:this.adUnitId_BlockAd,style:{left:0,top:0},size:5,orientation:"landscape"}),(e=this.blockAd).onError(e=>{console.log(e)}),e.onResize(i=>{console.log(i);let a=t.screenHeight-i.height-300/t.pixelRatio,s=(t.screenWidth-i.width)/2;e.style.top=a,e.style.left=s})}}showBlockAd(){this.blockAd&&this.blockAd.show()}hideBlockAd(){this.blockAd&&this.initBlockAd()}getBannerStyle(){if(this.bannerAd&&this.platform==t.qq){return this.bannerAd.style}}initBannerAd(){if(this.adUnitId_Banner)if(this.platform===t.wechat){let e=this.bannerAd;e&&e.destroy();let t=wx.getSystemInfoSync();this.banner_Width=t.screenWidth;let i=(t.screenWidth-this.banner_Width)/2,a=t.screenHeight-this.banner_Height-this.margin_Bottom;this.bannerAd=wx.createBannerAd({adUnitId:this.adUnitId_Banner,adIntervals:30,style:{left:i,top:a,width:this.banner_Width,height:this.banner_Height}}),(e=this.bannerAd).onError(e=>{console.log(e)}),e.onResize(i=>{this.banner_Height=i.height,e.style.top=t.screenHeight-this.banner_Height-this.margin_Bottom})}else if(this.platform===t.qq){let e=this.bannerAd;e&&e.destroy();let t=qq.getSystemInfoSync(),i=(t.screenWidth-this.banner_Width)/2,a=t.screenHeight-this.banner_Height-this.margin_Bottom;this.bannerAd=qq.createBannerAd({adUnitId:this.adUnitId_Banner,style:{left:i,top:a,width:this.banner_Width,height:this.banner_Height}}),(e=this.bannerAd).onResize(i=>{this.banner_Height=i.height,e.style.top=t.screenHeight-this.banner_Height-this.margin_Bottom})}else if(this.platform===t.tt){this.banner_Width=140;let e=tt.getSystemInfoSync(),t=e.screenHeight-this.banner_Width/16*9-this.margin_Bottom,i=this.bannerAd;i&&i.destroy(),this.bannerAd=tt.createBannerAd({adUnitId:this.adUnitId_Banner,adIntervals:30,style:{top:t,width:this.banner_Width}}),(i=this.bannerAd).onError(e=>{console.log(e)}),i.onLoad(()=>{i.show().then(()=>{console.log("广告显示成功")}).catch(e=>{console.log("广告组件出现问题",e)})}),i.onResize(t=>{this.banner_Height=t.height,this.banner_Width=t.width,i.style.top=e.screenHeight-this.banner_Height-this.margin_Bottom,i.style.left=(e.screenWidth-t.width)/2}),i.style.left=(e.screenWidth-this.banner_Width)/2}else if(this.platform===t.oppo){let e=this.bannerAd;if(e)return;let t=qg.getSystemInfoSync();this.banner_Width=t.screenWidth;let i=(t.screenWidth-this.banner_Width)/2,a=t.screenHeight-this.banner_Height-this.margin_Bottom;this.bannerAd=qg.createBannerAd({adUnitId:this.adUnitId_Banner,style:{left:i,top:a,width:this.banner_Width,height:this.banner_Height}}),(e=this.bannerAd).onError(e=>{console.error(e)}),e.onResize(i=>{this.banner_Height=i.height,this.banner_Width=i.width,e.style.top=t.screenHeight-this.banner_Height-this.margin_Bottom,e.style.width=i.width,e.style.left=(t.screenWidth-i.width)/2})}else if(this.platform===t.vivo){let e=this.bannerAd;if(e)return;let t=qg.getSystemInfoSync();this.banner_Width=t.screenWidth;let i=(t.screenWidth-this.banner_Width)/2,a=t.screenHeight-this.banner_Height-this.margin_Bottom;this.bannerAd=qg.createBannerAd({posId:this.adUnitId_Banner,style:{left:i,top:a,width:this.banner_Width,height:this.banner_Height}}),(e=this.bannerAd).onError(e=>{console.error(e)}),e.onResize(i=>{this.banner_Height=i.height,this.banner_Width=i.width,e.style.top=t.screenHeight-this.banner_Height-this.margin_Bottom,e.style.width=i.width,e.style.left=(t.screenWidth-i.width)/2})}}initVideoAd(){if(this.adUnitId_Video)switch(this.platform){case t.wechat:this.rewardedVideoAd=wx.createRewardedVideoAd({adUnitId:this.adUnitId_Video});let e=this.rewardedVideoAd;e.onError(e=>{console.log(e)}),e.onClose(e=>{e.isEnded?(this.video_OnClose_Callback&&this.video_OnClose_Callback(),this.showVideoEventId&&(this.showVideoEventId=0)):this.showVideoEventId&&(this.showVideoEventId=0),this.video_OnClose_Callback=null});break;case t.qq:this.rewardedVideoAd=qq.createRewardedVideoAd({adUnitId:this.adUnitId_Video});let i=this.rewardedVideoAd;i.onError(e=>{console.log(e)}),i.onClose(e=>{e.isEnded?(this.video_OnClose_Callback&&this.video_OnClose_Callback(),qq.aly&&window.videoPosition&&(qq.aly.videoDot(window.videoPosition,"success"),window.videoPosition=void 0)):qq.aly&&window.videoPosition&&(qq.aly.videoDot(window.videoPosition,"fail"),window.videoPosition=void 0),this.video_OnClose_Callback=null});break;case t.tt:this.rewardedVideoAd&&(this.rewardedVideoAd.destroy(),this.rewardedVideoAd=null),this.rewardedVideoAd=tt.createRewardedVideoAd({adUnitId:this.adUnitId_Video}),this.rewardedVideoAd.onError(e=>{console.log(e),a.load(),tt.showToast({title:"视频广告加载失败",icon:"none"})});break;case t.oppo:this.rewardedVideoAd=qg.createRewardedVideoAd({adUnitId:this.adUnitId_Video});let a=this.rewardedVideoAd;a.onError(e=>{console.error(e),qg.showToast({title:"视频广告加载失败",icon:"none"})}),a.onClose(e=>{e.isEnded&&this.video_OnClose_Callback&&this.video_OnClose_Callback()}),a.onLoad(()=>{a.show()});break;case t.vivo:this.rewardedVideoAd=qg.createRewardedVideoAd({posId:this.adUnitId_Video});let s=this.rewardedVideoAd;s.onError(e=>{console.error(e),qg.showToast({title:"视频广告加载失败",icon:"none"})}),s.onClose(e=>{s.load(),e.isEnded&&this.video_OnClose_Callback&&this.video_OnClose_Callback(),Laya.SoundManager.musicMuted=!1}),s.onLoad(()=>{})}}initAppBox(){if(this.adUnitId_AppBox){this.appBoxs=[];for(let e=0;e<this.adUnitId_AppBox.length;e++){let t=this.adUnitId_AppBox[e],i=qq.createAppBox({adUnitId:t});this.appBoxs.push(i)}}}initInterstitialAd(){if(this.adUnitId_Interstitial)switch(this.platform){case t.wechat:this.interstitialAd=wx.createInterstitialAd({adUnitId:this.adUnitId_Interstitial}),this.interstitialAd.onError(e=>{console.log(e)});break;case t.tt:if(this.interstitialAd&&this.interstitialAd.destroy(),this.interstitialAd=tt.createInterstitialAd({adUnitId:this.adUnitId_Interstitial}),!this.interstitialAd)return;let e=this.interstitialAd,i=!0,a=()=>{e.show().then(()=>{console.log("插屏广告展示成功")})},s=t=>{i&&(i=!1,e.load())};e.onLoad(a),e.onError(s);break;case t.qq:this.interstitialAd=qq.createInterstitialAd({adUnitId:this.adUnitId_Interstitial});let o=this.interstitialAd;o.onError(e=>{console.error("qq插屏广告加载失败",e)}),o.onLoad(()=>{console.log("qq插屏广告加载成功")});break;case t.oppo:this.interstitialAd=qg.createInsertAd({adUnitId:this.adUnitId_Interstitial});let n=this.interstitialAd;n.onError(e=>{console.error("oppo插屏广告加载失败",e)}),n.onLoad(()=>{console.log("oppo插屏广告加载成功")})}}initNativeAd(){if(this.adUnitId_Native&&(this.platform==t.oppo||this.platform==t.vivo)){if(this.nativeAd.length>0){for(let e=0;e<this.nativeAd.length;e++)this.nativeAd.shift().destroy();this.nativeAdData.length=0}if(this.platform==t.oppo){this.reportShowPer.length=0,this.refreshNativeTimeDelay.length=0;for(let e=0;e<this.adUnitId_Native.length;e++){let t=this.adUnitId_Native[e],i=qg.createNativeAd({adUnitId:t});this.nativeAdData.push([]),i.onLoad(e=>{let i=this.adUnitId_Native.indexOf(t);console.log("oppo原生广告加载成功",i,t,JSON.stringify(e)),this.nativeAdData[i].push(...e.adList),console.log("原生广告列表",JSON.stringify(this.nativeAdData))}),i.onError(e=>{let i=this.adUnitId_Native.indexOf(t);console.error("oppo原生广告加载失败",i,t,JSON.stringify(e))}),this.nativeAd.push(i),this.loadNativeAd(e),this.reportShowPer.push(1),this.refreshNativeTimeDelay.push(0)}}else if(this.platform==t.vivo)for(let e=0;e<this.adUnitId_Native.length;e++){let t=e;Laya.timer.once(5e3*t,this,()=>{let e=qg.createNativeAd({posId:this.adUnitId_Native[t]});this.nativeAd.push(e),this.nativeAdData.push([]),this.loadNativeAd(t),this.reportShowPer.push(1),this.refreshNativeTimeDelay.push(0)})}}}testNative(){Laya.timer.loop(this.testNativeTime,this,()=>{for(let e=0;e<this.nativeAdData.length;e++)0==this.nativeAdData[e].length&&this.loadNativeAd(e)})}loadNativeAd(e,t=!1){return new Promise(t=>{this.nativeAd[e].load(),t()})}haveNativeAd(e){}showNativeAd(e,t){this.isTestNative?Math.random()<.8?t&&t(this.nativeTestData):(console.log("测试没有拉到广告"),t&&t(null)):(e=e<this.nativeAd.length?e:0,this.loadNativeAd(e).then(()=>{let i=this.nativeAdData[e];for(let e=0;e<i.length;e++){let a=i[e];return void(t&&t(a))}t&&t(null)}))}hideNativeAd(e,t){}reportNativeAdClick(e,i){e=e<this.nativeAd.length?e:0;let a=this.nativeAdData[e];if(!a)return;let s=a.indexOf(i);if(console.log("reportNativeAdClick",s),-1!=s&&a.splice(s,1),this.platform==t.oppo){let t=[0],a=[1];0==this.thirdNativeBelong?t.push(2):a.push(2),-1!=t.indexOf(e)||-1!=a.indexOf(e)&&(this.nativeAd[e].reportAdShow({adId:i.adId}),this.reportShowTimeLeft--,Math.random()<this.secondReportPer&&(this.reportShowTimeLeft--,Laya.timer.once(1e4,this,()=>{this.nativeAd[e].reportAdShow({adId:i.adId})})),Math.random()<this.thirdReportPer&&(this.reportShowTimeLeft--,Laya.timer.once(2e4,this,()=>{this.nativeAd[e].reportAdShow({adId:i.adId})})))}this.nativeAd[e].reportAdClick({adId:i.adId})}reportNativeAdShow(e,i){if(e=e<this.nativeAd.length?e:0,this.platform==t.vivo)this.nativeAd[e].reportAdShow({adId:i.adId});else if(this.platform==t.oppo){let t=[0],a=[1];0==this.thirdNativeBelong?t.push(2):a.push(2),-1!=t.indexOf(e)?this.reportShowTimeLeft>0&&(this.reportShowTimeLeft--,this.nativeAd[e].reportAdShow({adId:i.adId})):a.indexOf(e)}}updateReportShowTimeLeft(){Laya.timer.loop(1e3*this.pullTimeDelay,this,()=>{this.reportShowTimeLeft++})}showBannerAd(){if((this.bannerAd||this.platform!=t.oppo||!this.oppoShowBanner)&&!this.noAd)switch(this.platform){case t.wechat:let e=this.bannerAd;e&&e.show();break;case t.qq:let i=this.bannerAd;i&&i.show();break;case t.tt:this.initBannerAd();break;case t.oppo:let a=this.bannerAd;a&&a.show();break;case t.vivo:let s=this.bannerAd;s&&s.show()}}showVideoAd(e,i=null){if(this.platform===t.editor||this.noAd)e&&e();else{if(!this.rewardedVideoAd)return;switch(this.video_OnClose_Callback=e,this.platform){case t.wechat:this.rewardedVideoAd.show().catch(e=>{this.showVideoEventId&&(this.showVideoEventId=0),console.log("微信视频播放失败原因",e),wx.showToast({icon:"none",title:"视频播放失败",duration:1500})});break;case t.qq:qq.aly&&window.videoPosition&&qq.aly.videoDot(window.videoPosition,"show"),this.rewardedVideoAd.show().catch(e=>{console.log("qq视频播放失败原因",e),window.videoPosition=void 0,qq.showToast({icon:"none",title:"视频播放失败",duration:1500})});break;case t.tt:Laya.MouseManager.enabled=!1;let a=this.rewardedVideoAd;if(e){let t=s=>{Laya.MouseManager.enabled=!0,i&&window.tt&&window.tt.uma&&window.tt.uma.trackEvent("watchVideo",{videoId:i}),s.isEnded&&e&&e(),a.offClose(t)};a.onClose(t)}a.show().catch(e=>{a.load().then(()=>{Laya.MouseManager.enabled=!0,a.show()}).catch(e=>{Laya.MouseManager.enabled=!0,tt.showToast({title:"视频广告加载失败",icon:"none"})})});break;case t.oppo:this.rewardedVideoAd.load();break;case t.vivo:Laya.SoundManager.musicMuted=!0,this.rewardedVideoAd.show()}}}showAppBox(e){if(this.platform!=t.editor)switch(this.platform){case t.qq:let i=this.appBoxs[e];i.load().then(()=>{i.show()})}}showInterstitialAd(e){if(e&&this.platform===t.editor&&e(),this.platform==t.tt||this.interstitialAd||this.platform==t.vivo)switch(this.platform){case t.wechat:this.interstitialAd.show();break;case t.qq:this.interstitialAd.show();break;case t.tt:this.initInterstitialAd();break;case t.oppo:let i=this.interstitialAd;i.onClose(()=>{i.load(),e&&e()}),i.show();break;case t.vivo:this.interstitialAd=qg.createInterstitialAd({posId:this.adUnitId_Interstitial});let a=this.interstitialAd;a.onError(e=>{console.error("vivo插屏广告加载失败",e)}),a.onLoad(()=>{console.log("vivo插屏广告加载成功")}),a.show()}}hideBannerAd(){if(this.bannerAd&&(this.platform!=t.oppo||!this.oppoShowBanner))switch(this.platform){case t.wechat:this.bannerAd.hide();break;case t.qq:this.bannerAd.hide();break;case t.tt:this.bannerAd.hide();break;case t.oppo:this.bannerAd.hide();break;case t.vivo:this.bannerAd.hide()}}getCloseAd(){return this.isGD?0:u.Instance.closeAd}getSuperBtnPer(e){return this.isGD?0:u.Instance.superBtnPer[e]}clearSuperBtnPer(e){this.superBtnPer[e]=0}getDelayTime(){return this.isGD||!this.isShowNative?0:u.Instance.delayTime}compareVersion(e,t){e=e.split(".");const i=Math.max(e.length,t.length);for(;e.length<i;)e.push("0");for(;t.length<i;)t.push("0");for(let a=0;a<i;a++){const i=parseInt(e[a]),s=parseInt(t[a]);if(i>s)return 1;if(i<s)return-1}return 0}}class y extends e.carScene.shareUI{constructor(){super(...arguments),this.money=100}onAwake(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.shareBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.moneyLabel.text=this.money+""}onBtnClick(e){e.target==this.closeBtn?this.close():e.target==this.shareBtn&&(y.shareVideoRecord(),r.Instance.EventDis.once(y.ShareVideoSuccess,this,()=>{window.homePage.root.shareBtn.visible=!1,window.homePage.rewardData={rewardType:0,num:100},window.homePage.showRewardGetBox(window.homePage.rewardData,!1,!0,!0,!1),this.close()}))}onOpened(){Laya.MouseManager.enabled=!0,y.stopRecord()}static init(){"undefined"!=typeof tt&&(this._recordManager=tt.getGameRecorderManager(),this._recordManager.onStart(e=>{console.log("录屏开始"),this.isRecording=!0,this._startTimeRec=Date.now(),r.Instance.EventDis.event(this.RecordStateChange)}),this._recordManager.onStop(e=>{console.log(e),Date.now()-this._startTimeRec<1e4&&window.tt.showToast({title:"录屏时间不能低于10秒",icon:"none"}),this._videoPath=e.videoPath,this.isRecording=!1,this._clipVideoPath=null,this._recordManager.clipVideo({path:this._videoPath,timeRange:[30,0],success:e=>{this._clipVideoPath=e.videoPath,console.log("裁剪视频成功"),r.Instance.EventDis.event(this.ClipEnd)},fail:e=>{console.error(e)}}),r.Instance.EventDis.event(this.RecordStateChange)}))}static startRecord(){this._recordManager&&this._recordManager.start({duration:300})}static stopRecord(){this._recordManager&&this._recordManager.stop()}static shareVideoRecord(){return new Promise(e=>{"undefined"!=typeof tt&&(this._clipVideoPath?tt.shareAppMessage({channel:"video",extra:{videoPath:this._clipVideoPath,videoTopics:["跑酷","竞速"],withVideoId:!0},success:t=>{console.log("success",t),r.Instance.EventDis.event(this.ShareVideoSuccess),e()},fail:e=>{console.log("fail",e)}}):r.Instance.EventDis.once(this.ClipEnd,this,()=>{tt.shareAppMessage({channel:"video",extra:{videoPath:this._clipVideoPath,videoTopics:["跑酷","竞速"],withVideoId:!0},success:t=>{console.log("success",t),r.Instance.EventDis.event(this.ShareVideoSuccess),e()},fail:e=>{console.log("fail",e)}})}))})}}y.RecordStateChange="RecordStateChange",y.ShareVideoSuccess="ShareVideoSuccess",y.isRecording=!1,y._recordManager=null,y._videoPath=null,y._clipVideoPath=null,y._startTimeRec=0,y.ClipEnd="ClipEnd";class f extends Laya.Script{constructor(){super(),this.maxX=0,this.dataReady=0,this.progress=0,this.isEnterGame=!1,this.isSendRegAccount=!1,this.isSendRegChar=!1}init(){console.log("开始运行"),y.init(),this.openWxShare(),u.Instance.init(),u.Instance.noAd=!0,p.Instance.init(),this.login(),m.Instance.init(),this.onStartBuildScene(),this.root.width=Laya.stage.width,this.root.height=Laya.stage.height,Laya.stage.useRetinalCanvas=!0,window.qg&&qg.loadingComplete({complete:function(e){console.log(e)}})}sendCount(e){if("undefined"!=typeof tt){let t=tt.getSystemInfoSync(),i=0;i=-1!=t.model.indexOf("iPhone")?2:1;let a=tt.getLaunchOptionsSync(),s={scene:a.scene};for(const e in a.query)s[e]=a.query[e];let o=this.QsStringify(s),n={gameid:"108278",channel:"TTGame",pf:"ttgame",account:e,mobile:t.brand,mobiletype:t.model,os:i,via:o};window.account=e,p.send("https://sdk.mxzgame.com/Report/regAccount",null,null,n,"post"),this.isSendRegAccount=!0}}sendCreateRole(){if("undefined"!=typeof tt&&window.account){let e=0;e=-1!=tt.getSystemInfoSync().model.indexOf("iPhone")?2:1;let t=tt.getLaunchOptionsSync(),i={scene:t.scene};for(const e in t.query)i[e]=t.query[e];let a=this.QsStringify(i),s={gameid:"108278",channel:"TTGame",pf:"ttgame",account:window.account,os:e,via:a,zoneid:"server01",zonename:"1区",roleid:window.account,rolename:window.roleName};p.send("https://sdk.mxzgame.com/Report/regChar",null,null,s,"post"),this.isSendRegChar=!0}}QsStringify(e){if(!e)return null;let t="";for(const i in e)t+=`${i}=${e[i]}&`;return t.length>0&&(t=t.slice(0,t.length-1)),t}openWxShare(){window.wx&&wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]})}timeMove(){this.dataReady>=2?(this.progress=100,this.updateProgress(this.progress),Laya.timer.clear(this,this.timeMove),Laya.Scene.close("carScene/loadScene.scene"),Laya.Scene.open("carScene/mainScene.scene"),this.isEnterGame=!0,this.isSendRegAccount&&!this.isSendRegChar&&this.sendCreateRole()):(this.progress+=.5,this.progress=this.progress<100?this.progress:100,this.updateProgress(this.progress))}updateProgress(e){this.root.progressLabel.text=`${Math.floor(e)}%`,this.root.loadMask.graphics.drawRect(0,330*(100-e)/100,347,330*e/100,"#110000","#110000",0)}onAwake(){this.root=this.owner,r.Instance.addEvntListener("LoadResOver",this,this.loadOver2),this.loadOver(),window.loadPage=this,Laya.timer.frameLoop(1,this,this.timeMove),w.Instance.init()}onUpdate(){}onStartBuildScene(){d.Instance.init()}loadOver2(){console.log("3d资源加载完成"),this.dataReady+=1}loadOver(){this.loadFont();Math.floor(1e5*Math.random());Laya.loader.load(["res/atlas/main.atlas"],Laya.Handler.create(this,function(){this.dataReady+=1,console.log("场景资源加载完成^-^")}))}loadFont(){var e=new Laya.BitmapFont;e.autoScaleSize=!0,e.loadFont("res/Font/NumHit_0.fnt",new Laya.Handler(this,function(e,t){t.setSpaceWidth(10),Laya.Text.registerBitmapFont(e,t)},["Font2",e]));var t=new Laya.BitmapFont;t.autoScaleSize=!0,t.loadFont("res/Font/Font1.fnt",new Laya.Handler(this,function(e,t){t.setSpaceWidth(10),Laya.Text.registerBitmapFont(e,t)},["Font1",t]))}login(){"undefined"!=typeof tt&&tt.login({success:e=>{console.log("登录成功"),tt.getUserInfo({withCredentials:!0,success:t=>{window.roleName=t.userInfo.nickName;let i={appid:"tt7192072feeabd60c02",secret:"84203ae8fa84f11c8290744e649967b3c399cf1d",code:e.code,anonymous_code:e.anonymousCode};p.send("https://developer.toutiao.com/api/apps/v2/jscode2session",e=>{this.sendCount(e.data.openid),this.isEnterGame&&!this.isSendRegChar&&this.sendCreateRole()},e=>{},i,"post")},fail:e=>{console.log("getUserInfo 调用失败",e.errMsg)}})}})}}class v extends Laya.Script{constructor(){super(),this.gameState=-1,this.moveNow=!1,this.movePos=[0,0],this.movePosPre=[0,0],this.speedUpTime=0,this.rushUpTime=0,this.moneyUpTime=0,this.signCells=null,this.blackFilter=null,this.closeBanner=!0,this.skinConfig=[{unlockType:0,moneyNeed:0},{unlockType:0,moneyNeed:990},{unlockType:0,moneyNeed:1280},{unlockType:0,moneyNeed:2560},{unlockType:0,moneyNeed:2560},{unlockType:0,moneyNeed:3750},{unlockType:0,moneyNeed:3750},{unlockType:0,moneyNeed:5e3},{unlockType:0,moneyNeed:9980},{unlockType:0,moneyNeed:9980}],this.tailConfig=[{unlockType:0,moneyNeed:0},{unlockType:0,moneyNeed:990},{unlockType:0,moneyNeed:1280},{unlockType:0,moneyNeed:2560},{unlockType:0,moneyNeed:2560},{unlockType:0,moneyNeed:3750},{unlockType:0,moneyNeed:3750},{unlockType:0,moneyNeed:5e3},{unlockType:0,moneyNeed:9980},{unlockType:0,moneyNeed:9980}],this.dayTaskConfig=[{desc:"完成*局比赛",id:0,num:3},{desc:"获得*金币",id:1,num:2e3},{desc:"达到第一名*次",id:2,num:2},{desc:"获得*个新人物",id:3,num:1}],this.achieveTaskConfig=[{desc:"踏过*个跳板",id:0,num:[10,20,50,100,200,300,500]},{desc:"穿行过*个加速带",id:1,num:[10,20,50,100,200,300,500]},{desc:"完成*局比赛",id:2,num:[2,5,10,20,30,50,75,100,300]},{desc:"达到第一名*局比赛",id:3,num:[2,5,10,20,30,50,75,100,300]},{desc:"获得*个新人物",id:4,num:[2,4,6,8,10]},{desc:"获得*金币",id:5,num:[1e3,3e3,5e3,7500,1e4,2e4,3e4,5e4]}],this.signConfig=[{id:0,rewardType:0,num:888},{id:1,rewardType:2,num:5},{id:2,rewardType:3,num:5},{id:3,rewardType:0,num:1880},{id:4,rewardType:0,num:2880},{id:5,rewardType:0,num:2880},{id:6,rewardType:0,num:5888}],this.lotteryConfig=[{id:0,per:.6,rewardType:0,num:288},{id:1,per:.3,rewardType:0,num:588},{id:2,per:.06,rewardType:0,num:880},{id:3,per:.01,rewardType:2,num:6},{id:4,per:.02,rewardType:0,num:1880},{id:5,per:.008,rewardType:0,num:5880},{id:6,per:.001,rewardType:2,num:9},{id:7,per:.001,rewardType:3,num:9}],this.init()}init(){}onAwake(){window.Gameing=!1,this.blackFilter=new Laya.ColorFilter,this.blackFilter.setColor("#000000"),this.root=this.owner,Laya.Browser.onWeiXin?this.root.logo.skin="main/Ui_logo1.png":this.root.logo.skin="main/Ui_logo.png",this.root.settingBox.visible=!1,this.root.showSceneLayer.addChild(window.ResManager.mainShow);let e=window.ResManager.mainShow.getChildByName("MainCamera");"undefined"!=typeof tt?e.transform.position=new Laya.Vector3(0,0,6):e.transform.position=new Laya.Vector3(0,-5,6),e.clearFlag=Laya.CameraClearFlags.DepthOnly,this.changePlayerRole(),this.speedUpTime=0,this.rushUpTime=0,this.moneyUpTime=0,this.initUpLevel(),this.registerPageEvent(),this.root.moneyLabel.text=window.DataManager.money.toString(),this.root.diamondLabel.text=window.DataManager.diamond.toString(),this.root.musicOpen.visible=1==window.DataManager.musicOpen,this.root.musicClose.visible=1!=window.DataManager.musicOpen,this.root.soundOpen.visible=1==window.DataManager.soundOpen,this.root.soundClose.visible=1!=window.DataManager.soundOpen,this.root.vibrateOpen.visible=1==window.DataManager.vibrateOpen,this.root.vibrateClose.visible=1!=window.DataManager.vibrateOpen,this.musicStart("res/Sound/mainBgm.mp3"),this.root.width=Laya.stage.width,this.root.height=Laya.stage.height,this.root.shopList.vScrollBarSkin=null,this.root.taskList.vScrollBarSkin=null,this.root.shopList.mouseHandler=Laya.Handler.create(this,this.onShopSelectHandler,null,!1),this.root.restartBtn.on(Laya.Event.CLICK,this,()=>{u.Instance.isShowTreasurePage?Laya.Scene.load("carScene/treasure.scene",Laya.Handler.create(this,e=>{e.open(!1),e.closeHandler=Laya.Handler.create(this,()=>{this.startMatch()})})):this.startMatch()}),this.root.MainBox.on(Laya.Event.MOUSE_DOWN,this,function(){0==this.gameState&&(this.moveNow=!0,window.GameManager.moveNow=!0,this.movePos=[Laya.stage.mouseX,Laya.stage.mouseY])}),this.root.MainBox.on(Laya.Event.MOUSE_UP,this,function(){0==this.gameState&&(this.moveNow=!1,window.GameManager.moveNow=!1)}),window.homePage=this,this.signCells=[this.root.day1Cell,this.root.day2Cell,this.root.day3Cell,this.root.day4Cell,this.root.day5Cell,this.root.day6Cell,this.root.day7Cell],this.showInstertAd()}showInstertAd(){window.isShowInsterAd=!0,Laya.timer.loop(1e3*u.Instance.insertAdShowGap,this,()=>{window.isShowInsterAd&&u.Instance.showInterstitialAd(null)})}changePlayerRole(){let e=window.ResManager.mainShow.getChildByName("ShowPlayer");e&&e.destroy(),(e=window.ResManager.onCloneRole()).name="ShowPlayer",window.ResManager.mainShow.addChild(e),e.transform.position=new Laya.Vector3(0,0,0),e.getComponent(Laya.Animator).play("Stand",0,0),this.changePlayerTail(e)}changePlayerTail(e,t=!0){let i=this.findNodeByUrl(e,"Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Neck/Bip001 L Clavicle/Bip001 L UpperArm/Bip001 L Forearm/Bip001 L Hand"),a=this.findNodeByUrl(e,"Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Neck/Bip001 R Clavicle/Bip001 R UpperArm/Bip001 R Forearm/Bip001 R Hand");i.destroyChildren(),a.destroyChildren();let s=window.ResManager.onCloneTail(t),o=s.clone();i.addChild(s),a.addChild(o)}tryPlayerRole(e){let t=window.ResManager.mainShow.getChildByName("ShowPlayer");t&&t.destroy(),(t=window.ResManager.onCloneTryRole(e)).name="ShowPlayer",window.ResManager.mainShow.addChild(t),t.transform.position=new Laya.Vector3(0,0,0),t.getComponent(Laya.Animator).play("Stand",0,0),this.changePlayerTail(t)}tryPlayerTail(e,t){let i=this.findNodeByUrl(e,"Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Neck/Bip001 L Clavicle/Bip001 L UpperArm/Bip001 L Forearm/Bip001 L Hand"),a=this.findNodeByUrl(e,"Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Neck/Bip001 R Clavicle/Bip001 R UpperArm/Bip001 R Forearm/Bip001 R Hand");i.destroyChildren(),a.destroyChildren();let s=window.ResManager.onCloneTryTail(t),o=s.clone();i.addChild(s),a.addChild(o)}registerPageEvent(){this.root.settingBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.settingCloseBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.moneyAddBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.diamondAddBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.speedUpBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.rushUpBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.moneyUpBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.musicOpen.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.musicClose.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.soundOpen.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.soundClose.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.vibrateOpen.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.vibrateClose.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.shopBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.shopCloseBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.skinClose.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.tailClose.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.dayTaskClose.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.achieveTaskClose.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.backBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.againBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.continueBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.doubleBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.nodoubleTip.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.challengeBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.signBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.lotteryBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.signBoxClose.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.lotteryBoxClose.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.lotteryStartBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.signCommonGet.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.signDoubleGet.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.rewardSkinAddOk.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.rewardSkinAddNo.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.rewardDoubleGetBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.rewardNoDoubleGetBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.rewardGetBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.rewardVideoGetBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.rewardDirectReceiveBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.rewardNoBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.shareBtn.on(Laya.Event.CLICK,this,this.onPageEvent),this.root.godLifeBtn.on(Laya.Event.CLICK,this,this.onPageEvent),r.Instance.EventDis.on("TryBuff",this,this.onTryBuff)}onTryBuff(e,t){1==e?this.speedUpTime=t:2==e?this.rushUpTime=t:3==e&&(this.moneyUpTime=t)}onShopSelectHandler(e,t){if(e.type==Laya.Event.CLICK){this.soundStart("res/Sound/click.mp3");let e=this.root.shopList.getCell(t);if("shop/Btn_Unlock.png"==e.tag.skin){if(0==e.dataSource.unlockType){let t=e.dataSource.moneyNeed;0==e.dataSource.goodsType?window.DataManager.money>=t?(this.onMoneyChange(-t),this.soundStart("res/Sound/buySuccess.mp3"),this.unlockSkin(e.dataSource.id),this.refreshShopList(0),this.updateRewardSkin()):wx&&wx.showToast({icon:"none",title:"金币不足",duration:2e3}):window.DataManager.money>=t?(this.soundStart("res/Sound/buySuccess.mp3"),this.onMoneyChange(-t),this.unlockTail(e.dataSource.id),this.refreshShopList(1),this.updateRewardTail()):wx&&wx.showToast({icon:"none",title:"金币不足",duration:2e3})}}else if("shop/Ui_ChuanDai.png"==e.tag.skin);else if("shop/Btn_Use.png"==e.tag.skin)if(0==e.dataSource.goodsType)window.DataManager.useSkinId=e.dataSource.id,this.changePlayerRole(),this.refreshShopList(0),localStorage.setItem("useSkinId",window.DataManager.useSkinId.toString());else{window.DataManager.useTailId=e.dataSource.id;let t=window.ResManager.mainShow.getChildByName("ShowPlayer");this.changePlayerTail(t),this.refreshShopList(1),localStorage.setItem("useTailId",window.DataManager.useTailId.toString())}}}unlockSkin(e){window.DataManager.achieveUnlockNum++,localStorage.setItem("achieveUnlockNum",window.DataManager.achieveUnlockNum.toString()),window.DataManager.dayUnlockNum++,localStorage.setItem("dayUnlockNum",window.DataManager.dayUnlockNum.toString()),window.DataManager.skinUnlockRecord[e]=1,localStorage.setItem("skinUnlockRecord",JSON.stringify(window.DataManager.skinUnlockRecord)),window.DataManager.useSkinId=e,localStorage.setItem("useSkinId",window.DataManager.useSkinId.toString()),this.changePlayerRole()}unlockTail(e){window.DataManager.tailUnlockRecord[e]=1,localStorage.setItem("tailUnlockRecord",JSON.stringify(window.DataManager.tailUnlockRecord)),window.DataManager.useTailId=e,localStorage.setItem("useTailId",window.DataManager.useTailId.toString());let t=window.ResManager.mainShow.getChildByName("ShowPlayer");this.changePlayerTail(t)}initUpLevel(){this.root.speedUpCostLabel.text=`${100+50*this.speedUpTime}`,this.root.rushUpCostLabel.text=`${100+50*this.rushUpTime}`,this.root.moneyUpCostLabel.text=`${100+50*this.moneyUpTime}`,this.root.speedUpLabel.text=`${100+3*(this.speedUpTime+1)}%`,this.root.rushUpLabel.text=`${100+3*(this.rushUpTime+1)}%`,this.root.moneyUpLabel.text=`${100+3*(this.moneyUpTime+1)}%`}onGetSignReward(e,t){let i=window.DataManager.signRecord;i[e.dataSource.id]=1,localStorage.setItem("signTimeStamp",Date.now().toString()),localStorage.setItem("signRecord",JSON.stringify(i)),0==e.dataSource.rewardType?t?this.onMoneyChange(2*e.dataSource.num):this.onMoneyChange(e.dataSource.num):1==e.dataSource.rewardType?t?this.onDiamondChange(2*e.dataSource.num):this.onDiamondChange(e.dataSource.num):2==e.dataSource.rewardType?(window.DataManager.achieveUnlockNum++,localStorage.setItem("achieveUnlockNum",window.DataManager.achieveUnlockNum.toString()),window.DataManager.dayUnlockNum++,localStorage.setItem("dayUnlockNum",window.DataManager.dayUnlockNum.toString()),window.DataManager.skinUnlockRecord[e.rewardSkinId]=1,localStorage.setItem("skinUnlockRecord",JSON.stringify(window.DataManager.skinUnlockRecord))):3==e.dataSource.rewardType.rewardType&&(window.DataManager.tailUnlockRecord[e.rewardTailId]=1,localStorage.setItem("tailUnlockRecord",JSON.stringify(window.DataManager.tailUnlockRecord)))}addBuff(e,t){let i=0;if(1==e){let e=Number(this.root.speedUpCostLabel.text);(!t||window.DataManager.money>=e)&&(t&&this.onMoneyChange(-e),this.speedUpTime+=1,this.initUpLevel(),i=this.speedUpTime)}else if(2==e){let e=Number(this.root.rushUpCostLabel.text);window.DataManager.money>=e&&(t&&this.onMoneyChange(-e),this.rushUpTime+=1,this.initUpLevel(),i=this.rushUpTime)}else if(3==e){let e=Number(this.root.moneyUpCostLabel.text);window.DataManager.money>=e&&(t&&this.onMoneyChange(-e),this.moneyUpTime+=1,this.initUpLevel(),i=this.moneyUpTime)}Laya.Scene.load("carScene/godLife.scene",Laya.Handler.create(this,t=>{t.setSupriseType(e,i),t.open(!1)}))}onPageEvent(e){if(this.soundStart("res/Sound/click.mp3"),e.target==this.root.settingBtn)u.Instance.showBannerAd(),this.root.settingBox.visible=!0;else if(e.target==this.root.settingCloseBtn)this.root.settingBox.visible=!1,u.Instance.hideBannerAd();else if(e.target==this.root.moneyAddBtn)this.rewardData={rewardType:0,num:500},this.showRewardGetBox(this.rewardData,!0);else if(e.target==this.root.diamondAddBtn)this.rewardData={rewardType:1,num:500},this.showRewardGetBox(this.rewardData,!0);else if(e.target==this.root.speedUpBtn)this.addBuff(1,!0);else if(e.target==this.root.rushUpBtn)this.addBuff(2,!0);else if(e.target==this.root.moneyUpBtn)this.addBuff(3,!0);else if(e.target==this.root.musicClose||e.target==this.root.musicOpen)window.DataManager.musicOpen=e.target==this.root.musicClose?1:0,this.root.musicOpen.visible=1==window.DataManager.musicOpen,this.root.musicClose.visible=1!=window.DataManager.musicOpen,localStorage.setItem("musicOpen",window.DataManager.musicOpen),window.DataManager.musicOpen?this.musicStart("res/Sound/mainBgm.mp3"):Laya.SoundManager.stopMusic();else if(e.target==this.root.soundClose||e.target==this.root.soundOpen)window.DataManager.soundOpen=e.target==this.root.soundClose?1:0,this.root.soundOpen.visible=1==window.DataManager.soundOpen,this.root.soundClose.visible=1!=window.DataManager.soundOpen,localStorage.setItem("soundOpen",window.DataManager.soundOpen);else if(e.target==this.root.vibrateClose||e.target==this.root.vibrateOpen)window.DataManager.vibrateOpen=e.target==this.root.vibrateClose?1:0,this.root.vibrateOpen.visible=1==window.DataManager.vibrateOpen,this.root.vibrateClose.visible=1!=window.DataManager.vibrateOpen,localStorage.setItem("vibrateOpen",window.DataManager.vibrateOpen);else if(e.target==this.root.shopBtn)this.root.shopBox.visible=!0,this.root.shopFrame.visible=!0,this.root.taskFrame.visible=!1,this.root.downBox.visible=!1,this.root.signBtn.visible=!1,this.root.lotteryBtn.visible=!1,this.root.challengeBtn.visible=!1,this.root.shopCloseBtn.bottom=500,this.root.shopMask.visible=!1,this.refreshShopList(0);else if(e.target==this.root.shopCloseBtn)this.root.upBox.visible=!0,this.root.signBtn.visible=!0,this.root.shopBox.visible=!1,this.root.downBox.visible=!0,this.root.signBtn.visible=!0,this.root.lotteryBtn.visible=!0,this.root.challengeBtn.visible=!0;else if(e.target==this.root.skinClose)this.refreshShopList(0);else if(e.target==this.root.tailClose)this.refreshShopList(1);else if(e.target==this.root.dayTaskClose)this.refreshTaskList(0);else if(e.target==this.root.achieveTaskClose)this.refreshTaskList(1);else if(e.target==this.root.challengeBtn)this.root.upBox.visible=!1,this.root.shopMask.visible=!0,this.root.shopBox.visible=!0,this.root.shopFrame.visible=!1,this.root.taskFrame.visible=!0,this.root.signBtn.visible=!1,this.root.challengeBtn.visible=!1,this.root.lotteryBtn.visible=!1,this.root.shopCloseBtn.bottom=1050,this.refreshTaskList(0);else if(e.target==this.root.backBtn)this.musicStart("res/Sound/mainBgm.mp3"),this.root.countBox.visible=!1,this.root.upBox.visible=!0,this.root.logo.visible=!0,this.root.downBox.visible=!0,this.root.signBtn.visible=!0,this.root.lotteryBtn.visible=!0,this.root.challengeBtn.visible=!0,this.root.bg.visible=!0,this.root.nameBox.destroyChildren(),this.speedUpTime=0,this.rushUpTime=0,this.moneyUpTime=0,this.initUpLevel(),window.ResManager.mainShow.visible=!0,window.ResManager.scene.visible=!1,window.isShowInsterAd=!0;else if(e.target==this.root.againBtn||e.target==this.root.continueBtn)e.target==this.root.againBtn?u.Instance.showVideoAd(()=>{window.giveRocket=!0,this.root.countBox.visible=!1,this.startMatch()}):(this.root.countBox.visible=!1,this.startMatch());else if(e.target==this.root.doubleBtn)"douyin/Btn_DoubleWin.png"==this.root.doubleBtn.skin?u.Instance.showVideoAd(()=>{this.onMoneyChange(2*Number(this.root.winMoneyLabel.text)),this.onDiamondChange(2*Number(this.root.winDiamondLabel.text)),this.root.doubleBtn.visible=!1,this.root.nodoubleTip.visible=!1}):(this.onMoneyChange(Number(this.root.winMoneyLabel.text)),this.onDiamondChange(Number(this.root.winDiamondLabel.text)),this.root.doubleBtn.visible=!1,this.root.nodoubleTip.visible=!1);else if(e.target==this.root.nodoubleTip)"douyin/Btn_GetNow.png"==this.root.doubleBtn.skin?this.root.doubleBtn.skin="douyin/Btn_DoubleWin.png":"douyin/Btn_DoubleWin.png"==this.root.doubleBtn.skin&&(this.root.doubleBtn.skin="douyin/Btn_GetNow.png");else if(e.target==this.root.signBtn)u.Instance.showBannerAd(),this.root.signBox.visible=!0,this.updateSign();else if(e.target==this.root.lotteryBtn)u.Instance.showBannerAd(),this.root.lotteryBox.visible=!0,this.updateLotteryStartBtn();else if(e.target==this.root.signBoxClose)this.root.signBox.visible=!1,u.Instance.hideBannerAd();else if(e.target==this.root.lotteryBoxClose)u.Instance.hideBannerAd(),this.root.lotteryBox.visible=!1;else if(e.target==this.root.lotteryStartBtn)"sign/Btn_ChouFree.png"==this.root.lotteryStartBtn.skin?(window.DataManager.freeLotteryUseTimestamp=Date.now(),localStorage.setItem("freeLotteryUseTimestamp",Date.now().toString()),this.startLottery()):u.Instance.showVideoAd(()=>{this.startLottery()});else if(e.target==this.root.signCommonGet){let e=window.DataManager.signDay;this.onGetSignReward(this.signCells[e],!1),this.updateSign()}else e.target==this.root.signDoubleGet?u.Instance.showVideoAd(()=>{let e=window.DataManager.signDay;this.onGetSignReward(this.signCells[e],!0),this.updateSign()}):e.target==this.root.rewardSkinAddOk?"douyin/Btn_HappyGet.png"==this.root.rewardSkinAddOk.skin?u.Instance.showVideoAd(()=>{if(this.root.rewardSkinBox.visible=!1,0==window.DataManager.rewardType){let e=window.DataManager.rewardSkinId;this.rewardData={rewardType:2,num:e,showCount:!0}}else{let e=window.DataManager.rewardTailId;this.rewardData={rewardType:3,num:e,showCount:!0}}this.showRewardGetBox(this.rewardData,!1,!1)}):u.Instance.showVideoAd(()=>{let e=0;1==window.DataManager.rewardType?(e=window.DataManager.rewardTailProgress,e+=20,window.DataManager.rewardTailProgress=e<100?e:100,localStorage.setItem("rewardTailProgress",window.DataManager.rewardTailProgress+"")):(e=window.DataManager.rewardSkinProgress,e+=20,window.DataManager.rewardSkinProgress=e<100?e:100,localStorage.setItem("rewardSkinProgress",window.DataManager.rewardSkinProgress+"")),this.showRewardSkinBox(!1,!0),100!=e?(this.root.rewardSkinAddOk.visible=!1,this.root.rewardSkinAddNo.visible=!1,Laya.timer.once(2e3,this,()=>{this.root.rewardSkinBox.visible=!1,this.showCount(window.GameManager.countData)})):(this.root.rewardSkinAddOk.visible=!0,this.root.rewardSkinAddNo.visible=!0)}):e.target==this.root.rewardSkinAddNo?("reward/Btn_GiveUp.png"==this.root.rewardSkinAddNo.skin&&this.updateRewardSkinData(),this.root.rewardSkinBox.visible=!1,this.showCount(window.GameManager.countData)):e.target==this.root.rewardDoubleGetBtn?"douyin/Btn_DoubleGong.png"==this.root.rewardDoubleGetBtn.skin?u.Instance.showVideoAd(()=>{0==this.rewardData.rewardType?this.onMoneyChange(2*this.rewardData.num):1==this.rewardData.rewardType&&this.onDiamondChange(2*this.rewardData.num),this.root.rewardGetBox.visible=!1,this.closeBanner&&u.Instance.hideBannerAd()}):(0==this.rewardData.rewardType?this.onMoneyChange(this.rewardData.num):1==this.rewardData.rewardType&&this.onDiamondChange(this.rewardData.num),this.root.rewardGetBox.visible=!1,this.closeBanner&&u.Instance.hideBannerAd()):e.target==this.root.rewardDirectReceiveBtn?(0==this.rewardData.rewardType?this.onMoneyChange(this.rewardData.num):1==this.rewardData.rewardType&&this.onDiamondChange(this.rewardData.num),this.root.rewardGetBox.visible=!1,this.closeBanner&&u.Instance.hideBannerAd()):e.target==this.root.rewardGetBtn?(2==this.rewardData.rewardType?(this.unlockSkin(this.rewardData.num),this.updateRewardSkinData()):3==this.rewardData.rewardType&&(this.unlockTail(this.rewardData.num),this.updateRewardSkinData()),this.rewardData.showCount&&this.showCount(window.GameManager.countData),this.root.rewardGetBox.visible=!1,u.Instance.hideBannerAd()):e.target==this.root.rewardNoDoubleGetBtn?"douyin/Btn_DoubleGong.png"==this.root.rewardDoubleGetBtn.skin?this.root.rewardDoubleGetBtn.skin="douyin/Btn_GetNow.png":this.root.rewardDoubleGetBtn.skin="douyin/Btn_DoubleGong.png":e.target==this.root.rewardVideoGetBtn?0==this.rewardData.rewardType?u.Instance.showVideoAd(()=>{this.onMoneyChange(this.rewardData.num),this.root.rewardGetBox.visible=!1,u.Instance.hideBannerAd()}):u.Instance.showVideoAd(()=>{this.onDiamondChange(this.rewardData.num),this.root.rewardGetBox.visible=!1,u.Instance.hideBannerAd()}):e.target==this.root.rewardNoBtn?(this.root.rewardGetBox.visible=!1,this.closeBanner&&u.Instance.hideBannerAd()):e.target==this.root.shareBtn?(Laya.MouseManager.enabled=!1,Laya.Scene.open("carScene/share.scene",!1)):e.target==this.root.godLifeBtn&&u.Instance.showVideoAd(()=>{let e=1+Math.floor(3*Math.random());this.addBuff(e,!1)})}onMoneyChange(e){e>0&&(window.DataManager.dayMoneyNum+=e,localStorage.setItem("dayMoneyNum",window.DataManager.dayMoneyNum.toString()),window.DataManager.achieveMoneyNum+=e,localStorage.setItem("achieveMoneyNum",window.DataManager.achieveMoneyNum.toString())),window.DataManager.money+=e,this.root.moneyLabel.text=window.DataManager.money.toString(),localStorage.setItem("money",this.root.moneyLabel.text)}onDiamondChange(e){window.DataManager.diamond+=e,this.root.diamondLabel.text=window.DataManager.diamond.toString(),localStorage.setItem("diamond",this.root.diamondLabel.text)}onUpdate(){var e=Laya.stage.mouseX,t=Laya.stage.mouseY;this.moveNow?(window.GameManager.movePos=[e-this.movePos[0],t-this.movePos[1]],this.movePos=[e,t]):window.GameManager.movePos=[0,0]}soundStart(e="",t=1){1==window.DataManager.soundOpen&&Laya.SoundManager.playSound(e,t,null,null,0)}musicStart(e=""){1==window.DataManager.musicOpen&&(console.log(e),this.music=Laya.SoundManager.playMusic(e,0,null,0))}showCount(e){this.root.shareBtn.visible=!0,this.root.roadBox.visible=!1,this.root.countBox.visible=!0,this.root.propSign.visible=!1,e.rank<=3?(this.root.rankImage.visible=!0,this.root.rankImage.skin=`count/Ui_No${e.rank}.png`):this.root.rankImage.visible=!1,Laya.SoundManager.stopMusic(),e.win?(this.root.winMoneyLabel.text=e.moneyNum.toString(),this.root.winDiamondLabel.text=e.diamondNum.toString(),this.root.doubleBtn.skin="douyin/Btn_DoubleWin.png",this.soundStart("res/Sound/gameSuccess.mp3")):(this.root.winMoneyLabel.text="0",this.root.winDiamondLabel.text="0"),this.root.winFrame.visible=e.win,this.root.moneyIcon.visible=e.win,this.root.diamondIcon.visible=e.win,this.root.doubleBtn.visible=e.win,this.root.nodoubleTip.visible=e.win,this.root.backBtn.visible=!0,this.root.continueBtn.visible=e.win,this.root.loseFrame.visible=!e.win,this.root.loseWord.visible=!e.win,this.root.againBtn.visible=!e.win}setPlayerInfo(e,t){this.root.playerName.text=t,this.root.playerHead.skin=e}refreshShopList(e){if(0==e){this.root.skinClose.visible=!1,this.root.skinOpen.visible=!0,this.root.tailClose.visible=!0,this.root.tailOpen.visible=!1;for(let e=0;e<this.skinConfig.length;e++){let t=this.skinConfig[e];t.id=e,t.goodsType=0,t.unlock=!1,t.using=!1,e==window.DataManager.useSkinId&&(t.using=!0),1==window.DataManager.skinUnlockRecord[e]&&(t.unlock=!0)}this.root.shopList.array=this.skinConfig}else if(1==e){this.root.skinClose.visible=!0,this.root.skinOpen.visible=!1,this.root.tailClose.visible=!1,this.root.tailOpen.visible=!0;for(let e=0;e<this.tailConfig.length;e++){let t=this.tailConfig[e];t.id=e,t.goodsType=1,t.unlock=!1,t.using=!1,e==window.DataManager.useTailId&&(t.using=!0),1==window.DataManager.tailUnlockRecord[e]&&(t.unlock=!0)}this.root.shopList.array=this.tailConfig}}refreshTaskList(e){if(0==e){this.root.dayTaskClose.visible=!1,this.root.dayTaskOpen.visible=!0,this.root.achieveTaskClose.visible=!0,this.root.achieveTaskOpen.visible=!1;let e=[];e.push(this.dayTaskConfig[window.DataManager.dayTaskId[0]]),e.push(this.dayTaskConfig[window.DataManager.dayTaskId[1]]),e.push(this.dayTaskConfig[window.DataManager.dayTaskId[2]]),this.root.taskList.array=e,Laya.timer.frameOnce(5,this,()=>{this.root.taskList.array=e})}else 1==e&&(this.root.dayTaskClose.visible=!0,this.root.dayTaskOpen.visible=!1,this.root.achieveTaskClose.visible=!1,this.root.achieveTaskOpen.visible=!0,this.root.taskList.array=this.achieveTaskConfig,Laya.timer.frameOnce(5,this,()=>{this.root.taskList.array=this.achieveTaskConfig}))}startMatch(){window.isShowInsterAd=!1,Laya.Scene.load("carScene/suprise.scene",Laya.Handler.create(this,e=>{e.open(!1),e.closeHandler=Laya.Handler.create(this,e=>{this.enterMatch()})}))}enterMatch(){window.GameManager.initIdList(),this.musicStart("res/Sound/bgm.mp3"),this.root.matchMask.visible=!0,this.root.matchMask.alpha=1,this.root.countNumber.visible=!1,window.ResManager.mainShow.visible=!1,window.ResManager.scene.visible=!0,this.root.signBtn.visible=!1,this.root.lotteryBtn.visible=!1,this.root.challengeBtn.visible=!1,this.root.bg.visible=!1,Laya.stage.addChildAt(window.ResManager.scene,0),window.GameManager.onMakeScene(),this.root.downBox.visible=!1,this.root.upBox.visible=!1,this.root.logo.visible=!1,this.root.matchBox.visible=!0,this.root.matchPoint.play(0,!0),this.onStartMatch()}onStartMatch(){let e=[{id:0,name:"等待对手中",head:""},{id:1,name:"等待对手中",head:""},{id:2,name:"主角名字",head:""},{id:3,name:"等待对手中",head:""},{id:4,name:"等待对手中",head:""}];this.root.matchList.array=[e[1],e[2],e[3]],Laya.loader.load("res/AiImage/name.json",Laya.Handler.create(this,t=>{Laya.timer.once(3e3,this,()=>{for(let i=0;i<5;i++)if(2!=i){let a=window.GameManager.getRoleId();e[i].name=t.name[a],e[i].head=`res/AiImage/Ai${a+1}.png`}this.root.matchList.array=[e[1],e[2],e[3]],this.root.matchPoint.stop(),window.GameManager.createRole(e[0]),window.GameManager.createRole(e[1]),window.GameManager.createRole(e[3]),window.GameManager.createRole(e[4]),Laya.timer.once(1e3,this,()=>{this.root.countNumber.visible=!0,this.root.matchBox.visible=!1,Laya.Tween.to(this.root.matchMask,{alpha:0},1e3,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.root.matchMask.visible=!1})),this.startCountDown(3).then(()=>{this.root.countNumber.visible=!1,this.gameState=0,window.GameManager.gameStart(),window.GameManager.gameState=0,window.GameManager.enemyNum=8,1==window.giveRocket&&(window.giveRocket=!1,window.GameManager.roleScript.changePlayerState("Fly")),this.root.matchBox.visible=!1,this.root.roadBox.visible=!0,y.startRecord()})})})}))}startCountDown(e){return new Promise(t=>{if(0==e)return t();this.root.countNumber.skin=`main/Ui_WordPiPei${6-e}.png`,Laya.timer.once(1e3,this,()=>{e-=1,this.startCountDown(e).then(()=>t())})})}tweenTo(e,t,i,a,s,o){let n={};for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){n[i+"Start"]=e.transform[i].clone();let a=new Laya.Vector3;Laya.Vector3.subtract(t[i],e.transform[i],a),n[i+"Diff"]=a}let r={value:0};return Laya.Tween.to(r,{value:1,update:Laya.Handler.create(this,()=>{for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){let t=new Laya.Vector3,a=new Laya.Vector3;Laya.Vector3.scale(n[i+"Diff"],r.value,a),Laya.Vector3.add(n[i+"Start"],a,t),e.destroyed||(e.transform[i]=t)}o&&o.run()},null,!1)},i,a,s)}findNodeByUrl(e,t){let i=t.split("/"),a=e;for(let e=0;e<i.length;e++)a=a.getChildByName(i[e]);return a}updateSign(){let e=window.DataManager.signDay,t=window.DataManager.signRecord;for(let i=0;i<this.signCells.length;i++){let a=this.signConfig[i];this.signCells[i].dataSource=a,a.id==e&&(1==t[a.id]?(this.root.signCommonGet.visible=!1,this.root.signDoubleGet.visible=!1):(this.root.signCommonGet.visible=!0,this.root.signDoubleGet.visible=!0))}}startLottery(){let e={rotation:this.root.lotteryArrow.rotation},t=this.calculateResult(),i=45*t;this.root.lotteryBoxClose.disabled=!0,this.root.lotteryStartBtn.disabled=!0,Laya.Tween.to(e,{rotation:this.root.lotteryArrow.rotation+1080,update:Laya.Handler.create(this,()=>{this.root.lotteryArrow.rotation=e.rotation},null,!1)},3e3,Laya.Ease.sineIn,Laya.Handler.create(this,()=>{e.rotation=this.root.lotteryArrow.rotation;let a=this.root.lotteryArrow.rotation%360,s=0;s=a>i?360+i-a:i-a,Laya.Tween.to(e,{rotation:this.root.lotteryArrow.rotation+1800+s,update:Laya.Handler.create(this,()=>{this.root.lotteryArrow.rotation=e.rotation},null,!1)},5e3,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.root.lotteryArrow.rotation=this.root.lotteryArrow.rotation%360,this.root.lotteryBoxClose.disabled=!1,this.root.lotteryStartBtn.disabled=!1,this.updateLotteryStartBtn();let e=this.lotteryConfig[t];this.rewardData=e,this.showRewardGetBox(this.rewardData,!1,!1)}))}))}updateLotteryStartBtn(){Date.now()-window.DataManager.freeLotteryUseTimestamp>864e5?this.root.lotteryStartBtn.skin="sign/Btn_ChouFree.png":this.root.lotteryStartBtn.skin="douyin/Btn_DoubleZhuan.png"}calculateResult(){let e=0,t=Math.random();for(let i=0;i<this.lotteryConfig.length;i++){if(t<(e+=this.lotteryConfig[i].per))return i}}project(e,t,i){let a=new Laya.Vector4;Laya.Vector3.transformV3ToV4(t,e.viewMatrix,a),a.y=a.y+(20*Math.sin(-a.z/50*3.14/2)-10),Laya.Vector3.transformV3ToV4(new Laya.Vector3(a.x,a.y,a.z),e.projectionMatrix,i);var s=i.x,o=i.y,n=i.z,r=i.w;return 1!==r&&(s/=r,o/=r,n/=r),i.x=.5*(s+1)*e.viewport.width+e.viewport.x,i.y=.5*(1-o)*e.viewport.height+e.viewport.y,i.z=n*(e.viewport.maxDepth-e.viewport.minDepth)+e.viewport.minDepth,a.z<=0}showRewardSkinBox(e,t){let i=window.DataManager.rewardType;if(-1==i)return!1;{0==i?(this.root.rewardProgressImage.width=374,this.root.rewardProgressImage.height=455):(this.root.rewardProgressImage.width=388,this.root.rewardProgressImage.height=553),this.root.rewardSkinBox.visible=!0;let t=0==i?window.DataManager.rewardSkinId:window.DataManager.rewardTailId,a=0==i?window.DataManager.rewardSkinProgress:window.DataManager.rewardTailProgress,s=window.DataManager.rewardCount;if(this.root.rewardSkinImage.skin=0==i?`shop/Ui_skin${t}.png`:`shop/Ui_Tail${t}.png`,this.root.rewardNameImage.skin=0==i?`shop/Ui_SkinName${t}.png`:`shop/Ui_TailName${t}.png`,this.root.rewardProgressImage.skin=0==i?`shop/Ui_PinkSkin${t}.png`:`shop/Ui_PinkTail${t}.png`,-1!=t){let t=Laya.Handler.create(this,()=>{let e=Math.floor((this.root.rewardProgressImage.height-this.root.rewardSkinProgressMask.y)/this.root.rewardProgressImage.height*100);this.root.rewardSkinProgressLabel.text=e+"%"},null,!1),o=Laya.Handler.create(this,()=>{100==a&&(this.root.rewardProgressImage.visible=!1,this.root.rewardSkinProgressLabel.visible=!1,this.root.rewardSkinImage.filters=null)}),n=0;return 100!=(n=e?a:Math.floor((this.root.rewardProgressImage.height-this.root.rewardSkinProgressMask.y)/this.root.rewardProgressImage.height*100))?(this.root.rewardSkinImage.filters=[this.blackFilter],this.root.rewardProgressImage.visible=!0,this.root.rewardSkinProgressLabel.visible=!0):(this.root.rewardSkinImage.filters=null,this.root.rewardProgressImage.visible=!1,this.root.rewardSkinProgressLabel.visible=!1),e?(this.root.rewardSkinProgressMask.y=(100-a)/100*this.root.rewardProgressImage.height,a=(a+=0==a?0==s?100:1==s?50:20:20)<100?a:100,0==i?(window.DataManager.rewardSkinProgress=a,localStorage.setItem("rewardSkinProgress",a+"")):(window.DataManager.rewardTailProgress=a,localStorage.setItem("rewardTailProgress",a+"")),Laya.Tween.to(this.root.rewardSkinProgressMask,{y:(100-a)/100*this.root.rewardProgressImage.height,update:t},1e3,Laya.Ease.sineOut,o)):Laya.Tween.to(this.root.rewardSkinProgressMask,{y:(100-a)/100*this.root.rewardProgressImage.height,update:t},1e3,Laya.Ease.sineOut,o),this.root.rewardSkinAddOk.visible=!0,this.root.rewardSkinAddNo.visible=!0,100==a?(this.root.rewardSkinAddOk.skin="douyin/Btn_HappyGet.png",this.root.rewardSkinAddNo.skin="douyin/Btn_Giveup.png"):(this.root.rewardSkinAddOk.skin="douyin/Btn_JinDu.png",this.root.rewardSkinAddNo.skin="douyin/Btn_NoWin.png"),!0}return!1}}updateRewardSkinData(){let e=window.DataManager.rewardType;if(-1!=e)if(e++,0==(e%=2)){let e=this.updateRewardSkin();-1==e&&-1==(e=this.updateRewardTail())?(window.DataManager.rewardType=-1,localStorage.setItem("rewardType",window.DataManager.rewardType+"")):(window.DataManager.rewardType=0,localStorage.setItem("rewardType",window.DataManager.rewardType+""))}else{let e=this.updateRewardTail();-1==e&&-1==(e=this.updateRewardSkin())?(window.DataManager.rewardType=-1,localStorage.setItem("rewardType",window.DataManager.rewardType+"")):(window.DataManager.rewardType=1,localStorage.setItem("rewardType",window.DataManager.rewardType+""))}}updateRewardSkin(){let e=window.DataManager.skinUnlockRecord,t=window.DataManager.rewardSkinId,i=window.DataManager.rewardCount;window.DataManager.rewardSkinId=-1;for(let a=t+1;a<e.length;a++)if(0==e[a]){window.DataManager.rewardSkinId=a,window.DataManager.rewardCount=i+1,window.DataManager.rewardSkinProgress=0;break}return localStorage.setItem("rewardCount",window.DataManager.rewardCount+""),localStorage.setItem("rewardSkinId",window.DataManager.rewardSkinId+""),localStorage.setItem("rewardSkinProgress",window.DataManager.rewardSkinProgress+""),window.DataManager.rewardSkinId}updateRewardTail(){let e=window.DataManager.tailUnlockRecord,t=window.DataManager.rewardTailId,i=window.DataManager.rewardCount;window.DataManager.rewardTailId=-1;for(let a=t+1;a<e.length;a++)if(0==e[a]){window.DataManager.rewardTailId=a,window.DataManager.rewardCount=i+1,window.DataManager.rewardTailProgress=0;break}return localStorage.setItem("rewardCount",window.DataManager.rewardCount+""),localStorage.setItem("rewardTailId",window.DataManager.rewardTailId+""),localStorage.setItem("rewardTailProgress",window.DataManager.rewardTailProgress+""),window.DataManager.rewardTailId}showRewardGetBox(e,t,i=!0,a=!1,s=!0){this.closeBanner=i,s&&u.Instance.showBannerAd(),this.root.rewardGetBox.visible=!0,2==e.rewardType||3==e.rewardType?(this.root.rewardDirectReceiveBtn.visible=!1,this.root.rewardVideoGetBtn.visible=!1,this.root.rewardNoBtn.visible=!1,this.root.rewardGetName.visible=!0,this.root.rewardGetImage.visible=!0,this.root.rewardNoDoubleGetBtn.visible=!1,this.root.rewardDoubleGetBtn.visible=!1,this.root.rewardGetBtn.visible=!0,this.root.rewardGetLabel.visible=!1,2==e.rewardType?(this.root.rewardGetImage.skin=`shop/Ui_skin${e.num}.png`,this.root.rewardGetName.skin=`shop/Ui_SkinName${e.num}.png`):(this.root.rewardGetImage.skin=`shop/Ui_Tail${e.num}.png`,this.root.rewardGetName.skin=`shop/Ui_TailName${e.num}.png`)):0!=e.rewardType&&1!=e.rewardType||(0==e.rewardType?this.root.rewardGetImage.skin="main/Ui_Money.png":1==e.rewardType&&(this.root.rewardGetImage.skin="main/Ui_diamond.png"),t?(this.root.rewardGetImage.visible=!0,this.root.rewardGetName.visible=!1,this.root.rewardGetLabel.visible=!0,this.root.rewardGetLabel.text=e.num+"",a?(this.root.rewardDirectReceiveBtn.visible=!0,this.root.rewardVideoGetBtn.visible=!1,this.root.rewardNoBtn.visible=!1,this.root.rewardDoubleGetBtn.visible=!0,this.root.rewardGetBtn.visible=!1,this.root.rewardNoDoubleGetBtn.visible=!1):(this.root.rewardDirectReceiveBtn.visible=!1,this.root.rewardVideoGetBtn.visible=!0,this.root.rewardNoBtn.visible=!0,this.root.rewardDoubleGetBtn.visible=!1,this.root.rewardGetBtn.visible=!1,this.root.rewardNoDoubleGetBtn.visible=!1)):(this.root.rewardDirectReceiveBtn.visible=!1,this.root.rewardVideoGetBtn.visible=!1,this.root.rewardNoBtn.visible=!1,this.root.rewardDoubleGetBtn.skin="douyin/Btn_DoubleGong.png",this.root.rewardDoubleGetBtn.visible=!0,this.root.rewardGetName.visible=!1,this.root.rewardGetImage.visible=!0,this.root.rewardGetBtn.visible=!1,this.root.rewardNoDoubleGetBtn.visible=!0,this.root.rewardGetLabel.visible=!0,this.root.rewardGetLabel.text=e.num+""))}}class S extends e.carScene.shopCellUI{onAwake(){this.colorFilter=new Laya.ColorFilter([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0])}set dataSource(e){super.dataSource=e,e&&(0==e.goodsType?(this.goodsImage.skin=`shop/Ui_skin${e.id}.png`,this.goodsName.skin=`shop/Ui_SkinName${e.id}.png`):1==e.goodsType&&(this.goodsImage.skin=`shop/Ui_Tail${e.id}.png`,this.goodsName.skin=`shop/Ui_TailName${e.id}.png`),e.unlock?(this.lockMask.visible=!1,this.videoUnlock.visible=!1,this.unlockCostLabel.visible=!1,e.using?this.tag.skin="shop/Ui_ChuanDai.png":this.tag.skin="shop/Btn_Use.png",this.goodsImage.filters=null):(this.goodsImage.filters=[this.colorFilter],this.lockMask.visible=!0,this.tag.skin="shop/Btn_Unlock.png",0==e.unlockType?(this.videoUnlock.visible=!1,this.unlockCostLabel.visible=!0,this.unlockCostLabel.text=e.moneyNeed.toString()):(this.videoUnlock.visible=!0,this.unlockCostLabel.visible=!1)))}get dataSource(){return this._dataSource}}class b extends e.carScene.taskCellUI{onAwake(){this.receiveBtn.on(Laya.Event.CLICK,this,this.onClickEvent),this.goBtn.on(Laya.Event.CLICK,this,this.onClickEvent),this.refreshBtn.on(Laya.Event.CLICK,this,this.onClickEvent)}set dataSource(e){if(super.dataSource=e,e)if("number"==typeof e.num){let t=0;this.refreshBtn.visible=!1,0==e.id?t=window.DataManager.dayFinishNum:1==e.id?t=window.DataManager.dayMoneyNum:2==e.id?t=window.DataManager.dayWinNum:3==e.id&&(t=window.DataManager.dayUnlockNum),this.taskDesc.text=e.desc.replace("*",e.num),this.goalLabel.text=e.num.toString(),this.finishLabel.text=t.toString(),t>=e.num?(this.goBtn.visible=!1,1==window.DataManager.dayTaskRecord[e.id]?(this.received.visible=!0,this.receiveBtn.visible=!1,window.DataManager.dayTaskRefreshRecord[e.id]<2&&(this.refreshBtn.visible=!0)):(this.received.visible=!1,this.receiveBtn.visible=!0)):(this.goBtn.visible=!0,this.received.visible=!1,this.receiveBtn.visible=!1)}else{this.refreshBtn.visible=!1;let t=0;0==e.id?t=window.DataManager.achieveJumpNum:1==e.id?t=window.DataManager.achieveSpeedNum:2==e.id?t=window.DataManager.achieveFinishNum:3==e.id?t=window.DataManager.achieveWinNum:4==e.id?t=window.DataManager.achieveUnlockNum:5==e.id&&(t=window.DataManager.achieveMoneyNum);let i=e.num[window.DataManager.achieveTaskStage[e.id]];this.taskDesc.text=e.desc.replace("*",i),this.goalLabel.text=i.toString(),this.finishLabel.text=t.toString(),t>=i?(this.goBtn.visible=!1,1==window.DataManager.achieveTaskRecord[e.id]?(this.received.visible=!0,this.receiveBtn.visible=!1):(this.received.visible=!1,this.receiveBtn.visible=!0)):(this.goBtn.visible=!0,this.received.visible=!1,this.receiveBtn.visible=!1)}}onClickEvent(e){window.homePage.soundStart("res/Sound/click.mp3"),e.target==this.goBtn?(window.homePage.root.shopBox.visible=!1,window.homePage.root.signBtn.visible=!0,window.homePage.root.lotteryBtn.visible=!0,window.homePage.root.challengeBtn.visible=!0,window.homePage.startMatch()):e.target==this.receiveBtn?("number"==typeof this._dataSource.num?(window.DataManager.dayTaskRecord[this._dataSource.id]=1,localStorage.setItem("dayTaskRecord",JSON.stringify(window.DataManager.dayTaskRecord))):(window.DataManager.achieveTaskRecord[this._dataSource.id]=1,window.DataManager.achieveTaskStage[this._dataSource.id]<this._dataSource.num.length-1&&(window.DataManager.achieveTaskStage[this._dataSource.id]++,window.DataManager.achieveTaskRecord[this._dataSource.id]=0,localStorage.setItem("achieveTaskStage",JSON.stringify(window.DataManager.achieveTaskStage))),localStorage.setItem("achieveTaskRecord",JSON.stringify(window.DataManager.achieveTaskRecord))),this.dataSource=this._dataSource,window.homePage.rewardData={rewardType:0,num:100},window.homePage.showRewardGetBox(window.homePage.rewardData,!1)):e.target==this.refreshBtn&&u.Instance.showVideoAd(()=>{window.DataManager.dayTaskRefreshRecord[this._dataSource.id]+=1,localStorage.setItem("dayTaskRefreshRecord",JSON.stringify(window.DataManager.dayTaskRefreshRecord)),0==this._dataSource.id?(window.DataManager.dayFinishNum=0,localStorage.setItem("dayFinishNum",window.DataManager.dayFinishNum.toString())):1==this._dataSource.id?(window.DataManager.dayMoneyNum=0,localStorage.setItem("dayMoneyNum",window.DataManager.dayMoneyNum.toString())):2==this._dataSource.id?(window.DataManager.dayWinNum=0,localStorage.setItem("dayWinNum",window.DataManager.dayWinNum.toString())):3==this._dataSource.id&&(window.DataManager.dayUnlockNum=0,localStorage.setItem("dayUnlockNum",window.DataManager.dayUnlockNum.toString())),this.dataSource=this._dataSource})}}class L extends e.carScene.signCellUI{constructor(){super(...arguments),this.rewardSkinId=-1,this.rewardTailId=-1}set dataSource(e){if(!e)return;if(2==e.rewardType){let t=window.DataManager.skinUnlockRecord;this.rewardSkinId=t.indexOf(0),-1==this.rewardSkinId&&(e.rewardType=1)}else if(3==e.rewardType){let t=window.DataManager.tailUnlockRecord;this.rewardTailId=t.indexOf(0),-1==this.rewardTailId&&(e.rewardType=1)}super.dataSource=e,this.dayImage.skin=`sign/Ui_Day${e.id+1}.png`,0==e.rewardType?(this.rewardImage.skin="main/Ui_Money.png",this.rewardImage.scaleX=this.rewardImage.scaleY=1,this.descLabel.text=`X${e.num}`):1==e.rewardType?(this.rewardImage.skin="main/Ui_diamond.png",this.rewardImage.scaleX=this.rewardImage.scaleY=1,this.descLabel.text=`X${e.num}`):2==e.rewardType?(this.rewardImage.scaleX=this.rewardImage.scaleY=.8,this.rewardImage.skin=`shop/Ui_skin${e.num}.png`,this.descLabel.text="X1"):3==e.rewardType&&(this.rewardImage.scaleX=this.rewardImage.scaleY=.8,this.rewardImage.skin=`shop/Ui_Tail${e.num}.png`,this.descLabel.text="X1"),0==e.id||1==e.id||6==e.id?this.bg.skin="sign/Ui_FrameQianDao2.png":2!=e.id&&3!=e.id&&4!=e.id&&5!=e.id||(this.bg.skin="sign/Ui_FrameQianDao5.png");let t=window.DataManager.signDay;e.id==t&&("sign/Ui_FrameQianDao2.png"==this.bg.skin?this.bg.skin="sign/Ui_FrameQianDao3.png":this.bg.skin="sign/Ui_FrameQianDao6.png")}get dataSource(){return this._dataSource}}class I extends e.carScene.supriseUI{constructor(){super(...arguments),this.supriseType=0,this.tailId=0,this.skinId=0,this.buffNum=0,this.buffType=0}onAwake(){this.tryBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.setSupriseType()}onBtnClick(e){e.target==this.tryBtn?u.Instance.showVideoAd(()=>{1==this.supriseType?(window.GameManager.isTryTail=!0,window.GameManager.tryTailId=this.tailId):2==this.supriseType?(window.GameManager.isTrySkin=!0,window.GameManager.trySkinId=this.skinId):3==this.supriseType&&r.Instance.EventDis.event("TryBuff",[this.buffType,this.buffNum]),this.close()}):e.target==this.closeBtn&&this.close()}setSupriseType(){let e=1+Math.floor(3*Math.random());1==e?this.setTailType()||this.setSkinType()||this.setBuffType():2==e?this.setSkinType()||this.setTailType()||this.setBuffType():3==e&&this.setBuffType()}setSkinType(){let e=window.DataManager.skinUnlockRecord.indexOf(0);return-1!=e&&(this.supriseType=2,this.skinImage.visible=!0,this.buffImage.visible=!1,this.skinId=e,this.skinImage.skin=`shop/Ui_skin${this.skinId}.png`,!0)}setTailType(){let e=window.DataManager.tailUnlockRecord.indexOf(0);return-1!=e&&(this.supriseType=1,this.skinImage.visible=!0,this.buffImage.visible=!1,this.tailId=e,this.skinImage.skin=`shop/Ui_Tail${this.tailId}.png`,!0)}setBuffType(){return this.supriseType=3,this.skinImage.visible=!1,this.buffImage.visible=!0,this.buffType=1+Math.floor(3*Math.random()),this.buffNum=1+Math.floor(10*Math.random()),1==this.buffType?this.buffImage.skin="main/Ui_WordSpeed.png":2==this.buffType?this.buffImage.skin="main/Ui_WordSpeed2.png":3==this.buffType&&(this.buffImage.skin="main/Ui_Wordmoney.png"),this.buffUpLabel.text=100+3*(this.buffNum+1)+"%",!0}}class C extends e.carScene.treasureUI{constructor(){super(...arguments),this.percent=.7,this.add=.1,this.back=.005,this.curPercent=0,this.isReach=!1}onAwake(){this.chargeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.setProgress(this.curPercent),"undefined"!=typeof tt&&(tt.onShow(this.onShow),tt.onHide(this.onHide)),this.closeBtn.visible=!1,u.Instance.isShowTreasureClose&&Laya.timer.once(3e3,this,()=>{this.closeBtn.visible=!0})}onBtnClick(e){if(e.target==this.chargeBtn){if(this.curPercent+=this.add,this.curPercent>1&&(this.curPercent=1),this.setProgress(this.curPercent),Laya.timer.clear(this,this.onBack),this.curPercent>=this.percent)return u.Instance.showBannerAd(),this.isReach=!0,void(this.closeBtn.visible=!0);Laya.timer.once(100,this,this.triggerBack)}else e.target==this.closeBtn&&this.close()}triggerBack(){Laya.timer.frameLoop(1,this,this.onBack)}onBack(){this.curPercent>0&&(this.curPercent-=this.back,this.curPercent<0&&(this.curPercent=0,Laya.timer.clear(this,this.onBack)),this.setProgress(this.curPercent))}onDestroy(){Laya.timer.clearAll(this),"undefined"!=typeof tt&&(tt.offShow(this.onShow),tt.offHide(this.onHide))}setProgress(e){this.progressBarMask.graphics.drawRect(0,0,516*e,15,"#ff0000")}onHide(){}onShow(){this.isReach&&(this.close(),window.homePage.rewardData={rewardType:0,num:100},window.homePage.showRewardGetBox(window.homePage.rewardData,!1))}}class k{constructor(){}static init(){var e=Laya.ClassUtils.regClass;e("pageScript/GodLifeRuntime.ts",o),e("pageScript/HeadCellRuntime.ts",n),e("pageScript/loadPageScript.ts",f),e("pageScript/homePageScript.ts",v),e("pageScript/ShopCellRuntime.ts",S),e("pageScript/TaskCellRuntime.ts",b),e("pageScript/SignCellRuntime.ts",L),e("pageScript/ShareDialogRuntime.ts",y),e("pageScript/SupriseDialogRuntime.ts",I),e("pageScript/TreasureDialogRuntime.ts",C)}}k.width=720,k.height=1600,k.scaleMode="fixedwidth",k.screenMode="vertical",k.alignV="top",k.alignH="center",k.startScene="carScene/loadPage.scene",k.sceneRoot="",k.debug=!1,k.stat=!1,k.physicsDebug=!1,k.exportSceneToJson=!0,k.init();console.log("newMain"),new class{constructor(){console.log("MainRun"),window.Laya3D?Laya3D.init(k.width,k.height):Laya.init(k.width,k.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=k.scaleMode,Laya.stage.screenMode=k.screenMode,Laya.stage.alignV=k.alignV,Laya.stage.alignH=k.alignH,Laya.URL.exportSceneToJson=k.exportSceneToJson,(k.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),k.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),k.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),console.log("Main111"),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){window.Gameing=!1,console.log("ddddddddddddddddd"),h.Instance.init(),k.startScene&&Laya.Scene.open(k.startScene)}}}();