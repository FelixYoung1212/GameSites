!function(){"use strict";var t;!function(t){t.TargetNodeChange="TargetNodeChange",t.SelectCard="SelectCard",t.StartGame="StartGame",t.UpdateFightData="UpdateFightData",t.InitFightCell="InitFightCell",t.AttackOnce="AttackOnce",t.GotoScene="GotoScene",t.BacktoScene="BacktoScene",t.PopTip="PopTip",t.ClickMainBtn="ClickMainBtn",t.ComposeNew="ComposeNew",t.ShowPicturePointer="ShowPicturePointer",t.UpdatePicturePointer="UpdatePicturePointer",t.ShowBossPointer="ShowBossPointer",t.UpdateBossPointer="UpdateBossPointer",t.ChooseOneFinish="ChooseOneFinish",t.ChangeFightList="ChangeFightList",t.QteSuccess="QteSuccess",t.ChangeQteState="ChangeQteState",t.QteNext="QteNext",t.ShowCount="ShowCount",t.ShowPvpCount="ShowPvpCount",t.UpdateTask="UpdateTask",t.RefreshRed="RefreshRed",t.UpdateRed="UpdateRed",t.QteEnd="QteEnd",t.ControlChange="ControlChange",t.OpenBig="OpenBig",t.OpenSmall="OpenSmall",t.OneCure="OneCure",t.StartCatch="StartCatch",t.ShowBlackMask="ShowBlackMask",t.AddMoney="AddMoney",t.CureMonster="CureMonster",t.UpdateProgress="UpdateProgress",t.UpdateBg="UpdateBg",t.ShowComposeEffect="ShowComposeEffect",t.ComposeEnd="ComposeEnd",t.EnableMustKill="EnableMustKill",t.FighterDeath="FighterDeath",t.UpdateSuperRed="UpdateSuperRed",t.UpdateComposeRed="UpdateComposeRed",t.UpdateSmallMap="UpdateSmallMap",t.ShowTreasurePointer="ShowTreasurePointer",t.UpdateTreasurePointer="UpdateTreasurePointer",t.CatchEnd="CatchEnd",t.UseMoney="UseMoney",t.PlayerStopMove="PlayerStopMove",t.BossOut="BossOut",t.FullHpRevive="FullHpRevive",t.CatchResultClose="CatchResultClose",t.GotoCatch="GotoCatch",t.BallStartCatch="BallStartCatch",t.ShowHandBook="ShowHandBook",t.ShowSpriteShop="ShowSpriteShop",t.ChangeElite="ChangeElite",t.ChangeAutoFight="ChangeAutoFight",t.CloseAutoFight="CloseAutoFight",t.ShowCustomAd="ShowCustomAd",t.OpenTreasureBoxFinish="OpenTreasureBoxFinish",t.VideoAdClosed="VideoAdClosed",t.ReceiveRankReward="ReceiveRankReward",t.GoChallenge="GoChallenge",t.ShowGoldMoneyUi="ShowGoldMoneyUi",t.ClickGameCell="ClickGameCell",t.RefreshGiftPackList="RefreshGiftPackList",t.ShowGiftPack="ShowGiftPack",t.JumpToPage="JumpToPage"}(t||(t={}));class e{static init(){e._disp||(e._disp=new Laya.EventDispatcher)}static event(t,i){return e._disp.event(t,i)}static on(t,i,s,a){return e._disp.on(t,i,s,a)}static once(t,i,s,a){return e._disp.once(t,i,s,a)}static off(t,i,s,a){return e._disp.off(t,i,s,a)}static offAll(t){return e._disp.offAll(t)}static isMouseEvent(t){return e._disp.isMouseEvent(t)}static hasListener(t){return e._disp.hasListener(t)}}var i,s,a,n,o=Laya.View,r=Laya.Dialog,h=Laya.Scene,l=Laya.ClassUtils.regClass;!function(t){!function(t){class e extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/addBadge")}}t.addBadgeUI=e,l("ui.pages.addBadgeUI",e);class i extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/addMoney")}}t.addMoneyUI=i,l("ui.pages.addMoneyUI",i);class s extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/askForCard")}}t.askForCardUI=s,l("ui.pages.askForCardUI",s);class a extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(a.uiView)}}a.uiView={type:"Scene",props:{width:139,runtime:"uilogic/CardRuntime.ts",height:149},compId:2,child:[{type:"Image",props:{width:139,var:"cardBg",skin:"main/Ui_FrameMonster.png",height:149},compId:3,child:[{type:"Image",props:{y:96,x:26,width:90,var:"hpProgress",skin:"main/Ui_FrameMonster2.png",height:6},compId:4},{type:"Label",props:{y:107,x:32,var:"hpLabel",text:"0",fontSize:20,color:"#000000",bold:!0},compId:5},{type:"Label",props:{y:107,x:91,var:"atkLabel",text:"0",fontSize:20,color:"#000000",bold:!0},compId:6},{type:"Sprite",props:{y:8,x:15,texture:"main/Ui_FrameMonster3.png"},compId:11},{type:"Image",props:{y:8,x:15,var:"icon",skin:"monster/Ui_Monster1.png"},compId:7},{type:"Sprite",props:{y:8,x:14,var:"redLight",texture:"main/Ui_FrameRed.png",alpha:.06666666666666667},compId:12},{type:"Sprite",props:{y:-5,x:61,var:"newTag",texture:"count/Ui_New.png",scaleY:.6,scaleX:.6},compId:13},{type:"Label",props:{y:66.5,var:"eggTimeLeftLabel",text:"00:00",scaleY:.5,scaleX:.5,fontSize:45,color:"#000000",centerX:0,bold:!0},compId:16},{type:"Image",props:{y:12,x:25,var:"starBg",skin:"main/Ui_FrameStarPurple(1).png"},compId:8,child:[{type:"Label",props:{var:"starLabel",text:"0",fontSize:14,color:"#ffffff",centerY:0,centerX:0,bold:!0},compId:10},{type:"Image",props:{y:7,x:0,var:"starIcon",skin:"newSystem/Ui_StarYellow.png",anchorY:.5,anchorX:.5},compId:19}]},{type:"Sprite",props:{y:71,x:18,var:"videoTag",texture:"ad/Btn_Ad.png"},compId:21}]}],animations:[{nodes:[{target:12,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:12,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:12,key:"alpha",index:15},{value:0,tweenMethod:"linearNone",tween:!0,target:12,key:"alpha",index:30}]}}],name:"hurt",id:1,frameRate:60,action:0}],loadList:["main/Ui_FrameMonster.png","main/Ui_FrameMonster2.png","main/Ui_FrameMonster3.png","monster/Ui_Monster1.png","main/Ui_FrameRed.png","count/Ui_New.png","main/Ui_FrameStarPurple(1).png","newSystem/Ui_StarYellow.png","ad/Btn_Ad.png"],loadList3D:[]},t.cardUI=a,l("ui.pages.cardUI",a);class n extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(n.uiView)}}n.uiView={type:"Scene",props:{width:720,runtime:"uilogic/CardBagRuntime.ts",height:1280},compId:2,child:[{type:"Box",props:{y:0,x:0,width:720,var:"topBox",top:0,height:1},compId:4,child:[{type:"List",props:{y:200,x:0,var:"monsterList",repeatY:1,repeatX:1,elasticEnabled:!0},compId:19,child:[{type:"cardPage",props:{renderType:"render",runtime:"uilogic/CardPageRuntime.ts"},compId:20}]},{type:"Sprite",props:{y:397,x:45,width:75,var:"leftBtn",texture:"main/Btn_Arrow.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:47,pivotX:38,height:93},compId:9},{type:"Sprite",props:{y:397,x:675,width:75,var:"rightBtn",texture:"main/Btn_Arrow.png",scaleX:-1,runtime:"gframe-work/effect/ButtonScale.ts",pivotY:47,pivotX:38,height:93},compId:10},{type:"Sprite",props:{y:139,x:265,width:190,texture:"handBook/Ui_ComposeTittle.png",height:48},compId:11}]},{type:"Box",props:{y:0,x:0,width:720,var:"middleBox",height:1,centerY:0},compId:5},{type:"Box",props:{y:0,x:0,width:720,var:"downBox",height:1,bottom:0},compId:6}],loadList:["main/Btn_Arrow.png","handBook/Ui_ComposeTittle.png"],loadList3D:[]},t.cardBagUI=n,l("ui.pages.cardBagUI",n);class c extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(c.uiView)}}c.uiView={type:"Scene",props:{width:720,runtime:"uilogic/CardPageRuntime.ts",height:447},compId:2,child:[{type:"List",props:{y:0,x:82,var:"cardList",repeatY:3,repeatX:4},compId:29,child:[{type:"card",props:{renderType:"render",runtime:"uilogic/CardRuntime.ts"},compId:30}]}],loadList:[],loadList3D:[]},t.cardPageUI=c,l("ui.pages.cardPageUI",c);class d extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(d.uiView)}}d.uiView={type:"Scene",props:{width:720,runtime:"uilogic/CatchRuntime.ts",height:1280},compId:2,child:[{type:"Box",props:{width:720,var:"topBox",top:0,height:1},compId:3,child:[{type:"Sprite",props:{y:65,x:84,var:"catchInfoBg",texture:"count/Ui_Catch.png"},compId:6,child:[{type:"Image",props:{y:213,x:42,skin:"count/Ui_CatchTiao2.png"},compId:11,child:[{type:"Image",props:{y:4,x:6,var:"progressBar",skin:"count/Ui_CatchTiao1.png"},compId:12}]},{type:"Image",props:{y:67,x:40,skin:"count/Ui_FrameStar.png"},compId:13,child:[{type:"Label",props:{var:"starLabel",text:"0",scaleY:.7,scaleX:.7,fontSize:45,color:"#ffffff",centerY:1,centerX:12,bold:!0},compId:16}]},{type:"Label",props:{y:144,x:232,var:"perLabel",text:"0%",scaleY:1,scaleX:1,fontSize:60,font:"Num1",color:"#ffffff",centerX:12},compId:17}]},{type:"Sprite",props:{y:56,x:65,width:64,var:"quitCatchBossBtn",texture:"main/Btn_Back.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:31,pivotX:32,height:61},compId:27}]},{type:"Box",props:{x:0,width:720,var:"downBox",height:1,bottom:0},compId:4,child:[{type:"Sprite",props:{y:-179,x:360,width:240,var:"catchBossBtn",texture:"main/Btn_BossCatch2.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:42,pivotX:120,height:84},compId:28,child:[{type:"Sprite",props:{y:62,x:21,var:"videoTag",texture:"main/Btn_Ad.png"},compId:29}]}]},{type:"Box",props:{width:720,var:"middleBox",height:1,centerY:0},compId:19},{type:"Image",props:{y:1112,x:356,var:"catchProgressBg",skin:"count/Ui_CatchTiao4.png",pivotY:161,pivotX:161},compId:21,child:[{type:"Image",props:{y:4,x:4,width:321,skin:"count/Ui_CatchTiao5.png",height:275},compId:22,child:[{type:"Image",props:{width:321,var:"progressMask2",renderType:"mask",height:275},compId:24}]},{type:"Image",props:{y:100,x:285,skin:"count/Ui_CatchTiao6.png"},compId:23}]}],loadList:["count/Ui_Catch.png","count/Ui_CatchTiao2.png","count/Ui_CatchTiao1.png","count/Ui_FrameStar.png","main/Btn_Back.png","main/Btn_BossCatch2.png","main/Btn_Ad.png","count/Ui_CatchTiao4.png","count/Ui_CatchTiao5.png","count/Ui_CatchTiao6.png"],loadList3D:[]},t.catchUI=d,l("ui.pages.catchUI",d);class p extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/catchResult")}}t.catchResultUI=p,l("ui.pages.catchResultUI",p);class g extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(g.uiView)}}g.uiView={type:"Scene",props:{width:720,runtime:"uilogic/ChallengeRuntime.ts",height:1280},compId:2,child:[{type:"Panel",props:{x:0,width:720,var:"bigLevelPanel",top:0,elasticEnabled:!0,bottom:144},compId:12},{type:"Box",props:{width:720,var:"upBox",top:0,height:1},compId:6,child:[{type:"Sprite",props:{y:401,x:72,width:100,var:"succeedBtn",texture:"newSystem/Btn_Sueeeed2.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:51,pivotX:50,height:102},compId:19,child:[{type:"Sprite",props:{y:-26,x:66,var:"succeedRed",texture:"main/Ui_RedPoint.png"},compId:20}]},{type:"Sprite",props:{y:518,x:72,width:100,var:"rankBtn",texture:"challengeRank/Btn_DaoGuanRank.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:52,pivotX:50,height:103},compId:26},{type:"moneyUi",props:{y:195,x:481,var:"badgeMoneyUi",runtime:"uilogic/MoneyUiRuntime.ts"},compId:27}]},{type:"Box",props:{x:0,width:720,var:"downBox",height:1,bottom:0},compId:7,child:[{type:"Sprite",props:{y:-400,x:18,width:680,var:"mapInfoPanel",texture:"newSystem/Ui_TittleDaoGuan.png",height:227},compId:8,child:[{type:"Sprite",props:{y:234,x:338,width:162,var:"challengeBtn",texture:"newSystem/Btn_Challenge.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:37,pivotX:81,height:74},compId:9},{type:"Sprite",props:{y:52,x:666,width:52,var:"closeBtn",texture:"main/Btn_Close.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:26,pivotX:26,height:52},compId:11},{type:"Panel",props:{y:94,x:29,width:623,var:"smallLevelPanel",height:94,elasticEnabled:!0},compId:13},{type:"Image",props:{y:13,x:124,var:"mapName",skin:"newSystem/Ui_DaoGuanName1.png"},compId:17},{type:"Image",props:{y:6,x:34,var:"mapImage",skin:"newSystem/Ui_DaoGuan1.png"},compId:18},{type:"Label",props:{y:46,x:207,var:"levelNumLabel",text:"40",scaleY:.35,scaleX:.35,fontSize:60,font:"Num1",color:"#ffffff",centerX:-124},compId:21}]}]}],loadList:["newSystem/Btn_Sueeeed2.png","main/Ui_RedPoint.png","challengeRank/Btn_DaoGuanRank.png","newSystem/Ui_TittleDaoGuan.png","newSystem/Btn_Challenge.png","main/Btn_Close.png","newSystem/Ui_DaoGuanName1.png","newSystem/Ui_DaoGuan1.png"],loadList3D:[]},t.challengeUI=g,l("ui.pages.challengeUI",g);class m extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/challengeRank")}}t.challengeRankUI=m,l("ui.pages.challengeRankUI",m);class u extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(u.uiView)}}u.uiView={type:"Scene",props:{width:450,runtime:"uilogic/ChallengeRankCellRuntime.ts",height:30},compId:2,child:[{type:"Image",props:{var:"bg",skin:"challengeRank/Ui_FrameRank3.png",centerY:0,centerX:0},compId:3},{type:"Box",props:{width:420,height:30,centerY:0,centerX:0},compId:6,child:[{type:"Label",props:{x:346,var:"levelLabel",text:"1-1",scaleY:.35,scaleX:.35,fontSize:60,color:"#ffffff",centerY:0},compId:5},{type:"Label",props:{var:"rankLabel",text:"1",scaleY:.35,scaleX:.35,fontSize:60,color:"#ffffff",centerY:0,centerX:-177},compId:7},{type:"Image",props:{y:-12,x:-11,var:"rankImage",skin:"challengeRank/Ui_No1.png"},compId:8},{type:"Label",props:{x:97,var:"nameLabel",text:"1",scaleY:.35,scaleX:.35,fontSize:60,color:"#000000",centerY:0},compId:9},{type:"Image",props:{x:51,width:30,var:"headImage",height:30,centerY:0},compId:10}]}],loadList:["challengeRank/Ui_FrameRank3.png","challengeRank/Ui_No1.png"],loadList3D:[]},t.challengeRankCellUI=u,l("ui.pages.challengeRankCellUI",u);class y extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(y.uiView)}}y.uiView={type:"Scene",props:{width:446,runtime:"uilogic/ChallengeRankRewardCellRuntime.ts",height:100},compId:2,child:[{type:"Sprite",props:{texture:"challengeRank/Ui_FrameRank4.png"},compId:3},{type:"Label",props:{y:-1,x:12,var:"levelLabel",text:"通过2-2",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1"},compId:5},{type:"List",props:{y:29,x:17,var:"rewardList",spaceX:10,repeatX:2},compId:6,child:[{type:"Box",props:{width:58,renderType:"render",height:63},compId:7,child:[{type:"Sprite",props:{texture:"challengeRank/Ui_FrameRank5.png"},compId:8},{type:"Image",props:{y:26,x:29,skin:"newSystem/Ui_SuCai1004.png",scaleY:.5,scaleX:.5,name:"icon",anchorY:.5,anchorX:.5},compId:18},{type:"Label",props:{y:51,x:28,text:"X1",scaleY:.25,scaleX:.25,name:"label",fontSize:60,font:"Num1",anchorY:.5,anchorX:.5},compId:19}]}]},{type:"Sprite",props:{y:39,x:164,var:"receiveBtn",texture:"pvp/Btn_RankGet1.png"},compId:10},{type:"Sprite",props:{y:39,x:163.5,var:"goBtn",texture:"challengeRank/Btn_Go.png"},compId:12},{type:"List",props:{y:29,x:278,var:"extraRewardList",repeatX:1},compId:13,child:[{type:"Box",props:{width:58,renderType:"render",height:63},compId:14,child:[{type:"Sprite",props:{texture:"challengeRank/Ui_FrameRank5.png"},compId:15},{type:"Image",props:{y:26,x:29,skin:"newSystem/Ui_SuCai1004.png",scaleY:.5,scaleX:.5,name:"icon",anchorY:.5,anchorX:.5},compId:21},{type:"Label",props:{y:51,x:28,text:"X1",scaleY:.25,scaleX:.25,name:"label",fontSize:60,font:"Num1",anchorY:.5,anchorX:.5},compId:22}]}]},{type:"Sprite",props:{y:39,x:351,var:"extraReceiveBtn",texture:"pvp/Btn_RankGet2.png"},compId:11,child:[{type:"Sprite",props:{y:31,x:5,width:12,var:"videoTag",texture:"main/Btn_Ad.png",height:9},compId:23}]},{type:"Label",props:{y:60.5,x:202,var:"normalReceiveTag",text:"已领取",fontSize:20,color:"#ffffff",anchorY:.5,anchorX:.5},compId:16},{type:"Label",props:{y:59,x:390,var:"extraReceiveTag",text:"已领取",fontSize:20,color:"#ffffff",anchorY:.5,anchorX:.5},compId:17}],loadList:["challengeRank/Ui_FrameRank4.png","challengeRank/Ui_FrameRank5.png","newSystem/Ui_SuCai1004.png","pvp/Btn_RankGet1.png","challengeRank/Btn_Go.png","pvp/Btn_RankGet2.png","main/Btn_Ad.png"],loadList3D:[]},t.ChallengeRankRewardCellUI=y,l("ui.pages.ChallengeRankRewardCellUI",y);class f extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(f.uiView)}}f.uiView={type:"Scene",props:{width:720,runtime:"uilogic/ChooseOneRuntime.ts",height:1280},compId:2,child:[{type:"Box",props:{width:720,height:1,centerY:0},compId:8,child:[{type:"Sprite",props:{y:-422,x:0,texture:"chooseOne/Ui_FrameSelect.png"},compId:6},{type:"Box",props:{y:-101,x:0,width:720,var:"monsterBox",height:142},compId:9},{type:"Sprite",props:{y:-231,x:193,var:"light",texture:"chooseOne/Ui_FrameSelect2.png",alpha:.6333333333333333},compId:7},{type:"Sprite",props:{y:298,x:360,width:156,var:"randomBtn",texture:"ad/Btn_Random2.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:18,pivotX:78,height:36},compId:4},{type:"Sprite",props:{y:196,x:360,width:211,var:"allBtn",texture:"chooseOne/Btn_All.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:42,pivotX:106,height:84},compId:5,child:[{type:"Sprite",props:{y:62,x:21,var:"videoTag",texture:"ad/Btn_Ad.png"},compId:11}]}]}],animations:[{nodes:[{target:7,keyframes:{alpha:[{value:.5,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:15},{value:.5,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:30}]}}],name:"ani1",id:1,frameRate:60,action:2}],loadList:["chooseOne/Ui_FrameSelect.png","chooseOne/Ui_FrameSelect2.png","ad/Btn_Random2.png","chooseOne/Btn_All.png","ad/Btn_Ad.png"],loadList3D:[]},t.chooseOneUI=f,l("ui.pages.chooseOneUI",f);class L extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(L.uiView)}}L.uiView={type:"Scene",props:{width:720,runtime:"uilogic/ComposeRuntime.ts",height:1280},compId:2,child:[{type:"cardBag",props:{var:"cardBag",runtime:"uilogic/CardBagRuntime.ts"},compId:25},{type:"Box",props:{y:0,x:0,width:720,var:"middleBox",height:1,centerY:0},compId:5},{type:"Box",props:{y:1279,x:0,width:720,var:"downBox",height:1,bottom:0},compId:6,child:[{type:"Sprite",props:{y:-632,x:20,width:373,texture:"handBook/Ui_FrameCompose1.png",height:257},compId:20,child:[{type:"Box",props:{y:62,x:25,width:139,var:"cardBox1",height:149},compId:33,child:[{type:"card",props:{y:0,x:0,var:"card1",runtime:"uilogic/CardRuntime.ts"},compId:32}]},{type:"Box",props:{y:62,x:204,width:139,var:"cardBox2",height:149},compId:34,child:[{type:"card",props:{y:0,x:0,var:"card2",runtime:"uilogic/CardRuntime.ts"},compId:35}]}]},{type:"Sprite",props:{y:-630,x:459,width:246,texture:"handBook/Ui_FrameCompose2.png",height:254},compId:22,child:[{type:"card",props:{y:52,x:53,var:"composeResultCard",runtime:"uilogic/CardRuntime.ts"},compId:28}]},{type:"Sprite",props:{y:-541,x:381,texture:"handBook/Ui_FrameCompose4.png"},compId:21},{type:"Sprite",props:{y:-367,x:207,width:170,var:"quickSelectBtn",texture:"handBook/Btn_Select.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:38,pivotX:85,height:76},compId:23,child:[{type:"Sprite",props:{y:3,x:165,width:52,var:"quickSelectRed",texture:"main/Ui_RedPoint.png",scaleY:.5,scaleX:.5,pivotY:26,pivotX:26,height:52},compId:36}]},{type:"Sprite",props:{y:-370,x:588,width:192,var:"composeBtn",texture:"handBook/Btn_Compose.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:43,pivotX:96,height:86},compId:24,child:[{type:"Label",props:{y:36,var:"composeCostLabel",text:"0",scaleY:.6,scaleX:.6,fontSize:60,font:"Num1",color:"#ffffff",centerX:10},compId:29}]},{type:"Sprite",props:{y:-530,x:181,texture:"handBook/Ui_FrameCompose3.png"},compId:31}]}],loadList:["handBook/Ui_FrameCompose1.png","handBook/Ui_FrameCompose2.png","handBook/Ui_FrameCompose4.png","handBook/Btn_Select.png","main/Ui_RedPoint.png","handBook/Btn_Compose.png","handBook/Ui_FrameCompose3.png"],loadList3D:[]},t.composeUI=L,l("ui.pages.composeUI",L);class v extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/count")}}t.countUI=v,l("ui.pages.countUI",v);class C extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(C.uiView)}}C.uiView={type:"Scene",props:{width:720,runtime:"uilogic/CureCellRuntime.ts",height:250},compId:2,child:[{type:"Panel",props:{y:0,x:92,width:535,height:250},compId:16,child:[{type:"Image",props:{y:74,x:0,width:535,var:"bigBg",skin:"play/Ui_FrameTeam1.png",height:176,bottom:0,sizeGrid:"0,26,0,69"},compId:3,child:[{type:"List",props:{y:22,x:69,var:"cardList",spaceX:10,repeatY:1,repeatX:3},compId:4,child:[{type:"card",props:{renderType:"render",runtime:"uilogic/CardRuntime.ts"},compId:5}]},{type:"List",props:{y:-57,x:71,var:"cureList",spaceX:17,repeatY:1,repeatX:3},compId:7,child:[{type:"Box",props:{width:133,renderType:"render",height:75},compId:9,child:[{type:"Sprite",props:{texture:"play/Btn_Cure.png"},compId:10},{type:"Label",props:{y:29,text:"0",scaleY:.5,scaleX:.5,name:"costLabel",fontSize:60,font:"Num1",color:"#ffffff",centerX:0},compId:11},{type:"Sprite",props:{texture:"main/Btn_CureAd1.png",name:"videoCure"},compId:27},{type:"Sprite",props:{y:54,x:10,texture:"ad/Btn_Ad.png",name:"videoTag"},compId:28}]}]}]}]},{type:"Sprite",props:{y:120,x:647,var:"closeBtn",texture:"main/Ui_TeamTan.png",scaleX:-1},compId:25}],loadList:["play/Ui_FrameTeam1.png","play/Btn_Cure.png","main/Btn_CureAd1.png","ad/Btn_Ad.png","main/Ui_TeamTan.png"],loadList3D:[]},t.cureCellUI=C,l("ui.pages.cureCellUI",C);class I extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(I.uiView)}}I.uiView={type:"Scene",props:{width:197,runtime:"uilogic/DivisionIconRuntime.ts",height:129},compId:2,child:[{type:"Image",props:{y:0,var:"divisionIcon",skin:"pvp/Ui_Rank1.png",centerX:0},compId:3},{type:"Image",props:{y:-41,var:"divisionName",skin:"pvp/Ui_RankWord1.png",centerX:0},compId:5},{type:"Box",props:{width:197,var:"starBox",height:129},compId:12,child:[{type:"Sprite",props:{y:120,x:31,var:"star1",texture:"pvp/Ui_RankStar.png"},compId:8},{type:"Sprite",props:{y:134,x:65,var:"star2",texture:"pvp/Ui_RankStar.png"},compId:7},{type:"Sprite",props:{y:134,x:107,var:"star3",texture:"pvp/Ui_RankStar.png"},compId:9},{type:"Sprite",props:{y:120,x:140,var:"star4",texture:"pvp/Ui_RankStar.png"},compId:10}]}],loadList:["pvp/Ui_Rank1.png","pvp/Ui_RankWord1.png","pvp/Ui_RankStar.png"],loadList3D:[]},t.divisionIconUI=I,l("ui.pages.divisionIconUI",I);class S extends o{constructor(){super()}createChildren(){super.createChildren(),this.createView(S.uiView)}}S.uiView={type:"View",props:{y:75,x:107,width:214,pivotY:75,pivotX:107,height:162},compId:2,child:[{type:"Image",props:{var:"btnIcon",skin:"main/Btn_Team.png",centerY:0,centerX:0},compId:3,child:[{type:"Image",props:{y:16,x:19,width:52,var:"redPoint",skin:"main/Ui_RedPoint.png",pivotY:26,pivotX:26,height:52},compId:6}]},{type:"Sprite",props:{y:0,x:7,var:"btnMask",texture:"newSystem/Btn_StarUPMask.png"},compId:7}],animations:[{nodes:[{target:6,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:20},{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:40}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:20},{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:40}]}}],name:"ani1",id:1,frameRate:60,action:0}],loadList:["main/Btn_Team.png","main/Ui_RedPoint.png","newSystem/Btn_StarUPMask.png"],loadList3D:[]},t.downBtnUI=S,l("ui.pages.downBtnUI",S);class w extends o{constructor(){super()}createChildren(){super.createChildren(),this.createView(w.uiView)}}w.uiView={type:"View",props:{width:720,runtime:"uilogic/DownPanelRuntime.ts",height:120},compId:2,loadList:[],loadList3D:[]},t.downPanelUI=w,l("ui.pages.downPanelUI",w);class x extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/eggShop")}}t.eggShopUI=x,l("ui.pages.eggShopUI",x);class k extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/escape")}}t.escapeUI=k,l("ui.pages.escapeUI",k);class B extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(B.uiView)}}B.uiView={type:"Scene",props:{width:720,runtime:"uilogic/FightRuntime.ts",height:1280,autoDestroyAtClosed:!0},compId:2,child:[{type:"Box",props:{width:720,top:0,height:1},compId:3,child:[{type:"Image",props:{y:65,x:0,width:233,var:"enemyCardBg",skin:"play/Ui_FrameEnemy.png",height:176,centerX:0,sizeGrid:"0,47,0,78"},compId:6,child:[{type:"List",props:{y:17,x:67,var:"enemyCardList",spaceX:11,repeatY:1,repeatX:3},compId:8,child:[{type:"card",props:{renderType:"render",runtime:"uilogic/CardRuntime.ts"},compId:9}]}]},{type:"Sprite",props:{y:75,x:94,width:134,var:"escapeBtn",texture:"main/Btn_Escape.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:38,pivotX:67,height:76},compId:7}]},{type:"Box",props:{x:0,width:720,height:1,bottom:0},compId:4,child:[{type:"fightCell",props:{y:-400,x:93,width:535,var:"fightCell",height:232,runtime:"uilogic/FightCellRuntime.ts"},compId:10},{type:"Image",props:{y:-430,x:244,width:234,var:"autoFightBg",skin:"newSystem/Ui_Fightword1.png",height:25,centerX:0},compId:11,child:[{type:"Sprite",props:{y:8,x:2,var:"gou",texture:"newSystem/Ui_Fightword2.png"},compId:12}]}]},{type:"qte",props:{y:0,x:0,var:"qtePage",runtime:"uilogic/QteRuntime.ts"},compId:5}],loadList:["play/Ui_FrameEnemy.png","main/Btn_Escape.png","newSystem/Ui_Fightword1.png","newSystem/Ui_Fightword2.png"],loadList3D:[]},t.fightUI=B,l("ui.pages.fightUI",B);class b extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(b.uiView)}}b.uiView={type:"Scene",props:{width:535,runtime:"uilogic/FightCellRuntime.ts",height:232},compId:2,child:[{type:"Image",props:{var:"bg",top:0,skin:"play/Ui_FrameTeam2.png",right:0,left:0,bottom:0,sizeGrid:"0,40,0,84"},compId:3,child:[{type:"List",props:{y:17,x:67,var:"monsterList",spaceX:11,repeatY:1,repeatX:3},compId:5,child:[{type:"card",props:{renderType:"render",runtime:"uilogic/CardRuntime.ts"},compId:6}]},{type:"List",props:{y:155,x:68,var:"atkTimeList",spaceX:18,repeatY:1,repeatX:3},compId:8,child:[{type:"fightDot",props:{renderType:"render",runtime:"uilogic/FightDotRuntime.ts"},compId:10}]}]}],loadList:["play/Ui_FrameTeam2.png"],loadList3D:[]},t.fightCellUI=b,l("ui.pages.fightCellUI",b);class T extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(T.uiView)}}T.uiView={type:"Scene",props:{width:133,runtime:"uilogic/FightDotRuntime.ts",height:75},compId:2,child:[{type:"Sprite",props:{y:26,x:22,width:88,var:"dotBg",texture:"play/Ui_Cost1.png",height:23},compId:3,child:[{type:"Sprite",props:{y:0,x:0,var:"dot1",texture:"play/Ui_Cost2.png"},compId:5},{type:"Sprite",props:{y:0,x:32,var:"dot2",texture:"play/Ui_Cost2.png"},compId:6},{type:"Sprite",props:{y:0,x:65,var:"dot3",texture:"play/Ui_Cost2.png"},compId:7}]},{type:"Image",props:{y:38,x:67,width:133,var:"mustKillBtn",skin:"play/Btn_Kill.png",pivotY:38,pivotX:67,height:75,disabled:!1},compId:4}],loadList:["play/Ui_Cost1.png","play/Ui_Cost2.png","play/Btn_Kill.png"],loadList3D:[]},t.fightDotUI=T,l("ui.pages.fightDotUI",T);class M extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/getCard")}}t.getCardUI=M,l("ui.pages.getCardUI",M);class D extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/getLotteryTime")}}t.getLotteryTimeUI=D,l("ui.pages.getLotteryTimeUI",D);class P extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(P.uiView)}}P.uiView={type:"Scene",props:{width:566,runtime:"uilogic/GiftPackRuntime.ts",height:156},compId:2,child:[{type:"Image",props:{y:-1,x:0,var:"bg",skin:"pay/Ui_Gift5.png",centerY:0,centerX:0},compId:3,child:[{type:"Image",props:{y:74,x:462,var:"buyBtn",skin:"pay/Btn_Money1.png"},compId:11},{type:"Label",props:{y:77,x:242,var:"hpLabel1",text:"100",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1"},compId:12},{type:"Label",props:{y:77,x:324,var:"atkLabel1",text:"100",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1"},compId:13},{type:"Label",props:{y:62,x:323,var:"hpLabel2",text:"100",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1"},compId:16},{type:"Label",props:{y:62,x:405,var:"atkLabel2",text:"100",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1"},compId:17},{type:"Label",props:{y:100,x:388,var:"hpLabel3",text:"100",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1"},compId:18},{type:"Label",props:{y:100,x:470,var:"atkLabel3",text:"100",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1"},compId:19},{type:"Sprite",props:{y:28,x:458,width:90,var:"limitBg",texture:"pay/Ui_purchaselimit2.png",height:31},compId:26,child:[{type:"Label",props:{y:3,x:58.5,var:"limitLabel",text:"0/1",scaleY:.3,scaleX:.3,fontSize:60,font:"Num1"},compId:28}]},{type:"Sprite",props:{y:22,x:6,var:"buyMask",texture:"pay/Ui_MaskGift5.png"},compId:29}]}],loadList:["pay/Ui_Gift5.png","pay/Btn_Money1.png","pay/Ui_purchaselimit2.png","pay/Ui_MaskGift5.png"],loadList3D:[]},t.giftPackUI=P,l("ui.pages.giftPackUI",P);class _ extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/giftPackPage")}}t.giftPackPageUI=_,l("ui.pages.giftPackPageUI",_);class U extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(U.uiView)}}U.uiView={type:"Scene",props:{width:720,runtime:"uilogic/GroupRuntime.ts",height:1280},compId:2,child:[{type:"cardBag",props:{var:"cardBag",runtime:"uilogic/CardBagRuntime.ts"},compId:13},{type:"Box",props:{y:0,x:0,width:720,var:"downBox",height:1,bottom:0},compId:5,child:[{type:"Sprite",props:{y:-572,x:360,width:297,var:"quickUpBtn",texture:"handBook/Btn_Go.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:53,pivotX:149,height:106},compId:11,child:[{type:"Sprite",props:{y:3,x:272,width:52,var:"quickUpRed",texture:"main/Ui_RedPoint.png",scaleY:.5,scaleX:.5,pivotY:26,pivotX:26,height:52},compId:30}]},{type:"Sprite",props:{y:-517,x:74,width:534,var:"groupBg",texture:"handBook/Ui_FrameTeam.png",height:177},compId:12,child:[{type:"Box",props:{y:23,x:60,width:139,var:"cardBox1",height:149},compId:23,child:[{type:"card",props:{y:0,x:0,var:"card1",runtime:"uilogic/CardRuntime.ts"},compId:25}]},{type:"Box",props:{y:23,x:216,width:139,var:"cardBox2",height:149},compId:24,child:[{type:"card",props:{y:0,x:0,var:"card2",runtime:"uilogic/CardRuntime.ts"},compId:26}]},{type:"Box",props:{y:23,x:372,width:139,var:"cardBox3",height:149},compId:28,child:[{type:"card",props:{y:0,x:0,var:"card3",runtime:"uilogic/CardRuntime.ts"},compId:29}]},{type:"Box",props:{y:34,x:72,width:116,var:"lockBox1",renderType:"render",mouseEnabled:!0,height:161},compId:40,child:[{type:"Image",props:{y:0,x:0,skin:"ad/Ui_MaskShangZhen2.png",name:"cover"},compId:41},{type:"Image",props:{y:99,x:4,skin:"ad/Btn_ForeverUnlock.png",name:"unlockBtn"},compId:42},{type:"Sprite",props:{y:142,x:9,width:20,texture:"ad/Btn_Ad.png",name:"videoTag",height:15},compId:49}]},{type:"Box",props:{y:34,x:228,width:116,var:"lockBox2",renderType:"render",mouseEnabled:!0,height:161},compId:43,child:[{type:"Image",props:{y:0,x:0,skin:"ad/Ui_MaskShangZhen2.png",name:"cover"},compId:44},{type:"Image",props:{y:99,x:4,skin:"ad/Btn_ForeverUnlock.png",name:"unlockBtn"},compId:45},{type:"Sprite",props:{y:142,x:9,width:20,texture:"ad/Btn_Ad.png",name:"videoTag",height:15},compId:50}]},{type:"Box",props:{y:34,x:384,width:116,var:"lockBox3",renderType:"render",mouseEnabled:!0,height:161},compId:46,child:[{type:"Image",props:{y:0,x:0,skin:"ad/Ui_MaskShangZhen2.png",name:"cover"},compId:47},{type:"Image",props:{y:99,x:4,skin:"ad/Btn_ForeverUnlock.png",name:"unlockBtn"},compId:48},{type:"Sprite",props:{y:142,x:9,width:20,texture:"ad/Btn_Ad.png",name:"videoTag",height:15},compId:51}]}]}]}],loadList:["handBook/Btn_Go.png","main/Ui_RedPoint.png","handBook/Ui_FrameTeam.png","ad/Ui_MaskShangZhen2.png","ad/Btn_ForeverUnlock.png","ad/Btn_Ad.png"],loadList3D:[]},t.groupUI=U,l("ui.pages.groupUI",U);class R extends r{constructor(){super()}createChildren(){super.createChildren(),this.createView(R.uiView)}}R.uiView={type:"Dialog",props:{width:720,height:1280},compId:2,child:[{type:"Image",props:{var:"talkBg",skin:"changeAdd1/Ui_FrameTalk.png",centerX:0,bottom:10},compId:4,child:[{type:"Label",props:{y:39,x:172,wordWrap:!0,width:813,var:"talkLabel",scaleY:.6,scaleX:.6,overflow:"hidden",height:173,fontSize:60,font:"Num1"},compId:5}]},{type:"Box",props:{var:"contentBox",top:0,right:0,left:0,bottom:0},compId:8},{type:"Box",props:{y:0,x:0,width:113,var:"hand",scaleY:1,scaleX:1,height:122},compId:7,child:[{type:"Sprite",props:{y:0,x:0,texture:"changeAdd1/Ui_Hand.png"},compId:6}]}],animations:[{nodes:[{target:6,keyframes:{y:[{value:0,tweenMethod:"linearNone",tween:!0,target:6,key:"y",index:0}],x:[{value:0,tweenMethod:"linearNone",tween:!0,target:6,key:"x",index:0}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:0}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:0}]}}],name:"handStand",id:1,frameRate:60,action:0},{nodes:[{target:6,keyframes:{y:[{value:0,tweenMethod:"linearNone",tween:!0,target:6,key:"y",index:0},{value:50,tweenMethod:"linearNone",tween:!0,target:6,key:"y",index:30}],x:[{value:0,tweenMethod:"linearNone",tween:!0,target:6,key:"x",index:0},{value:50,tweenMethod:"linearNone",tween:!0,target:6,key:"x",index:30}],scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:0},{value:1.3,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:30}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:0},{value:1.3,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:30}]}}],name:"handClick",id:2,frameRate:60,action:0}],loadList:["changeAdd1/Ui_FrameTalk.png","changeAdd1/Ui_Hand.png"],loadList3D:[]},t.guideUI=R,l("ui.pages.guideUI",R);class E extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(E.uiView)}}E.uiView={type:"Scene",props:{width:720,runtime:"uilogic/HandBookRuntime.ts",height:1280,autoDestroyAtClosed:!0},compId:2,child:[{type:"Box",props:{width:720,var:"topBox",top:0,height:1},compId:4,child:[{type:"List",props:{y:200,x:0,var:"monsterList",repeatY:1,repeatX:1,elasticEnabled:!0},compId:25,child:[{type:"cardPage",props:{renderType:"render",runtime:"uilogic/CardPageRuntime.ts"},compId:26}]},{type:"Sprite",props:{y:397,x:45,width:75,var:"leftBtn",texture:"main/Btn_Arrow.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:47,pivotX:38,height:93},compId:8},{type:"Sprite",props:{y:397,x:675,width:75,var:"rightBtn",texture:"main/Btn_Arrow.png",scaleX:-1,runtime:"gframe-work/effect/ButtonScale.ts",pivotY:47,pivotX:38,height:93},compId:9},{type:"Image",props:{y:656,skin:"handBook/Ui_BookPage1.png",centerX:0},compId:13,child:[{type:"Sprite",props:{x:0,var:"pagePoint",texture:"handBook/Ui_BookPage2.png"},compId:14}]},{type:"Sprite",props:{y:139,x:265,width:190,texture:"handBook/Ui_BookTittle.png",height:48},compId:18,child:[{type:"Label",props:{var:"pageLabel",text:"0/0",scaleY:.8,scaleX:.8,fontSize:60,font:"Num1",color:"#ffffff",centerY:-5,centerX:0},compId:19}]},{type:"Sprite",props:{y:80,x:62,width:64,var:"closeBtn",texture:"main/Btn_Back.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:31,pivotX:32,height:61},compId:28}]},{type:"Box",props:{x:0,width:720,var:"middleBox",height:1,centerY:0},compId:5},{type:"Box",props:{width:720,var:"downBox",height:1,bottom:0},compId:10,child:[{type:"Sprite",props:{y:-580,x:39,width:641,texture:"handBook/Ui_FrameBook.png",height:245},compId:11,child:[{type:"Sprite",props:{y:181,x:477,width:211,var:"receiveBtn",texture:"handBook/Btn_Get.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:42,pivotX:106,height:84},compId:17,child:[{type:"Sprite",props:{y:3,x:194,width:52,var:"receiveRed",texture:"main/Ui_RedPoint.png",scaleY:.5,scaleX:.5,pivotY:26,pivotX:26,height:52},compId:27}]},{type:"Label",props:{y:118,x:141,var:"receiveLabel",text:"0/0",scaleY:.8,scaleX:.8,fontSize:60,font:"Num1",color:"#ffffff"},compId:20},{type:"Label",props:{y:20,var:"rewardTargetLabel",text:"0",scaleY:.8,scaleX:.8,fontSize:60,font:"Num1",color:"#ffffff",centerX:115},compId:21},{type:"Label",props:{y:77,var:"rewardMoneyLabel",text:"0",scaleY:.8,scaleX:.8,fontSize:60,font:"Num1",color:"#ffffff",centerX:176},compId:22},{type:"Sprite",props:{y:85,x:399,texture:"main/Ui_Money.png"},compId:24}]}]}],loadList:["main/Btn_Arrow.png","handBook/Ui_BookPage1.png","handBook/Ui_BookPage2.png","handBook/Ui_BookTittle.png","main/Btn_Back.png","handBook/Ui_FrameBook.png","handBook/Btn_Get.png","main/Ui_RedPoint.png","main/Ui_Money.png"],loadList3D:[]},t.handBookUI=E,l("ui.pages.handBookUI",E);class O extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/handBookDetail")}}t.handBookDetailUI=O,l("ui.pages.handBookDetailUI",O);class F extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/helpPack")}}t.helpPackUI=F,l("ui.pages.helpPackUI",F);class A extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(A.uiView)}}A.uiView={type:"Scene",props:{width:185,runtime:"uilogic/LevelCellRuntime.ts",height:94},compId:2,child:[{type:"Image",props:{var:"bg",skin:"newSystem/Ui_Guan2.png",centerY:0,centerX:0},compId:3},{type:"Label",props:{y:57,var:"rewardLabel1",text:"X2",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1",color:"#ffffff",centerX:-10},compId:7},{type:"Label",props:{y:3,var:"levelLabel",text:"1-1",scaleY:.45,scaleX:.45,fontSize:60,font:"Num1",color:"#ffffff",centerX:-3},compId:9},{type:"Image",props:{y:61,x:148,width:17,var:"rewardIcon2",skin:"main/Ui_Money.png",height:21,anchorY:.5,anchorX:.5},compId:10},{type:"Image",props:{y:70,x:51,width:20,var:"rewardIcon1",skin:"newSystem/Ui_Badge.png",height:20,anchorY:.5,anchorX:.5},compId:15},{type:"Label",props:{y:72,var:"rewardLabel2",text:"X200",scaleY:.2,scaleX:.2,fontSize:60,font:"Num1",color:"#ffffff",centerX:55},compId:11},{type:"Image",props:{var:"curLight",skin:"newSystem/Btn_GuanSelect.png",centerY:0,centerX:0},compId:12},{type:"Image",props:{y:7,x:32,var:"cover",skin:"newSystem/Ui_Guan4.png",centerY:0,centerX:0},compId:4}],loadList:["newSystem/Ui_Guan2.png","main/Ui_Money.png","newSystem/Ui_Badge.png","newSystem/Btn_GuanSelect.png","newSystem/Ui_Guan4.png"],loadList3D:[]},t.levelCellUI=A,l("ui.pages.levelCellUI",A);class N extends o{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/load")}}t.loadUI=N,l("ui.pages.loadUI",N);class V extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/lottery")}}t.lotteryUI=V,l("ui.pages.lotteryUI",V);class X extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(X.uiView)}}X.uiView={type:"Scene",props:{width:183,height:177},compId:2,child:[{type:"Sprite",props:{y:6,x:0,var:"normalBg",texture:"sign/Ui_FrameZhuan2.png"},compId:3},{type:"Sprite",props:{var:"lightBg",texture:"sign/Ui_FrameZhuan3.png"},compId:4},{type:"Image",props:{y:64,x:91,var:"rewardImage",skin:"monster/Ui_Monster10.png",scaleY:.5,scaleX:.5,anchorY:.5,anchorX:.5},compId:5},{type:"Label",props:{y:118,var:"goldLabel",text:"X200",scaleY:.5,scaleX:.5,fontSize:60,font:"Num1",color:"#ffffff",centerX:0},compId:10}],loadList:["sign/Ui_FrameZhuan2.png","sign/Ui_FrameZhuan3.png","monster/Ui_Monster10.png"],loadList3D:[]},t.lotteryCellUI=X,l("ui.pages.lotteryCellUI",X);class G extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/luckyPack")}}t.luckyPackUI=G,l("ui.pages.luckyPackUI",G);class H extends o{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/main")}}t.mainUI=H,l("ui.pages.mainUI",H);class Y extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(Y.uiView)}}Y.uiView={type:"Scene",props:{width:720,runtime:"uilogic/MapRuntime.ts",height:720},compId:2,child:[{type:"Image",props:{y:50,x:110,var:"mapImg",skin:"mapImage/Ui_Guan1.png"},compId:3,child:[{type:"SkeletonPlayer",props:{y:310,x:250,var:"eliteFrog",url:"spine/yan.sk",runtime:"Laya.Skeleton"},compId:7}]},{type:"Sprite",props:{y:126,x:260,var:"passImage",texture:"main/Ui_Pass.png"},compId:5},{type:"Sprite",props:{y:284,x:241,var:"lockImage",texture:"main/Ui_Lock.png"},compId:4}],animations:[{nodes:[{target:3,keyframes:{y:[{value:113,tweenMethod:"sineOut",tween:!0,target:3,key:"y",index:0},{value:135,tweenMethod:"sineIn",tween:!0,target:3,key:"y",index:40},{value:113,tweenMethod:"sineOut",tween:!0,target:3,key:"y",index:80},{value:91,tweenMethod:"sineIn",tween:!0,target:3,key:"y",index:120},{value:113,tweenMethod:"linearNone",tween:!0,target:3,key:"y",index:160}]}}],name:"ani1",id:1,frameRate:60,action:2}],loadList:["mapImage/Ui_Guan1.png","spine/yan.sk","main/Ui_Pass.png","main/Ui_Lock.png"],loadList3D:[]},t.mapUI=Y,l("ui.pages.mapUI",Y);class z extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(z.uiView)}}z.uiView={type:"Scene",props:{width:720,runtime:"uilogic/MapCellRuntime.ts",height:600},compId:2,child:[{type:"Image",props:{var:"bg",skin:"newSystem/Ui_Map1.png",centerY:0,centerX:0},compId:3},{type:"Image",props:{y:247,x:305,var:"mapNameImage",skin:"newSystem/Ui_FrameDaoGuan.png"},compId:5,child:[{type:"Sprite",props:{y:-122,x:-54,width:201,var:"curLevelBg",texture:"newSystem/Ui_FrameGuan.png",pivotY:0,pivotX:0,height:122},compId:6,child:[{type:"Label",props:{y:44,var:"levelLabel",text:"1-1",scaleY:.45,scaleX:.45,fontSize:60,font:"Num1",color:"#ffffff",centerX:0},compId:7}]},{type:"Image",props:{y:8,x:9,var:"mapIcon",skin:"newSystem/Ui_DaoGuan1.png"},compId:8}]}],loadList:["newSystem/Ui_Map1.png","newSystem/Ui_FrameDaoGuan.png","newSystem/Ui_FrameGuan.png","newSystem/Ui_DaoGuan1.png"],loadList3D:[]},t.mapCellUI=z,l("ui.pages.mapCellUI",z);class j extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(j.uiView)}}j.uiView={type:"Scene",props:{width:229,runtime:"uilogic/MoneyUiRuntime.ts",height:48},compId:2,child:[{type:"Image",props:{y:5,x:51,width:178,var:"moneyBg",skin:"main/Ui_FrameMoney2.png",height:40},compId:3,child:[{type:"Sprite",props:{y:19,x:-27,width:48,var:"addMoneyBtn",texture:"main/Btn_Plus.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:24,pivotX:24,height:48},compId:4},{type:"Label",props:{y:-5,var:"moneyLabel",text:"0",scaleY:.7,scaleX:.7,fontSize:60,font:"Num1",color:"#ffffff",centerX:9},compId:5},{type:"Image",props:{y:19,x:27,var:"moneyIcon",skin:"pay/Ui_Diamond.png",anchorY:.5,anchorX:.5},compId:6}]}],animations:[{nodes:[{target:6,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:0},{value:1.3,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleY",index:6}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:0},{value:1.3,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:6,key:"scaleX",index:6}]}}],name:"moneyPop",id:1,frameRate:24,action:0}],loadList:["main/Ui_FrameMoney2.png","main/Btn_Plus.png","pay/Ui_Diamond.png"],loadList3D:[]},t.moneyUiUI=j,l("ui.pages.moneyUiUI",j);class W extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/neverGiveUp")}}t.neverGiveUpUI=W,l("ui.pages.neverGiveUpUI",W);class q extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/pause")}}t.pauseUI=q,l("ui.pages.pauseUI",q);class K extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(K.uiView)}}K.uiView={type:"Scene",props:{width:720,runtime:"uilogic/PkRuntime.ts",height:1280},compId:2,child:[{type:"Image",props:{y:230,x:34,width:651,var:"pvpBg",skin:"pvp/Ui_FrameFight2.png",height:620},compId:6},{type:"Sprite",props:{y:116,x:6,width:707,texture:"pvp/Ui_TittleFight.png",height:246},compId:4,child:[{type:"Image",props:{y:56,x:146,width:151,var:"rankBtn",skin:"pvp/Btn_FightRank2.png",pivotY:25,pivotX:76,height:50},compId:12},{type:"Image",props:{y:59,x:563,width:151,var:"divisionBtn",skin:"pvp/Btn_Fightgift2.png",pivotY:25,pivotX:76,height:50},compId:13}]},{type:"Box",props:{width:720,var:"downBox",height:1,bottom:0},compId:11,child:[{type:"Sprite",props:{y:-373,x:360,width:252,var:"matchBtn",texture:"pvp/Btn_Fight.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:48,pivotX:126,height:95},compId:7},{type:"Sprite",props:{y:-373,x:596,width:139,var:"goShopBtn",texture:"pvp/Btn_GoShop.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:35,pivotX:70,height:70},compId:8}]},{type:"Box",props:{y:230,x:34,width:651,var:"rewardBox",height:620},compId:43,child:[{type:"Sprite",props:{y:59,x:49,texture:"pvp/Ui_FrameRank5.png"},compId:33},{type:"divisionIcon",props:{y:67,x:150,var:"curDivisionIcon",scaleY:.5,scaleX:.5,runtime:"uilogic/DivisionIconRuntime.ts"},compId:34},{type:"divisionIcon",props:{y:66,x:510,var:"nextDivisionIcon",scaleY:.5,scaleX:.5,runtime:"uilogic/DivisionIconRuntime.ts"},compId:35},{type:"Sprite",props:{y:89,x:247,width:260,var:"divisionProgressBg",texture:"pvp/Ui_RankTiao2.png",height:29},compId:36,child:[{type:"Image",props:{y:-2,x:4,width:250,var:"divisionProgress",skin:"pvp/Ui_RankTiao1.png",height:23,sizeGrid:"0,8,0,8"},compId:37},{type:"Label",props:{y:-36,x:130,var:"winTimeLabel",text:"1/1",scaleY:.5,scaleX:.5,fontSize:60,font:"Num1"},compId:39}]},{type:"List",props:{y:160,x:51,width:550,var:"rankRewardList",spaceY:38,height:410,elasticEnabled:!0},compId:40,child:[{type:"PvpRankRewardCell",props:{renderType:"render",runtime:"uilogic/PvpRankRewardCellRuntime.ts"},compId:41}]}]},{type:"Box",props:{y:230,x:34,width:651,var:"rankBox",height:620},compId:44,child:[{type:"Sprite",props:{y:536,x:94,width:500,texture:"pvp/Ui_RankGiftTiao1.png",height:20},compId:14,child:[{type:"Image",props:{y:0,x:0,width:500,var:"dayWinprogress",skin:"pvp/Ui_RankGiftTiao2.png",height:20},compId:16},{type:"rewardBox",props:{y:-11,x:20,var:"box1",runtime:"ui.pages.rewardBoxUI"},compId:19},{type:"rewardBox",props:{y:-11,x:108,var:"box2",runtime:"ui.pages.rewardBoxUI"},compId:20},{type:"rewardBox",props:{y:-11,x:233,var:"box3",runtime:"ui.pages.rewardBoxUI"},compId:21},{type:"rewardBox",props:{y:-11,x:359,var:"box4",runtime:"ui.pages.rewardBoxUI"},compId:22},{type:"rewardBox",props:{y:-11,x:484,var:"box5",runtime:"ui.pages.rewardBoxUI"},compId:23}]},{type:"Sprite",props:{y:40,x:590,var:"upTag",texture:"pvp/Btn_Up.png"},compId:24},{type:"List",props:{y:55,x:51,width:550,var:"_list",spaceY:-15,height:425,elasticEnabled:!0},compId:53,child:[{type:"pvpRankCell",props:{renderType:"render",runtime:"uilogic/PvpRankCellRuntime.ts"},compId:54}]}]},{type:"WXOpenDataViewer",props:{width:720,var:"wxOpenDataViewer",iconSign:"wx",height:1280,runtime:"laya.ui.WXOpenDataViewer"},compId:55}],loadList:["pvp/Ui_FrameFight2.png","pvp/Ui_TittleFight.png","pvp/Btn_FightRank2.png","pvp/Btn_Fightgift2.png","pvp/Btn_Fight.png","pvp/Btn_GoShop.png","pvp/Ui_FrameRank5.png","pvp/Ui_RankTiao2.png","pvp/Ui_RankTiao1.png","pvp/Ui_RankGiftTiao1.png","pvp/Ui_RankGiftTiao2.png","pvp/Btn_Up.png"],loadList3D:[]},t.pkUI=K,l("ui.pages.pkUI",K);class $ extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/pvpCount")}}t.pvpCountUI=$,l("ui.pages.pvpCountUI",$);class Q extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(Q.uiView)}}Q.uiView={type:"Scene",props:{width:560,height:475},compId:2,child:[{type:"Sprite",props:{y:39,x:11,texture:"pvp/Ui_FrameRank6.png"},compId:4},{type:"Image",props:{y:195,x:427,var:"monsterImage3",skin:"monster/Ui_Monster10.png",scaleY:.7,scaleX:.7,anchorY:.5,anchorX:.5},compId:16},{type:"Image",props:{y:207,x:284,var:"monsterImage2",skin:"monster/Ui_Monster17.png",scaleY:.7,scaleX:.7,anchorY:.5,anchorX:.5},compId:17},{type:"Image",props:{y:200,x:134,var:"monsterImage1",skin:"monster/Ui_Monster11.png",scaleY:.7,scaleX:.7,anchorY:.5,anchorX:.5},compId:18},{type:"Image",props:{y:0,x:0,var:"resultImage",skin:"pvp/Ui_RankWin.png"},compId:3},{type:"Image",props:{y:275,x:257,var:"sideImage",skin:"pvp/Ui_RankEnemy.png"},compId:6},{type:"divisionIcon",props:{y:360,x:230,var:"divisionIcon",scaleY:.5,scaleX:.5,runtime:"uilogic/DivisionIconRuntime.ts"},compId:8},{type:"Sprite",props:{y:381,x:147,width:260,var:"divisionProgressBg",texture:"pvp/Ui_RankTiao2.png",height:29},compId:11,child:[{type:"Image",props:{y:-2,x:4,width:250,var:"divisionProgress",skin:"pvp/Ui_RankTiao1.png",height:23,sizeGrid:"0,8,0,8"},compId:15},{type:"Label",props:{y:-38,x:62,var:"winLabel",text:"胜场：",scaleY:.5,scaleX:.5,fontSize:60,font:"Num1"},compId:21},{type:"Label",props:{y:-37,x:135,var:"winTimeLabel",text:"1/1",scaleY:.5,scaleX:.5,fontSize:60,font:"Num1"},compId:20}]},{type:"divisionIcon",props:{y:360,x:50,var:"curDivisionIcon",scaleY:.5,scaleX:.5,runtime:"uilogic/DivisionIconRuntime.ts"},compId:13},{type:"divisionIcon",props:{y:360,x:410,var:"nextDivisionIcon",scaleY:.5,scaleX:.5,runtime:"uilogic/DivisionIconRuntime.ts"},compId:14}],loadList:["pvp/Ui_FrameRank6.png","monster/Ui_Monster10.png","monster/Ui_Monster17.png","monster/Ui_Monster11.png","pvp/Ui_RankWin.png","pvp/Ui_RankEnemy.png","pvp/Ui_RankTiao2.png","pvp/Ui_RankTiao1.png"],loadList3D:[]},t.pvpCountCellUI=Q,l("ui.pages.pvpCountCellUI",Q);class Z extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/pvpMatch")}}t.pvpMatchUI=Z,l("ui.pages.pvpMatchUI",Z);class J extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(J.uiView)}}J.uiView={type:"Scene",props:{width:561,runtime:"uilogic/PvpRankCellRuntime.ts",height:117},compId:2,child:[{type:"Image",props:{var:"bg",skin:"pvp/Ui_FrameRankMe.png",centerY:0,centerX:0},compId:4,child:[{type:"Image",props:{y:-15,var:"meTag",skin:"pvp/Ui_MyRank.png",left:-11},compId:6},{type:"Label",props:{y:42,x:41,var:"rankNumLabel",text:"1",scaleY:.5,scaleX:.5,fontSize:60,anchorY:.5,anchorX:.5},compId:10}]},{type:"divisionIcon",props:{y:41,x:134,var:"divisionIcon",scaleY:.2,scaleX:.2,runtime:"uilogic/DivisionIconRuntime.ts"},compId:7},{type:"Label",props:{y:45.5,x:371,var:"winLabel",text:"胜场：",scaleY:.4,scaleX:.4,fontSize:60},compId:8},{type:"Label",props:{y:42,x:189.5,var:"selfNameLabel",text:"我",scaleY:.5,scaleX:.5,fontSize:60},compId:9},{type:"Label",props:{y:46,x:431,var:"winTimeLabel",text:"1",scaleY:.4,scaleX:.4,fontSize:60},compId:11},{type:"Label",props:{y:41,x:189.5,var:"otherNameLabel",text:"123",scaleY:.5,scaleX:.5,fontSize:60,color:"#000000"},compId:12}],loadList:["pvp/Ui_FrameRankMe.png","pvp/Ui_MyRank.png"],loadList3D:[]},t.pvpRankCellUI=J,l("ui.pages.pvpRankCellUI",J);class tt extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(tt.uiView)}}tt.uiView={type:"Scene",props:{width:550,runtime:"uilogic/PvpRankRewardCellRuntime.ts",height:128},compId:2,child:[{type:"Sprite",props:{y:0,x:0,texture:"pvp/Ui_FrameRank4.png"},compId:3},{type:"divisionIcon",props:{y:42,x:106,var:"divisionIcon",scaleY:.45,scaleX:.45,runtime:"uilogic/DivisionIconRuntime.ts"},compId:5},{type:"Sprite",props:{y:106,x:268,var:"receiveBtn",texture:"pvp/Btn_RankGet1.png"},compId:6},{type:"Sprite",props:{y:106,x:441,var:"extraReceiveBtn",texture:"pvp/Btn_RankGet2.png"},compId:7,child:[{type:"Sprite",props:{y:31.5,x:5,width:12,var:"videoTag",texture:"main/Btn_Ad.png",height:9},compId:23}]},{type:"List",props:{y:35,x:247,var:"rewardList",spaceX:10,repeatX:2},compId:9,child:[{type:"Box",props:{width:58,renderType:"render",height:63},compId:10,child:[{type:"Sprite",props:{texture:"challengeRank/Ui_FrameRank5.png"},compId:11},{type:"Image",props:{y:26,x:29,skin:"newSystem/Ui_SuCai1003.png",scaleY:.5,scaleX:.5,name:"icon",anchorY:.5,anchorX:.5},compId:12},{type:"Label",props:{y:51,x:28,text:"X1",scaleY:.25,scaleX:.25,name:"label",fontSize:60,font:"Num1",anchorY:.5,anchorX:.5},compId:13}]}]},{type:"List",props:{y:35,x:411,var:"extraRewardList",spaceX:10,repeatX:2},compId:14,child:[{type:"Box",props:{width:58,renderType:"render",height:63},compId:15,child:[{type:"Sprite",props:{texture:"challengeRank/Ui_FrameRank5.png"},compId:16},{type:"Image",props:{y:26,x:29,skin:"newSystem/Ui_SuCai1004.png",scaleY:.5,scaleX:.5,name:"icon",anchorY:.5,anchorX:.5},compId:17},{type:"Label",props:{y:51,x:28,text:"X1",scaleY:.25,scaleX:.25,name:"label",fontSize:60,font:"Num1",anchorY:.5,anchorX:.5},compId:18}]}]}],loadList:["pvp/Ui_FrameRank4.png","pvp/Btn_RankGet1.png","pvp/Btn_RankGet2.png","main/Btn_Ad.png","challengeRank/Ui_FrameRank5.png","newSystem/Ui_SuCai1003.png","newSystem/Ui_SuCai1004.png"],loadList3D:[]},t.PvpRankRewardCellUI=tt,l("ui.pages.PvpRankRewardCellUI",tt);class et extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(et.uiView)}}et.uiView={type:"Scene",props:{width:720,runtime:"uilogic/QteRuntime.ts",height:1280},compId:2,child:[{type:"Box",props:{y:0,x:0,var:"maskBox"},compId:20},{type:"Box",props:{width:720,var:"middleBox",height:1,centerY:0},compId:4,child:[{type:"Sprite",props:{y:248,x:111,width:500,texture:"qte/Ui_Time1.png",height:66},compId:5,child:[{type:"Image",props:{y:36,x:0,var:"progressBar",skin:"qte/Ui_Time2.png",sizeGrid:"0,10,0,10"},compId:6}]},{type:"Box",props:{x:160,width:400,var:"numBox",height:400,centerY:-100},compId:11,child:[{type:"Image",props:{var:"num1",top:0,skin:"qte/Ui_White1.png",left:0},compId:7},{type:"Image",props:{var:"num2",top:0,skin:"qte/Ui_White2.png",right:0},compId:8},{type:"Image",props:{var:"num3",skin:"qte/Ui_White3.png",left:0,bottom:0},compId:9},{type:"Image",props:{var:"num4",skin:"qte/Ui_White4.png",right:0,bottom:0},compId:10},{type:"Sprite",props:{y:-212,x:57,texture:"qte/Ui_QteWord.png"},compId:12}]},{type:"Box",props:{y:-355,x:0,width:720,var:"rollBox",height:500},compId:13,child:[{type:"Sprite",props:{y:7,x:120,texture:"qte/Ui_QteZhuan3.png"},compId:15,child:[{type:"Image",props:{y:244,x:238,width:356,var:"rollBg",skin:"qte/Ui_QteZhuan1.png",scaleX:1,rotation:0,pivotY:178,pivotX:178,height:356},compId:16},{type:"Sprite",props:{y:176,x:174,width:132,texture:"qte/Ui_QteZhuan2.png",height:132},compId:18,child:[{type:"Label",props:{var:"rollLeftLabel",text:"1",scaleY:1,scaleX:1,rotation:0,fontSize:60,font:"Num1",color:"#ffffff",centerY:0,centerX:0},compId:19}]}]},{type:"Sprite",props:{y:-156,x:253,texture:"qte/Ui_QteWord2.png"},compId:17}]}]}],loadList:["qte/Ui_Time1.png","qte/Ui_Time2.png","qte/Ui_White1.png","qte/Ui_White2.png","qte/Ui_White3.png","qte/Ui_White4.png","qte/Ui_QteWord.png","qte/Ui_QteZhuan3.png","qte/Ui_QteZhuan1.png","qte/Ui_QteZhuan2.png","qte/Ui_QteWord2.png"],loadList3D:[]},t.qteUI=et,l("ui.pages.qteUI",et);class it extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/quickClickTreasure")}}t.quickClickTreasureUI=it,l("ui.pages.quickClickTreasureUI",it);class st extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(st.uiView)}}st.uiView={type:"Scene",props:{y:0,x:19,width:37,pivotX:19,height:35},compId:2,child:[{type:"Sprite",props:{y:0,x:0,width:37,texture:"pvp/Ui_RankGift.png",height:35},compId:3},{type:"Sprite",props:{y:-11.5,x:19.5,width:26,var:"redPoint",texture:"main/Ui_RedPoint.png",height:26},compId:5},{type:"Label",props:{y:35,var:"boxIndexLabel",text:"1",scaleY:.38,scaleX:.38,fontSize:60,font:"Num1",centerX:-1},compId:6}],loadList:["pvp/Ui_RankGift.png","main/Ui_RedPoint.png"],loadList3D:[]},t.rewardBoxUI=st,l("ui.pages.rewardBoxUI",st);class at extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(at.uiView)}}at.uiView={type:"Scene",props:{width:720,runtime:"uilogic/SearchMapRuntime.ts",height:1280,autoDestroyAtClosed:!0},compId:2,child:[{type:"Box",props:{width:720,top:0,height:1},compId:3,child:[{type:"Sprite",props:{y:70,x:40,width:64,var:"backBtn",texture:"play/Btn_Stop.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:31,pivotX:32,height:61},compId:10},{type:"Image",props:{y:113,x:308,var:"pictureBg",skin:"play/Ui_Picture.png"},compId:20,child:[{type:"Sprite",props:{y:114,x:-22,texture:"play/Ui_PictureWord.png"},compId:21},{type:"Label",props:{y:109,x:43,var:"pictureLabel",text:"0",scaleY:.6,scaleX:.6,fontSize:60,font:"Num1",color:"#ffffff"},compId:22}]},{type:"Box",props:{y:124,x:8,width:230,var:"smallMapBox",height:155},compId:53,child:[{type:"Panel",props:{y:7,x:4,width:222,var:"smallMapPanel",height:140},compId:26,child:[{type:"Image",props:{y:1,x:0,var:"smallMap",skin:"smallMap/Map1.png"},compId:27},{type:"Sprite",props:{y:1,x:0,width:24,var:"rolePointer",texture:"smallMap/Ui_TipMe.png",pivotY:15,pivotX:12,height:30},compId:29},{type:"Sprite",props:{y:29,x:78,width:26,var:"pointerBg",texture:"smallMap/Ui_Tip4.png",pivotY:13,pivotX:13,height:26},compId:31,child:[{type:"Sprite",props:{y:13,x:15,width:9,var:"pointer",texture:"smallMap/Ui_Tip3.png",rotation:-146,pivotY:6,pivotX:-15,height:12},compId:32}]},{type:"Sprite",props:{y:29,x:78,width:26,var:"bossPointerBg",texture:"smallMap/Ui_Tip1.png",pivotY:13,pivotX:13,height:26},compId:33,child:[{type:"Sprite",props:{y:13,x:15,width:9,var:"bossPointer",texture:"smallMap/Ui_Tip2.png",rotation:-196,pivotY:6,pivotX:-15,height:12},compId:34}]},{type:"Sprite",props:{y:29,x:78,width:26,var:"treasurePointerBg",texture:"play/Ui_PictureTip5.png",pivotY:13,pivotX:13,height:26},compId:35,child:[{type:"Sprite",props:{y:13,x:15,width:9,var:"treasurePointer",texture:"smallMap/Ui_Tip2.png",rotation:-196,pivotY:6,pivotX:-15,height:12},compId:36}]}]},{type:"Sprite",props:{y:0,x:0,texture:"smallMap/Ui_TipFrame.png"},compId:30}]},{type:"Sprite",props:{y:340,x:-760,texture:"changeAdd1/Ui_Warmming1.png"},compId:38},{type:"Sprite",props:{y:361,x:946,texture:"changeAdd1/Ui_Warmming2.png"},compId:40},{type:"Sprite",props:{y:448,x:166,texture:"changeAdd1/Ui_Warmming3.png",alpha:0},compId:41},{type:"Sprite",props:{y:397,x:50,width:70,var:"taskBtn",texture:"main/Btn_Task.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:36,pivotX:35,height:71},compId:48,child:[{type:"Sprite",props:{y:5,x:69,width:52,var:"taskRed",texture:"main/Ui_RedPoint.png",scaleY:.5,scaleX:.5,pivotY:26,pivotX:26,height:52},compId:49}]}]},{type:"Box",props:{x:0,width:720,height:1,bottom:0},compId:5,child:[{type:"Image",props:{y:-351,x:34,var:"smallBg",skin:"main/Ui_MiniHead.png"},compId:11,child:[{type:"Sprite",props:{y:-46,x:34,width:134,var:"oneCureBtn",texture:"main/Btn_Cure2.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:38,pivotX:67,height:76},compId:12,child:[{type:"Label",props:{y:29,x:60,var:"oneCureCostLabel",text:"0",scaleY:.5,scaleX:.5,fontSize:60,font:"Num1",color:"#ffffff"},compId:13}]},{type:"Sprite",props:{y:-130,x:34,width:134,var:"videoOneCureBtn",texture:"ad/Btn_CureAd2.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:38,pivotX:67,height:76},compId:55,child:[{type:"Sprite",props:{y:56,x:8,width:20,var:"videoTag",texture:"ad/Btn_Ad.png",height:15},compId:56}]},{type:"List",props:{y:20,x:8,var:"smallCardList",spaceY:4,repeatY:3,repeatX:1},compId:14,child:[{type:"Box",props:{y:0,x:0,width:55,renderType:"render",height:39},compId:15,child:[{type:"Sprite",props:{texture:"main/Ui_MiniHead2.png"},compId:16},{type:"Image",props:{width:55,skin:"monster/Ui_MonsterHead0.png",name:"monsterHead",height:40},compId:17}]}]},{type:"Sprite",props:{y:35,x:65,var:"openBtn",texture:"main/Ui_TeamTan.png"},compId:18}]},{type:"cureCell",props:{y:-435,x:0,var:"cureCell",runtime:"uilogic/CureCellRuntime.ts"},compId:19}]},{type:"Image",props:{y:1072,x:360,var:"joyStick",skin:"play/Ui_Quan2.png",anchorY:.5,anchorX:.5},compId:24},{type:"Image",props:{y:1073,x:360,var:"joyStickInner",skin:"play/Ui_Quan.png",anchorY:.5,anchorX:.5},compId:25},{type:"Box",props:{width:720,height:1,centerY:0},compId:45,child:[{type:"Sprite",props:{y:-267,x:656,width:98,var:"shopBtn",texture:"main/Btn_Shop.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:54,pivotX:49,height:108},compId:50,child:[{type:"Sprite",props:{y:-20,x:-13,var:"shopRed",texture:"main/Ui_RedPoint.png"},compId:51},{type:"Label",props:{y:108,var:"timeLabel",text:"00:00",scaleY:.5,scaleX:.5,fontSize:45,color:"#ffffff",centerX:0},compId:52}]}]}],animations:[{nodes:[{target:38,keyframes:{x:[{value:-760,tweenMethod:"sineOut",tween:!0,target:38,key:"x",index:0},{value:-20,tweenMethod:"linearNone",tween:!0,target:38,key:"x",index:30},{value:0,tweenMethod:"sineIn",tween:!0,target:38,key:"x",index:150},{value:720,tweenMethod:"linearNone",tween:!0,target:38,key:"x",index:180}]}},{target:40,keyframes:{x:[{value:946,tweenMethod:"sineOut",tween:!0,target:40,key:"x",index:0},{value:226,tweenMethod:"linearNone",tween:!0,target:40,key:"x",index:30},{value:206,tweenMethod:"sineIn",tween:!0,target:40,key:"x",index:150},{value:-494,tweenMethod:"linearNone",tween:!0,target:40,key:"x",index:180}]}},{target:41,keyframes:{alpha:[{value:0,tweenMethod:"sineOut",tween:!0,target:41,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:41,key:"alpha",index:30},{value:1,tweenMethod:"sineIn",tween:!0,target:41,key:"alpha",index:150},{value:0,tweenMethod:"linearNone",tween:!0,target:41,key:"alpha",index:180}]}}],name:"bossWarn",id:1,frameRate:60,action:0}],loadList:["play/Btn_Stop.png","play/Ui_Picture.png","play/Ui_PictureWord.png","smallMap/Map1.png","smallMap/Ui_TipMe.png","smallMap/Ui_Tip4.png","smallMap/Ui_Tip3.png","smallMap/Ui_Tip1.png","smallMap/Ui_Tip2.png","play/Ui_PictureTip5.png","smallMap/Ui_TipFrame.png","changeAdd1/Ui_Warmming1.png","changeAdd1/Ui_Warmming2.png","changeAdd1/Ui_Warmming3.png","main/Btn_Task.png","main/Ui_RedPoint.png","main/Ui_MiniHead.png","main/Btn_Cure2.png","ad/Btn_CureAd2.png","ad/Btn_Ad.png","main/Ui_MiniHead2.png","monster/Ui_MonsterHead0.png","main/Ui_TeamTan.png","play/Ui_Quan2.png","play/Ui_Quan.png","main/Btn_Shop.png"],loadList3D:[]},t.searchMapUI=at,l("ui.pages.searchMapUI",at);class nt extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/selectShareFriend")}}t.selectShareFriendUI=nt,l("ui.pages.selectShareFriendUI",nt);class ot extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/setting")}}t.settingUI=ot,l("ui.pages.settingUI",ot);class rt extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(rt.uiView)}}rt.uiView={type:"Scene",props:{width:195,runtime:"uilogic/ShopCellRuntime.ts",height:219},compId:2,child:[{type:"Sprite",props:{y:8,x:6,width:189,texture:"spriteShop/Ui_FrameShop1.png",height:211},compId:3,child:[{type:"Sprite",props:{y:132,x:41,texture:"spriteShop/Ui_FrameShop2.png"},compId:5},{type:"Image",props:{y:74,x:94,var:"itemImage",skin:"pay/Ui_Diamonds.png",anchorY:.5,anchorX:.5},compId:6},{type:"FontClip",props:{y:155,var:"itemMoneyNum",value:"1",text:"0",skin:"pay/Ui_WordRenMinBi.png",sheet:"0123456789￥",scaleY:.9,scaleX:.9,fontSize:60,font:"Num1",color:"#ffffff",centerX:0},compId:8,child:[{type:"Image",props:{y:19,var:"itemMoneyIcon",skin:"pay/Ui_Diamond.png",scaleY:.89,scaleX:.89,left:-35,anchorY:.5,anchorX:.5},compId:7}]},{type:"Sprite",props:{y:156,x:65,var:"freeTag",texture:"pay/Ui_Free.png",scaleY:.9,scaleX:.9},compId:28},{type:"Label",props:{y:129,x:89,var:"itemNameLabel",text:"0",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1",color:"#ffffff",centerX:0},compId:9},{type:"Image",props:{y:12,x:25,var:"starBg",skin:"main/Ui_FrameStarPurple(1).png"},compId:17,child:[{type:"Label",props:{var:"starLabel",text:"0",fontSize:14,color:"#ffffff",centerY:0,centerX:0,bold:!0},compId:18},{type:"Image",props:{y:7,x:0,var:"starIcon",skin:"newSystem/Ui_StarYellow.png",anchorY:.5,anchorX:.5},compId:19}]},{type:"Label",props:{y:10,x:47,var:"limitLabel",text:"每日限购：0/1",fontSize:15,color:"#a86816"},compId:29},{type:"Sprite",props:{var:"itemMask",texture:"spriteShop/Ui_MaskShop.png"},compId:10}]},{type:"Sprite",props:{y:0,x:0,width:98,var:"extraTag",texture:"pay/Ui_DepositExtra.png",height:41},compId:16,child:[{type:"Sprite",props:{y:11,x:17,texture:"pay/Ui_Add.png"},compId:27},{type:"FontClip",props:{y:10.5,x:50,var:"extraValue",value:"10%",skin:"pay/Ui_WordSale.png",sheet:"%0123456789",rotation:-9},compId:20}]}],loadList:["spriteShop/Ui_FrameShop1.png","spriteShop/Ui_FrameShop2.png","pay/Ui_Diamonds.png","pay/Ui_WordRenMinBi.png","pay/Ui_Diamond.png","pay/Ui_Free.png","main/Ui_FrameStarPurple(1).png","newSystem/Ui_StarYellow.png","spriteShop/Ui_MaskShop.png","pay/Ui_DepositExtra.png","pay/Ui_Add.png","pay/Ui_WordSale.png"],loadList3D:[]},t.shopCellUI=rt,l("ui.pages.shopCellUI",rt);class ht extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/sign")}}t.signUI=ht,l("ui.pages.signUI",ht);class lt extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(lt.uiView)}}lt.uiView={type:"Scene",props:{width:189,height:211},compId:2,child:[{type:"Image",props:{top:0,skin:"sign/Ui_FrameQian1.png",right:0,left:0,bottom:0,sizeGrid:"0,94,0,82"},compId:3},{type:"Label",props:{y:146,x:47,var:"goldLabel",text:"X200",scaleY:.75,scaleX:.75,rotation:0,height:60,fontSize:60,font:"Num1",color:"#ffffff",centerX:-1},compId:4},{type:"Image",props:{x:57,var:"rewardImage",skin:"count/Ui_TwoGold.png",scaleY:1,scaleX:1,centerY:-8,centerX:0},compId:6},{type:"Image",props:{y:8,x:38,skin:"sign/Ui_Day.png",centerX:0},compId:11,child:[{type:"Image",props:{y:8,x:29,var:"dayImage",skin:"sign/Ui_Day1.png"},compId:12}]},{type:"Image",props:{y:111,width:175,var:"monsterInfoBg",skin:"sign/Ui_FrameZhuan4.png",pivotY:0,pivotX:0,height:42,centerX:1},compId:14,child:[{type:"Label",props:{y:1,x:106,var:"hpLabel",text:"0",scaleY:.3,scaleX:.3,fontSize:60,font:"Num1",color:"#000000",bold:!0},compId:15},{type:"Label",props:{y:20,x:106,var:"atkLabel",text:"0",scaleY:.3,scaleX:.3,fontSize:60,font:"Num1",color:"#000000",bold:!0},compId:16},{type:"Label",props:{y:20,var:"starNumLabel",text:"0",scaleY:.3,scaleX:.3,fontSize:60,font:"Num1",color:"#000000",centerX:-65,bold:!0},compId:17}]},{type:"Image",props:{y:0,x:0,var:"maskImage",top:0,skin:"sign/Ui_FrameQian3.png",right:0,left:0,bottom:0,sizeGrid:"27,21,55,21"},compId:8,child:[{type:"Image",props:{skin:"sign/Ui_FrameQian4.png",centerY:0,centerX:0},compId:10}]},{type:"Sprite",props:{y:17,x:10,width:52,var:"redPoint",texture:"main/Ui_RedPoint.png",pivotY:26,pivotX:26,height:52},compId:13}],animations:[{nodes:[{target:13,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:13,key:"scaleY",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:13,key:"scaleY",index:20},{value:1,tweenMethod:"linearNone",tween:!0,target:13,key:"scaleY",index:40}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:13,key:"scaleX",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:13,key:"scaleX",index:20},{value:1,tweenMethod:"linearNone",tween:!0,target:13,key:"scaleX",index:40}]}}],name:"ani1",id:1,frameRate:60,action:0}],loadList:["sign/Ui_FrameQian1.png","count/Ui_TwoGold.png","sign/Ui_Day.png","sign/Ui_Day1.png","sign/Ui_FrameZhuan4.png","sign/Ui_FrameQian3.png","sign/Ui_FrameQian4.png","main/Ui_RedPoint.png"],loadList3D:[]},t.signCellUI=lt,l("ui.pages.signCellUI",lt);class ct extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(ct.uiView)}}ct.uiView={type:"Scene",props:{width:720,runtime:"uilogic/SpriteShopRuntime.ts",height:1280},compId:2,child:[{type:"Box",props:{width:720,var:"upBox",top:0,height:1},compId:14,child:[{type:"Sprite",props:{y:140,x:80,texture:"spriteShop/Ui_ShopTittle.png"},compId:4},{type:"Sprite",props:{y:80,x:62,width:64,var:"closeBtn",texture:"main/Btn_Back.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:31,pivotX:32,height:61},compId:13},{type:"moneyUi",props:{y:140,x:481,var:"badgeMoneyUi",runtime:"uilogic/MoneyUiRuntime.ts"},compId:16},{type:"moneyUi",props:{y:192,x:481,var:"diamondMoneyUi",runtime:"uilogic/MoneyUiRuntime.ts"},compId:19}]},{type:"Box",props:{x:0,width:720,var:"middleBox",height:1,centerY:0},compId:15,child:[{type:"Sprite",props:{y:-334,x:25,texture:"spriteShop/Ui_FrameShop.png"},compId:5},{type:"List",props:{y:-391,x:40,var:"tabList",spaceX:16,repeatX:4},compId:7,child:[{type:"Box",props:{width:148,renderType:"render",height:78},compId:8,child:[{type:"Image",props:{skin:"spriteShop/Btn_Shop1.png",name:"tabBg"},compId:9},{type:"Image",props:{skin:"pay/Btn_Giftword1.png",name:"tabLabel",centerY:0,centerX:0},compId:10}]}]},{type:"List",props:{y:-292,x:67,var:"itemList",spaceY:4,spaceX:4,repeatY:3,repeatX:3,height:624,elasticEnabled:!0},compId:11,child:[{type:"shopCell",props:{renderType:"render",runtime:"uilogic/ShopCellRuntime.ts"},compId:12}]},{type:"Sprite",props:{y:385,x:184,var:"diamondByTips",texture:"pay/Ui_DepositTips.png"},compId:18}]}],loadList:["spriteShop/Ui_ShopTittle.png","main/Btn_Back.png","spriteShop/Ui_FrameShop.png","spriteShop/Btn_Shop1.png","pay/Btn_Giftword1.png","pay/Ui_DepositTips.png"],loadList3D:[]},t.spriteShopUI=ct,l("ui.pages.spriteShopUI",ct);class dt extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(dt.uiView)}}dt.uiView={type:"Scene",props:{width:720,runtime:"uilogic/StarRuntime.ts",height:1280},compId:2,child:[{type:"cardBag",props:{y:0,x:0,var:"cardBag",runtime:"uilogic/CardBagRuntime.ts"},compId:3},{type:"Box",props:{y:0,x:0,width:720,var:"topBox",top:0,height:1},compId:54,child:[{type:"moneyUi",props:{y:140,x:-43,var:"chipUi",runtime:"uilogic/MoneyUiRuntime.ts"},compId:53}]},{type:"Box",props:{y:0,x:0,width:720,var:"downBox",height:1,bottom:0},compId:6,child:[{type:"Image",props:{y:-638,x:12,width:695,var:"groupBg",skin:"newSystem/Ui_FrameStar.png",height:312},compId:9,child:[{type:"Box",props:{y:0,x:0,width:695,var:"infoBox",height:312},compId:39,child:[{type:"Sprite",props:{y:61,x:216,var:"iconBg",texture:"newSystem/Ui_FrameStar2.png"},compId:41},{type:"Label",props:{y:60,x:466,var:"beforeAtkLabel",text:"0",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1",color:"#ffffff"},compId:22},{type:"Label",props:{y:60,x:590,var:"afterAtkLabel",text:"0",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1",color:"#ffffff"},compId:23},{type:"Label",props:{y:104,x:225,var:"beforeStarLabel",text:"0",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1",color:"#ffffff",centerX:-117},compId:24},{type:"Label",props:{y:104,x:600,var:"afterStarLabel",text:"0",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1",color:"#ffffff",centerX:258},compId:25},{type:"Label",props:{y:60,x:240,var:"beforeHpLabel",text:"0",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1",color:"#ffffff"},compId:20},{type:"Label",props:{y:60,x:365,var:"afterHpLabel",text:"0",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1",color:"#ffffff"},compId:21},{type:"Image",props:{y:118,x:251,var:"beforeStarImage",skin:"newSystem/Ui_StarYellow.png",anchorY:.5,anchorX:.5},compId:28},{type:"Image",props:{y:118,x:626,var:"afterStarImage",skin:"newSystem/Ui_StarYellow.png",anchorY:.5,anchorX:.5},compId:29},{type:"Image",props:{y:106,x:275,width:310,var:"progressBg",skin:"newSystem/Ui_StarTiao1.png",height:24},compId:30,child:[{type:"Image",props:{y:2,x:7,width:297,var:"progressBar2",skin:"newSystem/Ui_StarTiao2.png",height:20},compId:32,child:[{type:"Image",props:{y:0,x:0,width:297,var:"progressMask2",renderType:"mask",height:20},compId:42,child:[{type:"Rect",props:{width:297,lineWidth:1,height:20,fillColor:"#ff0000"},compId:45}]}]},{type:"Image",props:{y:2,x:7,width:297,var:"progressBar1",skin:"newSystem/Ui_StarTiao3.png",height:20},compId:31,child:[{type:"Image",props:{y:0,x:0,width:297,var:"progressMask1",renderType:"mask",height:20},compId:43,child:[{type:"Rect",props:{width:297,lineWidth:1,height:20,fillColor:"#ff0000"},compId:46}]}]}]}]},{type:"Box",props:{y:94,x:36,width:139,var:"cardMainBox",height:149},compId:40,child:[{type:"card",props:{y:0,x:0,var:"cardMain",runtime:"uilogic/CardRuntime.ts"},compId:16}]},{type:"Box",props:{y:169,x:202,width:139,var:"cardBox1",scaleY:.6,scaleX:.6,height:149},compId:10,child:[{type:"card",props:{var:"card1",runtime:"uilogic/CardRuntime.ts"},compId:11}]},{type:"Box",props:{y:169,x:286,width:139,var:"cardBox2",scaleY:.6,scaleX:.6,height:149},compId:12,child:[{type:"card",props:{var:"card2",runtime:"uilogic/CardRuntime.ts"},compId:13}]},{type:"Box",props:{y:169,x:370,width:139,var:"cardBox3",scaleY:.6,scaleX:.6,height:149},compId:14,child:[{type:"card",props:{var:"card3",runtime:"uilogic/CardRuntime.ts"},compId:15}]},{type:"Sprite",props:{y:220,x:569,width:192,var:"upBtn",texture:"newSystem/Btn_Star.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:61,pivotX:96,height:122},compId:17,child:[{type:"Sprite",props:{y:44,x:26,texture:"newSystem/Ui_FrameStarMoney.png"},compId:18},{type:"Sprite",props:{y:69,x:27,texture:"newSystem/Ui_FrameStarChip.png"},compId:19},{type:"Label",props:{y:73,var:"chipCostLabel",text:"20",scaleY:.55,scaleX:.55,fontSize:60,font:"Num1",color:"#ffffff",centerX:15},compId:27},{type:"Label",props:{y:40,var:"moneyCostLabel",text:"20",scaleY:.55,scaleX:.55,fontSize:60,font:"Num1",color:"#ffffff",centerX:15},compId:26}]},{type:"Sprite",props:{y:277,x:331,width:113,var:"quickSelectBtn",texture:"newSystem/Btn_StarChoice.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:22,pivotX:57,height:43},compId:33},{type:"List",props:{y:161,x:202,var:"stateList",spaceX:0,repeatY:1,repeatX:3},compId:34,child:[{type:"Box",props:{y:0,x:0,width:84,renderType:"render",height:138},compId:35,child:[{type:"Image",props:{y:0,x:2,skin:"newSystem/Btn_Lack.png",name:"missTag"},compId:36},{type:"Image",props:{y:115,x:42.5,width:72,skin:"newSystem/Btn_StarGet.png",pivotY:21,pivotX:36,name:"getBtn",height:42},compId:37},{type:"Sprite",props:{y:122,x:10,width:15,texture:"ad/Btn_Ad.png",name:"videoTag",height:11},compId:55}]}]},{type:"Sprite",props:{y:266,x:38,var:"starTip",texture:"newSystem/Ui_StarChipTips.png"},compId:51}]}]}],loadList:["newSystem/Ui_FrameStar.png","newSystem/Ui_FrameStar2.png","newSystem/Ui_StarYellow.png","newSystem/Ui_StarTiao1.png","newSystem/Ui_StarTiao2.png","newSystem/Ui_StarTiao3.png","newSystem/Btn_Star.png","newSystem/Ui_FrameStarMoney.png","newSystem/Ui_FrameStarChip.png","newSystem/Btn_StarChoice.png","newSystem/Btn_Lack.png","newSystem/Btn_StarGet.png","ad/Btn_Ad.png","newSystem/Ui_StarChipTips.png"],loadList3D:[]},t.starUI=dt,l("ui.pages.starUI",dt);class pt extends h{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/start")}}t.startUI=pt,l("ui.pages.startUI",pt);class gt extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/succeed")}}t.succeedUI=gt,l("ui.pages.succeedUI",gt);class mt extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/superEggMachine")}}t.superEggMachineUI=mt,l("ui.pages.superEggMachineUI",mt);class ut extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/superEva")}}t.superEvaUI=ut,l("ui.pages.superEvaUI",ut);class yt extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/task")}}t.taskUI=yt,l("ui.pages.taskUI",yt);class ft extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(ft.uiView)}}ft.uiView={type:"Scene",props:{width:503,runtime:"uilogic/TaskCellRuntime.ts",height:127},compId:2,child:[{type:"Image",props:{var:"taskBg",skin:"sign/Ui_FrameTask1.png"},compId:3},{type:"Sprite",props:{y:78,x:428,width:116,var:"receiveBtn",texture:"sign/Btn_Get.png",runtime:"gframe-work/effect/ButtonScale.ts",pivotY:25,pivotX:58,height:49},compId:5},{type:"Sprite",props:{y:76.5,x:383.5,var:"running",texture:"sign/Ui_FrameTask2.png"},compId:6},{type:"Label",props:{y:80,var:"goldLabel",text:"X200",scaleY:.5,scaleX:.5,fontSize:60,font:"Num1",color:"#ffffff",centerX:-197},compId:7},{type:"Sprite",props:{y:33,x:26,texture:"count/Ui_TwoGold.png",scaleY:.8,scaleX:.8},compId:8},{type:"Label",props:{y:39.5,x:148,var:"descLabel",text:"收集10只妖怪",scaleY:.6,scaleX:.6,fontSize:60,font:"Num1",color:"#ffffff"},compId:9},{type:"Label",props:{y:83,x:148,var:"progressLabel",text:"0/1",scaleY:.5,scaleX:.5,fontSize:40,color:"#a56428",bold:!0},compId:10},{type:"Sprite",props:{y:23.5,x:393.5,var:"completeTag",texture:"sign/Ui_TaskComplete.png"},compId:11}],loadList:["sign/Ui_FrameTask1.png","sign/Btn_Get.png","sign/Ui_FrameTask2.png","count/Ui_TwoGold.png","sign/Ui_TaskComplete.png"],loadList3D:[]},t.taskCellUI=ft,l("ui.pages.taskCellUI",ft);class Lt extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/treasureBox")}}t.treasureBoxUI=Lt,l("ui.pages.treasureBoxUI",Lt);class vt extends h{constructor(){super()}createChildren(){super.createChildren(),this.createView(vt.uiView)}}vt.uiView={type:"Scene",props:{width:147,runtime:"uilogic/TryGameCellRuntime.ts",height:203},compId:2,child:[{type:"Sprite",props:{y:0,x:0,texture:"pay/Ui_FramePlayTry2.png"},compId:3},{type:"Sprite",props:{y:115,x:18,width:44,texture:"pay/Ui_FramePlayTry3.png",height:18},compId:5,child:[{type:"Label",props:{y:-5,x:66,var:"moneyLabel",text:"X500",scaleY:.4,scaleX:.4,fontSize:60,font:"Num1",color:"#ffffff"},compId:10},{type:"Image",props:{y:9,x:57,width:31,var:"moneyIcon",skin:"main/Ui_Money.png",scaleY:.5,scaleX:.5,height:39,anchorY:.5,anchorX:.5},compId:11}]},{type:"Image",props:{y:138,x:34,var:"operateBtn",skin:"pay/Btn_PlayGet.png"},compId:7},{type:"Image",props:{y:40,x:38,width:71,var:"gameIcon",height:71},compId:8},{type:"Label",props:{y:16,var:"gameName",text:"label",fontSize:22,centerX:0},compId:9}],loadList:["pay/Ui_FramePlayTry2.png","pay/Ui_FramePlayTry3.png","main/Ui_Money.png","pay/Btn_PlayGet.png"],loadList3D:[]},t.tryGameCellUI=vt,l("ui.pages.tryGameCellUI",vt);class Ct extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/tryGamePage")}}t.tryGamePageUI=Ct,l("ui.pages.tryGamePageUI",Ct);class It extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/videoAddBlood")}}t.videoAddBloodUI=It,l("ui.pages.videoAddBloodUI",It);class St extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("pages/videoConfirm")}}t.videoConfirmUI=St,l("ui.pages.videoConfirmUI",St)}(t.pages||(t.pages={}))}(i||(i={}));class c extends i.pages.addBadgeUI{onAwake(){this.goBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick)}onBtnClick(i){i.target==this.goBtn&&e.event(t.JumpToPage,3),this.close()}}class d{static init(){d.CUR_PLATFORM=d.BROWSER;let t=window.navigator.userAgent;-1==t.indexOf("OPPO")&&t.indexOf("MiniGame")>-1&&"wx"in window&&("tt"in window?d.CUR_PLATFORM=d.TT:"qq"in window?d.CUR_PLATFORM=d.QQ:d.CUR_PLATFORM=d.WX),t.indexOf("OPPO")>-1&&t.indexOf("MiniGame")>-1&&(d.CUR_PLATFORM=d.OPPO),t.indexOf("VVGame")>-1&&(d.CUR_PLATFORM=d.VIVO),console.log("当前小游戏运行平台",d.CUR_PLATFORM)}}d.CUR_PLATFORM=null,d.OPPO="OPPO",d.VIVO="VIVO",d.WX="WX",d.TT="TT",d.QQ="QQ",d.BROWSER="BROWSER";class p{constructor(){window.ResManager=p,p._resMap=new Map,d.CUR_PLATFORM==d.WX?(p._remote="https://demo.xxtch.com/Pokemon/res/wx/",p._resBasePath=wx.env.USER_DATA_PATH+"/cache/res/",p._fileSystemManager=wx.getFileSystemManager(),p._downloadFile=wx.downloadFile,p._loadSubpackage=wx.loadSubpackage,p._fileSystemManager.access({path:p._resBasePath,fail:()=>{p._fileSystemManager.mkdirSync(p._resBasePath,!0)}})):d.CUR_PLATFORM==d.QQ?(p._remote="https://h5game.99aly.com/5agamewx/alywx/swzb/qq/",p._resBasePath=qq.env.USER_DATA_PATH+"/cache/res/",p._fileSystemManager=qq.getFileSystemManager(),p._downloadFile=qq.downloadFile,p._loadSubpackage=qq.loadSubpackage,p._fileSystemManager.access({path:p._resBasePath,fail:()=>{p._fileSystemManager.mkdirSync(p._resBasePath,!0)}})):d.CUR_PLATFORM!=d.OPPO&&d.CUR_PLATFORM!=d.VIVO||(p._remote="https://cdn.xxtch.com/Fish/res/oppo/",p._resBasePath=qg.env.USER_DATA_PATH+"/cache/res/",p._fileSystemManager=qg.getFileSystemManager(),p._downloadFile=qg.downloadFile,p._loadSubpackage=qg.loadSubpackage,p._fileSystemManager.access({path:p._resBasePath,fail:()=>{p._fileSystemManager.mkdirSync(p._resBasePath,!0)}}))}static init(){return new Promise(t=>{if(null==p._instance){p._instance=new p;let e=Laya.LocalStorage.getItem("zipVersion");e&&(p._zipVersion=JSON.parse(e));let i="resconfig.json";if(d.CUR_PLATFORM==d.WX){i=`resconfig_${"wx"}_${"1.0"}.json`}else if(d.CUR_PLATFORM==d.QQ){let t="qq",e="1.0";i=p._remote+`resconfig_${t}_${e}.json`,i+="?ran="+1e6*Math.random()}else if(d.CUR_PLATFORM==d.OPPO){i=`resconfig_${"oppo"}_${"1.0"}.json`}else if(d.CUR_PLATFORM==d.VIVO){i=`resconfig_${"vivo"}_${"1.0"}.json`}p.initResMap(i).then(()=>{t()})}})}static initResMap(t){return new Promise(e=>{p._resMap&&p._resMap.clear(),Laya.loader.load(t,Laya.Handler.create(this,t=>{"string"==typeof t&&(t=JSON.parse(t));for(const e in t)if(t.hasOwnProperty(e))if("isBake"==e)p.isBake=t[e];else{let i=t[e],s=i[0];for(let t=0;t<s.length;t++){let a=s[t],n=a.split("/"),o=n[n.length-1];if("local"==i[1]||"sub"==i[1]){let t="res/"+e+"/"+a;d.CUR_PLATFORM==d.OPPO&&"sub"==i[1]&&(t=e+"/"+a),p._resMap.set(o,new g(o,e,i[1],t))}else{let t=p._resBasePath+a;p._resMap.set(o,new g(o,e+"_"+i[2],i[1],t))}}}console.log(p._resMap),e(null)}))})}static analyseResBundle(t){let e={subNames:[],zipNames:[]};for(let i=0;i<t.length;i++){let s=t[i],a=p._resMap.get(s);a?"sub"==a.location?-1==e.subNames.indexOf(a.bundleName)&&e.subNames.push(a.bundleName):"net"==a.location&&-1==e.zipNames.indexOf(a.bundleName)&&e.zipNames.push(a.bundleName):console.error(s)}return e}static getResInfo(t){return p._resMap.get(t)}static getRes(t){return p._resMap.get(t)||console.error(t),Laya.loader.getRes(p._resMap.get(t).url)}static getResClone(t){return p._resMap.get(t)&&Laya.loader.getRes(p._resMap.get(t).url)||console.error(t),Laya.loader.getRes(p._resMap.get(t).url).clone()}static download(t,e=null){return new Promise(i=>{let s=[],a=[];for(let e=0;e<t.length;e++){let i=t[e],n=p._resMap.get(i);if(n||console.error("找不到资源",i),"sub"==n.location)-1==s.indexOf(n.bundleName)&&-1==p._loadedSubNames.indexOf(n.bundleName)&&s.push(n.bundleName);else if("net"==n.location&&-1==a.indexOf(n.bundleName)){let t=n.bundleName.split("_")[0],e=n.bundleName.split("_")[1];p._zipVersion[t]!=e&&a.push(n.bundleName)}}console.log(s,a),p._loadSubpackages(s,e).then(()=>{p._downloadFiles(a,e).then(()=>{i()})})})}static create(t,e=null){return new Promise(i=>{p.download(t,e).then(()=>{let s=[];for(let e=0;e<t.length;e++)s.push(p._resMap.get(t[e]));p._createRes(s,s.length,e).then(()=>{i()})})})}static _createRes(t,e,i=null){return new Promise(s=>{if(t.length>0){let a=t.shift(),n=a.name.split(".")[0],o=(e-t.length-1)/e;i&&i({type:"create",progress:o,name:n}),Laya.loader.create(a.url,Laya.Handler.create(this,()=>{o=(e-t.length)/e,i&&i({type:"create",progress:o,name:n}),p._createRes(t,e,i).then(()=>{s()})}),Laya.Handler.create(this,t=>{i&&i({type:"create",progress:o,name:n})}))}else s()})}static loadSpines(t){return new Promise(e=>{let i=[];if(t&&t.length>0){let s=t.shift();p.download([s]).then(()=>{let a=new Laya.Skeleton;i.push(a),a.load(p._resMap.get(s).url,Laya.Handler.create(this,()=>{p.loadSpines(t).then(t=>{e(i.concat(t))})}))})}else e(i)})}static loadFonts(t){return new Promise(e=>{if(t&&t.length>0){let i=t.shift();p.download([i]).then(()=>{let s=new Laya.BitmapFont;s.loadFont(p._resMap.get(i).url,Laya.Handler.create(this,s=>{s.setSpaceWidth(10),s.autoScaleSize=!0,Laya.Text.registerBitmapFont(i.split(".")[0],s),p.loadFonts(t).then(()=>{e()})},[s]))})}else e()})}static playSound(t,e=1,i=null,s=null,a=0){p.download([t]).then(()=>{if(p.soundOpen)return Laya.SoundManager.playSound(p._resMap.get(t).url,e,i,s,a)})}static stopSound(t){Laya.SoundManager.stopSound(p._resMap.get(t).url)}static playMusic(t,e=0,i=null,s=0){this.lastMusicName=t,this.musicName=t,p.download([t]).then(()=>{if(p.musicOpen)return Laya.SoundManager.playMusic(p._resMap.get(t).url,e,i,s)})}static stopMusic(){this.lastMusicName=null,Laya.SoundManager.stopMusic()}static _loadSubpackages(t,e=null){return new Promise(i=>{if(t.length>0){let s=t.shift(),a=0;e&&e({type:"download",progress:a,location:"sub",name:s}),console.log("loadSubpackageStart"+s);let n={name:s,success:n=>{p._loadedSubNames.push(s),a=1,e&&e({type:"download",progress:a,location:"sub",name:s}),p._loadSubpackages(t,e).then(()=>{i()})},fail:t=>{console.log("loadSubpackageFail",JSON.stringify(t),s)}};console.log(n),p._loadSubpackage(n).onProgressUpdate(t=>{a=(a=t.progress>a?t.progress:a)<1?a:1,e&&e({type:"download",progress:a,location:"sub",name:s,totalBytesWritten:t.totalBytesWritten,totalBytesExpectedToWrite:t.totalBytesExpectedToWrite})})}else i()})}static _loadSubpackages1(t,e=null){return new Promise(i=>{if(t.length>0){let s=!1,a=t=>{s=!0;let i=0;console.log("loadSubpackageStart",t,p._loadSubpackage),e&&e({type:"download",progress:i,location:"sub",name:t}),p._loadSubpackage({name:t,success:a=>{p._loadedSubNames.push(t),i=1,e&&e({type:"download",progress:i,location:"sub",name:t}),s=!1},fail:e=>{console.log("loadSubpackageFail",JSON.stringify(e),t)}}).onProgressUpdate(s=>{i=(i=s.progress>i?s.progress:i)<1?i:1,e&&e({type:"download",progress:i,location:"sub",name:t,totalBytesWritten:s.totalBytesWritten,totalBytesExpectedToWrite:s.totalBytesExpectedToWrite})})},n=()=>{t.length>0?s||a(t.shift()):(Laya.timer.clear(this,n),i())};Laya.timer.frameLoop(1,this,n)}else i()})}static _downloadFiles(t,e=null){return new Promise(i=>{if(t.length>0){let s=t.shift(),a=s.split("_")[0],n=s.split("_")[1],o=0;e&&e({type:"download",progress:o,location:"net",name:a});let r=p._resBasePath+s+".zip";p._downloadFile({url:p._remote+s+".zip",filePath:r,success:s=>{200===s.statusCode&&p._fileSystemManager.unzip({zipFilePath:r,targetPath:p._resBasePath,success:s=>{p._zipVersion[a]=n,Laya.LocalStorage.setItem("zipVersion",JSON.stringify(p._zipVersion)),o=1,e&&e({type:"download",progress:o,location:"net",name:a}),p._fileSystemManager.unlink({filePath:r}),p._downloadFiles(t,e).then(()=>{i()})},fail:t=>{}})},fail:t=>{}}).onProgressUpdate(t=>{let i=t.progress/100;o=(o=i>o?i:o)<1?o:1,e&&e({type:"download",progress:o,location:"net",name:a})})}else i()})}static manualShare(){}}p._instance=null,p._fileSystemManager=null,p._resBasePath=null,p._downloadFile=null,p._loadSubpackage=null,p._remote="",p._resMap=null,p._loadedSubNames=[],p._zipVersion={},p.musicOpen=!0,p.soundOpen=!0,p.vibrateOpen=!0,p.isBake=!1,p.musicName="";class g{constructor(t,e,i,s){this._location=null,this._bundleName=null,this._url=null,this._name=null,this._name=t,this._location=i,this._bundleName=e,this._url=s}get location(){return this._location}get bundleName(){return this._bundleName}get url(){return this._url}get name(){return this._name}}class m extends Laya.Sprite{constructor(){super(),this.isReverse=!1,this.sign=1}onAwake(){this.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.sign=Math.sign(this.scaleX)}onMouseDown(t){Laya.Tween.to(this,{scaleX:.9*this.sign,scaleY:.9},50,Laya.Ease.sineOut)}onMouseUp(t){p.playSound("click.mp3"),Laya.Tween.to(this,{scaleX:1*this.sign,scaleY:1},50,Laya.Ease.sineIn)}onMouseOut(t){Laya.Tween.to(this,{scaleX:1*this.sign,scaleY:1},50,Laya.Ease.sineIn)}}class u{constructor(){}static init(){null==u._instance&&(u._instance=new u),window.NetManager=u._instance}static send(t,e,i,s){let a=new Laya.HttpRequest;return a.once(Laya.Event.COMPLETE,this,t=>{s&&s(JSON.parse(t))},a.data),a.once(Laya.Event.ERROR,this,t=>{console.error(t)}),a.send(t,i,e,"text"),console.log("send",t,i,e),a}}u._instance=null;class y{constructor(t=null){this.cardId=0,this.monsterId=-1,this.curHp=0,this.special=0,this.star=1,this.exp=0,this.atk=0,this.hp=0,t&&(this.cardId=t.cardId||0,this.monsterId=t.monsterId>=0?t.monsterId:-1,this.curHp=t.curHp||0,this.special=t.special||0,this.star=t.star||1,this.exp=t.exp||0,this.atk=t.atk||0,this.hp=t.hp||0)}}class f{static init(t){return"undefined"==typeof wx?Promise.reject("database:fail"):(this._db=wx.cloud.database({env:t}),Promise.resolve("database:ok"))}static add(t,e){return"undefined"==typeof wx?Promise.reject("collection.add:fail"):this._db.collection(t).add({data:e})}static get(t,e){return"undefined"==typeof wx?Promise.reject("collection.get:fail"):this._db.collection(t).where(e).get()}static update(t,e,i){return"undefined"==typeof wx?Promise.reject("collection.update:fail"):this._db.collection(t).doc(e).update({data:i})}}class L{static findNodeByUrl(t,e){let i=e.split("/"),s=t;for(let t=0;t<i.length;t++)s=s.getChildByName(i[t]);return s}static findNodeByName(t,e){for(let i=0;i<t.numChildren;i++){let s=t.getChildAt(i);return s.name==e?s:this.findNodeByName(s,e)}}static findNodeByType(t,e){for(let i=0;i<t.numChildren;i++){let s=t.getChildAt(i);return s instanceof e?s:this.findNodeByType(s,e)}}static findNodesByType(t,e){let i=[];for(let s=0;s<t.numChildren;s++){let a=t.getChildAt(s);a instanceof e&&i.push(a),a.numChildren>0&&(i=i.concat(this.findNodeByType(a,e)))}return i}static getComponent(t,e){return t.getComponent(e)}static getComponents(t,e){return t.getComponents(e)}static getComponentInChildren(t,e){for(let i=0;i<t.numChildren;i++){let s=t.getChildAt(i),a=this.getComponent(s,e);if(a)return a;s.numChildren>0&&this.getComponentInChildren(s,e)}return null}static getComponentsInChildren(t,e){for(let i=0;i<t.numChildren;i++){let s=t.getChildAt(i),a=this.getComponents(s,e);return a||this.getComponentsInChildren(s,e)}}static tweenTo(t,e,i,s,a,n,o,r){let h={};for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){h[i+"Start"]=t.transform[i].clone();let s=new Laya.Vector3;Laya.Vector3.subtract(e[i],t.transform[i],s),h[i+"Diff"]=s}let l={value:0},c=Laya.Tween.to(l,{value:1,update:Laya.Handler.create(this,()=>{if(t&&t.transform){for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){let e=new Laya.Vector3,s=new Laya.Vector3;Laya.Vector3.scale(h[i+"Diff"],l.value,s),Laya.Vector3.add(h[i+"Start"],s,e),t.transform[i]=e}}else Laya.Tween.clear(c)},null,!1)},i,s,a,n,o,r);return c}static convert3DTo2DPosition(t,e){this.convertWorldToCameraProjection(t,e);var i=this.out.x,s=this.out.y,a=this.out.z,n=this.out.w;n<t.nearPlane&&(n=t.nearPlane),1!==n&&(i/=n,s/=n,a/=n);let o=t.viewport;return this.out.x=.5*(i+1)*o.width+o.x,this.out.y=.5*(1-s)*o.height+o.y,this.out.z=a*(o.maxDepth-o.minDepth)+o.minDepth,this.vec2.x=this.out.x/Laya.stage.clientScaleX,this.vec2.y=this.out.y/Laya.stage.clientScaleY,this.vec2}static convertWorldToCameraProjection(t,e){let i=t.projectionViewMatrix;return Laya.Vector3.transformV3ToV4(e,i,this.out),this.out}static openScene(t,e,i,s,a,n=!0){Laya.MouseManager.enabled=!1,Laya.Scene.load(t,Laya.Handler.create(this,t=>{t.width=Laya.stage.width,t.height=Laya.stage.height,i?Laya.Dialog.manager.open(t,e,n):t.open(e),Laya.MouseManager.enabled=!0,t.closeHandler=s,t.setParam&&t.setParam(...a)}))}static lookAt(t,e,i){let s=t;if(Math.abs(t.x-e.x)<Laya.MathUtils3D.zeroTolerance&&Math.abs(t.y-e.y)<Laya.MathUtils3D.zeroTolerance&&Math.abs(t.z-e.z)<Laya.MathUtils3D.zeroTolerance)return null;let a=new Laya.Quaternion;return Laya.Quaternion.lookAt(e,s,i,a),a.x*=-1,a.y*=-1,a.z*=-1,a}static createSprite3DWithScript(t,e,i){let s=Laya.Pool.getItem(e.name);if(s)i.addChild(s.gameObject);else{let a=p.getResClone(t+".lh");s=a.addComponent(e),i.addChild(a)}return s}static createSprite3D(t,e){let i=Laya.Pool.getItem(t);return i||(i=p.getResClone(t+".lh")),e.addChild(i),i}static getVisibleByCamera(t,e){return e instanceof Laya.SkinnedMeshSprite3D?t.boundFrustum.intersects(e.skinnedMeshRenderer.bounds._boundBox):t.boundFrustum.intersects(e.meshRenderer.bounds._boundBox)}static createVector3FromArray(t){return new Laya.Vector3(t[0],t[1],t[2])}static createQuaternionFromArray(t){return new Laya.Quaternion(t[0],t[1],t[2],t[3])}static cloneToLayaVec3(t,e){e.x=t.x,e.y=t.y,e.z=t.z}static cloneToVec3(t,e){e.x=t.x,e.y=t.y,e.z=t.z}static bezier(t,e=0,i=0,s,a,n,o){var r=1-t;return{x:r*r*e+2*t*r*s+t*t*n,y:r*r*i+2*t*r*a+t*t*o}}static getCharLength(t){let e=t.split(""),i=0;for(let t=0;t<e.length;t++){e[t].charCodeAt(0)<299?i++:i+=2}return i}static getSpecifyCharLengthStr(t,e,i){let s=t.split(""),a=0,n="";for(let t=0;t<s.length;t++){let o=s[t];if(o.charCodeAt(0)<299?a++:a+=2,!(a<=e))return n+i;n+=o}return n}}L.out=new Laya.Vector4,L.vec2=new Laya.Vector2;class v{static getRandom(t,e){return Math.floor(t+Math.random()*(e-t+1))}static getRotateRad(t,e){Laya.Vector3.normalize(t,t),Laya.Vector3.normalize(e,e);let i=Math.acos(v.fixedDot(t,e)),s=new Laya.Vector3;return Laya.Vector3.cross(t,e,s),s.y<0?-i:i}static eulerToQuaternion(t,e){Laya.Quaternion.createFromYawPitchRoll(t.y*Math.PI/180,t.x*Math.PI/180,t.z*Math.PI/180,e)}static quaternionToEuler(t,e){t.getYawPitchRoll(e),e.setValue(180*e.y/Math.PI,180*e.x/Math.PI,180*e.z/Math.PI)}static getPitchRotateRad(t,e){Laya.Vector3.normalize(t,t),Laya.Vector3.normalize(e,e);let i=Math.acos(v.fixedDot(t,e)),s=new Laya.Vector3(t.x,0,t.z);Laya.Vector3.normalize(s,s);let a=t.y,n=e.y,o=Math.acos(v.fixedDot(t,s)),r=Math.acos(v.fixedDot(e,s));return a==n?a>=0?o>=r?i:-i:o>=r?-i:i:a>n?i:-i}static fixedDot(t,e){let i=Laya.Vector3.dot(t,e);return i=(i=i>-1?i:-1)<1?i:1}getNormalByVecInFace(t,e){let i=new Laya.Vector3(0,0,1),s=t.x,a=t.y,n=t.z,o=e.x,r=e.y,h=e.z;i.x=(h*a-n*r)/(s*r-o*a),i.y=(h*s-n*o)/(a*o-r*s),Laya.Vector3.normalize(i,i)}getProjectionVecInFace(t,e){Laya.Vector3.normalize(t,t),Laya.Vector3.normalize(e,e);let i=new Laya.Vector3;return Laya.Vector3.scale(e,Laya.Vector3.dot(t,e),e),Laya.Vector3.subtract(t,e,i),i}static getRadBetweenVec3(t,e){return Laya.Vector3.normalize(t,t),Laya.Vector3.normalize(e,e),Math.acos(v.fixedDot(t,e))}static getRadBetweenVec2(t,e){Laya.Vector2.normalize(t,t),Laya.Vector2.normalize(e,e);let i=t.x,s=t.y,a=e.x,n=e.y,o=i*n-a*s;return Math.acos(i*a+s*n)*Math.sign(o)}static vector2Rotate(t,e){let i=t.x,s=t.y;t.x=i*Math.cos(e)+s*Math.sin(e),t.y=-i*Math.sin(e)+s*Math.cos(e)}static getYawAndPitch(t,e){let i=0,s=0;return this.projectionDir1.x=t.x,this.projectionDir1.z=t.z,this.projectionDir1.y=0,this.projectionDir2.x=e.x,this.projectionDir2.z=e.z,this.projectionDir2.y=0,s=v.getRotateRad(this.projectionDir1,this.projectionDir2),this.projectionDir1.x=t.x,this.projectionDir1.z=t.z,this.projectionDir1.y=t.y,this.projectionDir2.x=e.x,this.projectionDir2.z=e.z,this.projectionDir2.y=e.y,Laya.Quaternion.createFromYawPitchRoll(s,0,0,this.rotateQua),Laya.Vector3.transformQuat(this.projectionDir1,this.rotateQua,this.rotateVec),{yawDiff:s,pitchDiff:i=v.getPitchRotateRad(this.rotateVec,this.projectionDir2)}}static floatAdd(t,e){var i,s,a;try{i=t.toString().split(".")[1].length}catch(t){i=0}try{s=e.toString().split(".")[1].length}catch(t){s=0}return(t*(a=Math.pow(10,Math.max(i,s)))+e*a)/a}static floatSub(t,e){var i,s,a;try{i=t.toString().split(".")[1].length}catch(t){i=0}try{s=e.toString().split(".")[1].length}catch(t){s=0}return((t*(a=Math.pow(10,Math.max(i,s)))-e*a)/a).toFixed(i>=s?i:s)}static floatMul(t,e){var i=0,s=t.toString(),a=e.toString();try{i+=s.split(".")[1].length}catch(t){}try{i+=a.split(".")[1].length}catch(t){}return Number(s.replace(".",""))*Number(a.replace(".",""))/Math.pow(10,i)}static floatDiv(t,e){var i=0,s=0;try{i=t.toString().split(".")[1].length}catch(t){}try{s=e.toString().split(".")[1].length}catch(t){}return Number(t.toString().replace(".",""))/Number(e.toString().replace(".",""))*Math.pow(10,s-i)}}v.rad2Deg=180/Math.PI,v.deg2Rad=Math.PI/180,v.projectionDir1=new Laya.Vector3,v.projectionDir2=new Laya.Vector3,v.rotateVec2=new Laya.Vector2,v.rotateQua=new Laya.Quaternion,v.rotateVec=new Laya.Vector3,function(t){t[t.None=0]="None",t[t.Normal=1]="Normal",t[t.Tower=2]="Tower",t[t.Pvp=3]="Pvp",t[t.Cream=4]="Cream"}(s||(s={}));class C{constructor(){this.enterMapIndex=0,this.lastEnterMapIndex=-1,this.lastEnterMapIsCream=!1,this.curMapData=null,this.isGotoFightScene=!1,this.isPause=!1,this.isGameEnd=!1,this.isGameWin=!1,this.isBoss=!1,this.isInSearchMap=!1,this.isCatch=!1,this.catchMonsterId=-1,this.catchMonsterData=null,this.lastPos=null,this.aiNameList=["玩家1","玩家2","玩家3","玩家4","玩家5","玩家6","玩家7","玩家8","玩家9","玩家10"],this.aiConfig=[],this.openSuperEvaRank=1,this.curFrame=0,this.timeCount=60,this.fps=0,this.pointData=null,this.navMeshData=null,this.zoneId=null,this.monsterData=null,this.stageConfig=null,this.creamStageConfig=null,this.eliteStageConfig=null,this.passRewardConfig=null,this.standardModelConfig=null,this.collectConfig=null,this.mixConfig=null,this.mixCostConfig=null,this.specialMixConfig=null,this.goldConfig=null,this.upgradeConfig=null,this.towerConfig=null,this.shopConfig=null,this.enemyMonsterCardList=[],this.monsterAtkTimeList=[],this.newMonsterIdList=[],this.allEmptyBlood=!1,this.fightTime=0,this.mapMonsterIdList=[],this.challengeMapData=[],this.challengeMonsterIdList=[],this.challengeMonsterCardList=[],this.shopItemList=[],this.fightType=s.None,this.isCream=!1,this.autoFight=!0,this.isUseAutoFight=!1,this.isAutoFighting=!1,this.reviveLeftTime=1,this.escapeTimeLeft=2,this.stageMaxIndex=7,this.creamStageMaxIndex=7,this.winDivisionScore=1,this.lostDivisionScore=1,this.askForCardList=[15,8,9,5,14,7,12,22,4,9,19,21,27,38,34,35,26,46,50,11,18,39,36,66,44,48,52,62,57,64,58,56,49,69,76,68,47,55,61,40,59,70,73,79,88,82,75,95],this.forceDataObj={}}static get Instance(){return null==this._instance&&(this._instance=new C),this._instance}init(){this.monsterData=p.getRes("enemy.json"),this.stageConfig=p.getRes("stage.json"),this.creamStageConfig=p.getRes("creamStage.json"),this.eliteStageConfig=p.getRes("eliteStage.json"),this.passRewardConfig=p.getRes("passReward.json"),this.collectConfig=p.getRes("collect.json"),this.mixConfig=p.getRes("mix.json"),this.specialMixConfig=p.getRes("specialMix.json"),this.mixCostConfig=p.getRes("mixCost.json"),this.goldConfig=p.getRes("gold.json"),this.upgradeConfig=p.getRes("upgrade.json"),this.towerConfig=p.getRes("tower.json"),this.shopConfig=p.getRes("shop.json"),this.standardModelConfig=p.getRes("standardModel.json"),this.pvpFightMonsterConfig=p.getRes("pvp.json"),this.pvpScoreConfig=p.getRes("pvpScore.json"),this.goodsItem=p.getRes("goods.json"),this.initChallengeMapData(),this.initShopData(),this.initFightMonsterList(),this.initPvpScoreDataList(),this.initAiConfig()}initGameSceneConfig(t){this.reviveLeftTime=1,this.isCream=t,this.curMapData=t?this.creamStageConfig[this.enterMapIndex]:this.stageConfig[this.enterMapIndex],this.pointData=p.getRes(`ScenePoint${this.curMapData.mapIndex+1}.json`),this.navMeshData=p.getRes(`SceneNav${this.curMapData.mapIndex+1}.json`)}calculateFps(){if(this.curFrame++,this.timeCount+=Laya.timer.delta,5==this.curFrame){let t=this.timeCount/this.curFrame;this.curFrame=0,this.timeCount=0,this.fps=1e3/t}}getMonsterData(t){let e=[];for(let i=0;i<t.length;i++)e.push(this.monsterData[t[i]]);return e}getMapEnemyMonsterIdList(t,e){let i=[],s=C.Instance.curMapData;if(0==e){let e=0,a={};for(let t=0;t<s.list.length;t++){let i=s.list[t];"number"==typeof i&&(a[i]=this.monsterData[i],e+=a[i].appearRate)}if(!C.Instance.isCream&&0==B.instance.gameRank&&this.fightTime<2)i.push(5);else{let s=v.getRandom(1,3);0==t&&(s=1);for(let t=0;t<s;t++){let t=v.getRandom(0,e),s=-1;for(const e in a){let i=a[e];if(t<=i.appearRate){s=Number(e);break}t-=i.appearRate}s>=0&&i.push(s)}i.sort((t,e)=>t-e)}}else 1==e?i.push(this.curMapData.bossStat.id):2==e&&i.push(10);return i}setMonsterIdList(t,e){this.enemyMonsterCardList.length=0;for(let i=0;i<t.length;i++){let s=t[i],a=this.getOneCardData(s);e&&(a.curHp=this.curMapData.bossStat.hp,a.hp=this.curMapData.bossStat.hp),a.forceShow=!0,this.enemyMonsterCardList.push(a)}}haveMonster(t){for(let e=0;e<B.instance.cardList.length;e++)if(B.instance.cardList[e].monsterId==t)return!0;return!1}updateMapMonsterList(t,e){if(this.lastEnterMapIndex!=t||this.lastEnterMapIsCream!=e){this.mapMonsterIdList.length=0;let e=this.pointData;for(const i in e)-1!=i.indexOf("Npc")&&this.mapMonsterIdList.push(this.getMapEnemyMonsterIdList(t,0))}}getMonsterCatchRate(t,e){if(e)return 10;{let e=C.Instance.monsterData[t],i=B.instance.catchTimeRec[t]||0,s=Math.ceil(e.catchRate+(100-e.catchRate)/3*i);return s=s>100?100:s}}getNextMonsterData(t){let e={hp:0,atk:0},i=t.star+1,s=C.Instance.standardModelConfig[i],a=C.Instance.standardModelConfig.ttk;if(i<=10)e.hp=t.hp>s.hp?t.hp:s.hp,e.atk=t.atk>s.atk?t.atk:s.atk;else{e.hp=t.hp>s.hp?t.hp:s.hp;let i=t.hp/t.atk;e.atk=i>=a?s.atk:t.atk}return e.atk=v.getRandom(e.atk-5,e.atk+5),e.hp=v.getRandom(e.hp-5,e.hp+5),e}upMonsterDataToSpecifyStar(t,e){for(let i=t.star;i<e;i++){let e=this.getNextMonsterData(t);t.hp=e.hp,t.atk=e.atk,t.star+=1}}initChallengeMapData(){for(let t=0;t<this.towerConfig.length;t++){let e=this.towerConfig[t];this.challengeMapData[e.tower-1]||(this.challengeMapData[e.tower-1]=[]),this.challengeMapData[e.tower-1].push(e)}}initMonsterAtkTimeList(){C.Instance.monsterAtkTimeList.length=0;for(let t=0;t<B.instance.fightCardList.length;t++)B.instance.fightCardList[t]&&C.Instance.monsterAtkTimeList.push(0)}initChallengeMonsterIdList(){this.challengeMonsterIdList.length=0;let t=B.instance.challengeLevel[0]-1,e=B.instance.challengeLevel[1]-1,i=this.challengeMapData[t][e];for(const t in i)if(-1!=t.indexOf("enemyWave"))if("number"==typeof i[t]){let e=[];e.push(i[t]),this.challengeMonsterIdList.push(e)}else if("string"==typeof i[t]&&i[t].length>0){let e=[],s=i[t].split(",");for(let t=0;t<s.length;t++)e.push(Number(s[t]));this.challengeMonsterIdList.push(e)}this.challengeMonsterCardList.length=0;for(let t=0;t<this.challengeMonsterIdList.length;t++){let e=[];this.challengeMonsterCardList.push(e);for(let i=0;i<this.challengeMonsterIdList[t].length;i++){let s=this.getOneCardData(this.challengeMonsterIdList[t][i]);s.forceShow=!0,e.push(s)}}}getOneCardData(t){let e=new y(null);return e.curHp=this.monsterData[t].hp,e.hp=this.monsterData[t].hp,e.atk=this.monsterData[t].atk,e.monsterId=t,e.star=this.monsterData[t].level,e}initShopData(){this.shopItemList=[[],[],[]];for(let t=0;t<this.shopConfig.length;t++){let e=this.shopConfig[t];4==e.item?this.shopItemList[0].push(e):1==e.item||2==e.item?this.shopItemList[1].push(e):3==e.item&&this.shopItemList[2].push(e)}}isMaterial(t){return Number(t)>=1003&&Number(t)<=1008}parseRewardData(t){let e=[],i=t.split(";");for(let t=0;t<i.length;t++){let s=i[t].split(",");e.push([Number(s[0]),Number(s[1])])}return e}countRewardList(t,e){let i={1:"gold",2:"chip",3:"fightTicket",4:"badge",5:"monster"};e==s.Tower?i={1:"gold",2:"fightTicket",3:"chip",4:"monster",5:"badge"}:e==s.Pvp&&(i={1:"gold",2:"chip",3:"fightTicket",4:"monster"});let a=[],n=[];for(let e=0;e<t.length;e++){let s=i[t[e][0]],o=n.indexOf(s);-1==o&&(o=n.length,n.push(s),a.push({type:s,num:0})),a[o].num+=t[e][1]}return a}receiveReward(i){for(let s=0;s<i.length;s++){let a=i[s];if("gold"==a.type)B.instance.gold+=a.num,B.instance.onDataChange("gold"),e.event(t.AddMoney,["gold",a.num]);else if("badge"==a.type)B.instance.badge+=a.num,B.instance.onDataChange("badge"),e.event(t.AddMoney,["badge",a.num]);else if("chip"==a.type)B.instance.chip+=a.num,B.instance.onDataChange("chip"),e.event(t.AddMoney,["chip",a.num]);else if("fightTicket"==a.type)B.instance.fightTicket+=a.num,B.instance.onDataChange("fightTicket"),e.event(t.AddMoney,["fightTicket",a.num]);else if("diamond"==a.type)B.instance.diamond+=a.num,B.instance.onDataChange("diamond"),e.event(t.AddMoney,["diamond",a.num]);else if("monster"==a.type){let t=C.Instance.getMonsterData([a.num]),e=this.forceDataObj[a.num],i=[!0,a.num,t[0],!1,3,!1,e];L.openScene("pages/catchResult.scene",!1,!0,null,i)}}}getSpecifyStarMonsterCard(t,e=!1,i=null){let s=[],a=C.Instance.monsterData,n=[120,121,122,123,124,125,128];for(const o in a){let a=Number(o),r=C.Instance.getOneCardData(a);-1==n.indexOf(a)&&r.star>=t[0]&&r.star<=t[1]&&(!i||i&&r.monsterId>=i[0]&&r.monsterId<=i[1])&&(e?-1==B.instance.collectMonsterIdList.indexOf(a)&&s.push(r):s.push(r))}return s[v.getRandom(0,s.length-1)]}isTryCard(t){for(let e=0;e<B.instance.tryCardDataList.length;e++){let i=B.instance.tryCardDataList[e];if(i.cardId==t.cardId&&!i.isLose)return!0}return!1}isSuperEva(t){let e=[];for(const t in C.Instance.specialMixConfig)e.push(C.Instance.specialMixConfig[t].index);return-1!=e.indexOf(t.monsterId)}isInFightList(t){for(let e=0;e<B.instance.fightCardList.length;e++){let i=B.instance.fightCardList[e];if(i&&i.cardId==t.cardId)return!0}return!1}getRewardUiDataList(t){let e=[];for(let i=0;i<t.length;i++){let s={label:{text:""},icon:{skin:""}};s.label.text="X"+t[i].num,"gold"==t[i].type?s.icon.skin="count/Ui_TwoGold.png":"badge"==t[i].type?s.icon.skin="newSystem/Ui_Badgebig.png":"monster"==t[i].type?(t[i].num>=1003?s.icon.skin=`newSystem/Ui_SuCai${t[i].num}.png`:(s.icon.skin=`monster/Ui_Monster${t[i].num}.png`,s.icon.scaleX=.2,s.icon.scaleY=.2),s.label.text="X1"):"chip"==t[i].type?s.icon.skin="newSystem/Ui_MonsterHeadChip.png":"fightTicket"==t[i].type&&(s.icon.skin="newSystem/Ui_Badgebig.png"),e.push(s)}return e}uploadChallengeRankScore(){if("undefined"!=typeof wx){let t=10*(B.instance.challengeLevel[0]-1)+B.instance.challengeLevel[1];wx.getOpenDataContext().postMessage({type:"uploadchallenge",score:t})}}isExpeditionCard(t){for(let e=0;e<B.instance.expeditionCardList.length;e++)for(let i=0;i<B.instance.expeditionCardList[e].length;i++){let s=B.instance.expeditionCardList[e][i];if(s&&t.cardId==s.cardId)return!0}return!1}initFightMonsterList(){this.pvpFightMonsterList=[];for(let t=0;t<this.pvpFightMonsterConfig.length;t++){let e=this.pvpFightMonsterConfig[t],i=e.level;this.pvpFightMonsterList[i-1]||(this.pvpFightMonsterList[i-1]=[]),this.pvpFightMonsterList[i-1].push(e)}}initPvpMonsterCardList(t){let e=3*(t[0]-1)+t[1],i=[0,0];i[0]=e-2,i[0]=i[0]<1?1:i[0],i[1]=e+2,i[1]=i[1]>24?24:i[1];let s=v.getRandom(i[0],i[1]);s=s>this.pvpFightMonsterList.length?this.pvpFightMonsterList.length:s,this.pvpMonsterCardList=[];let a=this.pvpFightMonsterList[s-1],n=a[v.getRandom(0,a.length-1)];for(let t=0;t<3;t++){let e=n["monster"+(t+1)],i=0,s=0;0==t?(i=n.hp,s=n.atk):(i=n["hp_"+t],s=n["atk_"+t]);let a=this.getOneCardData(e);a.hp=a.curHp=i,a.atk=s,a.forceShow=!0,this.pvpMonsterCardList.push(a)}}setPvpMonsterIdList(){this.enemyMonsterCardList=[...this.pvpMonsterCardList]}initPvpScoreDataList(){let t=0;this.pvpScoreDataList=[];for(let e=0;e<this.pvpScoreConfig.length;e++){let i=this.pvpScoreConfig[e],s=i.level;this.pvpScoreDataList[s-1]||(this.pvpScoreDataList[s-1]=[]),i.totalUpgradeScore=t+i.upgradeScore,this.pvpScoreDataList[s-1].push(i),t=i.totalUpgradeScore}}getPvpDivisionDataByScore(t){let e=[1,1];for(let i=0;i<this.pvpScoreDataList.length;i++)for(let s=0;s<this.pvpScoreDataList[i].length;s++){let a=this.pvpScoreDataList[i][s];if(!(t>=a.totalUpgradeScore))return e;e[0]=a.level,e[1]=a.star}return e}compareDivision(t,e){return t[0]==e[0]&&t[1]==e[1]?0:t[0]>e[0]||t[0]==e[0]&&t[1]>e[1]?1:t[0]<e[0]||t[0]==e[0]&&t[1]<e[1]?-1:void 0}haveExtra(t){let e=this.getShopItemBuyTime(t.productId);return t.extra>0&&0==e}getShopItemBuyTime(t){return B.instance.shopBuyRecord[t]||0}getGiftPackBuyTime(t){return B.instance.giftPackBuyRecord[t]||0}initAiConfig(){let t=["XXTCH","阳阳","Vanl","悦","绝世总攻铁柱","吸汉总少女丶","V","陈小飞","小丑八怪","Doraemon","奥特鄙视","未忈","强颜欢笑","BWUWB","185****5206","风华绝代的芋仔","蘑菇炖提莫","沧海入我杯中酒","Heaven","淺笑如夏","橘味果酱","纸鸢","今世的繁华╮","一抹胭脂冷","短腿萝莉*^﹏^*","风吹半茶凉","爱在夜里翻滚","别跟我玩心跳","呆到﹏天然萌","无恙","执手不离","吃货最怕做饿梦","陌路人生","袖染墨凉°","刁民别害朕","夏了夏天","坚守、那份情","谎言成双","寡欢","猫南北","予你百年情深","软妹贩卖机","一纸折扇情","陌挽巷","为你尽力","风吹半茶凉","╭笑丶扯","→苍凉ゝ","怎么没把你淹死","元气丶梦醒.","独羁","荒漠@","法海 ，我不爱你","幼稚小孩","╰︶糖果超朲","姊ヽ伱旳女王","太过爱你@","之卿","仄情","东南萌","一秒、德擦肩","☆*小可爱的女巫帽ぅ","起开我有煞气","ゞ 藍凋","哆来咪发索拉西","男人霸气ゝ","听一曲 丶Go Away","痛de味道","初夏、夜微凉","久病成医 Break shoe,","难凉热血","花糖纸※","騎著鴨子找火雞","心痛只能用时间来消耗。","-[氐調]。","哑忍","最 爱","揽你到怀里","无敌大欧巴i","限量版|珍藏款","▼尽多少欢愉","旧城不暖少年","＊诂lǐ舊sんi","看着迩们尽情德演绎甜蜜、","城梦淤纪","吴梵°心脏被你瓦解","╰+鎕鑵裏甾ふ陔メo","让时间说真话","海伤°","刺青刺心°","独饮孟婆汤","ε给我一个晚安吻","小呀么小骄傲。","￡冰翼★之魂彡","天南地北双飞客.","软酱","情深与你","﹎銘婲囿鉒","江心薄雾起","掌灯师"];for(let e=0;e<t.length;e++){let i={name:t[e],icon:""};i.icon=e<50?`AiImage/Ai${e+1}.png`:"",this.aiConfig.push(i)}}}class I{static init(t,e){return new Promise((i,s)=>{Laya.loader.load(t,Laya.Handler.create(this,t=>{t?(this._guideConfig=t,this._guideUICls=e,this._guideRecord=B.instance.guideRecord,i()):s("引导配置加载失败")}))})}static analyzeNodeList(t){let e={addNodeList:[],handNodeList:[]};if(t)for(let i=0;i<t.length;i++)e.addNodeList.push(t[i].node),t[i].isHandNode&&e.handNodeList.push(t[i].node);return e}static startInnerTask(t,e=null){if(!this._enable||this.finished||this._isRunTask)return;if(t!=this.curInnerTask.taskName)return;this._isRunTask=!0,this.open(),this.showTalk(this.curInnerTask.text);let i=this.analyzeNodeList(e);this.showHand(i.handNodeList),this.addNode(i.addNodeList)}static hideMask(){Laya.Dialog.manager.maskLayer.alpha=0}static finishInnerTask(t){this._enable&&!this.finished&&this._isRunTask&&t==this.curInnerTask.taskName&&(this._isRunTask=!1,this.hideTalk(),this.hideHand(),this.backNode(),this.close(),e.event(this.InnerTaskFinish,this.curInnerTask.taskName),++this._curTask.innerTaskId==this.curOutTask.innertask.length?(B.instance.guideRecord.push(this._curTask.outTaskId),B.instance.onDataChange("guideRecord"),this.finishOutTask()):e.event(this.InnerTaskStart,this.curInnerTask.taskName))}static startOutTask(t){if(!this._curTask){for(let e=0;e<this._guideConfig.length;e++)if(this._guideConfig[e].taskName==t){if(-1!=this._guideRecord.indexOf(e))return;this._curTask={outTaskId:e,innerTaskId:0};break}e.event(this.OutTaskStart,this.curOutTask.taskName),e.event(this.InnerTaskStart,this.curInnerTask.taskName)}}static finishOutTask(){if(this._curTask){let t=this.curOutTask.taskName;this._curTask=null,e.event(this.OutTaskFinish,t)}}static set enable(t){this._enable=t}static get enable(){return this._enable}static get finished(){return this._guideRecord.length==this._guideConfig.length}static get isOpen(){return this._isOpen}static open(){!this._enable||this.finished||this._isOpen||(this._isOpen=!0,this._guideUIInstance=new this._guideUICls,this._guideUIInstance.isModal=!0,this._guideUIInstance.autoDestroyAtClosed=!0,this._guideUIInstance.width=Laya.stage.width,this._guideUIInstance.height=Laya.stage.height,this._guideUIInstance.talkBg.visible=!1,this._guideUIInstance.hand.visible=!1,this._handStandAni=this._guideUIInstance.handStand,this._handClickAni=this._guideUIInstance.handClick,Laya.Dialog.manager.open(this._guideUIInstance,!1,!1),this._guideUIInstance.on(Laya.Event.CLICK,this,this.onPageEvent))}static close(){this._enable&&!this.finished&&this._isOpen&&(Laya.Dialog.manager.close(this._guideUIInstance),Laya.Dialog.manager.maskLayer.alpha=UIConfig.popupBgAlpha,this._guideUIInstance=null,this._isOpen=!1)}static showHand(t){if(!t||0==t.length||this._isShowHand)return;this._isShowHand=!0,this._handPointList=[],this._handPointIndex=0;for(let e=0;e<t.length;e++){let i=t[e],s=new Laya.Point;s.x=i.width/2*i.globalScaleX,s.y=i.height/2*i.globalScaleY,i.localToGlobal(s,!1),this._handPointList.push(s)}this._guideUIInstance.hand.visible=!0;let e=this._handPointList[this._handPointIndex];this._guideUIInstance.hand.x=e.x,this._guideUIInstance.hand.y=e.y,Laya.timer.clear(this,this.onFrameLoop),this._handPointList.length>=2?(this._handStandAni.play(0,!1),Laya.timer.frameLoop(1,this,this.onFrameLoop)):(this._handClickAni.wrapMode=Laya.FrameAnimation.WRAP_PINGPONG,this._handClickAni.play(0,!0))}static hideHand(){this._handPointList&&this._isShowHand&&(this._isShowHand=!1,this._handPointList.length>=2&&Laya.timer.clear(this,this.onFrameLoop),this._handPointList=null,this._handPointIndex=-1,this._guideUIInstance.hand.visible=!1,this._handStandAni.play(0,!1))}static showTalk(t){t&&!this._isShowTalk&&(this._isShowTalk=!0,this._guideUIInstance.talkBg.visible=!0,this._guideUIInstance.talkLabel.text=t)}static hideTalk(){this._isShowTalk&&(this._isShowTalk=!1,this._guideUIInstance.talkBg.visible=!1,this._guideUIInstance.talkLabel.text="")}static onFrameLoop(){let t=this._handPointList[this._handPointIndex],e=this._handPointList[this._handPointIndex+1];this._t+=this._growSpeed,this._t=this._t>1?1:this._t,this._guideUIInstance.hand.x=t.x+(e.x-t.x)*this._t,this._guideUIInstance.hand.y=t.y+(e.y-t.y)*this._t,1==this._t&&(this._t=0,this._handPointIndex=++this._handPointIndex%this._handPointList.length)}static addNode(t){if(t&&0!=t.length){this._nodeList=t,this._nodeExDataList=[];for(let t=0;t<this._nodeList.length;t++){let e=this._nodeList[t],i={parent:e.parent,x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY};this._nodeExDataList.push(i);let s=e.globalScaleX,a=e.globalScaleY,n=new Laya.Point;n.x=e.pivotX,n.y=e.pivotY,e.localToGlobal(n,!1),this._guideUIInstance.contentBox.addChild(e),e.x=n.x,e.y=n.y,e.scaleX=s,e.scaleY=a}}}static backNode(){if(this._nodeList){for(let t=0;t<this._nodeList.length;t++){let e=this._nodeList[t],i=this._nodeExDataList[t];i.parent.addChild(e),e.x=i.x,e.y=i.y,e.scaleX=i.scaleX,e.scaleY=i.scaleY}this._nodeList=null,this._nodeExDataList=null}}static onPageEvent(t){1==this.curInnerTask.type&&this.finishInnerTask(this.curInnerTask.taskName)}static get curOutTask(){return this._guideConfig[this._curTask.outTaskId]}static get curInnerTask(){return this.curOutTask.innertask[this._curTask.innerTaskId]}}I.OutTaskStart="OutTaskStart",I.OutTaskFinish="OutTaskFinish",I.InnerTaskStart="InnerTaskStart",I.InnerTaskFinish="InnerTaskFinish",I._handPointIndex=-1,I._isOpen=!1,I._isRunTask=!1,I._isShowHand=!1,I._isShowTalk=!1,I._enable=!1,I._t=0,I._growSpeed=.01;class S{static dateFormat(t,e){let i;const s={"y+":e.getFullYear().toString(),"m+":(e.getMonth()+1).toString(),"d+":e.getDate().toString(),"H+":e.getHours().toString(),"M+":e.getMinutes().toString(),"S+":e.getSeconds().toString()};for(let e in s)(i=new RegExp("("+e+")").exec(t))&&(t=t.replace(i[1],1==i[1].length?s[e]:s[e].padStart(i[1].length,"0")));return t}static isSameDay(t,e){return t.toDateString()==e.toDateString()}static convertTimeFormat(t){let e="";const i="number"==typeof t?t:parseInt(t),s=Math.floor(i/36e5),a=s>9?s:"0"+s,n=Math.floor((i-3600*s*1e3)/6e4),o=n>9?n:"0"+n,r=Math.floor((i-3600*s*1e3-60*n*1e3)/1e3);return e+=a+":"+o+":"+(r>9?r:"0"+r)}static uuid(t,e){let i,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=[];if(e=e||s.length,t)for(i=0;i<t;i++)a[i]=s[0|Math.random()*e];else{let t;for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",i=0;i<36;i++)a[i]||(t=0|16*Math.random(),a[i]=s[19==i?3&t|8:t])}return a.join("")}static generateUUID(){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:3&i|8).toString(16)})}static dayDiff(t,e){let i=Math.floor(t/864e5);return Math.floor(e/864e5)-i}static getYearMonthDay(t,e){let i=[31,28,31,30,31,30,31,31,30,31,30,31];return this.isLeapYear(t)&&(i[1]=29),i[e-1]}static isLeapYear(t){return t%4==0&&(t%100!=0||t%400==0)}static DateDiff(t,e){let i=this.dateFormat("yyyy-mm-dd",new Date(t)),s=this.dateFormat("yyyy-mm-dd",new Date(e)),a=new Date(i),n=new Date(s),o=0;return n>a&&(o=parseInt(Math.abs(n-a)/1e3/60/60/24+"")),o}static isDuringDate(t,e){let i=new Date,s=new Date(t),a=new Date(e);return i>=s&&i<=a}}!function(t){t.unknown="unknown",t.qq="qq",t.wechat="wx",t.tt="tt",t.oppo="oppo",t.vivo="vivo",t.editor="editor"}(a||(a={}));class w{constructor(){this.platform=a.unknown,this.adUnitId_Config={wx:{bannerId:"adunit-9379d0955f8130cb",videoId:"adunit-6951da5cd30ae1f4",interstitialId:"adunit-12501330ee48e1d1",customAdId:["adunit-239e866b6ff05e2f"]},qq:{bannerId:"ad2918d389e3686713d15e9dd4aa85b2",videoId:"f643227e68419423ff634b594dc139a8",appBoxId:["8795f01ae515971a67967322f0a8bbfe","e7543f1deacad96dff7ad9a1d919c7bf"],blockId:"89bd30f53749f7b662ab31b5e8ee7614",interstitialId:"fc02726f82ae326434122b8d01664d58"},tt:{bannerId:null,videoId:null},oppo:{appId:"30593425",nativeId:["359518","359520"],videoId:"359517",bannerId:"359516",interstitialId:null,boxId:null},vivo:{appId:"105500064",nativeId:["9e6531bc0f0f4e799aab902ed3a023f7","365c252bf85c4a889ada107be45dbdec","65f5bbbdccc343c2bbff6999c540e249"],videoId:"09235017308e4c1c8dba236f877f7aa6",bannerId:"1f1a58296a64450d91eb1ce5fcf8e404",interstitialId:"2d907b3086dd4a8f9c0e6151a3ca86d0"}},this.recommendConfig=[{name:"我冲的贼快",appId:"30444933",pkgName:"com.wcdzk.xxtch.nearme.gamecenter"},{name:"兽王争霸",appId:"30428233",pkgName:"com.monsterking.xxtch.nearme.gamecenter"},{name:"撞飞糖豆人",appId:"30439515",pkgName:"com.zftdr.xxtch.nearme.gamecenter"},{name:"音速少女",appId:"30348185",pkgName:"com.speedgirl.xxtch.nearme.gamecenter"},{name:"肥仔大冲撞",appId:"30439517",pkgName:"com.fzdcz.xxtch.nearme.gamecenter"},{name:"剁手狂欢",appId:"30439516",pkgName:"com.xx.cutmyhand.nearme.gamecenter"}],this.adUnitId_Banner=null,this.adUnitId_Video=null,this.adUnitId_AppBox=null,this.adUnitId_BlockAd=null,this.adUnitId_Interstitial=null,this.adUnitId_Native=null,this.adUnitId_OppoBox=null,this.adUnitId_CustomAd=null,this.rewardedVideoAd=null,this.bannerAd=null,this.interstitialAd=null,this.appBoxs=null,this.blockAd=null,this.nativeAd=[],this.nativeAdData=[],this.boxAdSelf=null,this.boxAdOfficial=null,this.customAdMap=new Map,this.adUnitId_VideoList=["adunit-670d87306dc1c259","adunit-5e9bb5c9d90565eb","adunit-eb988867c0754d81","adunit-9de3143facfc2b2d","adunit-ad045e709bd7ac27","adunit-92987caa2fa84b4e","adunit-cf2f4369f3e13570","adunit-b7e3aa4e04c41392","adunit-0cad7f4a75069fbe"],this.videoAdMap=new Map,this.banner_Width=300,this.banner_Height=120,this.margin_Bottom=0,this.nativeLoadTime=0,this.video_OnLoad_Callback=null,this.video_OnClose_Callback=null,this.native_OnLoad_Callback=null,this.adList=[],this.noAd=!1,this.isCheat=0,this.isShowNative=1,this.exchangeTime=0,this.delayTime=0,this.defaultOpen=0,this.oppoLimit=0,this.oppoShowBanner=0,this.boxTimeLimit=4,this.boxType=0,this.isOfficial=1,this.freeTry=1,this.showVideoEventId=0,this.isOld=0,this.forceAd=0,this.forceTimeDelay=18e4,this.forceTimeLeft=1,this.tryDelayTime=0,this.packDelayTime=0,this.reportShowPer=[],this.reportShowTimeLeft=2,this.refreshNativeTimeDelay=[],this.nativePer=[100,10,100,50,50,1],this.isNativeInsertShow=!1,this.mistakeSwitch=0,this.mistakeTimeDelay=0,this.pullTimeDelay=60,this.secondReportPer=0,this.thirdReportPer=0,this.nativeRefreshTimeDelay=10,this.thirdNativeBelong=0,this.improveExpPer=.3,this.rewardPurplePer=.02,this.moneyGodPer=0,this.isGD=!1,this.superBtnPer=[0,0],this.closeAd=0,this.isTestNative=!1,this.nativeRePullTime=1,this.testNativeTime=2e4,this.areaCode=0,this.changeBntPos=0,this.atkControl=1,this.isBake=0,this.bakeWhiteList=["PDBM00"],this.forceTouchWhiteList=[1037,1095,1046],this.forceTouchOpenTime=["9:00","19:00"],this.forceTouchSwitch=0,this.click_award_add=.1,this.click_award_back=.005,this.click_award_percent=[.4,.7],this.closeAreaList=[[440300,440399],[510100,510199],[5e5,501e3],[440100,440199],[441900,441999],[44e4]],this.nativeTestData={adId:"89fa5398-56a5-47cf-bafb-f1079ea6aec7",clickBtnTxt:"立即下载",creativeType:3,desc:"抖音极速版，有红包可以领！",iconUrlList:["https://store.heytapimage.com/img/202107/28/95e271c68c4a28a3395bd3d89c58e0c8.png"],icon:"https://store.heytapimage.com/img/202107/28/95e271c68c4a28a3395bd3d89c58e0c8.png",interactionType:3,logoUrl:"https://adsfs.heytapimage.com/union/adlogo/o_1512387525231.png",title:"抖音极速版",imgUrlList:[]},this.videoMode=1,this.appDataList=[{appId:"wx3102f6021c0e6a33",appName:"兽王争霸1",appIcon:""}],this.sendVideoData=null}static get Instance(){return null==this._instance&&(this._instance=new w),window.AllPlatformAdMgr=this._instance,this._instance}getPlatform(){if(window.wx)this.platform=a.wechat,window.tt&&(this.platform=a.tt),window.qq&&(this.platform=a.qq);else if(window.qg){"vivo"==qg.getSystemInfoSync().brand?this.platform=a.vivo:this.platform=a.oppo}else this.platform=a.editor,this.isTestNative=!0}init(){this.getPlatform(),this.initAdId(),this.getCheatState().then(()=>{this.initAdComponent()}).catch(()=>{this.initAdComponent()})}updateIsGD(){var t=this.closeAreaList,e=this.areaCode,i=!1;for(let s=0;s<t.length;s++){const a=t[s];if(2==a.length){if(e>=a[0]&&e<a[1]){i=!0;break}}else if(e==a[0]){i=!0;break}}i&&(this.isGD=!0)}initAdId(){switch(this.platform){case a.wechat:this.adUnitId_Video=this.adUnitId_Config.wx.videoId,this.adUnitId_Banner=this.adUnitId_Config.wx.bannerId,this.adUnitId_Interstitial=this.adUnitId_Config.wx.interstitialId,this.adUnitId_CustomAd=this.adUnitId_Config.wx.customAdId;break;case a.qq:this.adUnitId_Video=this.adUnitId_Config.qq.videoId,this.adUnitId_Banner=this.adUnitId_Config.qq.bannerId,this.adUnitId_AppBox=this.adUnitId_Config.qq.appBoxId,this.adUnitId_BlockAd=this.adUnitId_Config.qq.blockId,this.adUnitId_Interstitial=this.adUnitId_Config.qq.interstitialId;break;case a.tt:this.adUnitId_Video=this.adUnitId_Config.tt.videoId,this.adUnitId_Banner=this.adUnitId_Config.tt.bannerId;break;case a.oppo:this.adUnitId_Video=this.adUnitId_Config.oppo.videoId,this.adUnitId_Interstitial=this.adUnitId_Config.oppo.interstitialId,this.adUnitId_Native=this.adUnitId_Config.oppo.nativeId,this.adUnitId_Banner=this.adUnitId_Config.oppo.bannerId,this.adUnitId_OppoBox=this.adUnitId_Config.oppo.boxId;break;case a.vivo:this.adUnitId_Video=this.adUnitId_Config.vivo.videoId,this.adUnitId_Interstitial=this.adUnitId_Config.vivo.interstitialId,this.adUnitId_Native=this.adUnitId_Config.vivo.nativeId,this.adUnitId_Banner=this.adUnitId_Config.vivo.bannerId}}initAdComponent(){switch(this.platform){case a.wechat:this.initVideoAdMap(),this.initBannerAd(this.adUnitId_Banner),this.initInterstitialAd();break;case a.qq:this.initVideoAd(),this.initBannerAd(this.adUnitId_Banner),this.initAppBox(),this.initBlockAd(),this.initInterstitialAd();break;case a.tt:break;case a.oppo:this.initVideoAd(),this.initBannerAd(this.adUnitId_Banner),this.initNativeAd(),this.testNative(),this.initBox(),this.updateReportShowTimeLeft();break;case a.vivo:this.initVideoAd(),this.initBannerAd(this.adUnitId_Banner),this.initNativeAd(),this.initInterstitialAd(),this.updateReportShowTimeLeft()}}getCheatState(){return new Promise((t,e)=>{let i=this.getAdconfigUrl();Laya.loader.load(i,Laya.Handler.create(this,i=>{i?(this.isCheat=i.isCheat,this.isShowNative=i.isShowNative,this.exchangeTime=i.exchangeTime,this.delayTime=i.delayTime,this.defaultOpen=i.defaultOpen,this.oppoLimit=i.oppoLimit,this.oppoShowBanner=i.oppoShowBanner,this.isOfficial=i.isOfficial,this.freeTry=i.freeTry?i.freeTry:0,this.isOld=i.isOld?i.isOld:0,this.forceAd=i.forceAd?i.forceAd:0,this.tryDelayTime=i.tryDelayTime?i.tryDelayTime:0,this.mistakeSwitch=i.mistakeSwitch?i.mistakeSwitch:0,this.mistakeTimeDelay=i.mistakeTimeDelay?i.mistakeTimeDelay:0,this.packDelayTime=i.packDelayTime?i.packDelayTime:0,this.forceAd&&Laya.timer.once(12e4,this,()=>{this.forceTimeDelay=0}),this.reportShowPer=i.reportShowPer?i.reportShowPer:this.reportShowPer,this.refreshNativeTimeDelay=i.refreshNativeTimeDelay?i.refreshNativeTimeDelay:this.refreshNativeTimeDelay,this.nativePer=i.nativePer?i.nativePer:this.nativePer,this.pullTimeDelay=i.pullTimeDelay?i.pullTimeDelay:this.pullTimeDelay,this.secondReportPer=i.secondReportPer?i.secondReportPer:this.secondReportPer,this.thirdReportPer=i.thirdReportPer?i.thirdReportPer:this.thirdReportPer,this.nativeRefreshTimeDelay=i.nativeRefreshTimeDelay?i.nativeRefreshTimeDelay:this.nativeRefreshTimeDelay,this.thirdNativeBelong=i.thirdNativeBelong?i.thirdNativeBelong:this.thirdNativeBelong,this.adUnitId_Native=i.nativeId?i.nativeId:this.adUnitId_Native,this.improveExpPer=i.improveExpPer?i.improveExpPer:this.improveExpPer,this.rewardPurplePer=i.rewardPurplePer?i.rewardPurplePer:this.rewardPurplePer,this.moneyGodPer=i.moneyGodPer?i.moneyGodPer:this.moneyGodPer,this.superBtnPer=i.superBtnPer?i.superBtnPer:this.superBtnPer,this.closeAd=i.closeAd?i.closeAd:this.closeAd,this.testNativeTime=i.testNativeTime?i.testNativeTime:this.testNativeTime,this.closeAreaList=i.closeAreaList?i.closeAreaList:this.closeAreaList,this.changeBntPos=i.changeBntPos?i.changeBntPos:this.changeBntPos,this.isBake=i.isBake?i.isBake:this.isBake,this.bakeWhiteList=i.bakeWhiteList?i.bakeWhiteList:this.bakeWhiteList,this.atkControl=i.atkControl?i.atkControl:1,this.forceTouchWhiteList=i.forceTouchWhiteList?i.forceTouchWhiteList:[1037,1095,1046],this.forceTouchOpenTime=i.forceTouchOpenTime?i.forceTouchOpenTime:["9:00","19:00"],this.forceTouchSwitch=!!i.forceTouchSwitch&&i.forceTouchSwitch,this.click_award_add=i.click_award_add?i.click_award_add:.1,this.click_award_back=i.click_award_back?i.click_award_back:.005,this.click_award_percent=i.click_award_percent?i.click_award_percent:[.4,.7],this.videoMode=i.videoMode?i.videoMode:1,this.appDataList=i.appDataList?i.appDataList:[{appId:"wx3102f6021c0e6a33",appName:"兽王争霸1",appIcon:""}],t()):e()}))})}getAdconfigUrl(){return`https://demo.xxtch.com/Pokemon/adconfig/adconfig_${this.platform}_7.0.json?ran=${Math.floor(1e6*Math.random())}`}initBox(){if(this.adUnitId_OppoBox&&this.platform===a.oppo){Laya.timer.once(60*this.boxTimeLimit*1e3,this,()=>{this.boxTimeLimit=0}),this.boxAdSelf=new Laya.Image("ads/Ui_Commontuijian.png"),this.boxAdSelf.width=Laya.stage.width,this.boxAdSelf.height=275;for(let t=0;t<this.recommendConfig.length;t++){let e=this.recommendConfig[t];if(e.appId==this.adUnitId_Config.oppo.appId){let i=new Laya.Image("ads/icon"+e.appId+".png");i.anchorY=.5,i.y=168,i.width=i.height=128,i.x=52+148*t,i.on(Laya.Event.CLICK,this,()=>{qg.navigateToMiniGame({pkgName:e.pkgName})}),this.boxAdSelf.addChild(i)}}qg.getSystemInfoSync().platformVersionCode>=1076&&(this.boxAdOfficial=qg.createGameBannerAd({adUnitId:this.adUnitId_OppoBox}),this.boxAdOfficial.onError(t=>{console.error(t)}),this.boxAdOfficial.onLoad(t=>{console.log(t)}))}}showBox(){(this.boxAdSelf||this.boxAdOfficial)&&(this.isOfficial&&this.boxAdOfficial?this.boxAdOfficial.show():(this.boxAdSelf.x=0,this.boxAdSelf.y=Laya.stage.height-this.boxAdSelf.height,Laya.stage.addChild(this.boxAdSelf)))}hideBox(){(this.boxAdSelf||this.boxAdOfficial)&&(this.isOfficial&&this.boxAdOfficial?this.boxAdOfficial.hide():Laya.stage.removeChild(this.boxAdSelf))}initBlockAd(){if(this.adUnitId_BlockAd&&this.platform===a.qq){let t=this.blockAd;t&&t.destroy();let e=qq.getSystemInfoSync();this.blockAd=qq.createBlockAd({adUnitId:this.adUnitId_BlockAd,style:{left:0,top:0},size:5,orientation:"landscape"}),(t=this.blockAd).onError(t=>{console.log(t)}),t.onResize(i=>{console.log(i);let s=e.screenHeight-i.height-300/e.pixelRatio,a=(e.screenWidth-i.width)/2;t.style.top=s,t.style.left=a})}}showBlockAd(){this.blockAd&&this.blockAd.show()}hideBlockAd(){this.blockAd&&this.initBlockAd()}getBannerStyle(){if(this.bannerAd&&this.platform==a.qq){return this.bannerAd.style}}initBannerAd(t,e){if(this.adUnitId_Banner=t,this.adUnitId_Banner)if(this.platform===a.wechat){let t=this.bannerAd;t&&t.destroy();let i=wx.getSystemInfoSync(),s=(i.screenWidth-this.banner_Width)/2,a=e||i.screenHeight-this.banner_Height-this.margin_Bottom;this.bannerAd=wx.createBannerAd({adUnitId:this.adUnitId_Banner,adIntervals:30,style:{left:s,top:a,width:this.banner_Width,height:this.banner_Height}}),(t=this.bannerAd).onError(t=>{console.log(t)}),t.onResize(s=>{this.banner_Height=s.height,t.style.top=e||i.screenHeight-this.banner_Height-this.margin_Bottom})}else if(this.platform===a.qq){let t=this.bannerAd;t&&t.destroy();let e=qq.getSystemInfoSync(),i=(e.screenWidth-this.banner_Width)/2,s=e.screenHeight-this.banner_Height-this.margin_Bottom;this.bannerAd=qq.createBannerAd({adUnitId:this.adUnitId_Banner,style:{left:i,top:s,width:this.banner_Width,height:this.banner_Height}}),(t=this.bannerAd).onResize(i=>{this.banner_Height=i.height,t.style.top=e.screenHeight-this.banner_Height-this.margin_Bottom})}else if(this.platform===a.tt){this.banner_Width=208;let t=tt.getSystemInfoSync(),e=(t.screenWidth-this.banner_Width)/2,i=t.screenHeight-this.banner_Height-this.margin_Bottom,s=this.bannerAd;s&&s.destory(),this.bannerAd=tt.createBannerAd({adUnitId:this.adUnitId_Banner,adIntervals:30,style:{left:e,top:i,width:this.banner_Width}}),(s=this.bannerAd).onError(t=>{console.log(t)}),s.onResize(e=>{this.banner_Height=e.height,s.style.top=t.screenHeight-this.banner_Height-this.margin_Bottom})}else if(this.platform===a.oppo){let t=this.bannerAd;t&&t.destroy();let e=qg.getSystemInfoSync();this.banner_Width=e.screenWidth;let i=(e.screenWidth-this.banner_Width)/2,s=e.screenHeight-this.banner_Height-this.margin_Bottom;this.bannerAd=qg.createBannerAd({adUnitId:this.adUnitId_Banner,style:{left:i,top:s,width:this.banner_Width,height:this.banner_Height}}),(t=this.bannerAd).onError(t=>{console.error(t)}),t.onResize(i=>{this.banner_Height=i.height,this.banner_Width=i.width,t.style.top=e.screenHeight-this.banner_Height-this.margin_Bottom,t.style.width=i.width,t.style.left=(e.screenWidth-i.width)/2})}else if(this.platform===a.vivo){let t=this.bannerAd;if(t)return;let e=qg.getSystemInfoSync();this.banner_Width=e.screenWidth;let i=(e.screenWidth-this.banner_Width)/2,s=e.screenHeight-this.banner_Height-this.margin_Bottom;this.bannerAd=qg.createBannerAd({posId:this.adUnitId_Banner,style:{left:i,top:s,width:this.banner_Width,height:this.banner_Height}}),(t=this.bannerAd).onError(t=>{console.error(t)}),t.onResize(i=>{this.banner_Height=i.height,this.banner_Width=i.width,t.style.top=e.screenHeight-this.banner_Height-this.margin_Bottom,t.style.width=i.width,t.style.left=(e.screenWidth-i.width)/2})}}initVideoAd(){if(this.adUnitId_Video)switch(this.platform){case a.wechat:this.rewardedVideoAd=wx.createRewardedVideoAd({adUnitId:this.adUnitId_Video});let i=this.rewardedVideoAd;i.onError(t=>{console.log(t)}),i.onClose(i=>{this.sendVideoData&&(this.sendVideoData.ad_id=3,b.sendEvent(10002,this.sendVideoData)),i.isEnded?(this.sendVideoData&&(this.sendVideoData.ad_id=4,b.sendEvent(10002,this.sendVideoData)),this.video_OnClose_Callback&&this.video_OnClose_Callback(),this.showVideoEventId&&(this.showVideoEventId=0)):this.showVideoEventId&&(this.showVideoEventId=0),this.video_OnClose_Callback=null,this.sendVideoData=null,e.event(t.VideoAdClosed,i.isEnded)});break;case a.qq:this.rewardedVideoAd=qq.createRewardedVideoAd({adUnitId:this.adUnitId_Video});let s=this.rewardedVideoAd;s.onError(t=>{console.log(t)}),s.onClose(t=>{t.isEnded?(this.video_OnClose_Callback&&this.video_OnClose_Callback(),qq.aly&&window.videoPosition&&(qq.aly.videoDot(window.videoPosition,"success"),window.videoPosition=void 0)):qq.aly&&window.videoPosition&&(qq.aly.videoDot(window.videoPosition,"fail"),window.videoPosition=void 0),this.video_OnClose_Callback=null});break;case a.tt:this.rewardedVideoAd=tt.createRewardedVideoAd({adUnitId:this.adUnitId_Video}),this.rewardedVideoAd.onError(t=>{console.log(t)});break;case a.oppo:this.rewardedVideoAd&&(this.rewardedVideoAd.destroy(),this.rewardedVideoAd=null),this.rewardedVideoAd=qg.createRewardedVideoAd({adUnitId:this.adUnitId_Video});let n=this.rewardedVideoAd;n.onError(t=>{console.error(t),qg.showToast({title:"视频广告加载失败",icon:"none"})}),n.onClose(t=>{t.isEnded&&this.video_OnClose_Callback&&this.video_OnClose_Callback()}),n.onLoad(()=>{n.show()});break;case a.vivo:this.rewardedVideoAd=qg.createRewardedVideoAd({posId:this.adUnitId_Video});let o=this.rewardedVideoAd;o.onError(t=>{console.error(t),qg.showToast({title:"视频广告加载失败",icon:"none"})}),o.onClose(t=>{o.load(),t.isEnded&&this.video_OnClose_Callback&&this.video_OnClose_Callback(),Laya.SoundManager.musicMuted=!1}),o.onLoad(()=>{})}}initVideoAdMap(){if(this.platform==a.wechat)for(let i=0;i<this.adUnitId_VideoList.length;i++){let s=this.adUnitId_VideoList[i],a=wx.createRewardedVideoAd({adUnitId:s}),n=a;this.videoAdMap.set(s,a),n.onError(t=>{console.error(s,t)}),n.onClose(i=>{this.sendVideoData&&(this.sendVideoData.ad_id=3,b.sendEvent(10002,this.sendVideoData)),i.isEnded?(this.sendVideoData&&(this.sendVideoData.ad_id=4,b.sendEvent(10002,this.sendVideoData)),this.video_OnClose_Callback&&this.video_OnClose_Callback(),this.showVideoEventId&&(this.showVideoEventId=0)):this.showVideoEventId&&(this.showVideoEventId=0),this.video_OnClose_Callback=null,this.sendVideoData=null,e.event(t.VideoAdClosed,i.isEnded)})}}initAppBox(){if(this.adUnitId_AppBox){this.appBoxs=[];for(let t=0;t<this.adUnitId_AppBox.length;t++){let e=this.adUnitId_AppBox[t],i=qq.createAppBox({adUnitId:e});this.appBoxs.push(i)}}}initInterstitialAd(){if(this.adUnitId_Interstitial)switch(this.platform){case a.wechat:this.interstitialAd=wx.createInterstitialAd({adUnitId:this.adUnitId_Interstitial}),this.interstitialAd.onError(t=>{console.log(t)});break;case a.qq:this.interstitialAd=qq.createInterstitialAd({adUnitId:this.adUnitId_Interstitial});let t=this.interstitialAd;t.onError(t=>{console.error("qq插屏广告加载失败",t)}),t.onLoad(()=>{console.log("qq插屏广告加载成功")});break;case a.oppo:this.interstitialAd=qg.createInsertAd({adUnitId:this.adUnitId_Interstitial});let e=this.interstitialAd;e.onError(t=>{console.error("oppo插屏广告加载失败",t)}),e.onLoad(()=>{console.log("oppo插屏广告加载成功")})}}initNativeAd(){if(this.adUnitId_Native&&(this.platform==a.oppo||this.platform==a.vivo)){if(this.nativeAd.length>0){for(let t=0;t<this.nativeAd.length;t++)this.nativeAd.shift().destroy();this.nativeAdData.length=0,this.nativeAd.length=0}if(this.platform==a.oppo){this.reportShowPer.length=0,this.refreshNativeTimeDelay.length=0;for(let t=0;t<this.adUnitId_Native.length;t++){let e=this.adUnitId_Native[t],i=qg.createNativeAd({adUnitId:e});this.nativeAdData.push([]),i.onLoad(t=>{let i=this.adUnitId_Native.indexOf(e);console.log("oppo原生广告加载成功",i,e,JSON.stringify(t)),this.nativeAdData[i].push(...t.adList),console.log("原生广告列表",JSON.stringify(this.nativeAdData))}),i.onError(t=>{let i=this.adUnitId_Native.indexOf(e);console.error("oppo原生广告加载失败",i,e,JSON.stringify(t))}),this.nativeAd.push(i),this.loadNativeAd(t),this.reportShowPer.push(1),this.refreshNativeTimeDelay.push(0)}}else if(this.platform==a.vivo){this.reportShowPer.length=0,this.refreshNativeTimeDelay.length=0;for(let t=0;t<this.adUnitId_Native.length;t++){let i=t,s=this.adUnitId_Native[i];Laya.timer.once(5e3*i,this,()=>{let t=qg.createNativeAd({posId:s});this.nativeAd.push(t),this.nativeAdData.push([]),t.onLoad(t=>{let i=this.adUnitId_Native.indexOf(s);console.log("vivo原生广告加载成功",i,s,JSON.stringify(t)),this.nativeAdData[i].push(...t.adList),console.log("原生广告列表",JSON.stringify(this.nativeAdData)),e.event("NativeLoaded",i)}),t.onError(t=>{let e=this.adUnitId_Native.indexOf(s);console.error("vivo原生广告加载失败",e,s,JSON.stringify(t))}),this.loadNativeAd(i),this.reportShowPer.push(1),this.refreshNativeTimeDelay.push(0)})}}}}testNative(){Laya.timer.loop(this.testNativeTime,this,()=>{for(let t=0;t<this.nativeAdData.length;t++)0==this.nativeAdData[t].length&&this.loadNativeAd(t)})}loadNativeAd(t,e=!1){return new Promise(e=>{this.nativeAd[t].load(),e()})}haveNativeAd(t){}showNativeAd(t,i){this.isTestNative?Math.random()<.8?i&&i(this.nativeTestData):(console.log("测试没有拉到广告"),i&&i(null)):(t=t<this.nativeAd.length?t:0,this.loadNativeAd(t).then(()=>{e.offAll("NativeLoaded");let s=this.nativeAdData[t];for(let t=0;t<s.length;t++){let e=s[t];return void(i&&i(e))}i&&(i(null),e.once("NativeLoaded",this,e=>{if(t==e){let e=this.nativeAdData[t][0];i&&i(e)}}))}))}hideNativeAd(t,i){e.offAll("NativeLoaded")}reportNativeAdClick(t,e){t=t<this.nativeAd.length?t:0;let i=this.nativeAdData[t];if(console.log("原生广告索引",t,i),!i)return;let s=i.indexOf(e);console.log("reportNativeAdClick",s,e),-1!=s&&i.splice(s,1),this.reportNativeAdShow(t,e),this.nativeAd[t].reportAdClick({adId:e.adId})}reportNativeAdShow(t,e){t=t<this.nativeAd.length?t:0,this.platform==a.vivo?this.nativeAd[t].reportAdShow({adId:e.adId}):this.platform==a.oppo&&(this.nativeAd[t].reportAdShow({adId:e.adId}),this.reportShowTimeLeft--,Math.random()<this.secondReportPer&&(this.reportShowTimeLeft--,Laya.timer.once(1e4,this,()=>{this.nativeAd[t].reportAdShow({adId:e.adId})})),Math.random()<this.thirdReportPer&&(this.reportShowTimeLeft--,Laya.timer.once(2e4,this,()=>{this.nativeAd[t].reportAdShow({adId:e.adId})})))}updateReportShowTimeLeft(){Laya.timer.loop(1e3*this.pullTimeDelay,this,()=>{this.reportShowTimeLeft++})}showBannerAd(){if((this.bannerAd||this.platform!=a.oppo||!this.oppoShowBanner)&&!this.noAd&&!I.isOpen)switch(this.platform){case a.wechat:let t=this.bannerAd;t&&t.show();break;case a.qq:let e=this.bannerAd;e&&e.show();break;case a.tt:let i=this.bannerAd;i&&i.show();break;case a.oppo:let s=this.bannerAd;s&&s.show();break;case a.vivo:let n=this.bannerAd;n&&n.show()}}showVideoAd(t,e){let i=()=>{if(this.platform===a.editor||this.noAd)e&&e();else{if(this.rewardedVideoAd=this.videoAdMap.get(t),!this.rewardedVideoAd)return;switch(this.video_OnClose_Callback=e,this.platform){case a.wechat:this.sendVideoData&&b.sendEvent(10002,this.sendVideoData),this.rewardedVideoAd.show().catch(t=>{this.sendVideoData=null,this.showVideoEventId&&(this.showVideoEventId=0),console.log("微信视频播放失败原因",t),wx.showToast({icon:"none",title:"视频播放失败",duration:1500}),p.manualShare()});break;case a.qq:qq.aly&&window.videoPosition&&qq.aly.videoDot(window.videoPosition,"show"),this.rewardedVideoAd.show().catch(t=>{console.log("qq视频播放失败原因",t),window.videoPosition=void 0,qq.showToast({icon:"none",title:"视频播放失败",duration:1500})});break;case a.tt:let t=this.rewardedVideoAd;e&&t.onClose(t=>{t.isEnded&&e&&e()}),t.show().catch(t=>{});break;case a.oppo:this.rewardedVideoAd.load();break;case a.vivo:Laya.SoundManager.musicMuted=!0,this.rewardedVideoAd.show()}}};1==this.videoMode?i():L.openScene("pages/videoConfirm.scene",!1,!0,null,[i,e])}showAppBox(t){if(this.platform!=a.editor)switch(this.platform){case a.qq:let e=this.appBoxs[t];e.load().then(()=>{e.show()})}}showInterstitialAd(t){if(t&&this.platform===a.editor&&t(),this.interstitialAd||this.platform==a.vivo)switch(this.platform){case a.wechat:this.interstitialAd.show();break;case a.qq:this.interstitialAd.show();break;case a.oppo:let e=this.interstitialAd;e.onClose(()=>{e.load(),t&&t()}),e.show();break;case a.vivo:this.interstitialAd=qg.createInterstitialAd({posId:this.adUnitId_Interstitial});let i=this.interstitialAd;i.onError(t=>{console.error("vivo插屏广告加载失败",t),qg.showToast({title:"插屏广告加载失败",icon:"none"})}),i.onLoad(()=>{console.log("vivo插屏广告加载成功")}),i.show()}}hideBannerAd(){if(this.bannerAd&&(this.platform!=a.oppo||!this.oppoShowBanner))switch(this.platform){case a.wechat:this.bannerAd.hide();break;case a.qq:this.bannerAd.hide();break;case a.tt:this.bannerAd.hide();break;case a.oppo:this.bannerAd.hide();break;case a.vivo:this.bannerAd.hide()}}getCloseAd(){return this.isGD?0:w.Instance.closeAd}getSuperBtnPer(t){return this.isGD?0:w.Instance.superBtnPer[t]}clearSuperBtnPer(t){this.superBtnPer[t]=0}getDelayTime(){return this.isGD||!this.isShowNative?0:w.Instance.delayTime}compareVersion(t,e){t=t.split(".");const i=Math.max(t.length,e.length);for(;t.length<i;)t.push("0");for(;e.length<i;)e.push("0");for(let s=0;s<i;s++){const i=parseInt(t[s]),a=parseInt(e[s]);if(i>a)return 1;if(i<a)return-1}return 0}showCustomAd(t){if(!this.adUnitId_CustomAd||0==this.adUnitId_CustomAd.length||-1==this.adUnitId_CustomAd.indexOf(t))return;if(this.platform!=a.wechat||this.noAd)return;let e=this.customAdMap.get(t);e&&(e.show(),console.log("展示原生模板广告",e))}initSingleCustomAd(t,e){let i=this.customAdMap.get(t);i&&(i.destroy(),i=null,this.customAdMap.delete(t)),(i=wx.createCustomAd({adUnitId:t,adIntervals:30,style:e})).onLoad(()=>{console.log(t,"原生模板广告加载成功")}),i.onError(e=>{console.error(t,"原生模板广告出错",e)}),this.customAdMap.set(t,i)}hideCustomAd(t){if(!this.adUnitId_CustomAd||0==this.adUnitId_CustomAd.length||-1==this.adUnitId_CustomAd.indexOf(t))return;if(this.platform!=a.wechat||this.noAd)return;let e=this.customAdMap.get(t);e&&e&&e.hide()}isForceTouch(){if(Math.random()<this.forceTouchSwitch){if(-1!=this.forceTouchWhiteList.indexOf(B.instance.scene)){let t=(new Date).getDay();if(t>=1&&t<=5){let t=S.dateFormat("yyyy-mm-dd",new Date),e=t+" "+this.forceTouchOpenTime[0],i=t+" "+this.forceTouchOpenTime[1];return!S.isDuringDate(e,i)}return!0}return!1}return!1}}class x extends i.pages.catchUI{constructor(){super(...arguments),this.monsterId=-1,this.monsterData=null,this.progressMask=new Laya.Image,this.catchRate=0,this.isVideoCatchBoss=!1,this.closeHandler=null}onAwake(){this.width=Laya.stage.width,this.height=Laya.stage.height,this.perLabel.filters=[x.blackColorFilter],this.progressMask.skin="count/Ui_CatchTiao3.png",this.progressMask.sizeGrid="0,5,0,5",this.progressMask.width=0,this.progressBar.mask=this.progressMask,this.catchBossBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.quitCatchBossBtn.on(Laya.Event.CLICK,this,this.onBtnClick),e.on(t.StartCatch,this,this.onStartCatch),e.on(t.UpdateProgress,this,this.onUpdateProgress),e.on(t.CatchEnd,this,this.onCatchEnd),this.setBtnVideoTag()}onDestroy(){e.off(t.StartCatch,this,this.onStartCatch),e.off(t.UpdateProgress,this,this.onUpdateProgress),e.off(t.CatchEnd,this,this.onCatchEnd)}onStartCatch(){B.instance.gameRank<=1&&this.catchRate<100&&(this.catchRate=Math.floor(this.catchRate/2)),(B.instance.isFirstCatch||this.isVideoCatchBoss||100*Math.random()<this.catchRate)&&(C.Instance.isCatch=!0),B.instance.isFirstCatch&&(B.instance.isFirstCatch=!1,B.instance.onDataChange("isFirstCatch")),this.visible=!1}initCatchData(i){p.stopMusic(),this.isVideoCatchBoss=i,this.monsterId=C.Instance.catchMonsterId,this.monsterData=C.Instance.catchMonsterData,this.catchBossBtn.visible=i,this.quitCatchBossBtn.visible=i,this.catchProgressBg.visible=!i,this.catchInfoBg.visible=!i,this.isVideoCatchBoss||(this.starLabel.text=this.monsterData.level+"",this.catchRate=C.Instance.getMonsterCatchRate(this.monsterId,C.Instance.isBoss),this.setCatchPer(this.catchRate),B.instance.finishTask(1,1,1),100==this.catchRate&&e.event(t.BallStartCatch))}setCatchPer(t){let e=Laya.Handler.create(this,()=>{this.perLabel.text=Math.floor(this.progressMask.width/456*100)+"%"},null,!1);Laya.Tween.to(this.progressMask,{width:t/100*456,update:e},200,Laya.Ease.sineOut)}setProgress(t){this.progressMask2.graphics.clear(),this.progressMask2.graphics.drawPie(161,161,170,135,135+271*t,"#ff0000","#ff0000",0)}onUpdateProgress(t){this.setProgress(t)}onCatchEnd(){this.popCatchResult()}popCatchResult(){Laya.timer.once(500,this,()=>{if(this.isVideoCatchBoss){let t=Laya.Handler.create(this,()=>{this.closeHandler&&this.closeHandler.run(),this.closeHandler=null}),e=[C.Instance.isCatch,C.Instance.catchMonsterId,C.Instance.catchMonsterData,!1,5];L.openScene("pages/catchResult.scene",!0,!0,t,e)}else{let t=[C.Instance.isCatch,C.Instance.catchMonsterId,C.Instance.catchMonsterData,!0,1];L.openScene("pages/catchResult.scene",!0,!0,null,t)}})}onBtnClick(i){i.target==this.catchBossBtn?w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{e.event(t.BallStartCatch)}):i.target==this.quitCatchBossBtn&&(this.visible=!1,this.closeHandler&&this.closeHandler.run(),this.closeHandler=null)}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}x.blackColorFilter=new Laya.ColorFilter([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0]);class k extends i.pages.superEvaUI{constructor(){super(...arguments),this.maxPage=0,this.curPageIndex=0,this.cardDataList=[],this.cardStateList=[],this.mixMonsterId=-1,this.haveMonsterNum=0,this.cost=0,this.curTabIndex=-1,this.dayUnlockStartIndex=3}onAwake(){this.updateTryState(),this.monsterList.hScrollBarSkin=null,this.stateList.hScrollBarSkin=null,this.maxPage=k.superEvaDataList.length-1;for(let t=0;t<3;t++)this.cardDataList.push(new y),this.cardStateList.push({missTag:{visible:!1},getBtn:{visible:!1},haveTag:{visible:!1},videoTag:{visible:!1}});this.monsterNameLabel.filters=[x.blackColorFilter],this.starNumLabel.filters=[x.blackColorFilter],this.hpLabel.filters=[x.blackColorFilter],this.atkLabel.filters=[x.blackColorFilter],this.setSelectTab(0),e.on(I.InnerTaskStart,this,this.onInnerTaskStart),Laya.Dialog.manager.maskLayer.alpha=.9,this.setBtnVideoTag(1)}onOpened(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.superBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.leftBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.rightBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.dayUnlockTabBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.stageUnlockTabBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.receiveWelfareBtn.on(Laya.Event.CLICK,this,this.onBtnClick),w.Instance.showBannerAd(),w.Instance.sendVideoData={page_id:7,button_id:7,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData),this.speedBtn.on(Laya.Event.CLICK,this,this.onBtnClick)}onClosed(){w.Instance.hideBannerAd(),Laya.Dialog.manager.maskLayer.alpha=UIConfig.popupBgAlpha}onDestroy(){e.off(I.InnerTaskStart,this,this.onInnerTaskStart)}onMouseHandler(i,s){if(s.type==Laya.Event.CLICK){if(!this.lastMonsterHave())return void e.event(t.PopTip,"究极进化上一级");w.Instance.sendVideoData={page_id:7,button_id:7,ad_id:2,ad_type:1},w.Instance.showVideoAd("adunit-eb988867c0754d81",()=>{let t=C.Instance.getMonsterData([this.cardDataList[i].monsterId])[0];L.openScene("pages/catchResult.scene",!1,!0,Laya.Handler.create(this,()=>{this.setPageData(this.curPageIndex)}),[!0,this.cardDataList[i].monsterId,t,!1,3])})}}onBtnClick(i){if(i.target==this.closeBtn)I.finishInnerTask("关闭究极进化"),this.close();else if(i.target==this.speedBtn)w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{B.instance.speedUpTimeRec[this.curPageIndex]++,B.instance.onDataChange("speedUpTimeRec"),this.setPageData(this.curPageIndex)});else if(i.target==this.superBtn)if(3==this.haveMonsterNum)if(B.instance.gold>=this.cost){if(!this.lastMonsterHave())return void e.event(t.PopTip,"究极进化上一级");B.instance.gold-=this.cost,e.event(t.UseMoney,"gold"),B.instance.onDataChange("gold"),b.sendEvent(10005,{item_type:1,item_id:1,get_num:-1*this.cost,get_type:11,last_num:B.instance.gold});for(let t=0;t<this.cardDataList.length;t++)for(let e=0;e<B.instance.cardList.length;e++)if(this.cardDataList[t].monsterId==B.instance.cardList[e].monsterId){let t=B.instance.cardList.splice(e,1)[0];B.instance.removeCard(t,11);break}let i=C.Instance.getMonsterData([this.mixMonsterId])[0];e.event(t.PopTip,"合成成功"),p.playSound("composeSuccess.mp3"),B.instance.finishTask(0,2,1),L.openScene("pages/catchResult.scene",!1,!0,Laya.Handler.create(this,()=>{this.setPageData(this.curPageIndex),e.event(t.UpdateSuperRed),e.event(t.UpdateComposeRed)}),[!0,this.mixMonsterId,i,!1,9])}else L.openScene("pages/addMoney.scene",!1,!0,null,[2,200]),e.event(t.ShowGiftPack);else e.event(t.PopTip,"条件不满足");else if(i.target==this.leftBtn){let t=0;1==this.curTabIndex&&(t=3),this.curPageIndex>t&&this.setPageData(--this.curPageIndex)}else if(i.target==this.rightBtn){let t=2;1==this.curTabIndex&&(t=this.maxPage),this.curPageIndex<t&&this.setPageData(++this.curPageIndex)}else i.target==this.receiveWelfareBtn?w.Instance.showVideoAd("adunit-eb988867c0754d81",()=>{let i=this.getTryState(this.curPageIndex),s=C.Instance.getOneCardData(this.mixMonsterId),a=C.Instance.monsterData[s.monsterId];0==i?L.openScene("pages/catchResult.scene",!1,!0,Laya.Handler.create(this,()=>{this.setPageData(this.curPageIndex)}),[!0,this.mixMonsterId,a,!1,7]):2==i&&L.openScene("pages/catchResult.scene",!1,!0,Laya.Handler.create(this,()=>{this.setPageData(this.curPageIndex),e.event(t.UpdateSuperRed),e.event(t.UpdateComposeRed)}),[!0,this.mixMonsterId,a,!1,8])}):i.target==this.dayUnlockTabBtn?this.setSelectTab(1):i.target==this.stageUnlockTabBtn&&this.setSelectTab(0)}setPageData(t){k.superEvaIndex=t,this.curPageIndex=t;let e=k.superEvaDataList[t].specialMixId,i=C.Instance.specialMixConfig[e];this.mixMonsterId=i.index,this.monsterImage.skin=`monster/Ui_Monster${this.mixMonsterId}.png`,this.monsterNameLabel.text=C.Instance.monsterData[this.mixMonsterId].name,this.speedBtn.visible=!1,this.unlockInfoBg.visible=!1;let s=C.Instance.getOneCardData(this.mixMonsterId);if(this.hpLabel.text=s.hp+"",this.atkLabel.text=s.atk+"",this.starNumLabel.text=s.star+"",this.isTrueHaveMonster())this.partBg.visible=!1,this.superBtn.visible=!1,this.haveTag.visible=!0;else{let e=k.superEvaDataList[t];if(1==e.type){if(B.instance.gameRank<e.value)return this.partBg.visible=!1,this.superBtn.visible=!1,this.haveTag.visible=!1,this.unlockInfoBg.visible=!0,this.unlockDatLeftLabel.text=e.value+"",this.unlockInfoBg.skin="changeAdd1/Ui_FrameComposeDay2.png",this.updateArrowBtn(),void this.updateWelfare()}else{let e=this.getDayLeft(t);if(e>0)return this.partBg.visible=!1,this.superBtn.visible=!1,this.haveTag.visible=!1,this.unlockInfoBg.visible=!0,this.unlockDatLeftLabel.text=e+"",this.unlockInfoBg.skin="changeAdd1/Ui_FrameComposeDay.png",this.speedBtn.visible=!0,this.updateArrowBtn(),void this.updateWelfare()}this.partBg.visible=!0,this.superBtn.visible=!0,this.haveTag.visible=!1,this.cost=2e3*(this.curPageIndex+1),this.moneyLabel.text=this.cost+"";for(let t=0;t<3;t++)this.cardDataList[t]=C.Instance.getOneCardData(i.mixIndex[t]);this.haveMonsterNum=0;let s=[...i.mixIndex],a=[0,0,0];for(let t=0;t<B.instance.cardList.length;t++){let e=B.instance.cardList[t],i=s.indexOf(e.monsterId);if(-1!=i&&(s[i]=-1,a[i]=1,this.haveMonsterNum++,this.haveMonsterNum==s.length))break}for(let t=0;t<a.length;t++){let e=this.cardStateList[t];a[t]?(e.missTag.visible=!1,e.getBtn.visible=!1,e.haveTag.visible=!0,e.videoTag.visible=!1):(e.missTag.visible=!0,e.getBtn.visible=!0,e.haveTag.visible=!1,e.videoTag.visible=!0)}this.monsterList.array=this.cardDataList,this.monsterList.refresh(),this.stateList.array=this.cardStateList,this.stateList.refresh();for(let t=0;t<this.stateList.length;t++){let e=this.stateList.getCell(t).getChildByName("getBtn");e.hasListener(Laya.Event.CLICK)||e.on(Laya.Event.CLICK,this,this.onMouseHandler,[t])}this.setBtnVideoTag(2)}this.updateArrowBtn(),this.updateWelfare()}updateArrowBtn(){let t=0,e=0;0==this.curTabIndex?(t=2,e=this.curPageIndex):1==this.curTabIndex&&(t=3,e=this.curPageIndex-3),0==t?(this.leftBtn.alpha=.5,this.rightBtn.alpha=.5):0==e?(this.leftBtn.alpha=.5,this.rightBtn.alpha=1):e==t?(this.leftBtn.alpha=1,this.rightBtn.alpha=.5):(this.leftBtn.alpha=1,this.rightBtn.alpha=1)}static haveRed(){if(B.instance.gameRank>=C.Instance.openSuperEvaRank){for(let t=0;t<this.superEvaDataList.length;t++){let e=k.superEvaDataList[t].specialMixId,i=C.Instance.specialMixConfig[e],s=i.index;if(!C.Instance.haveMonster(s)){if(this.haveMixList([...i.mixIndex]))return!0}}return!1}return!1}static haveMixList(t){for(let e=0;e<B.instance.cardList.length;e++){let i=B.instance.cardList[e],s=t.indexOf(i.monsterId);if(-1!=s&&(t.splice(s,1),0==t.length))return!0}return!1}getDayLeft(t){let e=k.superEvaDataList[t],i=Date.now(),s=Math.floor((i-B.instance.registerTimestamp)/864e5);return e.value-s-B.instance.speedUpTimeRec[t]}onInnerTaskStart(t){"关闭究极进化"==t&&I.startInnerTask(t,[{node:this.closeBtn,isHandNode:!0}])}updateWelfare(){if(this.getSuperEvaUnlockState(this.curPageIndex).unlock){let t=this.getTryState(this.curPageIndex);C.Instance.haveMonster(this.mixMonsterId)?t>0&&0==B.instance.tryCardDataList[this.curPageIndex].isLose?this.welfareBg.visible=!1:-1!=B.instance.tryCardDataList[this.curPageIndex].monsterId&&B.instance.tryCardDataList[this.curPageIndex].isTryGet?(this.welfareBg.visible=!0,this.welfareBg.skin="ad/Ui_FrameFuLi3.png",this.receiveWelfareBtn.visible=!1):this.welfareBg.visible=!1:0==t?(this.welfareBg.visible=!0,this.welfareBg.skin="ad/Ui_FrameFuLi1.png",this.receiveWelfareBtn.visible=!0):(this.welfareBg.visible=!0,this.welfareBg.skin="ad/Ui_FrameFuLi2.png",this.receiveWelfareBtn.visible=!0)}else this.welfareBg.visible=!1}getSuperEvaUnlockState(t){let e=k.superEvaDataList[t],i={type:e.type,unlock:!0};if(1==e.type)B.instance.gameRank<e.value&&(i.unlock=!1);else{this.getDayLeft(t)>0&&(i.unlock=!1)}return i}getTryState(t){if(-1!=B.instance.tryCardDataList[t].monsterId){let e=Date.now()-B.instance.tryCardDataList[t].timestamp;return e<=864e5?1:e<=1728e5?2:3}return 0}updateTryState(){for(let t=0;t<B.instance.tryCardDataList.length;t++){if(2==this.getTryState(t)){B.instance.tryCardDataList[t].isLose=!0;for(let e=0;e<B.instance.cardList.length;e++)if(B.instance.cardList[e].cardId==B.instance.tryCardDataList[t].cardId){B.instance.cardList.splice(e,1);break}}}B.instance.onDataChange("tryCardData"),B.instance.onDataChange("cardList")}setSelectTab(t){t!=this.curTabIndex&&(this.curTabIndex=t,0==t?(this.stageUnlockTabBtn.alpha=1,this.stageUnlockTabBtn.scaleX=1,this.stageUnlockTabBtn.scaleY=1,this.dayUnlockTabBtn.alpha=.8,this.dayUnlockTabBtn.scaleX=.8,this.dayUnlockTabBtn.scaleY=.8,this.setPageData(0)):(this.dayUnlockRed.visible=!1,this.dayUnlockTabBtn.alpha=1,this.dayUnlockTabBtn.scaleX=1,this.dayUnlockTabBtn.scaleY=1,this.stageUnlockTabBtn.alpha=.8,this.stageUnlockTabBtn.scaleX=.8,this.stageUnlockTabBtn.scaleY=.8,this.setPageData(this.dayUnlockStartIndex)))}lastMonsterHave(){if(this.curPageIndex<=2&&0==this.curPageIndex||this.curPageIndex>=3&&3==this.curPageIndex)return!0;{let t=k.superEvaDataList[this.curPageIndex-1].specialMixId,e=C.Instance.specialMixConfig[t];return C.Instance.haveMonster(e.index)}}isTrueHaveMonster(){return!!C.Instance.haveMonster(this.mixMonsterId)&&!(-1!=B.instance.tryCardDataList[this.curPageIndex].monsterId&&!B.instance.tryCardDataList[this.curPageIndex].isLose)}setBtnVideoTag(t){let e=1==w.Instance.videoMode;if(1==t)this.videoTag1.visible=e,this.videoTag2.visible=e;else for(let t=0;t<this.stateList.length;t++){this.stateList.getCell(t).getChildByName("videoTag").visible=e}}}k.superEvaIndex=0,k.superEvaDataList=[{type:1,value:1,specialMixId:0},{type:1,value:2,specialMixId:1},{type:1,value:3,specialMixId:2},{type:2,value:1,specialMixId:6},{type:2,value:2,specialMixId:3},{type:2,value:3,specialMixId:4},{type:2,value:4,specialMixId:5}];class B{constructor(){this.guideRecord=[],this.expedition=[0,0,0,0,0,0,0,0],this.isFirstSelect=0,this.isFirstTreasureBox=!0,this.isFirstCatch=!0,this.isFirstDie=!0,this.diamond=0,this.gold=10,this.chip=0,this.badge=0,this.gameRank=0,this.gameAllPass=!1,this.eliteGameRank=0,this.eliteGameAllPass=!1,this.registerTimestamp=0,this.speedUpTimeRec=[0,0,0,0,0,0,0],this.niuDanLeftTime=4,this.niuDanSuperLeftTime=10,this.niuDanSuperBag=[],this.niuDanTimestamp=0,this.catchBossRec={timestamp:0,bossId:-1},this.niuDanUpdateTimestamp=0,this.collectStage=0,this.collectReceived=0,this.cardList=[],this.catchTimeRec={},this.pictureCollectList={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[]},this.creamPictureCollectList={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[]},this.stageCollectObj={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[]},this.creamStageCollectObj={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[]},this.fightCardList=[null,null,null],this.expeditionCardList=[[null,null,null],[null,null,null],[null,null,null],[null,null,null],[null,null,null],[null,null,null],[null,null,null],[null,null,null]],this.collectMonsterIdList=[],this.cardId=1,this.level=1,this.playLevel=1,this.isFull=0,this.playerID=0,this.playerUnlock=[1,0,0,0,0],this.weaponID=0,this.weaponType=0,this.weaponUnlock=[[1,0,0],[0,0,0],[0,0,0]],this.weaponLevel=[0,0,0,0,0],this.propNum=[0,0,0,0],this.freeLotteryTimestamp=0,this.freeLotteryTimeLeft=1,this.lotteryTime=0,this.signDay=0,this.signTimestamp=0,this.signRec=[0,0,0,0,0,0,0],this.dayTaskRefreshTimestamp=0,this.dayTaskId=[0,0,0],this.dayTaskCountRec=[0,0,0],this.dayTaskReceiveRec=[0,0,0],this.achieveTaskCountRec=[0,0,0,0,0],this.achieveTaskReceiveRec=[0,0,0,0,0],this.achieveTaskStage=[0,0,0,0,0],this.roleQualityList=[1,1,1,1,1],this.warriorLevelList=[1,1,1,1,1],this.buildingLevelList=[1,1,1,1],this.divisionRewardState=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],this.upTicket=0,this.fishStage=[3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.strengthLevel=1,this.strengthStage=[0,0,0,0,0],this.winCount=0,this.dayWinCount=0,this.seasonStartTimeStamp=0,this.matchCount=0,this.isReceiveNew=0,this.unlockSystem={compose:!0,star:!0,group:!0,challenge:!0,pk:!0},this.challengeLevel=[1,1],this.highestChallengeLevel=null,this.isSucceed=!1,this.refreshChallengeTime=0,this.allPassChallenge=!1,this.shopBuyRecord={},this.giftPackBuyRecord={},this.fightTicket=0,this.expeditionReward=[0,0,0,0,0,0,0,0],this.expeditionTimeLeftList=[3,3,3,3,3,3,3,3],this.expeditionRefreshTime=0,this.luckPackLeftTime=3,this.luckPackUpdateTimestamp=0,this.unlockSystem1={star:!1,elite:!1},this.superEggPlayTime=0,this.isFirstOpenEggShop=!0,this.countPopEggLeftTime=8,this.fightPosUnlock=[!0,!1,!1],this.tryCardDataList=[],this.scene=0,this.dayLoginTime=0,this.lastLoginTimestamp=0,this.challengeRewardReceiveList=[],this.challengeExtraRewardReceiveList=[],this.pvpRewardBoxReceiveList=[0,0,0,0,0],this.speedBuff=1,this.freeCure=!1,this.freeAutoFight=!1,this.noAd=!1,this.shareHandBookTime=0,this.receiveShareRewardTime=0,this.shareRewardObj={}}static get instance(){if(!B._instance){let t=Laya.LocalStorage.getItem(B._name);t&&(t=JSON.parse(t)),B._instance=new B,B._instance.init(t)}return B._instance}init(t=null){this.updateData(t),this.parseCardData(),this.updateRegisterTimestamp(),this.updateSign(),this.updateDayTask(),this.updateDivisonSeason(),this.updateDivisonDay(),this.updateNiuDan(),this.refreshChallengeData(),this.updateUUID(),this.updateRegisterTime(),this.updateLuckPack(),this.updateExpeditionTimeLeftList(),this.updateScene(),this.updateGiftPackBuyRecord(),this.updateShareHandBookTime(),this.updateReceiveShareRewardTime(),this.updateShopBuyRecord(),this.updateDayLoginTime(),this.initTryCardDataList(),window.UserData=this}updateData(t){if(t)for(const e in this)t.hasOwnProperty(e)&&(this[e]=t[e])}onDataChange(t){if(-1==B.ChangeKeyList.indexOf(t)&&B.ChangeKeyList.push(t),B._id){let e={};e[t]=this[t],f.update("usersinfo",B._id,e).then(t=>{console.log(t)}).catch(t=>{console.error(t)})}Laya.timer.frameOnce(1,this,this.sendDataChangeEvent)}sendDataChangeEvent(){Laya.LocalStorage.setItem(B._name,JSON.stringify(this));for(let t=0;t<B.ChangeKeyList.length;t++)e.event(B.UserDataChange,B.ChangeKeyList[t]);B.ChangeKeyList.length=0}finishTask(t,e,i){0==t?(this.dayTaskCountRec[e]+=i,this.onDataChange("dayTaskCountRec")):(this.achieveTaskCountRec[e]+=i,this.onDataChange("achieveTaskCountRec"))}updateRegisterTimestamp(){0==this.registerTimestamp&&(this.registerTimestamp=Date.now(),this.onDataChange("registerTimestamp"))}updateSign(){if(this.signTimestamp>0){Date.now()-this.signTimestamp>864e5&&1==this.signRec[this.signDay]&&(this.signDay++,7==this.signDay&&(this.signDay=0,this.signRec=[0,0,0,0,0,0,0]),this.onDataChange("signDay"),this.onDataChange("signRec"))}}updateDayTask(){let t=Date.now();if(t-this.dayTaskRefreshTimestamp>864e5){this.dayTaskRefreshTimestamp=t,this.dayTaskId=[],this.dayTaskCountRec=[],this.dayTaskReceiveRec=[];for(let t=0;t<3;t++)this.dayTaskCountRec.push(0),this.dayTaskReceiveRec.push(0);this.onDataChange("dayTaskRefreshTimestamp"),this.onDataChange("dayTaskId"),this.onDataChange("dayTaskCountRec"),this.onDataChange("dayTaskReceiveRec")}}updateNiuDan(){let t=Date.now();0!=this.niuDanUpdateTimestamp?t-this.niuDanUpdateTimestamp>864e5&&(this.niuDanLeftTime=4,this.niuDanSuperLeftTime=10,this.niuDanTimestamp=0,this.niuDanUpdateTimestamp=t,this.onDataChange("niuDanLeftTime"),this.onDataChange("niuDanSuperLeftTime"),this.onDataChange("niuDanTimestamp"),this.onDataChange("niuDanUpdateTimestamp")):(this.niuDanUpdateTimestamp=t,this.onDataChange("niuDanUpdateTimestamp"))}updateDivisonSeason(){0==this.seasonStartTimeStamp&&(this.seasonStartTimeStamp=Date.now(),this.onDataChange("seasonStartTimeStamp"),this.winCount=0,this.onDataChange("winCount"),this.divisionRewardState=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],this.onDataChange("divisionRewardState"))}updateDivisonDay(){0==this.seasonStartTimeStamp&&(this.seasonStartTimeStamp=Date.now(),this.onDataChange("seasonStartTimeStamp"),this.winCount=0,this.onDataChange("winCount"),this.divisionRewardState=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],this.onDataChange("divisionRewardState"))}addCard(t,e,i,s){let a=C.Instance.getOneCardData(t);if(s&&(a.atk=s.atk,a.hp=a.curHp=s.hp),a.cardId=this.getOneCardId(),e){let t=Math.round(Math.max(5,.1*a.curHp));a.curHp+=t,a.hp+=t}let n={item_type:2,item_id:t+1001,get_num:1,get_type:i,last_num:0,extra1:C.Instance.monsterData[t].level,extra2:0};return-1==this.collectMonsterIdList.indexOf(t)&&(-1==C.Instance.newMonsterIdList.indexOf(t)&&C.Instance.newMonsterIdList.push(t),this.collectMonsterIdList.push(t),this.onDataChange("collectMonsterIdList"),this.finishTask(1,0,1),n.extra2=1),this.finishTask(0,0,1),this.cardList.push(a),this.onDataChange("cardList"),n.last_num=this.getMonsterIdNum(t),b.sendEvent(10005,n),a}getMonsterIdNum(t){let e=0;for(let i=0;i<this.cardList.length;i++)this.cardList[i].monsterId==t&&e++;return e}removeCard(t,e){let i={item_type:2,item_id:t.monsterId+1001,get_num:-1,get_type:e,last_num:0,extra1:C.Instance.monsterData[t.monsterId].level,extra2:0};i.last_num=this.getMonsterIdNum(t.monsterId),b.sendEvent(10005,i)}getOneCardId(){let t=this.cardId;return this.cardId++,this.onDataChange("cardId"),t}parseCardData(){for(let t=0;t<this.cardList.length;t++)this.cardList[t]=new y(this.cardList[t]);for(let t=0;t<this.fightCardList.length;t++)this.fightCardList[t]&&(this.fightCardList[t]=new y(this.fightCardList[t]))}refreshChallengeData(){let t=S.isSameDay(new Date(this.refreshChallengeTime),new Date);0!=this.refreshChallengeTime&&t||(this.highestChallengeLevel&&1!=this.compareLevel(this.challengeLevel,this.highestChallengeLevel)||(this.highestChallengeLevel=this.challengeLevel,this.isSucceed=!1,this.onDataChange("highestChallengeLevel"),this.onDataChange("isSucceed")),this.challengeLevel=[1,1],this.onDataChange("challengeLevel"),this.refreshChallengeTime=Date.now(),this.onDataChange("refreshChallengeTime"),this.challengeRewardReceiveList=[],this.onDataChange("challengeRewardReceiveList"),this.challengeExtraRewardReceiveList=[],this.onDataChange("challengeExtraRewardReceiveList"),C.Instance.uploadChallengeRankScore())}compareLevel(t,e){return t[0]>e[0]||t[0]==e[0]&&t[1]>e[1]?1:t[0]==e[0]&&t[1]==e[1]?0:-1}refreshExpeditionData(){for(let t=0;t<B.instance.expedition.length;t++){let e=B.instance.expedition[t],i=t;if(0!=e){let s=C.Instance.eliteStageConfig[i].expeditionTime;if(Date.now()-e>=3600*s*1e3){let e=0,i=this.expeditionCardList[t];for(let t=0;t<i.length;t++){let s=i[t];s&&(e+=s.star)}let s=0;s=e<=5?.15:e<=10?.3:e<=20?.5:.7,Math.random()<s?this.expeditionReward[t]=2:this.expeditionReward[t]=1,this.expeditionCardList[t]=[null,null,null],this.expedition[t]=0}}}this.onDataChange("expeditionReward"),this.onDataChange("expeditionCardList"),this.onDataChange("expedition")}updateUUID(){this.uuid||(this.uuid=S.generateUUID(),this.onDataChange("uuid"))}updateRegisterTime(){this.registerTime||(this.registerTime=Date.now(),this.onDataChange("registerTime"))}updateLuckPack(){let t=Date.now();0!=this.luckPackUpdateTimestamp?t-this.luckPackUpdateTimestamp>864e5&&(this.luckPackLeftTime=3,this.luckPackUpdateTimestamp=t,this.onDataChange("luckPackUpdateTimestamp"),this.onDataChange("luckPackLeftTime")):(this.luckPackUpdateTimestamp=t,this.onDataChange("luckPackUpdateTimestamp"))}updateExpeditionTimeLeftList(){let t=Date.now();this.expeditionRefreshTime?t-this.expeditionRefreshTime>864e5&&(this.expeditionTimeLeftList=[3,3,3,3,3,3,3,3],this.expeditionRefreshTime=t,this.onDataChange("expeditionRefreshTime"),this.onDataChange("expeditionTimeLeftList")):(this.expeditionRefreshTime=t,this.onDataChange("expeditionRefreshTime"))}updateScene(){0==this.scene&&"undefined"!=typeof wx&&(this.scene=wx.getLaunchOptionsSync().scene,this.onDataChange("scene"))}updateDayLoginTime(){S.DateDiff(this.lastLoginTimestamp,Date.now())>0&&(this.dayLoginTime=0),this.dayLoginTime++,this.onDataChange("dayLoginTime"),this.lastLoginTimestamp=Date.now(),this.onDataChange("lastLoginTimestamp")}initTryCardDataList(){if(0==this.tryCardDataList.length){for(let t=0;t<k.superEvaDataList.length;t++)this.tryCardDataList.push({cardId:0,timestamp:0,monsterId:-1,isLose:!1,isTryGet:!1});this.onDataChange("tryCardDataList")}}updateShopBuyRecord(){let t=Date.now();S.DateDiff(this.lastLoginTimestamp,t)>0&&(this.shopBuyRecord={},this.onDataChange("shopBuyRecord"))}updateGiftPackBuyRecord(){let t=Date.now();S.DateDiff(this.lastLoginTimestamp,t)>0&&(this.giftPackBuyRecord[29]=0,this.onDataChange("giftPackBuyRecord"))}updateShareHandBookTime(){let t=Date.now();S.DateDiff(this.lastLoginTimestamp,t)>0&&(this.shareHandBookTime=0,this.onDataChange("shareHandBookTime"))}updateReceiveShareRewardTime(){let t=Date.now();S.DateDiff(this.lastLoginTimestamp,t)>0&&(this.receiveShareRewardTime=0,this.onDataChange("receiveShareRewardTime"))}}B._name="UserData",B.ChangeKeyList=[],B.UserDataChange="UserDataChange";class b{constructor(){}static init(){null==b._instance&&(b._instance=new b),window.TongYiEventManager=b._instance}static sendEvent(t,e){let i={event:t,game_id:"ZYXLS",game_name:"ZYXLS",play_id:B.instance.uuid,event_date:Math.floor(Date.now()/1e3*60)};for(const t in e)i[t]=e[t];u.send("https://ebk.17u.cn/noveladmin/api/game/event/log","post",{msg:JSON.stringify(i)},t=>{console.log(t)})}}b._instance=null;class T extends i.pages.addMoneyUI{constructor(){super(...arguments),this.money=200}onAwake(){this.goldLabel.filters=[x.blackColorFilter],this.setBtnVideoTag()}onOpened(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.getBtn.on(Laya.Event.CLICK,this,this.onBtnClick),w.Instance.showBannerAd(),w.Instance.sendVideoData={page_id:1,button_id:1,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData)}onClosed(){w.Instance.hideBannerAd()}setParam(t,e){this.money=[200,300,400,450,500,550,600,700][B.instance.gameRank],this.goldLabel.text="X"+this.money,1==t?(this.title1.visible=!0,this.title2.visible=!1,this.moneyBg.y=-261):(this.title1.visible=!1,this.title2.visible=!0,this.moneyBg.y=-243)}onBtnClick(i){i.target==this.closeBtn?this.close():i.target==this.getBtn&&(w.Instance.sendVideoData={page_id:1,button_id:1,ad_id:2,ad_type:1},w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{B.instance.gold+=this.money,B.instance.onDataChange("gold"),e.event(t.AddMoney,["gold",this.money])}))}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class M extends i.pages.askForCardUI{onAwake(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.askBtn.on(Laya.Event.CLICK,this,this.onBtnClick)}onBtnClick(t){t.target==this.askBtn?L.openScene("pages/selectShareFriend.scene",!1,!0,null,[this.monsterIdIndex],!1):t.target==this.closeBtn&&this.close()}setParam(t){let e=C.Instance.askForCardList,i=e.indexOf(t.monsterId);-1==i&&(i=e.length-1),this.monsterIdIndex=i;let s=e[i],a=C.Instance.getOneCardData(s);this.card.dataSource=a}}class D extends i.pages.cardBagUI{constructor(){super(...arguments),this.curPage=0,this.maxPage=0,this.panelDownX=0,this.isUpTrigger=!1,this.cardPageDataList=[],this.cardDataList=[],this.isShowStoreEgg=!1,this.exceptFunc=null,this.canSelectFunc=null}onAwake(){this.monsterList.hScrollBarSkin=null,this.monsterList.scrollBar.rollRatio=0,this.leftBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.rightBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.monsterList.on(Laya.Event.MOUSE_UP,this,this.onPanelEvent),this.monsterList.on(Laya.Event.MOUSE_OUT,this,this.onPanelEvent),this.monsterList.on(Laya.Event.MOUSE_DOWN,this,this.onPanelEvent),e.on(B.UserDataChange,this,this.onUserDataChange)}onPanelEvent(t){if(t.type==Laya.Event.MOUSE_DOWN)this.panelDownX=t.stageX;else{if(t.type==Laya.Event.MOUSE_UP&&(this.isUpTrigger=!0),t.type==Laya.Event.MOUSE_OUT&&this.isUpTrigger)return void(this.isUpTrigger=!1);this.stopMove(t.stageX)}}stopMove(t){let e=this.panelDownX-t;if(Math.abs(e)<200){if(0==this.curPage&&-1==Math.sign(e)||this.curPage==this.maxPage-1&&1==Math.sign(e))return;this.tweenList(this.curPage)}else this.curPage+Math.sign(e)>=0&&this.curPage+Math.sign(e)<this.maxPage&&this.tweenList(this.curPage+Math.sign(e))}tweenList(t){if(-1==t)return;this.curPage=t;let e=Laya.stage.width*t;0==this.curPage?Laya.Tween.to(this.leftBtn,{alpha:.5},100,Laya.Ease.sineOut):Laya.Tween.to(this.leftBtn,{alpha:1},100,Laya.Ease.sineOut),this.curPage==this.maxPage-1?Laya.Tween.to(this.rightBtn,{alpha:.5},100,Laya.Ease.sineOut):Laya.Tween.to(this.rightBtn,{alpha:1},100,Laya.Ease.sineOut),Laya.Tween.to(this.monsterList.scrollBar,{value:e},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.monsterList.scrollBar.stopScroll()}),0,!0)}onDestroy(){e.off(B.UserDataChange,this,this.onUserDataChange)}onBtnClick(t){t.target==this.leftBtn?this.curPage>0&&(this.curPage--,this.tweenList(this.curPage)):t.target==this.rightBtn&&this.curPage<this.maxPage-1&&(this.curPage++,this.tweenList(this.curPage))}onUserDataChange(t){"cardList"==t?this.initMonsterList():"niuDanSuperBag"==t&&this.isShowStoreEgg&&this.initMonsterList()}initMonsterList(t){if(this.cardDataList.length=0,this.isShowStoreEgg){let t=!1;for(let e=0;e<B.instance.niuDanSuperBag.length;){let i=B.instance.niuDanSuperBag[e];if(1e3*D.eggStoreTime-(Date.now()-i.saveTime)>0){let t=new y;t.isEgg=!0,t.level=i.level,t.saveTime=i.saveTime,this.cardDataList.push(t),e++}else B.instance.niuDanSuperBag.splice(e,1),t=!0}t&&B.instance.onDataChange("niuDanSuperBag")}for(let t=0;t<B.instance.cardList.length;t++){let e=B.instance.cardList[t];this.exceptFunc?this.exceptFunc(e)&&this.cardDataList.push(e):this.cardDataList.push(e)}for(let t=0;t<this.cardDataList.length;t++){let e=this.cardDataList[t];this.canSelectFunc&&(this.canSelectFunc(e)?e.canSelect=!0:e.canSelect=!1)}t&&this.cardDataList.sort(t),this.cardPageDataList.length=0;for(let t=0;t<this.cardDataList.length;t++){let e=Math.floor(t/12);this.cardPageDataList[e]||(this.cardPageDataList[e]=[]);let i=this.cardDataList[t];this.exceptFunc?this.exceptFunc(i)&&this.cardPageDataList[e].push(i):this.cardPageDataList[e].push(i)}this.maxPage=this.cardPageDataList.length,this.monsterList.array=this.cardPageDataList,this.monsterList.refresh(),this.updateArrow()}updateArrow(){this.maxPage<=1?(this.leftBtn.alpha=.5,this.rightBtn.alpha=.5):0==this.curPage?(this.leftBtn.alpha=.5,this.rightBtn.alpha=1):this.curPage==this.maxPage-1?(this.rightBtn.alpha=.5,this.leftBtn.alpha=1):(this.leftBtn.alpha=1,this.rightBtn.alpha=1)}static removeStoreEgg(t){for(let e=0;e<B.instance.niuDanSuperBag.length;e++){if(B.instance.niuDanSuperBag[e].saveTime==t)return B.instance.niuDanSuperBag.splice(e,1),void B.instance.onDataChange("niuDanSuperBag")}}}D.eggStoreTime=600;class P extends i.pages.cardUI{constructor(){super(...arguments),this.data=null,this.fullHp=0,this.shanSpine=null,this.storeLeftTime=0}set dataSource(t){t&&(this.data=t,(this.data.isEgg||-1!=this.data.monsterId)&&(this.icon.mask=P.mask,this.eggTimeLeftLabel.visible=!1,Laya.timer.clear(this,this.onTimeLoop),this.data.isEgg?(this.setBtnVideoTag(),this.hpLabel.text="???",this.atkLabel.text="???",this.starLabel.text="?",this.icon.skin="main/Ui_MonsterHeadBall.png",this.newTag.visible=!1,this.setBloodProgress(1),this.icon.filters=null,this.removeEffect(),this.redLight.alpha=0,this.hurt.stop(),this.storeLeftTime=1e3*D.eggStoreTime-(Date.now()-this.data.saveTime),this.storeLeftTime>0&&(this.eggTimeLeftLabel.visible=!0,this.eggTimeLeftLabel.text=S.dateFormat("MM:SS",new Date(this.storeLeftTime)),Laya.timer.loop(1e3,this,this.onTimeLoop))):(this.videoTag.visible=!1,-1==C.Instance.newMonsterIdList.indexOf(this.data.monsterId)?this.newTag.visible=!1:this.newTag.visible=!0,this.fullHp=t.hp||this.data.hp,t.special&&(this.fullHp+=Math.round(Math.max(5,.1*this.fullHp))),this.hpLabel.text=this.data.curHp+"",this.atkLabel.text=(t.atk||this.data.atk)+"",this.setStar(this.data.star),this.icon.skin=`monster/Ui_MonsterHead${this.data.monsterId}.png`,-1!=B.instance.collectMonsterIdList.indexOf(this.data.monsterId)||this.data.forceShow?(this.data.monsterId>=120?this.addEffect():this.removeEffect(),this.icon.filters=null):(this.icon.filters=[P.colorFilter],this.removeEffect()),this.data.cardId,this.data.curHp==this.fullHp?(this.hurt.stop(),this.redLight.alpha=0):this.hurt.isPlaying||this.hurt.play(0,!0),this.setBloodProgress(this.data.curHp/this.fullHp)),"canSelect"in this.data?this.data.canSelect?this.cardBg.disabled=!1:this.cardBg.disabled=!0:this.cardBg.disabled=!1))}addEffect(){this.shanSpine||(this.shanSpine=Laya.Pool.getItem("ShanSpine"),this.shanSpine||(this.shanSpine=new Laya.Skeleton,this.shanSpine.x=70,this.shanSpine.y=57)),this.addChild(this.shanSpine),this.shanSpine.load("spine/shan.sk",Laya.Handler.create(this,()=>{this.shanSpine.play(0,!0,!0,0)}),0)}removeEffect(){this.shanSpine&&(this.shanSpine.removeSelf(),Laya.Pool.recover("ShanSpine",this.shanSpine),this.shanSpine=null)}setBloodProgress(t){Laya.Tween.to(this.hpProgress,{width:90*t},100,Laya.Ease.sineOut)}onTimeLoop(){this.storeLeftTime-=1e3,this.storeLeftTime<=0&&this.removeStoreEgg(),this.eggTimeLeftLabel.text=S.dateFormat("MM:SS",new Date(this.storeLeftTime))}removeStoreEgg(){this.storeLeftTime=0,Laya.timer.clear(this,this.onTimeLoop),D.removeStoreEgg(this.data.saveTime)}setStar(t){t<=10?(this.starLabel.text=this.data.star+"",this.starIcon.skin="newSystem/Ui_StarYellow.png"):(this.starIcon.skin="newSystem/Ui_StarPurple.png",this.starLabel.text=this.data.star-10+"")}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}P.colorFilter=new Laya.ColorFilter([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0]),P.mask=new Laya.Image;class _ extends i.pages.cardPageUI{onAwake(){this.cardList.vScrollBarSkin=null,this.cardList.mouseHandler=Laya.Handler.create(this,this.onMouseHandler,null,!1)}set dataSource(t){t&&(this.cardList.array=t,this.cardList.refresh())}onMouseHandler(i,s){let a=this.cardList.getCell(s);e.event(t.SelectCard,[this.parent.parent,i,a])}}class U extends i.pages.quickClickTreasureUI{constructor(){super(...arguments),this.isFade=!1,this.isShowAd=!1,this.click_award_add=.1,this.click_award_back=.005,this.click_award_percent=[.4,.7],this.jumpSuccess=!1,this.successFunc=null,this.curProgress=0,this.forceTouchAdType=n.None}onAwake(){this.clickBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.clickBtn.on(Laya.Event.MOUSE_DOWN,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),Laya.timer.frameLoop(1,this,this.onFrameLoop),this.setProgress(0),"undefined"!=typeof wx&&(wx.onShow(this.onShow.bind(this)),wx.onHide(this.onShow.bind(this))),this.successFunc=(()=>{let t=v.getRandom(200,500);L.openScene("pages/getCard.scene",!1,!0,null,[1,t,8]),this.close()})}onDestroy(){Laya.timer.clearAll(this),"undefined"!=typeof wx&&(wx.offShow(this.onShow),wx.offHide(this.onHide)),this.forceTouchAdType==n.Banner?(w.Instance.hideBannerAd(),this.backBannerPos()):this.forceTouchAdType==n.Custom&&(w.Instance.hideCustomAd("adunit-239e866b6ff05e2f"),this.backCustomPos())}onShow(){console.log("onshow")}onHide(){console.log("onhide")}setParam(t){this.click_award_add=w.Instance.click_award_add,this.click_award_back=w.Instance.click_award_back,this.click_award_percent=w.Instance.click_award_percent,this.forceTouchAdType=t}onOpened(t){this.forceTouchAdType==n.Banner?this.initBannerToBtnPos():this.forceTouchAdType==n.Custom&&this.initCustomToBtnPos()}onBtnClick(i){i.target==this.clickBtn?i.type==Laya.Event.MOUSE_DOWN&&(this.curProgress<1&&(this.curProgress+=this.click_award_add,this.curProgress=this.curProgress>1?1:this.curProgress,this.setProgress(this.curProgress),this.isFade=!1,1!=this.curProgress&&Laya.timer.once(100,this,()=>{this.isFade=!0})),(this.curProgress>=this.click_award_percent[0]&&this.curProgress<=this.click_award_percent[1]||1==this.curProgress)&&!this.isShowAd&&(this.isShowAd=!0,this.forceTouchAdType==n.Video?(w.Instance.showVideoAd("adunit-670d87306dc1c259",null),e.once(t.VideoAdClosed,this,t=>{t?this.successFunc&&this.successFunc():this.close()})):this.forceTouchAdType==n.Custom?"undefined"!=typeof wx&&w.Instance.showCustomAd("adunit-239e866b6ff05e2f"):this.forceTouchAdType==n.Banner&&"undefined"!=typeof wx&&(w.Instance.showBannerAd(),Laya.timer.once(2e3,this,()=>{this.successFunc&&this.successFunc()})))):i.target==this.closeBtn&&i.type==Laya.Event.CLICK&&this.close()}onFrameLoop(){this.isFade&&(this.curProgress-=this.click_award_back,this.curProgress=this.curProgress<0?0:this.curProgress,this.setProgress(this.curProgress))}setProgress(t){this.curProgress=t,this.progressBar.width=620*this.curProgress}initBannerToBtnPos(){if("undefined"!=typeof wx){let t=new Laya.Point;t.x=this.clickBtn.width/2,t.y=this.clickBtn.height/2,this.clickBtn.localToGlobal(t,!1);let e=t.y/Laya.stage.height*wx.getSystemInfoSync().screenHeight-w.Instance.banner_Height/2;w.Instance.initBannerAd("adunit-f5780315db6f4ec6",e)}}backBannerPos(){w.Instance.initBannerAd("adunit-9379d0955f8130cb")}initCustomToBtnPos(){if("undefined"!=typeof wx){let t=new Laya.Point;t.x=this.clickBtn.width/2,t.y=this.clickBtn.height/2,this.clickBtn.localToGlobal(t,!1);let e=wx.getSystemInfoSync(),i={left:0,top:0,fixed:!0};i.left=t.x/Laya.stage.width*e.screenWidth-34,i.top=t.y/Laya.stage.height*e.screenHeight-53,w.Instance.initSingleCustomAd("adunit-239e866b6ff05e2f",i)}}backCustomPos(){if("undefined"!=typeof wx){let t=wx.getSystemInfoSync(),e={left:0,top:0,fixed:!0};e.left=0/Laya.stage.width*t.screenWidth,e.top=(Laya.stage.height/2-200)/Laya.stage.height*t.screenHeight,w.Instance.initSingleCustomAd("adunit-239e866b6ff05e2f",e)}}}U.isOpen=!1,function(t){t[t.None=0]="None",t[t.Banner=1]="Banner",t[t.Video=2]="Video",t[t.Custom=3]="Custom"}(n||(n={}));class R extends i.pages.catchResultUI{constructor(){super(...arguments),this.monsterId=-1,this.monsterData=null,this.isBacktoSearch=!1,this.sceneType=0,this.showScene3d=null,this.showCamera=null,this.showMonster=null,this.isCatch=!1}onAwake(){this.initShowScene(),this.setBtnVideoTag()}onOpened(){this.sureBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.videoCatchBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.noForceBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.showScene3d.active=!0,Laya.timer.frameLoop(1,this,this.onFrameLoop),1==this.sceneType&&p.playSound("catchSuccess.mp3"),w.Instance.showBannerAd()}onClosed(){p.stopSound("catchSuccess.mp3"),w.Instance.hideBannerAd(),1==this.sceneType&&this.isCatch&&w.Instance.initBannerAd("adunit-9379d0955f8130cb"),e.event(t.CatchResultClose,this.cardData),R.isRunNiuDanGuide&&(R.isRunNiuDanGuide=!1,I.startOutTask("介绍扭蛋"))}initShowScene(){this.showScene3d=new Laya.Scene3D,this.showScene3d.ambientColor.x=.8254717,this.showScene3d.ambientColor.y=.8793155,this.showScene3d.ambientColor.z=1;let t=new Laya.Camera(0,.3,200);t.name="MainCamera",t.enableHDR=!1,t.clearFlag=Laya.CameraClearFlags.DepthOnly,t.transform.position=new Laya.Vector3(0,5.94,13.98),t.transform.rotation=new Laya.Quaternion(-.2088847,0,0,.9779403),this.showScene3d.addChild(t);let e=new Laya.DirectionLight;e.name="MainLight",e.transform.position=new Laya.Vector3(0,13.81,6.95),e.transform.rotation=new Laya.Quaternion(-.2416573,.8379717,.4228851,.2461164),e.color.x=.9056604,e.color.y=.8615166,e.color.z=.7732289,e.intensity=.5,this.showScene3d.addChild(e),this.sceneBox.addChild(this.showScene3d)}onBtnClick(i){i.target==this.sureBtn||i.target==this.noForceBtn?(this.hideShowScene(),this.close(),1==this.sceneType&&C.Instance.isBoss&&C.Instance.fightType!=s.Tower?(this.isCatch||(B.instance.catchBossRec.timestamp=Date.now(),B.instance.catchBossRec.bossId=this.monsterId,B.instance.onDataChange("catchBossRec")),e.event(t.ShowCount,!0)):this.isBacktoSearch&&(Math.random()<.5&&w.Instance.showInterstitialAd(null),e.event(t.BacktoScene,"search"))):i.target==this.videoCatchBtn&&(w.Instance.sendVideoData={page_id:2,button_id:2,ad_id:2,ad_type:1},w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{this.setParam(!0,this.monsterId,this.monsterData,this.isBacktoSearch,this.sceneType,null)}))}hideShowScene(){this.showMonster&&this.showMonster.destroy(),this.showScene3d.destroy()}addMonster(){p.create([`Enemy${this.monsterId}.lh`]).then(()=>{if(this.destroyed)return;this.showMonster=L.createSprite3D(`Enemy${this.monsterId}`,this.showScene3d),this.showMonster.transform.position=new Laya.Vector3(0,0,0),this.showMonster.transform.rotationEuler=new Laya.Vector3,this.showMonster.getChildAt(0).getComponent(Laya.Animator).play("Stand",0,0)})}onDestroy(){Laya.timer.clearAll(this)}setParam(i,s,a,o,r,h,l){this.isCatch=i,this.sceneType=r,this.isBacktoSearch=o,this.monsterId=s,this.monsterData=a,this.nameLabel.text=a.name;let c=C.Instance.getOneCardData(s);if(l&&(c.atk=l.atk,c.hp=l.hp,c.star=l.star),c.star>=11?this.starBg.skin="count/Ui_FrameStarPurple.png":this.starBg.skin="count/Ui_FrameStar.png",this.hpLabel.text=c.hp+"",this.atkLabel.text=c.atk+"",c.star>10?this.starLabel.text=c.star-10+"":this.starLabel.text=c.star+"",1==this.sceneType&&(B.instance.catchTimeRec[s]||(B.instance.catchTimeRec[s]=0),B.instance.catchTimeRec[s]++,B.instance.onDataChange("catchTimeRec")),i){if(-1==B.instance.collectMonsterIdList.indexOf(s)?this.newTag.visible=!0:this.newTag.visible=!1,this.failTag.visible=!1,this.lightBg.visible=!0,this.sureBtn.visible=!0,this.videoCatchBtn.visible=!1,this.noForceBtn.visible=!1,1==r||2==r||3==r||5==r||7==r||8==r||9==r){let i=14;1==r?i=13:2==r||3==r?i=14:7!=r&&8!=r&&9!=r||(i=15);let a=B.instance.addCard(s,!1,i,l);if(1==this.sceneType){let t=B.instance.stageCollectObj[C.Instance.enterMapIndex];C.Instance.isCream&&(t=B.instance.creamStageCollectObj[C.Instance.enterMapIndex]),-1==t.indexOf(s)&&(t.push(s),C.Instance.isCream?B.instance.onDataChange("creamStageCollectObj"):B.instance.onDataChange("stageCollectObj"))}else if(2==this.sceneType)e.event(t.ComposeNew,a);else if(5==this.sceneType)B.instance.catchBossRec={timestamp:0,bossId:-1},B.instance.onDataChange("catchBossRec");else if(7==this.sceneType){let t=k.superEvaIndex;B.instance.tryCardDataList[t].cardId=a.cardId,B.instance.tryCardDataList[t].monsterId=a.monsterId,B.instance.tryCardDataList[t].timestamp=Date.now(),B.instance.onDataChange("tryCardData")}else 8!=this.sceneType&&9!=this.sceneType||this.clearTryAndAddSuperEvaIndex(8==this.sceneType)}else this.cardData=B.instance.addCard(s,h,2);this.addMonster()}else this.noForceBtn.visible=!0,this.newTag.visible=!1,this.failTag.visible=!0,this.lightBg.visible=!1,this.sureBtn.visible=!1,this.videoCatchBtn.visible=!0,w.Instance.sendVideoData={page_id:2,button_id:2,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData);1!=this.sceneType||this.isCatch||I.startOutTask("捕捉失败"),i&&Math.random()<.5&&w.Instance.showInterstitialAd(null),1==this.sceneType&&this.isCatch&&w.Instance.isForceTouch()&&L.openScene("pages/quickClickTreasure.scene",!1,!0,null,[n.Banner])}onFrameLoop(){this.lightBg.visible&&(this.lightBg.rotation+=1,this.lightBg.rotation>=360&&(this.lightBg.rotation=this.lightBg.rotation%360))}clearTryAndAddSuperEvaIndex(t){let e=k.superEvaIndex;if(B.instance.tryCardDataList[e].cardId)for(let t=0;t<B.instance.cardList.length;t++)if(B.instance.cardList[t].cardId==B.instance.tryCardDataList[e].cardId){B.instance.cardList.splice(t,1),B.instance.onDataChange("cardList");break}B.instance.tryCardDataList[e].isLose=!0,B.instance.tryCardDataList[e].isTryGet=t,B.instance.onDataChange("tryCardData")}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}R.isRunNiuDanGuide=!1;class E extends i.pages.levelCellUI{onAwake(){this.levelLabel.filters=[x.blackColorFilter]}set dataSource(t){if(this.data=t,!t)return;let e=10*(t.bigLevel-1)+t.smallLevel,i=10*(B.instance.challengeLevel[0]-1)+B.instance.challengeLevel[1];e<i?this.setCellState(0):e==i?B.instance.allPassChallenge?this.setCellState(0):this.setCellState(1):this.setCellState(2)}setCellState(t){this.curLight.visible=1==t,this.cover.visible=2==t,this.rewardIcon1.visible=1==t||2==t,this.rewardLabel1.visible=1==t||2==t,this.levelLabel.visible=1==t||2==t,this.rewardIcon2.visible=1==t,this.rewardLabel2.visible=1==t,0==t?(this.bg.skin="newSystem/Ui_Guan1.png",this.width=120):1==t?(this.bg.skin="newSystem/Ui_Guan2.png",this.width=185,this.levelLabel.text=`${this.data.bigLevel}-${this.data.smallLevel}`,this.rewardIcon1.x=51,this.rewardIcon1.y=70,this.rewardLabel1.centerX=-10,this.rewardIcon2.x=148,this.rewardIcon2.y=61,this.setReward(1,this.data.passReward[0][0],this.data.passReward[0][1]),this.setReward(2,this.data.firstPassReward[0][0],this.data.firstPassReward[0][1])):2==t&&(this.bg.skin="newSystem/Ui_Guan3.png",this.width=120,this.levelLabel.text=`${this.data.bigLevel}-${this.data.smallLevel}`,this.rewardIcon1.x=42,this.rewardIcon1.y=70,this.rewardLabel1.centerX=13,this.setReward(1,this.data.passReward[0][0],this.data.passReward[0][1]))}setReward(t,e,i){let s=[{icon:this.rewardIcon1,label:this.rewardLabel1},{icon:this.rewardIcon2,label:this.rewardLabel2}][t-1];1==e?(s.icon.skin="main/Ui_Money.png",s.icon.width=17,s.icon.height=21):5==e&&(s.icon.skin="newSystem/Ui_Badge.png",s.icon.width=20,s.icon.height=20),s.label.text="X"+i}}class O extends i.pages.mapCellUI{set dataSource(t){if(this.data=t,!t)return;this.bg.skin=`newSystem/Ui_Map${t.bigLevel}.png`;let e=[{x:398,y:245},{x:251,y:184},{x:267,y:304},{x:375,y:378},{x:212,y:327},{x:256,y:339},{x:221,y:309},{x:316,y:238},{x:349,y:252},{x:305,y:247}][t.bigLevel-1];this.mapNameImage.x=e.x,this.mapNameImage.y=e.y,this.updateCellState()}setCellState(t){this.curLevelBg.visible=0==t||1==t,this.mapIcon.visible=0==t||1==t,0==t?(this.mapNameImage.skin="newSystem/Ui_FrameDaoGuan.png",this.mapIcon.skin=`newSystem/Ui_DaoGuan${this.data.bigLevel}.png`,this.levelLabel.text=`${this.data.bigLevel}-${C.Instance.challengeMapData[this.data.bigLevel-1].length}`):1==t?(this.mapNameImage.skin="newSystem/Ui_FrameDaoGuan.png",this.mapIcon.skin=`newSystem/Ui_DaoGuan${this.data.bigLevel}.png`,this.levelLabel.text=`${this.data.bigLevel}-${B.instance.challengeLevel[1]}`):2==t&&(this.mapNameImage.skin="newSystem/Ui_DaoGuan.png")}updateCellState(){this.data&&(this.data.bigLevel<B.instance.challengeLevel[0]?this.setCellState(0):this.data.bigLevel==B.instance.challengeLevel[0]?this.setCellState(1):this.setCellState(2))}}class F extends i.pages.challengeUI{constructor(){super(...arguments),this.bigMapCellList=[],this.showCellList=[],this.spaceX=10,this.curMapIndex=0}onAwake(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.challengeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.succeedBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.rankBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.levelNumLabel.filters=[x.blackColorFilter],this.bigLevelPanel.vScrollBarSkin=null,this.initBigLevelUi(),Laya.timer.frameOnce(1,this,()=>{this.updateCurBigLevel(B.instance.challengeLevel[0])}),this.smallLevelPanel.hScrollBarSkin=null,this.initSmallLevelUi(B.instance.challengeLevel[0]),Laya.timer.frameOnce(1,this,()=>{this.updateCurSmallLevel(B.instance.challengeLevel[1])}),this.initPanelUi(B.instance.challengeLevel[0]),this.curMapIndex=B.instance.challengeLevel[0],this.initMoneyPoint(),this.judgeShowSucceedBtn(),e.on(B.UserDataChange,this,this.onUserDataChange)}static haveRed(){return!1}initSmallLevelUi(t){let e=[];for(let i=0;i<C.Instance.challengeMapData[t-1].length;i++){let s=C.Instance.challengeMapData[t-1][i];e.push({bigLevel:t,smallLevel:i+1,passReward:C.Instance.parseRewardData(s.passReward),firstPassReward:C.Instance.parseRewardData(s.firstPassReward)})}let i=e.length-this.showCellList.length,s=i>0?e.length:this.showCellList.length,a=i>0?this.showCellList.length:e.length,n=0;for(let t=0;t<s;)if(t<a){let i=this.showCellList[t],s=e[t];i.dataSource=s,i.x=n,n+=i.width+this.spaceX,t++}else if(i>0){let i=this.getOneCell(),s=e[t];i.dataSource=s,i.x=n,n+=i.width+this.spaceX,this.smallLevelPanel.addChild(i),this.showCellList.push(i),t++}else{let e=this.showCellList[t];e.removeSelf(),Laya.Pool.recover("LevelCell",e),this.showCellList.splice(t,1),s=this.showCellList.length}}initBigLevelUi(){let t=0;for(let e=C.Instance.challengeMapData.length-1;e>=0;e--){let i=new O;i.dataSource={bigLevel:e+1},i.y=t,t+=i.height,this.bigLevelPanel.addChild(i),this.bigMapCellList.push(i),i.on(Laya.Event.CLICK,this,this.onMapCellClick,[e+1])}}onBtnClick(i){i.target==this.closeBtn?Laya.Tween.to(this.mapInfoPanel,{x:-Laya.stage.width},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.mapInfoPanel.visible=!1})):i.target==this.challengeBtn?(Laya.MouseManager.enabled=!1,e.event(t.GotoScene,"challenge")):i.target==this.succeedBtn?L.openScene("pages/succeed.scene",!1,!0,Laya.Handler.create(this,t=>{"yes"==t&&this.onSucceed()}),null,!0):i.target==this.rankBtn&&L.openScene("pages/challengeRank.scene",!1,!0,null,null,!1)}updateCurBigLevel(t){let e=0;for(let i=0;i<=C.Instance.challengeMapData.length-t;i++)e+=this.bigMapCellList[i].height;let i=e-this.bigLevelPanel.height;i<0&&(i=0),this.bigLevelPanel.vScrollBar.value=i}updateCurSmallLevel(t){let e=0;for(let i=0;i<t;i++)e+=this.showCellList[i].width+this.spaceX;let i=e-this.smallLevelPanel.width;i<0&&(i=0),this.smallLevelPanel.hScrollBar.value=i}getOneCell(){let t=Laya.Pool.getItem("LevelCell");return t||(t=new E),t}initPanelUi(t){this.mapImage.skin=`newSystem/Ui_DaoGuan${t}.png`,this.mapName.skin=`newSystem/Ui_DaoGuanName${t}.png`,this.levelNumLabel.text=C.Instance.challengeMapData[t-1].length+""}onMapCellClick(i,s){i>B.instance.challengeLevel[0]?e.event(t.PopTip,"先通关当前道馆"):(this.curMapIndex!=i&&(this.curMapIndex=i,this.initSmallLevelUi(i),Laya.timer.frameOnce(1,this,()=>{i<B.instance.challengeLevel[0]?this.updateCurSmallLevel(C.Instance.challengeMapData[i-1].length):this.updateCurSmallLevel(B.instance.challengeLevel[1])}),this.initPanelUi(i)),this.mapInfoPanel.visible=!0,Laya.Tween.to(this.mapInfoPanel,{x:18},200,Laya.Ease.sineIn))}onUserDataChange(t){"challengeLevel"==t?(this.updateBigLevelUi(),this.updateCurBigLevel(B.instance.challengeLevel[0]),this.initSmallLevelUi(B.instance.challengeLevel[0]),this.updateCurSmallLevel(B.instance.challengeLevel[1]),this.initPanelUi(B.instance.challengeLevel[0]),this.curMapIndex=B.instance.challengeLevel[0]):"isSucceed"==t&&this.judgeShowSucceedBtn()}onDestroy(){e.off(B.UserDataChange,this,this.onUserDataChange)}updateBigLevelUi(){let t=C.Instance.challengeMapData.length-1;for(let e=t;e>=0;e--){this.bigMapCellList[t-e].dataSource={bigLevel:e+1}}}judgeShowSucceedBtn(){B.instance.highestChallengeLevel&&!B.instance.isSucceed?this.succeedBtn.visible=!0:this.succeedBtn.visible=!1}onSucceed(){let i=0,s=0,a=[...B.instance.highestChallengeLevel];if(a[1]--,0==a[1]&&(a[0]--,a[0]-1>=0&&(a[1]=C.Instance.challengeMapData[a[0]-1].length)),a[0]>0&&a[1]>0){let n=a[0];for(let t=0;t<n;t++)for(let e=0;e<C.Instance.challengeMapData[t].length;e++){let a=C.Instance.challengeMapData[t][e],n=[...C.Instance.parseRewardData(a.passReward),...C.Instance.parseRewardData(a.firstPassReward)];for(let t=0;t<n.length;t++)1==n[t][0]?i+=n[t][1]:5==n[t][0]&&(s+=n[t][1])}i>0&&(B.instance.gold+=i,B.instance.onDataChange("gold"),e.event(t.AddMoney,["gold",i])),s>0&&(B.instance.badge+=s,B.instance.onDataChange("badge"),e.event(t.AddMoney,["badge",s]))}B.instance.challengeLevel=[...B.instance.highestChallengeLevel],B.instance.onDataChange("challengeLevel"),B.instance.isSucceed=!0,B.instance.onDataChange("isSucceed"),C.Instance.uploadChallengeRankScore()}initMoneyPoint(){let t=this.badgeMoneyUi;t.setMoneyType("badge",!1),t.moneyIcon.localToGlobal(t.moneyPoint,!1,this)}onSelect(){this.visible=!0,C.Instance.isPause=!0,e.event(t.PlayerStopMove)}offSelect(){this.visible=!1,C.Instance.isPause=!1}}class A extends i.pages.moneyUiUI{constructor(){super(...arguments),this.moneyPoint=new Laya.Point,this.enableEffect=!0}onAwake(){e.on(t.AddMoney,this,this.onAddMoney),e.on(t.UseMoney,this,this.onUseMoney),this.addMoneyBtn.on(Laya.Event.CLICK,this,this.onBtnClick)}onDestroy(){e.off(t.AddMoney,this,this.onAddMoney),e.off(t.UseMoney,this,this.onUseMoney)}onBtnClick(i){i.target==this.addMoneyBtn&&("gold"==this.type?L.openScene("pages/addMoney.scene",!0,!0,null,[1,200]):"badge"==this.type?L.openScene("pages/addBadge.scene",!0,!0,null,null):"diamond"==this.type&&e.event(t.JumpToPage,5))}setMoneyType(t,e){this.addMoneyBtn.visible=e,this.type=t,"gold"==t?(this.updateGoldLabel(B.instance.gold),this.moneyIcon.skin="main/Ui_Money.png",this.moneyIcon.x=21,this.moneyIcon.y=19):"badge"==t?(this.updateGoldLabel(B.instance.badge),this.moneyIcon.skin="newSystem/Ui_Badge.png",this.moneyIcon.x=21,this.moneyIcon.y=19):"fightTicket"==t?(this.updateGoldLabel(B.instance.fightTicket),this.moneyIcon.skin="newSystem/Ui_Quan.png",this.moneyIcon.x=27,this.moneyIcon.y=19):"chip"==t?(this.updateGoldLabel(B.instance.chip),this.moneyIcon.skin="newSystem/Ui_Chip.png",this.moneyIcon.x=27,this.moneyIcon.y=19):"diamond"==t&&(this.updateGoldLabel(B.instance.diamond),this.moneyIcon.skin="pay/Ui_Diamond.png",this.moneyIcon.x=27,this.moneyIcon.y=19)}createMoney(t){Laya.timer.once(200*Math.random(),this,()=>{let e=new Laya.Image;e.anchorX=.5,e.anchorY=.5,e.skin=this.moneyIcon.skin,e.zOrder=1e3,Laya.stage.addChild(e);let i=2*Math.random()*Math.PI,s=100*Math.random();e.x=Laya.stage.width/2+s*Math.cos(i),e.y=Laya.stage.height/2+s*Math.sin(i);let a=e.x,n=e.y,o=this.moneyPoint.x,r=this.moneyPoint.y,h=a-300*Math.random();a>=Laya.stage.width/2&&(h=a+300*Math.random());let l=n,c={value:0};Laya.Tween.to(c,{value:1,update:Laya.Handler.create(this,()=>{let t=L.bezier(c.value,a,n,h,l,o,r);e.x=t.x,e.y=t.y},null,!1)},800,Laya.Ease.sineIn,Laya.Handler.create(this,()=>{e.destroy(),this.moneyPop.play(0,!1),this.updateGoldLabel(Number(this.moneyLabel.text.replace(/,/g,""))+t)}))})}onAddMoney(t,e){t==this.type&&(this.enableEffect?this.addMoney(e):this.onUseMoney("diamond"))}onUseMoney(t){t==this.type&&("gold"==this.type?this.updateGoldLabel(B.instance.gold):"badge"==this.type?this.updateGoldLabel(B.instance.badge):"fightTicket"==this.type?this.updateGoldLabel(B.instance.fightTicket):"chip"==this.type?this.updateGoldLabel(B.instance.chip):"diamond"==this.type&&this.updateGoldLabel(B.instance.diamond))}addMoney(t){let e=[],i=0;for(;t>0;)e[i]||e.push(0),e[i]++,t--,i=++i%20;for(let t=0;t<e.length;t++)this.createMoney(e[t])}updateGoldLabel(t){let e=t+"",i="",s=0;for(let t=e.length-1;t>=0;t--)i+=e[t],3==++s&&(e[t-1]&&(i+=","),s=0);i=i.split("").reverse().join(""),this.moneyLabel.text=i}}class N extends i.pages.challengeRankUI{constructor(){super(...arguments),this.challengeRankRewardDataList=[]}onAwake(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.wxOpenDataViewer.visible=!1,this._list.vScrollBarSkin=null,this.showRankList(),this.showFakeRankList(),this.initChallengeRankRewardDataList(),this.rankRewardList.vScrollBarSkin=null,this.rankRewardList.array=this.challengeRankRewardDataList,this.rankRewardList.refresh(),e.on(t.ReceiveRankReward,this,this.onReceiveRankReward),e.on(t.GoChallenge,this,this.onGoChallenge)}onDestroy(){e.off(t.ReceiveRankReward,this,this.onReceiveRankReward),e.off(t.GoChallenge,this,this.onGoChallenge),this.hideRankList()}onBtnClick(t){t.target==this.closeBtn&&this.close()}showRankList(){}hideRankList(){}showFakeRankList(){let t=[],e=B.instance.challengeLevel,i={index:0,avatarIP:"",UserName:"我",RankValue:10*(e[0]-1)+e[1],isMe:!0};t.push(i),this.addAiData(t),t.sort((t,e)=>e.RankValue-t.RankValue);for(let e=0;e<t.length;e++)t[e].index=e+1;this._list.array=t,this._list.refresh()}initChallengeRankRewardDataList(){for(let t=0;t<C.Instance.towerConfig.length;t++){let e=C.Instance.towerConfig[t];if(e.rankReward.length>0||e.rankExtraReward.length>0){let t=e.level-10*(Math.ceil(e.level/10)-1),i={index:this.challengeRankRewardDataList.length,level:[e.tower,t]};if(e.rankReward.length>0){let t=C.Instance.parseRewardData(e.rankReward);i.rankReward=C.Instance.countRewardList(t,s.Tower)}if(e.rankExtraReward.length>0){let t=C.Instance.parseRewardData(e.rankExtraReward);i.rankExtraReward=C.Instance.countRewardList(t,s.Tower)}this.challengeRankRewardDataList.push(i)}}}onReceiveRankReward(t,e){let i=this.challengeRankRewardDataList[t];if("normal"==e){let t=`${i.level[0]}-${i.level[1]}`;B.instance.challengeRewardReceiveList.push(t),B.instance.onDataChange("challengeRewardReceiveList"),C.Instance.receiveReward(i.rankExtraReward),this.rankRewardList.refresh()}else w.Instance.showVideoAd("adunit-670d87306dc1c259",()=>{let t=`${i.level[0]}-${i.level[1]}`;B.instance.challengeExtraRewardReceiveList.push(t),B.instance.onDataChange("challengeExtraRewardReceiveList"),C.Instance.receiveReward(i.rankReward),this.rankRewardList.refresh()})}onGoChallenge(){this.close()}addAiData(t){for(let e=0;e<C.Instance.aiConfig.length;e++){let i=C.Instance.aiConfig[e],s={index:0,avatarIP:i.icon,UserName:i.name,RankValue:v.getRandom(0,50),isMe:!1};t.push(s)}console.log(t)}}class V extends i.pages.ChallengeRankRewardCellUI{onAwake(){this.goBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.receiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.extraReceiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.setBtnVideoTag()}onBtnClick(i){i.target==this.goBtn?e.event(t.GoChallenge):i.target==this.receiveBtn?e.event(t.ReceiveRankReward,[this.data.index,"normal"]):i.target==this.extraReceiveBtn&&w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{e.event(t.ReceiveRankReward,[this.data.index,"extra"])})}set dataSource(t){if(!t)return;this.data=t;let e=`${this.data.level[0]}-${this.data.level[1]}`;this.levelLabel.text="通过"+e;let i=10*(this.data.level[0]-1)+this.data.level[1];if(10*(B.instance.challengeLevel[0]-1)+B.instance.challengeLevel[1]>i){this.goBtn.visible=!1;let t=-1!=B.instance.challengeRewardReceiveList.indexOf(e);this.receiveBtn.visible=!t,this.normalReceiveTag.visible=t;let i=-1!=B.instance.challengeExtraRewardReceiveList.indexOf(e);this.extraReceiveBtn.visible=!i,this.extraReceiveTag.visible=i}else this.goBtn.visible=!0,this.receiveBtn.visible=!1,this.extraReceiveBtn.visible=!1,this.normalReceiveTag.visible=!1,this.extraReceiveTag.visible=!1;let s=C.Instance.getRewardUiDataList(this.data.rankReward);this.extraRewardList.array=s,this.extraRewardList.refresh();let a=C.Instance.getRewardUiDataList(this.data.rankExtraReward);this.rewardList.array=a,this.rewardList.refresh()}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class X extends i.pages.challengeRankCellUI{set dataSource(t){if(this.data=t,!this.data)return;this.nameLabel.text=this.data.UserName,this.headImage.skin=this.data.avatarIP,this.setRank(t.index);let e=t.RankValue%10,i=Math.ceil(t.RankValue/10);this.levelLabel.text=`${i}-${e}`,this.setMe(t.isMe)}setRank(t){t<=3?(this.rankImage.visible=!0,this.rankLabel.visible=!1,this.rankImage.skin=`challengeRank/Ui_No${t}.png`,this.rankImage.x=X.rankImagePosConfig[t-1].x,this.rankImage.y=X.rankImagePosConfig[t-1].y):(this.rankImage.visible=!1,this.rankLabel.visible=!0,this.rankLabel.text=t+"")}setMe(t){this.bg.skin=t?"challengeRank/Ui_FrameRank3.png":"challengeRank/Ui_FrameRank2.png"}}X.rankImagePosConfig=[{x:-11,y:-12},{x:7,y:1},{x:14,y:-1}];class G extends i.pages.chooseOneUI{constructor(){super(...arguments),this.chooseMonsterIdList=[1,2,3,7,4,8,6,9],this.runTime=0,this.moveSpeed=5,this.curMoveSpeed=0,this.rewardMonsterIdList=[9,3,4,6],this.isMoving=!1,this.monsterImageList=[],this.monsterIdList=[],this.centerX=0,this.gap=0,this.selectIndex=-1,this.isPick=!1}onAwake(){this.width=Laya.stage.width,this.height=Laya.stage.height,this.randomBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.allBtn.on(Laya.Event.CLICK,this,this.onBtnClick),Laya.timer.frameLoop(1,this,this.onFrameLoop),this.createMonsterImageList(),this.startMove(),w.Instance.sendVideoData={page_id:3,button_id:3,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData),this.randomBtn.visible=!1,Laya.timer.once(w.Instance.delayTime,this,()=>{this.randomBtn.visible=!0}),this.setBtnVideoTag()}createMonsterImageList(){this.curMoveSpeed=this.moveSpeed;let t=(this.chooseMonsterIdList.length-1)/2;this.centerX=Laya.stage.width/2,this.gap=Laya.stage.width/2;for(let e=0;e<this.chooseMonsterIdList.length;e++){let i=new Laya.Image(`monster/Ui_Monster${this.chooseMonsterIdList[e]}.png`);i.anchorX=.5,i.anchorY=1,i.y=this.monsterBox.height,i.x=(e-t)*this.gap+this.centerX,this.monsterImageList.push(i),this.monsterBox.addChild(i),i.scaleX=i.scaleY=this.getRealScale(i.x)}this.monsterIdList=[...this.chooseMonsterIdList]}onBtnClick(t){if(!this.isPick)if(t.target==this.randomBtn){this.isPick=!0;let t=this.getIndex();this.stopMove(t),this.rewardMonsterIdList=[this.chooseMonsterIdList[t]],I.finishInnerTask("点击选择初始怪按钮")}else t.target==this.allBtn&&(w.Instance.sendVideoData={page_id:3,button_id:3,ad_id:2,ad_type:1},w.Instance.showVideoAd("adunit-0cad7f4a75069fbe",()=>{I.finishInnerTask("点击选择初始怪按钮"),this.isPick=!0;let t=this.getIndex();this.rewardMonsterIdList=[this.chooseMonsterIdList[t]].concat(this.rewardMonsterIdList),this.stopMove(t)}))}onDestroy(){Laya.timer.clear(this,this.onFrameLoop)}onFrameLoop(){let i=Laya.timer.delta/1e3;if(this.runTime+=i,this.isMoving){-1!=this.selectIndex&&(this.curMoveSpeed-=.03,this.curMoveSpeed=this.curMoveSpeed>2?this.curMoveSpeed:2);let s=this.curMoveSpeed*i*100,a=this.monsterIdList.indexOf(this.chooseMonsterIdList[this.selectIndex]);-1!=this.selectIndex&&this.monsterImageList[a].x<this.centerX&&this.monsterImageList[a].x+s>=this.centerX&&(s=this.centerX-this.monsterImageList[a].x,this.isMoving=!1,Laya.timer.clear(this,this.onFrameLoop),L.openScene("pages/getCard.scene",!0,!0,Laya.Handler.create(this,()=>{e.event(t.ChooseOneFinish)}),[2,this.rewardMonsterIdList,1]));for(let t=0;t<this.monsterImageList.length;t++){let e=this.monsterImageList[t];if(e.x+=s,e.x>this.centerX+4*this.gap){let t=this.monsterImageList.pop();t.x=this.monsterImageList[0].x-this.gap,this.monsterImageList=[t].concat(this.monsterImageList);let e=this.monsterIdList.pop();this.monsterIdList=[e].concat(this.monsterIdList)}e.scaleX=e.scaleY=this.getRealScale(e.x)}}}getIndex(){let t=0,e=-1,i=-1;for(let s=0;s<this.monsterImageList.length;s++){let a=this.monsterImageList[s];a.scaleX>t&&(e=this.monsterIdList[s],t=a.scaleX,i=s)}let s=i-2;return s=s>0?s:0,this.chooseMonsterIdList.indexOf(this.monsterIdList[s])}startMove(){this.isMoving=!0}stopMove(t){this.selectIndex=t}getRealScale(t){return t>this.centerX?1-.3*((t=t<Laya.stage.width?t:Laya.stage.width)-this.centerX)/(Laya.stage.width-this.centerX):t==this.centerX?1:1-.3*((t=t<0?0:t)-this.centerX)/(0-this.centerX)}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class H extends i.pages.composeUI{constructor(){super(...arguments),this.selectCard=null,this.cloneCard=null,this.posType=0,this.selectFrom=0,this.composeResultData=new y,this.mixCost=0,this.stopClick=!1,this.downY=0,this.downX=0,this.isMove=!1,this.downPoint=new Laya.Point}onAwake(){e.on(t.SelectCard,this,this.onSelectPageCard),e.on(t.ComposeEnd,this,this.onComposeEnd),this.cardBag.isShowStoreEgg=!0,this.cardBag.exceptFunc=this.exceptFunc.bind(this),this.cardBag.initMonsterList(),this.on(Laya.Event.MOUSE_MOVE,this,this.onComposePageEvent),this.on(Laya.Event.MOUSE_UP,this,this.onComposePageEvent),this.cardBag.monsterList.on(Laya.Event.MOUSE_OUT,this,this.onCardBagEvent),this.cardBag.monsterList.on(Laya.Event.MOUSE_OVER,this,this.onCardBagEvent),this.cardBox1.on(Laya.Event.MOUSE_OUT,this,this.onComposeListEvent),this.cardBox1.on(Laya.Event.MOUSE_OVER,this,this.onComposeListEvent),this.cardBox1.on(Laya.Event.CLICK,this,this.onComposeListEvent),this.cardBox1.on(Laya.Event.MOUSE_DOWN,this,this.onComposeListEvent),this.cardBox2.on(Laya.Event.MOUSE_OUT,this,this.onComposeListEvent),this.cardBox2.on(Laya.Event.MOUSE_OVER,this,this.onComposeListEvent),this.cardBox2.on(Laya.Event.CLICK,this,this.onComposeListEvent),this.cardBox2.on(Laya.Event.MOUSE_DOWN,this,this.onComposeListEvent),this.quickSelectBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.composeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.refreshComposeList(),this.composeResultCard.visible=!1,this.card1.visible=!1,this.card2.visible=!1,this.cloneCard=new P,this.cloneCard.visible=!1,this.addChild(this.cloneCard),this.quickSelectRed.visible=H.haveRed(),e.on(B.UserDataChange,this,this.onUserDataChange)}onUserDataChange(i){if("fightCardList"==i||"cardList"==i){let i=H.haveRed();this.quickSelectRed.visible=i,e.event(t.UpdateComposeRed,i)}}clearSelect(t){this.cloneCard.visible=!1,t&&(this.selectCard.visible=!0),this.selectCard=null,this.downPoint.x=0,this.downPoint.y=0,this.selectFrom=0,this.posType=0}onComposeListEvent(t){if(t.target==this.cardBox1){if(t.type==Laya.Event.MOUSE_OUT)this.posType=0;else if(t.type==Laya.Event.MOUSE_OVER)this.posType=2;else if(t.type==Laya.Event.MOUSE_DOWN){if(!this.card1.visible)return;let e=this.card1;this.selectCard=e,this.selectFrom=2,this.downPoint.x=t.stageX,this.downPoint.y=t.stageY,this.posType=2,this.cloneCard.dataSource=this.selectCard.data,this.downY=t.stageY,this.downX=t.stageX}else if(t.type==Laya.Event.CLICK){if(this.stopClick||!this.card1.visible)return;this.changeComposeList([this.card1.data],!1,0)}}else if(t.type==Laya.Event.MOUSE_OUT)this.posType=0;else if(t.type==Laya.Event.MOUSE_OVER)this.posType=3;else if(t.type==Laya.Event.MOUSE_DOWN){if(!this.card2.visible)return;let e=this.card2;this.selectCard=e,this.selectFrom=3,this.downPoint.x=t.stageX,this.downPoint.y=t.stageY,this.posType=3,this.cloneCard.dataSource=this.selectCard.data,this.downY=t.stageY}else if(t.type==Laya.Event.CLICK){if(this.stopClick||!this.card2.visible)return;this.changeComposeList([this.card1.data],!1,1)}}onCardBagEvent(t){t.type==Laya.Event.MOUSE_OUT?this.posType=0:t.type==Laya.Event.MOUSE_OVER&&(this.posType=1)}onComposePageEvent(t){if(this.selectCard)if(t.type==Laya.Event.MOUSE_MOVE){if(console.log(t.stageX,t.stageY,this.downPoint.x,this.downPoint.y),t.stageX==this.downPoint.x&&t.stageY==this.downPoint.y)return;this.isMove=!0,this.selectCard.visible&&(this.cloneCard.visible=!0,this.selectCard.visible=!1,this.cardBag.monsterList.scrollBar.stopScroll()),this.cloneCard.visible&&(this.cloneCard.x=t.stageX-this.cloneCard.width/2,this.cloneCard.y=t.stageY-this.cloneCard.height/2)}else if(t.type==Laya.Event.MOUSE_UP){if(0!=this.posType&&this.posType!=this.selectFrom&&H.isAllowCompose(this.selectCard.data)){if(1==this.posType)2==this.selectFrom?(this.changeComposeList([this.selectCard.data],!1,0),this.clearSelect(!1)):3==this.selectFrom&&(this.changeComposeList([this.selectCard.data],!1,1),this.clearSelect(!1));else if(2==this.posType){if(1==this.selectFrom)this.changeComposeList([this.selectCard.data],!0,0),this.clearSelect(!0);else if(3==this.selectFrom){let t=H.composeSelectData[0];H.composeSelectData[0]=H.composeSelectData[1],H.composeSelectData[1]=t,this.changeComposeList([...H.composeSelectData],!0,-1),this.clearSelect(!1)}}else if(3==this.posType)if(1==this.selectFrom)this.changeComposeList([this.selectCard.data],!0,1),this.clearSelect(!0);else if(2==this.selectFrom){let t=H.composeSelectData[1];H.composeSelectData[1]=H.composeSelectData[0],H.composeSelectData[0]=t,this.changeComposeList([...H.composeSelectData],!0,-1),this.clearSelect(!1)}}else this.isMove&&this.posType==this.selectFrom&&this.posType>=2&&this.posType<=3&&(this.stopClick=!0,Laya.timer.frameOnce(2,this,()=>{this.stopClick=!1})),this.clearSelect(!0);this.isMove=!1}}onBtnClick(i){if(i.target==this.quickSelectBtn){let t={page_id:10,button_id:11,ad_id:2,ad_type:4};b.sendEvent(10002,t),H.composeSelectData[0]=null,H.composeSelectData[1]=null;let e=[];for(let t=0;t<B.instance.cardList.length;t++){let i=B.instance.cardList[t];H.isAllowCompose(i)&&e.push(i)}e.sort((t,e)=>{let i=C.Instance.getMonsterData([t.monsterId,e.monsterId]);if(i[0].level==i[1].level){if(i[0].atk==i[1].atk){if(i[0].hp==i[1].hp){let s=i[0].hp-t.curHp;return i[1].hp-e.curHp-s}return i[1].hp-i[0].hp}return i[1].atk-i[0].atk}return i[0].level-i[1].level});let i=[];for(let t=0;t<(e.length>2?2:e.length);t++)i.push(e[t]);this.changeComposeList(i,!0,-1)}else if(i.target==this.composeBtn){let i=0;for(let t=0;t<H.composeSelectData.length;t++)H.composeSelectData[t]&&i++;if(i<2)return void e.event(t.PopTip,"合成不足");if(I.isOpen)return void this.startCompose();if(B.instance.gold>=this.mixCost){let i=B.instance.gameRank+3;if(C.Instance.monsterData[this.composeResultData.monsterId].level>i)return void e.event(t.PopTip,"合成等级超过");this.startCompose(),B.instance.gold-=this.mixCost,B.instance.onDataChange("gold"),b.sendEvent(10005,{item_type:1,item_id:1,get_num:-1*this.mixCost,get_type:10,last_num:B.instance.gold}),e.event(t.UseMoney,"gold")}else L.openScene("pages/addMoney.scene",!1,!0,null,[2,200]),e.event(t.ShowGiftPack)}}startCompose(){for(let t=0;t<H.composeSelectData.length;t++){let e=B.instance.cardList.indexOf(H.composeSelectData[t]);-1!=e&&B.instance.cardList.splice(e,1)}this.playCardFly(),e.event(t.ShowComposeEffect),Laya.MouseManager.enabled=!1,I.finishInnerTask("点击合成")}playCardFly(){Laya.stage.addChild(this.card1),Laya.stage.addChild(this.card2);let t=new Laya.Point(0,0);this.cardBox1.localToGlobal(t,!1),this.card1.x=t.x,this.card1.y=t.y,this.card1.zOrder=1e3,t.x=0,t.y=0,this.cardBox2.localToGlobal(t,!1),this.card2.x=t.x,this.card2.y=t.y,this.card2.zOrder=1e3,Laya.Tween.to(this.card1,{x:Laya.stage.width/2-70,y:Laya.stage.height/2-174},500,Laya.Ease.sineOut),Laya.Tween.to(this.card2,{x:Laya.stage.width/2-70,y:Laya.stage.height/2-174},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{Laya.Tween.to(this.card1,{alpha:0},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.cardBox1.addChild(this.card1),this.card1.x=0,this.card1.y=0,this.card1.alpha=1})),Laya.Tween.to(this.card2,{alpha:0},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.cardBox2.addChild(this.card2),this.card2.x=0,this.card2.y=0,this.card2.alpha=1,this.clearCompose()}))}),250)}onComposeEnd(){Laya.MouseManager.enabled=!0,e.event(t.PopTip,"合成成功"),p.playSound("composeSuccess.mp3"),B.instance.finishTask(0,2,1);let i=C.Instance.getMonsterData([this.composeResultData.monsterId]),s=Laya.Handler.create(this,()=>{this.composeResultData.star>=3&&B.instance.luckPackLeftTime>0&&L.openScene("pages/luckyPack.scene",!1,!0,null,null,!0)});L.openScene("pages/catchResult.scene",!0,!0,s,[!0,this.composeResultData.monsterId,i[0],!1,2])}clearCompose(){H.composeSelectData[0]=null,H.composeSelectData[1]=null,this.refreshComposeList();let i=H.haveRed();this.quickSelectRed.visible=i,e.event(t.UpdateComposeRed,i),this.mixCost=0,this.composeCostLabel.text=this.mixCost+"",this.composeResultCard.visible=!1}changeComposeList(i,s,a){for(let t=0;t<i.length;t++)if(s)-1!=a?H.composeSelectData[a]=i[t]:H.composeSelectData[t]=i[t];else if(-1!=a)H.composeSelectData[a]=null;else for(let e=0;e<H.composeSelectData.length;e++)if(i[t].cardId==H.composeSelectData[e].cardId){H.composeSelectData[e]=null;break}this.cardBag.initMonsterList(),this.refreshComposeList();let n=H.haveRed();this.quickSelectRed.visible=n,e.event(t.UpdateComposeRed,n);let o=0;for(let t=0;t<H.composeSelectData.length;t++)H.composeSelectData[t]&&o++;if(2==o){let t=0;t=this.haveNewAddMonsterId()?this.getNewAddMixMonsterId():C.Instance.mixConfig[H.composeSelectData[0].monsterId].tab[H.composeSelectData[1].monsterId];let e=C.Instance.getMonsterData([t])[0];this.composeResultData=C.Instance.getOneCardData(t),this.composeResultCard.visible=!0,this.composeResultCard.dataSource=this.composeResultData,this.mixCost=C.Instance.mixCostConfig[e.level-1].cost,this.composeCostLabel.text=this.mixCost+""}else this.composeResultCard.visible=!1,this.mixCost=0,this.composeCostLabel.text=this.mixCost+"";1==o?I.finishInnerTask("选择第一只怪"):I.finishInnerTask("选择第二只怪")}refreshComposeList(){let t=[this.card1,this.card2];for(let e=0;e<H.composeSelectData.length;e++)H.composeSelectData[e]?(t[e].visible=!0,t[e].dataSource=H.composeSelectData[e]):t[e].visible=!1}exceptFunc(t){if(C.Instance.isSuperEva(t))return!1;for(let e=0;e<H.composeSelectData.length;e++)if(H.composeSelectData[e]&&t.cardId==H.composeSelectData[e].cardId)return!1;return!0}onDestroy(){e.off(t.SelectCard,this,this.onSelectPageCard),e.off(t.ComposeEnd,this,this.onComposeEnd),e.off(B.UserDataChange,this,this.onUserDataChange)}onSelectPageCard(t,e,i){if(t==this.cardBag.monsterList)if(i.data.isEgg)e.type==Laya.Event.MOUSE_DOWN&&w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{L.openScene("pages/superEggMachine.scene",!1,!0,null,[!1,!0]),i.removeStoreEgg()});else if(e.type==Laya.Event.MOUSE_DOWN)this.selectFrom=1,this.selectCard=i,this.downPoint.x=e.stageX,this.downPoint.y=e.stageY,this.cloneCard.dataSource=i.data;else if(e.type==Laya.Event.CLICK){let t=this.getFirstEmptyIndex();if(-1==t)return;if(!H.isAllowCompose(i.data))return;this.changeComposeList([i.data],!0,t)}}offSelect(){this.clearCompose(),this.cardBag.initMonsterList(),this.visible=!1,C.Instance.isPause=!1,I.finishInnerTask("点击关闭合成"),Math.random()<.5&&w.Instance.showInterstitialAd(null)}onSelect(){this.visible=!0,C.Instance.isPause=!0,e.event(t.PlayerStopMove),I.finishInnerTask("点击怪物合成")}haveNewAddMonsterId(){for(let t=0;t<H.composeSelectData.length;t++){let e=H.composeSelectData[t];if(e.monsterId>=129&&e.monsterId<=1008)return!0}return!1}getNewAddMixMonsterId(){let t=1;return[2,12,22,34,46,57,71,81,90,101][(t=(t=H.composeSelectData[0].star==H.composeSelectData[1].star?H.composeSelectData[0].star+1:Math.floor((H.composeSelectData[0].star+H.composeSelectData[1].star)/2))>10?10:t)-1]}static haveRed(){let t=0;for(let e=0;e<B.instance.cardList.length;e++){let i=B.instance.cardList[e];this.isAllowCompose(i)&&t++}return t>=2&&-1!=H.composeSelectData.indexOf(null)}getFirstEmptyIndex(){for(let t=0;t<H.composeSelectData.length;t++)if(null==H.composeSelectData[t])return t;return-1}static isAllowCompose(t){return!C.Instance.isTryCard(t)&&!C.Instance.isSuperEva(t)}}H.composeSelectData=[null,null];class Y extends i.pages.countUI{constructor(){super(...arguments),this.rewardDataList=[],this.isWin=!1}onAwake(){this.width=Laya.stage.width,this.height=Laya.stage.height,this.stageLabel.filters=[Y.colorFilter],this.videoReceiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.backBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.goComposeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.goEggShopBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.setWin(C.Instance.isGameWin),this.setBtnVideoTag()}setWin(t){this.isWin=t,w.Instance.sendVideoData={page_id:4,button_id:4,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData),w.Instance.showBannerAd(),this.setBtn(t),t?p.playSound("success.mp3"):p.playSound("fail.mp3"),t&&(C.Instance.fightType==s.Normal?this.updateGameRank():C.Instance.fightType==s.Cream?this.updateEliteGameRank():C.Instance.fightType==s.Tower&&(this.updateChallengeLevel(),C.Instance.uploadChallengeRankScore()),B.instance.finishTask(1,1,1)),this.setPlayStage(),this.setReward(t),C.Instance.fightType==s.Normal?this.setStageCollect(!1):C.Instance.fightType==s.Cream?this.setStageCollect(!0):C.Instance.fightType==s.Tower&&this.hideCollectMonsterList()}setBtn(t){this.bg1.skin=t?"count/Ui_JieSuanBg2.png":"count/Ui_JieSuanBg5.png",this.bg2.skin=t?"count/Ui_JieSuanBg3.png":"count/Ui_JieSuanBg6.png",this.strongTip.visible=!t,this.goComposeBtn.visible=!t,this.goEggShopBtn.visible=!t,this.videoReceiveBtn.visible=t,this.winTitleIcon.visible=t,this.lostTitleIcon.visible=!t,t?(this.backBtn.x=513,this.backBtn.y=870):(this.backBtn.x=360,this.backBtn.y=991)}onBtnClick(i){i.target==this.backBtn?this.onBack(!1):i.target==this.videoReceiveBtn?(w.Instance.sendVideoData={page_id:4,button_id:4,ad_id:2,ad_type:1},w.Instance.showVideoAd("adunit-e3e88638c0c5f30f",()=>{this.onBack(!0)})):i.target==this.goComposeBtn?(this.onBack(!1),e.event(t.GotoScene,"compose")):i.target==this.goEggShopBtn&&(this.onBack(!1),e.event(t.GotoScene,"eggshop"))}setStageCollect(t){this.cardList.hScrollBarSkin=null;let e=B.instance.stageCollectObj[C.Instance.enterMapIndex];t&&(e=B.instance.creamStageCollectObj[C.Instance.enterMapIndex]);let i=[];for(let t=0;t<e.length;t++){let s=e[t],a=C.Instance.getOneCardData(s);i.push(a)}this.cardList.array=i,this.cardList.refresh(),t?(B.instance.creamStageCollectObj[C.Instance.enterMapIndex]=[],B.instance.onDataChange("creamStageCollectObj")):(B.instance.stageCollectObj[C.Instance.enterMapIndex]=[],B.instance.onDataChange("stageCollectObj")),0==i.length&&this.hideCollectMonsterList()}updateGameRank(){B.instance.gameRank==C.Instance.enterMapIndex&&(B.instance.gameRank<C.Instance.stageMaxIndex?(B.instance.gameRank++,B.instance.onDataChange("gameRank")):(B.instance.gameAllPass=!0,B.instance.onDataChange("gameAllPass")),B.instance.finishTask(0,1,1))}updateEliteGameRank(){B.instance.eliteGameRank==C.Instance.enterMapIndex&&(B.instance.eliteGameRank<C.Instance.creamStageMaxIndex?(B.instance.eliteGameRank++,B.instance.onDataChange("eliteGameRank")):(B.instance.eliteGameAllPass=!0,B.instance.onDataChange("eliteGameAllPass")),B.instance.finishTask(0,1,1))}updateChallengeLevel(){let t=B.instance.challengeLevel[0],e=B.instance.challengeLevel[1];e+1>C.Instance.challengeMapData[t-1].length?t+1>C.Instance.challengeMapData.length?(B.instance.allPassChallenge=!0,B.instance.onDataChange("allPassChallenge")):(B.instance.challengeLevel[0]=t+1,B.instance.challengeLevel[1]=1):B.instance.challengeLevel[1]=e+1,B.instance.onDataChange("challengeLevel")}setPlayStage(){C.Instance.fightType==s.Normal?this.stageLabel.text=C.Instance.enterMapIndex+1+"":C.Instance.fightType==s.Cream?this.stageLabel.text=C.Instance.enterMapIndex+1+"":C.Instance.fightType==s.Tower&&(this.stageLabel.text=`${B.instance.challengeLevel[0]}-${B.instance.challengeLevel[1]}`)}setReward(t){if(t){if(C.Instance.fightType==s.Normal){let t=C.Instance.passRewardConfig[C.Instance.enterMapIndex].passReward,e=C.Instance.parseRewardData(t);this.rewardDataList=C.Instance.countRewardList(e,s.Normal)}else if(C.Instance.fightType==s.Cream){let t=C.Instance.eliteStageConfig[C.Instance.enterMapIndex].passReward,e=C.Instance.parseRewardData(t);this.rewardDataList=C.Instance.countRewardList(e,s.Cream)}else if(C.Instance.fightType==s.Tower){let t=C.Instance.challengeMapData[B.instance.challengeLevel[0]-1][B.instance.challengeLevel[1]-1],e=[...C.Instance.parseRewardData(t.passReward),...C.Instance.parseRewardData(t.firstPassReward)];this.rewardDataList=C.Instance.countRewardList(e,s.Tower)}}else this.rewardDataList.push({type:"gold",num:10});let e=C.Instance.getRewardUiDataList(this.rewardDataList);this.rewardList.array=e,this.rewardList.refresh(),this.rewardList.repeatX=e.length;for(let t=0;t<this.rewardList.length;t++){this.rewardList.getCell(t).getChildByName("label").filters=[x.blackColorFilter]}}onBack(t){if(t)for(let t=0;t<this.rewardDataList.length;t++)"gold"!=this.rewardDataList[t].type&&"badge"!=this.rewardDataList[t].type&&"chip"!=this.rewardDataList[t].type&&"fightTicket"!=this.rewardDataList[t].type||(this.rewardDataList[t].num*=2);C.Instance.receiveReward(this.rewardDataList),b.sendEvent(10005,{item_type:1,item_id:1,get_num:this.rewardDataList[0].num,get_type:9,last_num:B.instance.gold}),w.Instance.hideBannerAd(),Math.random()<.5&&w.Instance.showInterstitialAd(null),this.close(),this.isWin&&this.countPopEggMachine()}countPopEggMachine(){C.Instance.fightType!=s.Normal&&C.Instance.fightType!=s.Cream||B.instance.countPopEggLeftTime>0&&(B.instance.countPopEggLeftTime--,B.instance.onDataChange("countPopEggLeftTime"),L.openScene("pages/superEggMachine.scene",!1,!0,null,[!0,!1]))}hideCollectMonsterList(){this.catchMonsterTitle.visible=!1,this.cardList.visible=!1,this.rewardTitle.y=517,this.rewardList.y=569}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}Y.colorFilter=new Laya.ColorFilter([226/256,0,0,0,0,0,162/256,0,0,0,0,0,0,0,0,0,0,0,1,0]);class z extends i.pages.cureCellUI{constructor(){super(...arguments),this.cureCostList=[0,0,0],this.fightMonsterList=[],this.fightGroupIndexList=[],this.isBigOpen=!0}onAwake(){z.mask.skin="main/Ui_MiniHead1.png",this.cureList.hScrollBarSkin=null,this.cureList.array=this.cureCostList,this.cureList.refresh(),this.cureList.mouseHandler=Laya.Handler.create(this,this.onMouseHandler,null,!1),e.on(t.OpenBig,this,this.onOpenBig),e.on(t.OneCure,this,this.onOneCure),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),e.on("UserDataChange",this,this.onUserDataChange)}onUserDataChange(t){"gold"==t&&this.upadteCureBtnState()}onOpenBig(i){this.isBigOpen=i,i?Laya.Tween.to(this.bigBg,{x:0},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.closeBtn.visible=!0,this.mouseEnabled=!0}),0,!0):(this.closeBtn.visible=!1,this.mouseEnabled=!1,Laya.Tween.to(this.bigBg,{x:-535},200,Laya.Ease.sineOut,null,0,!0),e.event(t.OpenSmall,!0))}onOneCure(i){for(let t=0;t<this.cureCostList.length;t++)this.cureMonster(t);e.event(t.PopTip,"体力恢复"),e.event(t.CureMonster,-1),i&&e.event(t.FullHpRevive)}onBtnClick(t){t.target==this.closeBtn&&this.onOpenBig(!1)}onDestroy(){e.off(t.OpenBig,this,this.onOpenBig),e.off(t.OneCure,this,this.onOneCure),e.off("UserDataChange",this,this.onUserDataChange)}onMouseHandler(i,s){if(i.type==Laya.Event.CLICK){let i=this.cureCostList[s];i>0&&(B.instance.gold>=i||B.instance.freeCure?(B.instance.freeCure||(B.instance.gold-=i,B.instance.onDataChange("gold"),e.event(t.UseMoney,"gold")),b.sendEvent(10005,{item_type:1,item_id:1,get_num:-1*i,get_type:12,last_num:B.instance.gold}),this.cureMonster(s),e.event(t.PopTip,"体力恢复"),e.event(t.CureMonster,s)):(w.Instance.sendVideoData={page_id:5,button_id:5,ad_id:2,ad_type:1},w.Instance.showVideoAd("adunit-344c07eccef75220",()=>{this.cureMonster(s),e.event(t.PopTip,"体力恢复"),e.event(t.CureMonster,s)})))}}cureMonster(t){let e=B.instance.fightCardList[t];e&&(B.instance.finishTask(1,2,1),this.cureCostList[t]=0,e.curHp=e.hp,B.instance.onDataChange("fightCardList"),this.syncHp(e))}syncHp(t){for(let e=0;e<B.instance.cardList.length;e++)if(B.instance.cardList[e].cardId==t.cardId){B.instance.cardList[e].curHp=t.curHp,B.instance.onDataChange("cardList");break}}initBigCellData(){this.fightMonsterList.length=0,this.fightGroupIndexList.length=0;for(let t=0;t<B.instance.fightCardList.length;t++){let e=B.instance.fightCardList[t];e&&(this.fightMonsterList.push(e),this.fightGroupIndexList.push(t))}this.cardList.array=this.fightMonsterList,this.cardList.refresh();for(let t=0;t<3;t++)if(t<this.fightMonsterList.length){let e=this.fightMonsterList[t],i=C.Instance.monsterData[e.monsterId].hp;e.special&&(i+=Math.round(Math.max(5,.1*i))),this.cureCostList[t]=2*(i-e.curHp)}else this.cureCostList[t]=0;for(let t=0;t<3;t++){let e=this.cureList.getCell(t);e.getChildByName("costLabel").text=this.cureCostList[t]+"",0==this.cureCostList[t]?Laya.Tween.to(e,{y:75},100,Laya.Ease.sineOut):Laya.Tween.to(e,{y:0},100,Laya.Ease.sineOut)}this.setBtnVideoTag(),this.upadteCureBtnState()}upadteCureBtnState(){for(let t=0;t<3;t++){let e=this.cureList.getCell(t).getChildByName("videoCure");B.instance.gold>=this.cureCostList[t]?e.visible=!1:e.visible=!0}}setBtnVideoTag(){let t=1==w.Instance.videoMode;for(let e=0;e<3;e++){this.cureList.getCell(e).getChildByName("videoTag").visible=t}}}z.mask=new Laya.Image;class j extends i.pages.divisionIconUI{constructor(){super(...arguments),this.positionList1=[[51,127],[85,135],[118,127]],this.positionList2=[[31,120],[65,134],[107,134],[140,120]]}onAwake(){}setStarNum(t){let e=[this.star1,this.star2,this.star3,this.star4],i=[],s=this.positionList1;1==t?(i=[1],s=this.positionList1):2==t?(i=[1,2],s=this.positionList2):3==t?(i=[0,1,2],s=this.positionList1):4==t&&(i=[0,1,2,3],s=this.positionList2);for(let a=0;a<t;a++)e[a].visible=!0,e[a].x=s[i[a]][0],e[a].y=s[i[a]][1];for(let i=t;i<e.length;i++)e[i].visible=!1}setDivision(t){this.divisionIcon.skin=`pvp/Ui_Rank${t}.png`,this.divisionName.skin=`pvp/Ui_RankWord${t}.png`}setShowType(t,e){this.divisionName.visible=t,this.starBox.visible=e}setScore(t){}}class W extends i.pages.downPanelUI{constructor(){super(...arguments),this.btnList=[],this.pageList=[],this.curIndex=0,this.lastIndex=0,this.tweenTarget={progress:0},this.isTweening=!1,this.canChangePage=!0,this.mainPage=null,this.mainBtn=null,this.btnDataArr=null,this.pageBox=null,this.isShowMain=!0}onAwake(){}initBtnArr(t){this.curIndex=-1,this.lastIndex=-1,this.btnDataArr=t;for(let e=0;e<t.length;e++){let i=t[e];this.btnList.push(i.btn),this.pageList.push(null),i.iconSkin&&(i.btn.btnIcon.skin=i.iconSkin),i.btn.btnMask.visible=!1,i.btn.on(Laya.Event.CLICK,this,this.onBtnClick,[e])}this.tweenTarget.progress=1,this.onTweenUpdate()}setBtnScale(){for(let t=0;t<this.btnList.length;t++){let e=this.btnList[t];e.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),e.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),e.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut)}}onMouseDown(t){Laya.Tween.to(t.target,{scaleX:.9,scaleY:.9},50,Laya.Ease.sineOut)}onMouseUp(t){Laya.Tween.to(t.target,{scaleX:1,scaleY:1},50,Laya.Ease.sineIn)}onMouseOut(t){Laya.Tween.to(t.target,{scaleX:1,scaleY:1},50,Laya.Ease.sineIn)}setMainPage(t,e){this.mainPage=e,this.mainBtn=t,this.mainBtn&&this.mainBtn.on(Laya.Event.CLICK,this,this.onBtnClick,[-1])}setPage(t,e){e&&(this.pageList[t]=e,e.x=Laya.stage.width+Laya.stage.width*t)}getPage(t){return-1==t?this.mainPage:this.pageList[t]}getBtn(t){return-1==t?this.mainBtn:this.btnList[t]}onBtnClick(t,i=null){i&&i.stopPropagation();let s=this.getBtn(t),a=this.unlockBtnList.indexOf(s);if(p.playSound("click.mp3"),this.isTweening||!this.canChangePage||s.btnMask.visible)return;-1!=t&&("handBook/Btn_Close2.png"==s.btnIcon.skin?(s.btnIcon.skin=this.btnDataArr[t].iconSkin,t=-1):s.btnIcon.skin="handBook/Btn_Close2.png"),this.mainPage.visible=this.isShowMain,this.isTweening=!0,this.tweenTarget.progress=0,this.curIndex=t;let n=0;if(-1!=t&&(n=-Laya.stage.width*(a+1)),console.log("pageBox",n),Laya.Tween.to(this.pageBox,{x:n},380,Laya.Ease.backOut,Laya.Handler.create(this,this.onTweenComplete),0,!0),-1!=this.lastIndex){let t=this.getBtn(this.lastIndex);"handBook/Btn_Close2.png"==t.btnIcon.skin&&(t.btnIcon.skin=this.btnDataArr[this.lastIndex].iconSkin)}let o=this.getPage(this.lastIndex);o.offSelect&&o.offSelect();let r=this.getPage(this.curIndex);r.onSelect&&r.onSelect(),e.event(W.OnSelectPage,r)}onTweenUpdate(){let t=this.getPage(this.lastIndex),e=this.getPage(this.curIndex);-1==this.curIndex?(e.x=(1-this.tweenTarget.progress)*-Laya.stage.width,e!=t&&(t.x=this.tweenTarget.progress*Laya.stage.width)):(e.x=(1-this.tweenTarget.progress)*Laya.stage.width,e!=t&&(t.x=this.tweenTarget.progress*-Laya.stage.width))}onTweenComplete(){this.isTweening=!1,this.lastIndex=this.curIndex}showBtnRedPoint(t,e){this.btnList[t].redPoint.visible=e}setBtnLockState(t,e){this.getBtn(t).btnMask.visible=e}}W.OnSelectPage="OnSelectPage";class q extends i.pages.eggShopUI{constructor(){super(...arguments),this.isPlaying=!1,this.niuDanTimeLimit=0,this.isFirstOpenEggShop=!1}onAwake(){this.commonSpine.x=195,this.commonSpine.y=Laya.stage.height/2-130,this.superSpine.x=530,this.superSpine.y=Laya.stage.height/2-140,this.commonSpine._complete=Laya.Handler.create(this,()=>{this.commonSpine.stop(),this.commonSpine.on(Laya.Event.STOPPED,this,this.onCommonFinish)}),this.superSpine._complete=Laya.Handler.create(this,()=>{this.superSpine.stop(),this.superSpine.on(Laya.Event.STOPPED,this,this.onSuperFinish)}),this.leftLabel.text=B.instance.niuDanLeftTime+"",this.superLeftLabel.text=B.instance.niuDanSuperLeftTime+"",e.on(B.UserDataChange,this,this.onUserDataChange),this.updateNiuDanTimeStamp(),this.updateSuperEggTip(),Laya.Dialog.manager.maskLayer.alpha=.9,this.setBtnVideoTag()}updateNiuDanTimeStamp(){if(B.instance.niuDanLeftTime>0){let t=600;2==B.instance.niuDanLeftTime?t=300:3==B.instance.niuDanLeftTime?t=180:4==B.instance.niuDanLeftTime&&(t=0),this.niuDanTimeLimit=1e3*t-(Date.now()-B.instance.niuDanTimestamp),this.niuDanTimeLimit=this.niuDanTimeLimit>0?this.niuDanTimeLimit:0,this.niuDanTimeLimit>0?(this.freeRed.visible=!1,this.timeLabelBg.visible=!0,this.timeLabel.text=S.dateFormat("MM:SS",new Date(this.niuDanTimeLimit)),Laya.timer.loop(1e3,this,this.onLoop)):(this.timeLabelBg.visible=!1,this.freeRed.visible=!0)}else this.timeLabelBg.visible=!1,this.freeRed.visible=!1}onLoop(){this.niuDanTimeLimit-=1e3,this.niuDanTimeLimit<=0&&(this.niuDanTimeLimit=0,this.timeLabelBg.visible=!1,B.instance.niuDanLeftTime>0?this.freeRed.visible=!0:this.freeRed.visible=!1,Laya.timer.clear(this,this.onLoop)),this.timeLabel.text=S.dateFormat("MM:SS",new Date(this.niuDanTimeLimit))}onUserDataChange(t){"niuDanLeftTime"==t?this.leftLabel.text=B.instance.niuDanLeftTime+"":"niuDanTimestamp"==t?this.updateNiuDanTimeStamp():"niuDanSuperLeftTime"==t&&(this.superLeftLabel.text=B.instance.niuDanSuperLeftTime+"")}onCommonFinish(){this.isPlaying=!1,this.commonEggReward()}onSuperFinish(){this.isPlaying=!1,B.instance.superEggPlayTime++,B.instance.onDataChange("superEggPlayTime");let t=!1;(this.isFirstOpenEggShop||B.instance.superEggPlayTime%5==0)&&(t=!0),q.superEggReward(!0,!1,t),this.updateSuperEggTip(),Math.random()<.75&&B.instance.luckPackLeftTime>0&&L.openScene("pages/luckyPack.scene",!1,!0,null,null,!0)}onDestroy(){e.off(B.UserDataChange,this,this.onUserDataChange),e.off(I.InnerTaskStart,this,this.onInnerTaskStart),Laya.timer.clear(this,this.onLoop)}onOpened(){this.superBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.freeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),w.Instance.showBannerAd(),w.Instance.sendVideoData={page_id:6,button_id:6,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData),e.on(I.InnerTaskStart,this,this.onInnerTaskStart)}onClosed(){w.Instance.hideBannerAd(),Laya.Dialog.manager.maskLayer.alpha=UIConfig.popupBgAlpha}commonEggReward(){B.instance.niuDanLeftTime--,B.instance.onDataChange("niuDanLeftTime"),B.instance.niuDanTimestamp=Date.now(),B.instance.onDataChange("niuDanTimestamp");let t=100*Math.random();t<50?q.getCard([1,3],null):t<55?q.getCard([4,4],[1003,1008]):t<85?L.openScene("pages/getCard.scene",!1,!0,null,[1,100,2]):t<95?L.openScene("pages/getCard.scene",!1,!0,null,[1,200,2]):t<100&&L.openScene("pages/getCard.scene",!1,!0,null,[1,300,2])}static getCard(t,e=null){let i=C.Instance.getSpecifyStarMonsterCard(t,!1,e),s=C.Instance.monsterData;L.openScene("pages/catchResult.scene",!1,!0,null,[!0,i.monsterId,s[i.monsterId],!1,4,i.special])}static superEggReward(t,e,i=!1){t&&(B.instance.niuDanSuperLeftTime--,B.instance.onDataChange("niuDanSuperLeftTime"));let s=0;if(e){if(s=i?50*Math.random():55*Math.random(),B.instance.isFirstDie){B.instance.isFirstDie=!1,B.instance.onDataChange("isFirstDie");let t=C.Instance.getOneCardData(39),e=C.Instance.monsterData;return void L.openScene("pages/catchResult.scene",!1,!0,null,[!0,t.monsterId,e[t.monsterId],!1,4,t.special])}}else s=i?50*Math.random():100*Math.random();s<50?i?q.getCard([7,7],[0,158]):q.getCard([4,7],[0,158]):s<55?q.getCard([7,7],[1003,1008]):s<85?L.openScene("pages/getCard.scene",!1,!0,null,[1,300,2]):s<95?L.openScene("pages/getCard.scene",!1,!0,null,[1,400,2]):s<100&&L.openScene("pages/getCard.scene",!1,!0,null,[1,600,2])}onBtnClick(i){if(i.target==this.superBtn){if(this.isPlaying||0==B.instance.niuDanSuperLeftTime)return;w.Instance.sendVideoData={page_id:6,button_id:6,ad_id:2,ad_type:1},w.Instance.showVideoAd("adunit-b7e3aa4e04c41392",()=>{this.isPlaying=!0,this.superSpine.play(0,!1,!0,0),this.playNiuDanSound()})}else if(i.target==this.freeBtn){if(this.isPlaying||0==B.instance.niuDanLeftTime||this.niuDanTimeLimit>0)return void(this.niuDanTimeLimit>0&&e.event(t.PopTip,"扭蛋冷却中"));this.isPlaying=!0,this.commonSpine.play(0,!1,!0,0),this.playNiuDanSound()}else i.target==this.closeBtn&&this.close()}playNiuDanSound(){p.playSound("niuDanBtn.mp3"),Laya.timer.once(1300,this,()=>{p.playSound("niuDaning.mp3")})}onInnerTaskStart(t){"点击免费扭蛋"==t&&I.startInnerTask(t,[{node:this.freeBtn,isHandNode:!0}])}updateSuperEggTip(){this.isFirstOpenEggShop=B.instance.isFirstOpenEggShop,B.instance.isFirstOpenEggShop?(this.superTip.skin="ad/Ui_NiuWord1.png",B.instance.isFirstOpenEggShop=!1,B.instance.onDataChange("isFirstOpenEggShop"),this.superPlayTimeBg.visible=!1):(this.superPlayTimeBg.visible=!0,this.superTip.skin="ad/Ui_NiuWord2.png",this.superPlayTimeLabel.text=B.instance.superEggPlayTime%5+1+"")}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class K extends i.pages.escapeUI{onAwake(){this.sureBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.sureDisableBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.continueBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.initBtn()}onBtnClick(t){t.target==this.sureBtn?this.close("yes"):t.target==this.sureDisableBtn||t.target==this.continueBtn&&this.close("no")}initBtn(){C.Instance.escapeTimeLeft>0?(this.sureBtn.visible=!0,this.sureDisableBtn.visible=!1):(this.sureBtn.visible=!1,this.sureDisableBtn.visible=!0)}}class $ extends i.pages.fightUI{constructor(){super(...arguments),this.fightMonsterCardList=[]}onAwake(){e.on(t.UpdateFightData,this,this.onUpdateFightData),e.on(t.InitFightCell,this,this.onInitFightCell),e.on(t.ChangeQteState,this,this.onChangeQteState),e.on(t.QteEnd,this,this.onQteEnd),e.on(t.EnableMustKill,this,this.onEnableMustKill),e.on(t.FighterDeath,this,this.onFighterDeath),e.on(t.CloseAutoFight,this,this.onCloseAutoFight),this.width=Laya.stage.width,this.height=Laya.stage.height,this.escapeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.autoFightBg.on(Laya.Event.CLICK,this,this.onBtnClick),this.qtePage.visible=!1,window.FightScene2=this}onBtnClick(i){if(i.target==this.escapeBtn)C.Instance.isGameEnd||C.Instance.allEmptyBlood||L.openScene("pages/escape.scene",!1,!0,Laya.Handler.create(this,i=>{"yes"==i&&(C.Instance.escapeTimeLeft--,C.Instance.fightType==s.Normal||C.Instance.fightType==s.Cream?e.event(t.BacktoScene,"search"):C.Instance.fightType==s.Tower?e.event(t.BacktoScene,"challenge"):C.Instance.fightType==s.Pvp&&e.event(t.BacktoScene,"pvp"))}),null);else if(i.target==this.autoFightBg){if(B.instance.fightTicket<=0&&!B.instance.freeAutoFight)return;this.gou.visible=!this.gou.visible,C.Instance.autoFight=this.gou.visible,e.event(t.ChangeAutoFight)}}onChangeQteState(t){0==t?(this.qtePage.visible=!0,this.qtePage.qteStart()):1==t?this.qtePage.visible=!1:2==t?this.qtePage.visible=!0:3==t&&(this.qtePage.visible=!1)}onQteEnd(){this.qtePage.qteEnd()}onUpdateFightData(t,e){if("self"==t){this.fightCell.atkTimeList.getCell(e).dataSource=C.Instance.monsterAtkTimeList[e],3==C.Instance.monsterAtkTimeList[e]&&I.startOutTask("介绍必杀技");let t=this.fightCell.monsterList.getCell(e);t.dataSource=t.data}else if("enemy"==t){let t=this.enemyCardList.getCell(e);t.dataSource=t.data}}onInitFightCell(){this.fightMonsterCardList.length=0;for(let t=0;t<B.instance.fightCardList.length;t++){let e=B.instance.fightCardList[t];e&&this.fightMonsterCardList.push(e)}0==this.fightMonsterCardList.length?this.fightCell.visible=!1:(this.fightCell.visible=!0,this.fightCell.width=85+150*this.fightMonsterCardList.length,this.fightCell.x=(Laya.stage.width-this.fightCell.width)/2,this.fightCell.monsterList.array=this.fightMonsterCardList,this.fightCell.monsterList.refresh(),this.fightCell.atkTimeList.array=C.Instance.monsterAtkTimeList,this.fightCell.atkTimeList.refresh()),0==C.Instance.enemyMonsterCardList.length?this.enemyCardBg.visible=!1:(this.enemyCardBg.visible=!0,this.enemyCardBg.width=83+150*C.Instance.enemyMonsterCardList.length,C.Instance.isBoss&&(C.Instance.enemyMonsterCardList[0].hp=C.Instance.curMapData.bossStat.hp,C.Instance.enemyMonsterCardList[0].atk=C.Instance.curMapData.bossStat.atk),this.enemyCardList.array=C.Instance.enemyMonsterCardList,this.enemyCardList.refresh())}onEnableMustKill(t){for(let e=0;e<B.instance.fightCardList.length;e++){let i=B.instance.fightCardList[e];if(i){let s=this.fightCell.atkTimeList.getCell(e);i.curHp>0&&s.mustKillBtn.visible&&(s.mustKillBtn.disabled=t)}}}onFighterDeath(t,e){if(1==t){let t=this.fightCell.atkTimeList.getCell(e);t.mustKillBtn.visible&&(t.mustKillBtn.disabled=!0)}}setVisible(t){if(this.visible=t,this.visible){if(w.Instance.showBannerAd(),"undefined"!=typeof wx){let t=w.Instance.banner_Height*wx.getSystemInfoSync().pixelRatio;this.fightCell.y=-232-t,this.autoFightBg.y=-262-t}this.setAutoFight()}else w.Instance.hideBannerAd(),this.fightCell.y=-400,this.autoFightBg.y=-430}onDestroy(){e.off(t.UpdateFightData,this,this.onUpdateFightData),e.off(t.InitFightCell,this,this.onInitFightCell),e.off(t.ChangeQteState,this,this.onChangeQteState),e.off(t.QteEnd,this,this.onQteEnd),e.off(t.EnableMustKill,this,this.onEnableMustKill),e.off(t.FighterDeath,this,this.onFighterDeath),e.off(t.CloseAutoFight,this,this.onCloseAutoFight)}setAutoFight(){B.instance.gameRank>=2?(this.autoFightBg.visible=!0,C.Instance.autoFight&&(B.instance.fightTicket>0||B.instance.freeAutoFight)?this.gou.visible=!0:this.gou.visible=!1):this.autoFightBg.visible=!1}onCloseAutoFight(){this.gou.visible=!1}}class Q extends i.pages.fightCellUI{onAwake(){this.monsterList.mouseHandler=Laya.Handler.create(this,this.onMonsterListEvent,null,!1),this.atkTimeList.mouseHandler=Laya.Handler.create(this,this.onAtkTimeListEvent,null,!1)}onMonsterListEvent(i,s){i.type==Laya.Event.CLICK&&e.event(t.AttackOnce,[s,!1,!1])}onAtkTimeListEvent(i,s){if(i.type==Laya.Event.CLICK){if(C.Instance.monsterAtkTimeList[s]>=3){0==i.target.disabled&&e.event(t.AttackOnce,[s,!0,!1])}}}}class Z extends i.pages.qteUI{constructor(){super(...arguments),this.timeLeft=0,this.numList=[1,2,3,4],this.targetNum=0,this.isClickWrong=!1,this.qteTime=2,this.wrongIndex=-1,this.rollTimeLeft=3,this.totalAngle=0,this.rollDir=1,this.startPoint=new Laya.Vector2,this.nowPoint=new Laya.Vector2,this.centerPoint=new Laya.Point,this.isSuccess=!1}onAwake(){let t=new Laya.Sprite;t.width=Laya.stage.width,t.height=Laya.stage.height,t.graphics.clear(!0),t.graphics.drawRect(0,0,Laya.stage.width,Laya.stage.height,UIConfig.popupBgColor),t.alpha=UIConfig.popupBgAlpha,this.maskBox.addChild(t),this.num1.on(Laya.Event.MOUSE_DOWN,this,this.onNumClick),this.num2.on(Laya.Event.MOUSE_DOWN,this,this.onNumClick),this.num3.on(Laya.Event.MOUSE_DOWN,this,this.onNumClick),this.num4.on(Laya.Event.MOUSE_DOWN,this,this.onNumClick),this.num4.on(Laya.Event.MOUSE_DOWN,this,this.onNumClick),this.rollBg.on(Laya.Event.MOUSE_MOVE,this,this.onRollBgMove),this.rollBg.on(Laya.Event.MOUSE_DOWN,this,this.onRollBgMove),this.numImageList=[this.num1,this.num2,this.num3,this.num4],this.width=Laya.stage.width,this.height=Laya.stage.height}onQteNext(){this.qteNext()}onRollBgMove(i){if(i.type==Laya.Event.MOUSE_DOWN)this.centerPoint.x=178,this.centerPoint.y=178,this.rollBg.localToGlobal(this.centerPoint,!1),this.startPoint.x=i.stageX-this.centerPoint.x,this.startPoint.y=i.stageY-this.centerPoint.y;else if(i.type==Laya.Event.MOUSE_MOVE){this.nowPoint.x=i.stageX-this.centerPoint.x,this.nowPoint.y=i.stageY-this.centerPoint.y;let s=v.getRadBetweenVec2(this.startPoint,this.nowPoint),a=s*v.rad2Deg;this.rollBg.rotation+=a,Math.sign(s)==this.rollDir?("qte/Ui_QteZhuan1.png"!=this.rollBg.skin&&(this.rollBg.skin="qte/Ui_QteZhuan1.png"),this.totalAngle+=Math.abs(a),this.totalAngle>=360&&(this.totalAngle=0,this.rollTimeLeft>0&&(this.rollTimeLeft--,this.rollLeftLabel.text=this.rollTimeLeft+"",0==this.rollTimeLeft&&(this.isSuccess=!0,e.event(t.QteSuccess))))):("qte/Ui_QteZhuan4.png"!=this.rollBg.skin&&(this.rollBg.skin="qte/Ui_QteZhuan4.png"),this.totalAngle-=Math.abs(a),this.totalAngle<0&&(this.totalAngle=0)),this.startPoint.x=i.stageX-this.centerPoint.x,this.startPoint.y=i.stageY-this.centerPoint.y}}onNumClick(i){let s=this.numImageList.indexOf(i.target);if(s==this.numList.indexOf(this.targetNum))this.wrongIndex>=0&&(this.numImageList[this.wrongIndex].skin=`qte/Ui_White${this.numList[this.wrongIndex]}.png`,this.isClickWrong=!1,this.wrongIndex=-1),i.target.skin=`qte/Ui_Yellow${this.targetNum}.png`,this.targetNum<4?this.targetNum++:(this.isSuccess=!0,e.event(t.QteSuccess));else{if(this.isClickWrong)return;this.isClickWrong=!0;let t=this.numList[s];this.wrongIndex=s,i.target.skin=`qte/Ui_Red${t}.png`}}onDestroy(){this.qteEnd()}onFrameLoop(){this.isSuccess||this.timeLeft>0&&(this.timeLeft-=Laya.timer.delta,this.timeLeft<=0&&(this.timeLeft=0,this.qteNext()),this.setTimeLeft(this.timeLeft))}setQteType(t){1==t?(this.numBox.visible=!0,this.rollBox.visible=!1,this.initNumBox()):2==t&&(this.numBox.visible=!1,this.rollBox.visible=!0,this.initRollBox()),this.isSuccess=!1,this.setTimeLeft(3e3)}setTimeLeft(t){this.timeLeft=t,this.progressBar.width=this.timeLeft/3e3*500}initNumBox(){let t=[1,2,3,4];for(let e=0;e<4;e++)this.numList[e]=t.splice(v.getRandom(0,t.length-1),1)[0];for(let t=0;t<this.numImageList.length;t++)this.numImageList[t].skin=`qte/Ui_White${this.numList[t]}.png`;this.targetNum=1,this.isClickWrong=!1}initRollBox(){this.rollBg.skin="qte/Ui_QteZhuan1.png",this.rollTimeLeft=3,this.rollLeftLabel.text=this.rollTimeLeft+"",this.totalAngle=0,Math.random()<.5?(this.rollDir=1,this.rollBg.scaleX=1):(this.rollDir=-1,this.rollBg.scaleX=-1)}qteStart(){Laya.timer.frameLoop(1,this,this.onFrameLoop),e.on(t.QteNext,this,this.onQteNext),this.qteTime=2;let i=[1,2];this.qteTypeList=[1,2];for(let t=0;t<2;t++)this.qteTypeList[t]=i[v.getRandom(0,i.length-1)];this.qteNext()}qteNext(){console.error("netxt"),this.qteTime>0?(e.event(t.ChangeQteState,2),this.qteTime--,this.setQteType(this.qteTypeList.pop())):this.qteEnd()}qteEnd(){console.error("qteend"),Laya.timer.clear(this,this.onFrameLoop),e.off(t.QteNext,this,this.onQteNext),e.event(t.ChangeQteState,3)}}class J extends i.pages.fightDotUI{constructor(){super(...arguments),this.sign=1}onAwake(){this.dotList=[this.dot1,this.dot2,this.dot3],this.mustKillBtn.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.mustKillBtn.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.mustKillBtn.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.sign=Math.sign(this.scaleX)}set dataSource(t){if("number"==typeof t){this.mustKillBtn.visible=t>=3;for(let e=0;e<3;e++)this.dotList[e].visible=e<t}}onMouseDown(t){this.mustKillBtn.disabled||Laya.Tween.to(this.mustKillBtn,{scaleX:.9*this.sign,scaleY:.9},50,Laya.Ease.sineOut)}onMouseUp(t){this.mustKillBtn.disabled||(p.playSound("click.mp3"),Laya.Tween.to(this.mustKillBtn,{scaleX:1*this.sign,scaleY:1},50,Laya.Ease.sineIn))}onMouseOut(t){this.mustKillBtn.disabled||Laya.Tween.to(this.mustKillBtn,{scaleX:1*this.sign,scaleY:1},50,Laya.Ease.sineIn)}}class et extends i.pages.getCardUI{constructor(){super(...arguments),this.cardList=[],this.dataList=[],this.rewardNum=0,this.rewardType=0,this.rewardFrom=1}onAwake(){Laya.timer.frameLoop(1,this,this.onFrameLoop),this.setBtnVideoTag()}onOpened(){this.sureBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.doubleBtn.on(Laya.Event.CLICK,this,this.onBtnClick),p.playSound("reward.mp3"),w.Instance.showBannerAd(),w.Instance.sendVideoData={page_id:9,button_id:10,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData)}onClosed(){w.Instance.hideBannerAd()}onBtnClick(t){if(t.target==this.sureBtn||t.target==this.doubleBtn)if(1==this.rewardType||4==this.rewardType||5==this.rewardType||6==this.rewardType){let e=this.rewardNum;t.target==this.doubleBtn?(e=2*this.rewardNum,w.Instance.sendVideoData={page_id:9,button_id:10,ad_id:2,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData),w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{this.sendReward(e),b.sendEvent(10005,{item_type:1,item_id:1,get_num:e,get_type:this.rewardFrom,last_num:B.instance.gold}),this.close()})):(this.sendReward(e),b.sendEvent(10005,{item_type:1,item_id:1,get_num:e,get_type:this.rewardFrom,last_num:B.instance.gold}),this.close())}else this.close()}updateBtnType(t){0==t?(this.doubleBtn.visible=!1,this.sureBtn.visible=!0,this.sureBtn.y=112):1==t&&(this.doubleBtn.visible=!0,this.sureBtn.visible=!0,this.sureBtn.y=204,this.sureBtn.visible=!1,Laya.timer.once(w.Instance.delayTime,this,()=>{this.sureBtn.visible=!0}))}onFrameLoop(){this.lightBg.visible&&(this.lightBg.rotation+=1,this.lightBg.rotation>=360&&(this.lightBg.rotation=this.lightBg.rotation%360))}onDestroy(){}setParam(i,s,a){if(this.rewardType=i,this.rewardNum=s,this.rewardFrom=a,1==i||3==i||4==i||5==i||6==i)this.goldBg.visible=!0,this.cardBox.visible=!1,1==i||4==i||5==i||6==i?(this.updateBtnType(1),1==i?this.rewardImage.skin="count/Ui_TwoGold.png":4==i?this.rewardImage.skin="newSystem/Ui_MonsterHeadChip.png":5==i?this.rewardImage.skin="spriteShop/Ui_TwoQuan.png":6==i&&(this.doubleBtn.visible=!1,this.rewardImage.skin="pay/Ui_Diamonds.png"),this.goldLabel.text="X"+s):(this.updateBtnType(0),this.goldLabel.text="X1",1==s?(this.rewardImage.skin="main/Ui_Ball2.png",B.instance.niuDanLeftTime<4&&(B.instance.niuDanLeftTime++,B.instance.onDataChange("niuDanLeftTime"))):(this.rewardImage.skin="main/Ui_Ball.png",B.instance.niuDanSuperLeftTime<10&&(B.instance.niuDanSuperLeftTime++,B.instance.onDataChange("niuDanSuperLeftTime"))));else{this.updateBtnType(0),this.goldBg.visible=!1,this.cardBox.visible=!0;for(let t=0;t<s.length;t++)this.dataList.push(B.instance.addCard(s[t],!1,1));for(let t=0;t<this.dataList.length;t++){let e=Math.floor(t/3),i=t%3,s=this.dataList[t],a=new P;if(a.dataSource=s,this.cardBox.addChild(a),this.cardList.push(a),a.x=(a.width+10)*i,a.y=(a.height+10)*e,t==this.dataList.length-1||2==i){let t=a.x+a.width,s=(this.cardBox.width-t)/2;for(let t=0;t<i+1;t++)this.cardList[3*e+t].x+=s}}let i=this.cardList[this.cardList.length-1].y+this.cardList[this.cardList.length-1].height,a=(this.cardBox.height-i)/2;for(let t=0;t<this.cardList.length;t++)this.cardList[t].y+=a;B.instance.isFirstSelect=1,B.instance.onDataChange("isFirstSelect"),e.event(t.ChangeFightList,[[this.dataList[0]],!0,0])}}sendReward(t){let e="";1==this.rewardType?e="gold":4==this.rewardType?e="chip":5==this.rewardType?e="fightTicket":6==this.rewardType&&(e="diamond"),C.Instance.receiveReward([{type:e,num:t}])}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class it extends i.pages.getLotteryTimeUI{onAwake(){this.goShopBtn.on(Laya.Event.CLICK,this,this.onBtnClick)}onBtnClick(t){t.target==this.goShopBtn&&this.close("yes")}}class st{static iosOrder(t){return new Promise((e,i)=>{"undefined"==typeof wx?i("iosOrder:fail"):this.createOrder(t,"IOS").then(i=>{wx.navigateToMiniProgram({appId:"wx9a9c65769d117255",path:`pages/pay/test?name=${t.desc}&amount=${t.costNum}&remark=${i._id}`,envVersion:"trial",success:()=>{let t=s=>{0==s.referrerInfo.extraData.code&&(this.changeOrderStatus(i,"待发货"),this.changeOrderStatus(i,"已发货"),e()),wx.offShow(t)};wx.onShow(t)},fail:()=>{}})})})}static requestMidasPayment(t){return new Promise((e,i)=>{"undefined"==typeof wx?i("requestMidasPayment:fail"):wx.requestMidasPayment({mode:"game",env:0,offerId:"1450032621",platform:"android",currencyType:"CNY",buyQuantity:t.buyQuantity,zoneId:"1",success:t=>{console.log(t),e(t)},fail:t=>{console.error(t),i("requestMidasPayment:fail")},complete:t=>{console.log(t)}})})}static getBalance(){return new Promise((t,e)=>{"undefined"==typeof wx&&e("getBalance:fail"),wx.cloud.callFunction({name:"getBalance",success:i=>{if(console.log(i),i.result&&i.result.hasOwnProperty("balance")){let e=i.result.balance;t({balance:e})}else e("getBalance:fail")},fail:t=>{console.error(t),e("getBalance:fail")}})})}static buyItem(t){return new Promise((e,i)=>{"undefined"==typeof wx&&i("buyItem:fail");{let i=!1;if(-1!=wx.getSystemInfoSync().model.indexOf("iPhone")&&(i=!0),i)this.iosOrder(t).then(()=>{e()});else{let i=100*t.costNum;this.createOrder(t,"Android").then(t=>{this.requestMidasPayment({buyQuantity:i}).then(()=>{this.changeOrderStatus(t,"待发货"),this.midasPay(t).then(()=>{this.changeOrderStatus(t,"已发货"),e()}).catch(()=>{})}).catch(()=>{})})}}})}static createOrder(t,e){return new Promise((i,s)=>{"undefined"==typeof wx&&s("createOrder:fail");{let a={pt:e,itemId:t.productId,price:t.costNum,amount:1,desc:t.desc,status:"待支付",createTime:new Date,updateTime:new Date};f.add("orderinfo",a).then(t=>{console.log(t),a._id=t._id,a.amt=100*a.price,i(a)}).catch(t=>{s("createOrder:fail")})}})}static midasPay(t){return new Promise((e,i)=>{"undefined"==typeof wx&&i("midasPay:fail"),wx.cloud.callFunction({name:"midasPay",data:{amt:t.amt,billNo:t._id},success:t=>{console.log(t),t.result&&0==t.result.errCode?e():i("midasPay:fail")},fail:e=>{this.midasCancelPay(t),console.error(e),i("midasPay:fail")}})})}static midasCancelPay(t){return new Promise((e,i)=>{"undefined"==typeof wx&&i("midasCancelPay:fail"),wx.cloud.callFunction({name:"midasCancelPay",data:{billNo:t._id},success:t=>{console.log(t),t.result&&0==t.result.errCode?e():i("midasCancelPay:fail")},fail:t=>{console.error(t),i("midasCancelPay:fail")}})})}static changeOrderStatus(t,e){return f.update("orderinfo",t._id,{status:e})}}class at extends i.pages.giftPackUI{onAwake(){this.hpLabel1.filters=[x.blackColorFilter],this.atkLabel1.filters=[x.blackColorFilter],this.hpLabel2.filters=[x.blackColorFilter],this.atkLabel2.filters=[x.blackColorFilter],this.hpLabel3.filters=[x.blackColorFilter],this.atkLabel3.filters=[x.blackColorFilter],this.buyBtn.on(Laya.Event.CLICK,this,this.onBtnClick)}set dataSource(t){if(this.data=t,!t)return;let e=[[566,156],[566,158],[566,152],[566,152],[566,152],[566,211],[566,211],[566,329]],i=[[this.hpLabel1,this.atkLabel1],[this.hpLabel2,this.atkLabel2],[this.hpLabel3,this.atkLabel3]],s=["新手礼包A","新手礼包B","新手礼包C","新手礼包D","成长礼包","资深礼包A","资深礼包B","资深礼包C"].indexOf(t.desc);this.width=e[s][0],this.height=e[s][1],this.bg.skin=`pay/Ui_Gift${s+1}.png`;let a=[1,1,1,1,0,2,2,3][s];for(let t=0;t<i.length;t++)t<a?(i[t][0].visible=!0,i[t][1].visible=!0):(i[t][0].visible=!1,i[t][1].visible=!1);let n=[[[242,77],[324,77],[436,53]],[[242,75],[324,75],[438,52]],[[241,73],[323,73],[438,53]],[[241,76],[323,76],[437,52]],[[0,0],[0,0],[435,53]],[[44,124],[126,124],[318,78],[398,78],[463,71]],[[43,125],[125,125],[323,62],[405,62],[462,74]],[[66,224],[148,224],[86,73],[168,73],[388,100],[470,100],[443,152]]][s],o=0;for(let t=0;t<a;t++){let e=i[t];e[0].x=n[o][0],e[0].y=n[o][1],o++,e[1].x=n[o][0],e[1].y=n[o][1],o++}this.updateMonsterData(),this.buyBtn.x=n[n.length-1][0],this.buyBtn.y=n[n.length-1][1],this.buyBtn.skin=["pay/Btn_Money1.png","pay/Btn_Money2.png","pay/Btn_Money2.png","pay/Btn_Money3.png","pay/Btn_Money1.png","pay/Btn_Money4.png","pay/Btn_Money5.png","pay/Btn_Money6.png"][s];let r=C.Instance.getGiftPackBuyTime(this.data.productId);this.data.limit>0?(this.limitBg.visible=!0,this.limitLabel.text=`${r}/${this.data.limit}`):this.limitBg.visible=!1,"成长礼包"==this.data.desc&&r>=1?this.buyMask.visible=!0:this.buyMask.visible=!1}onBtnClick(t){if(t.target==this.buyBtn){if(!this.getCanBuy(this.data))return;"undefined"==typeof wx?this.buyGiftPackSuccess():st.buyItem(this.data).then(()=>{this.buyGiftPackSuccess()})}}buyGiftPackSuccess(){this.getSpecialReward(this.data),this.updateForceDataObj(),C.Instance.receiveReward(this.data.goods),C.Instance.forceDataObj={},B.instance.giftPackBuyRecord[this.data.productId]||(B.instance.giftPackBuyRecord[this.data.productId]=0),B.instance.giftPackBuyRecord[this.data.productId]++,B.instance.onDataChange("giftPackBuyRecord"),e.event(t.RefreshGiftPackList),this.addLotteryTime(this.data.costNum)}getCanBuy(i){let s=!0,a=C.Instance.getGiftPackBuyTime(i.productId);if("新手礼包A"==i.desc)a>=1&&(s=!1);else if("新手礼包B"==i.desc){let n=C.Instance.getGiftPackBuyTime(i.productId-1);(0==n||a>=1)&&(s=!1),0==n&&e.event(t.PopTip,"购买前置礼包")}else if("新手礼包C"==i.desc){let n=C.Instance.getGiftPackBuyTime(i.productId-1);(0==n||a>=1)&&(s=!1),0==n&&e.event(t.PopTip,"购买前置礼包")}else"成长礼包"==i.desc&&a>=1&&(s=!1);return s}getSpecialReward(t){"资深礼包A"==t.desc?(B.instance.gameRank=7,B.instance.eliteGameRank=7,B.instance.onDataChange("gameRank"),B.instance.onDataChange("eliteGameRank")):"资深礼包B"==t.desc?(B.instance.speedBuff=2,B.instance.onDataChange("speedBuff")):"资深礼包C"==t.desc&&(this.openAllCollectMonster(),w.Instance.noAd=!0,B.instance.noAd=!0,B.instance.freeAutoFight=!0,B.instance.freeCure=!0,B.instance.onDataChange("noAd"),B.instance.onDataChange("freeAutoFight"),B.instance.onDataChange("freeCure"))}openAllCollectMonster(){for(const t in C.Instance.monsterData){let e=Number(t);-1==B.instance.collectMonsterIdList.indexOf(e)&&B.instance.collectMonsterIdList.push(e)}B.instance.onDataChange("collectMonsterIdList")}addLotteryTime(t){let e=3*t;B.instance.freeLotteryTimeLeft+=e,B.instance.onDataChange("freeLotteryTimeLeft")}updateMonsterData(){let t=[[this.hpLabel1,this.atkLabel1],[this.hpLabel2,this.atkLabel2],[this.hpLabel3,this.atkLabel3]];for(let e=0;e<this.data.goods.length;e++){let i=this.data.goods[e];if("monster"==i.type){let s=t[e],a=C.Instance.getOneCardData(i.num);i.star&&C.Instance.upMonsterDataToSpecifyStar(a,i.star),s[0].text=a.hp+"",s[1].text=a.atk+""}}}updateForceDataObj(){let t=[[this.hpLabel1,this.atkLabel1],[this.hpLabel2,this.atkLabel2],[this.hpLabel3,this.atkLabel3]];for(let e=0;e<this.data.goods.length;e++){let i=this.data.goods[e];if("monster"==i.type){let s=t[e],a=Number(s[0].text),n=Number(s[1].text);C.Instance.forceDataObj[i.num]={hp:a,atk:n,star:i.star}}}}}class nt extends i.pages.giftPackPageUI{constructor(){super(...arguments),this.curTabIndex=-1,this.giftPackList=[],this.spaceY=10}onAwake(){this.tabList.mouseHandler=Laya.Handler.create(this,this.onTabListMouseHandler,null,!1),this.initTabList(0),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.packPanel.vScrollBarSkin=null,e.on(t.RefreshGiftPackList,this,this.onRefreshGiftPackList)}onDestroy(){e.off(t.RefreshGiftPackList,this,this.onRefreshGiftPackList)}initTabList(t){if(t==this.curTabIndex)return;let e=[];for(let i=0;i<3;i++)t!=i?e.push({tabBg:{skin:"spriteShop/Btn_Shop1.png"},tabLabel:{skin:`pay/Btn_Giftword${2*(i+1)-1}.png`}}):e.push({tabBg:{skin:"spriteShop/Btn_Shop2.png"},tabLabel:{skin:`pay/Btn_Giftword${2*(i+1)}.png`}});this.tabList.array=e,this.tabList.refresh(),this.curTabIndex=t,this.initItemList(this.curTabIndex)}initItemList(t){this.giftPackDataList=this.getGiftPackDataList(["newGiftPack","middleGiftPack","superGiftPack"][t]);let e=this.giftPackDataList.length-this.giftPackList.length,i=e>0?this.giftPackDataList.length:this.giftPackList.length,s=e>0?this.giftPackList.length:this.giftPackDataList.length,a=0;for(let t=0;t<i;)if(t<s){let e=this.giftPackList[t],i=this.giftPackDataList[t];e.dataSource=i,e.y=a,a+=e.height+this.spaceY,t++}else if(e>0){let e=this.getOneCell(),i=this.giftPackDataList[t];e.dataSource=i,e.y=a,a+=e.height+this.spaceY,this.packPanel.addChild(e),this.giftPackList.push(e),t++}else{let e=this.giftPackList[t];e.removeSelf(),Laya.Pool.recover("GiftPack",e),this.giftPackList.splice(t,1),i=this.giftPackList.length}}onTabListMouseHandler(t,e){t.type==Laya.Event.CLICK&&this.initTabList(e)}onBtnClick(t){t.target==this.closeBtn&&this.close()}getOneCell(){let t=Laya.Pool.getItem("GiftPack");return t||(t=new at),t}getGiftPackDataList(t){let e=[...C.Instance.goodsItem[t]];if("newGiftPack"==t){if(0==S.DateDiff(B.instance.registerTimestamp,Date.now())){let t=[];for(let i=0;i<3;i++){let s=e[i];0==C.Instance.getGiftPackBuyTime(s.productId)&&t.push(s)}e=t}else{let t=!1;for(let i=0;i<e.length;i++){let s=e[i];if(C.Instance.getGiftPackBuyTime(s.productId)>0){t=!0;break}}t?e.length=0:e=[e[3]]}}else if("superGiftPack"==t)for(let t=0;t<e.length;){let i=e[t];C.Instance.getGiftPackBuyTime(i.productId)>=i.limit?e.splice(t,1):t++}return e}onRefreshGiftPackList(){this.initItemList(this.curTabIndex)}}class ot extends i.pages.groupUI{constructor(){super(...arguments),this.selectCard=null,this.cloneCard=null,this.posType=0,this.selectFrom=0,this.stopClick=!1,this.isMove=!1,this.downPoint=new Laya.Point}onAwake(){e.on(t.SelectCard,this,this.onSelectPageCard),this.refreshFightGroupList(),this.cardBag.isShowStoreEgg=!0,this.cardBag.exceptFunc=this.exceptFunc,this.cardBag.initMonsterList(),this.quickUpBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.on(Laya.Event.MOUSE_MOVE,this,this.onGroupPageEvent),this.on(Laya.Event.MOUSE_UP,this,this.onGroupPageEvent),this.cardBag.monsterList.on(Laya.Event.MOUSE_OUT,this,this.onCardBagEvent),this.cardBag.monsterList.on(Laya.Event.MOUSE_OVER,this,this.onCardBagEvent),this.cardBox1.on(Laya.Event.MOUSE_OUT,this,this.onUpListEvent),this.cardBox1.on(Laya.Event.MOUSE_OVER,this,this.onUpListEvent),this.cardBox1.on(Laya.Event.CLICK,this,this.onUpListEvent),this.cardBox1.on(Laya.Event.MOUSE_DOWN,this,this.onUpListEvent),this.cardBox2.on(Laya.Event.MOUSE_OUT,this,this.onUpListEvent),this.cardBox2.on(Laya.Event.MOUSE_OVER,this,this.onUpListEvent),this.cardBox2.on(Laya.Event.CLICK,this,this.onUpListEvent),this.cardBox2.on(Laya.Event.MOUSE_DOWN,this,this.onUpListEvent),this.cardBox3.on(Laya.Event.MOUSE_OUT,this,this.onUpListEvent),this.cardBox3.on(Laya.Event.MOUSE_OVER,this,this.onUpListEvent),this.cardBox3.on(Laya.Event.CLICK,this,this.onUpListEvent),this.cardBox3.on(Laya.Event.MOUSE_DOWN,this,this.onUpListEvent),this.cloneCard=new P,this.addChild(this.cloneCard),this.cloneCard.visible=!1,e.on(B.UserDataChange,this,this.onUserDataChange),e.on(t.ComposeNew,this,this.onComposeNew),e.on(t.ChangeFightList,this,this.onChangeFightList),this.quickUpRed.visible=ot.haveRed(),this.judgeUnlockFightPos(),this.updateFightPosState(),this.registerUnlockPosBtnEvent(),this.setBtnVideoTag()}onChangeFightList(t,e,i){this.changeFightList(t,e,i)}onUpListEvent(i){if(i.target==this.cardBox1){if(i.type==Laya.Event.MOUSE_OUT)this.posType=0;else if(i.type==Laya.Event.MOUSE_OVER)this.posType=2;else if(i.type==Laya.Event.MOUSE_DOWN){if(!this.card1.visible)return;this.selectCard=this.card1,this.selectFrom=2,this.downPoint.x=i.stageX,this.downPoint.y=i.stageY,this.cloneCard.dataSource=this.selectCard.data}else if(i.type==Laya.Event.CLICK){if(this.stopClick||!this.card1.visible)return;if(this.otherAllEmpty(0))return void e.event(t.PopTip,"至少上阵一只怪物");if(!this.fightPosUnlock(0))return;this.changeFightList([this.card1.data],!1,0)}}else if(i.target==this.cardBox2){if(i.type==Laya.Event.MOUSE_OUT)this.posType=0;else if(i.type==Laya.Event.MOUSE_OVER)this.posType=3;else if(i.type==Laya.Event.MOUSE_DOWN){if(!this.card2.visible)return;this.selectCard=this.card2,this.selectFrom=3,this.downPoint.x=i.stageX,this.downPoint.y=i.stageY,this.cloneCard.dataSource=this.selectCard.data}else if(i.type==Laya.Event.CLICK){if(this.stopClick||!this.card2.visible)return;if(this.otherAllEmpty(1))return void e.event(t.PopTip,"至少上阵一只怪物");if(!this.fightPosUnlock(1))return;this.changeFightList([this.card1.data],!1,1)}}else if(i.target==this.cardBox3)if(i.type==Laya.Event.MOUSE_OUT)this.posType=0;else if(i.type==Laya.Event.MOUSE_OVER)this.posType=4;else if(i.type==Laya.Event.MOUSE_DOWN){if(!this.card3.visible)return;this.selectCard=this.card3,this.selectFrom=4,this.downPoint.x=i.stageX,this.downPoint.y=i.stageY,this.cloneCard.dataSource=this.selectCard.data}else if(i.type==Laya.Event.CLICK){if(this.stopClick||!this.card3.visible)return;if(this.otherAllEmpty(2))return void e.event(t.PopTip,"至少上阵一只怪物");if(!this.fightPosUnlock(2))return;this.changeFightList([this.card1.data],!1,2)}}getFirstEmptyUnlockIndex(){for(let t=0;t<B.instance.fightCardList.length;t++)if(null==B.instance.fightCardList[t]&&this.fightPosUnlock(t))return t;return-1}onCardBagEvent(t){t.type==Laya.Event.MOUSE_OUT?this.posType=0:t.type==Laya.Event.MOUSE_OVER&&(this.posType=1)}onGroupPageEvent(i){if(this.selectCard)if(i.type==Laya.Event.MOUSE_MOVE)this.selectCard.visible&&(this.cloneCard.visible=!0,this.selectCard.visible=!1,this.cardBag.monsterList.scrollBar.stopScroll()),this.cloneCard.visible&&(this.cloneCard.x=i.stageX-this.cloneCard.width/2,this.cloneCard.y=i.stageY-this.cloneCard.height/2),this.isMove=!0;else if(i.type==Laya.Event.MOUSE_UP){if(0==this.posType||this.posType==this.selectFrom||this.posType>=2&&this.posType<=4&&!this.fightPosUnlock(this.posType-2)||1==this.posType&&this.otherAllEmpty(this.selectFrom-2))this.isMove&&this.posType==this.selectFrom&&this.posType>=2&&this.posType<=4&&(this.stopClick=!0,Laya.timer.frameOnce(2,this,()=>{this.stopClick=!1})),1==this.posType&&this.otherAllEmpty(this.selectFrom-2)&&e.event(t.PopTip,"至少上阵一只怪物"),this.clearSelect(!0);else if(1==this.posType)2==this.selectFrom?(this.changeFightList([this.selectCard.data],!1,0),this.clearSelect(!1)):3==this.selectFrom?(this.changeFightList([this.selectCard.data],!1,1),this.clearSelect(!1)):4==this.selectFrom&&(this.changeFightList([this.selectCard.data],!1,2),this.clearSelect(!1));else if(2==this.posType){if(1==this.selectFrom)this.changeFightList([this.selectCard.data],!0,0),this.clearSelect(!1),e.event(t.PopTip,"上阵成功");else if(3==this.selectFrom){let t=B.instance.fightCardList[0];B.instance.fightCardList[0]=B.instance.fightCardList[1],B.instance.fightCardList[1]=t,this.changeFightList([...B.instance.fightCardList],!0,-1),this.clearSelect(!1)}else if(4==this.selectFrom){let t=B.instance.fightCardList[0];B.instance.fightCardList[0]=B.instance.fightCardList[2],B.instance.fightCardList[2]=t,this.changeFightList([...B.instance.fightCardList],!0,-1),this.clearSelect(!1)}}else if(3==this.posType){if(1==this.selectFrom)this.changeFightList([this.selectCard.data],!0,1),this.clearSelect(!1),e.event(t.PopTip,"上阵成功");else if(2==this.selectFrom){let t=B.instance.fightCardList[1];B.instance.fightCardList[1]=B.instance.fightCardList[0],B.instance.fightCardList[0]=t,this.changeFightList([...B.instance.fightCardList],!0,-1),this.clearSelect(!1)}else if(4==this.selectFrom){let t=B.instance.fightCardList[1];B.instance.fightCardList[1]=B.instance.fightCardList[2],B.instance.fightCardList[2]=t,this.changeFightList([...B.instance.fightCardList],!0,-1),this.clearSelect(!1)}}else if(4==this.posType)if(1==this.selectFrom)this.changeFightList([this.selectCard.data],!0,2),this.clearSelect(!1),e.event(t.PopTip,"上阵成功");else if(2==this.selectFrom){let t=B.instance.fightCardList[2];B.instance.fightCardList[2]=B.instance.fightCardList[0],B.instance.fightCardList[0]=t,this.changeFightList([...B.instance.fightCardList],!0,-1),this.clearSelect(!1)}else if(3==this.selectFrom){let t=B.instance.fightCardList[2];B.instance.fightCardList[2]=B.instance.fightCardList[1],B.instance.fightCardList[1]=t,this.changeFightList([...B.instance.fightCardList],!0,-1),this.clearSelect(!1)}this.isMove=!1}}clearSelect(t){this.cloneCard.visible=!1,t&&(this.selectCard.visible=!0),this.selectCard=null,this.selectFrom=0,this.posType=0,this.downPoint.x=0,this.downPoint.y=0}exceptFunc(t){for(let e=0;e<B.instance.fightCardList.length;e++)if(B.instance.fightCardList[e]&&t.cardId==B.instance.fightCardList[e].cardId)return!1;return!0}onDestroy(){e.off(B.UserDataChange,this,this.onUserDataChange),e.off(t.SelectCard,this,this.onSelectPageCard),e.off(t.ComposeNew,this,this.onComposeNew),e.off(t.ChangeFightList,this,this.onChangeFightList)}onComposeNew(t){let e=-1;for(let t=0;t<B.instance.fightCardList.length;t++)if(null==B.instance.fightCardList[t]&&this.fightPosUnlock(t)){e=t;break}-1!=e&&this.changeFightList([t],!0,e)}onUpBoxEvent(){}onUserDataChange(t){"cardList"==t?this.removeComposeCardFromFightList():"fightCardList"!=t&&"fightPosUnlock"!=t||(this.quickUpRed.visible=ot.haveRed())}onSelectPageCard(t,e,i){if(t==this.cardBag.monsterList)if(i.data.isEgg)e.type==Laya.Event.MOUSE_DOWN&&w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{L.openScene("pages/superEggMachine.scene",!1,!0,null,[!1,!0]),i.removeStoreEgg()});else if(e.type==Laya.Event.MOUSE_DOWN)this.selectFrom=1,this.selectCard=i,this.downPoint.x=e.stageX,this.downPoint.y=e.stageY,this.cloneCard.dataSource=i.data;else if(e.type==Laya.Event.CLICK){let t=this.getFirstEmptyUnlockIndex();-1!=t&&this.changeFightList([i.data],!0,t)}}refreshFightGroupList(){let t=[this.card1,this.card2,this.card3];for(let e=0;e<B.instance.fightCardList.length;e++)B.instance.fightCardList[e]?(t[e].visible=!0,t[e].dataSource=B.instance.fightCardList[e]):t[e].visible=!1}onBtnClick(i){if(i.target==this.quickUpBtn){let i=[...B.instance.cardList];i.sort((t,e)=>e.atk+e.hp-(t.atk+t.hp));let s=[],a=0;for(let t=0;t<3;t++)a<i.length&&this.fightPosUnlock(t)?(s.push(i[a]),a++):s.push(null);for(let i=0;i<s.length;i++)if(s[i]){let a=!1;for(let t=0;t<B.instance.fightCardList.length;t++)if(B.instance.fightCardList[t]&&s[i].cardId==B.instance.fightCardList[t].cardId){a=!0;break}if(!a){e.event(t.PopTip,"上阵成功");break}}this.changeFightList(s,!0,-1),I.finishInnerTask("点击一键上阵")}}changeFightList(t,e,i){for(let s=0;s<t.length;s++)if(e)-1!=i?B.instance.fightCardList[i]=t[s]:B.instance.fightCardList[s]=t[s];else if(-1!=i)B.instance.fightCardList[i]=null;else for(let e=0;e<B.instance.fightCardList.length;e++)if(t[s].cardId==B.instance.fightCardList[e].cardId){B.instance.fightCardList[e]=null;break}B.instance.onDataChange("fightCardList"),this.refreshFightGroupList(),this.cardBag.initMonsterList()}removeComposeCardFromFightList(){if(B.instance.fightCardList.length>0){let t=[];for(let e=0;e<B.instance.cardList.length;e++)t.push(B.instance.cardList[e].cardId);for(let e=0;e<B.instance.fightCardList.length;){let i=B.instance.fightCardList[e];i&&-1==t.indexOf(i.cardId)?B.instance.fightCardList[e]=null:e++}B.instance.onDataChange("fightCardList"),this.refreshFightGroupList()}}onSelect(){this.visible=!0,C.Instance.isPause=!0,e.event(t.PlayerStopMove),I.finishInnerTask("点击队伍组建")}offSelect(){this.visible=!1,C.Instance.isPause=!1,I.finishInnerTask("点击关闭队伍组建"),Math.random()<.5&&w.Instance.showInterstitialAd(null)}updateFightPosState(){let t=[];for(let e=0;e<B.instance.fightPosUnlock.length;e++){let i={unlockBtn:{visible:!1},cover:{skin:"ad/Ui_MaskShangZhen1.png",visible:!1}};B.instance.fightPosUnlock[e]?(i.unlockBtn.visible=!1,i.cover.visible=!1):(i.unlockBtn.visible=!0,i.cover.visible=!0,1==e?i.cover.skin="ad/Ui_MaskShangZhen1.png":2==e&&(i.cover.skin="ad/Ui_MaskShangZhen2.png")),t.push(i)}let e=[this.lockBox1,this.lockBox2,this.lockBox3];for(let i=0;i<t.length;i++)0==t[i].unlockBtn.visible?e[i].visible=!1:(e[i].visible=!0,e[i].getChildByName("cover").skin=t[i].cover.skin)}registerUnlockPosBtnEvent(){let t=[this.lockBox1,this.lockBox2,this.lockBox3];for(let e=0;e<t.length;e++){t[e].getChildByName("unlockBtn").on(Laya.Event.CLICK,this,this.onUnlockFightPos,[e])}}onStateListHandler(t,e){console.log(t,e)}onUnlockFightPos(t){0==B.instance.fightPosUnlock[t]&&w.Instance.showVideoAd("adunit-cf2f4369f3e13570",()=>{B.instance.fightPosUnlock[t]=!0,B.instance.onDataChange("fightPosUnlock"),this.updateFightPosState()})}fightPosUnlock(t){return B.instance.fightPosUnlock[t]}judgeUnlockFightPos(){if(0==B.instance.fightPosUnlock[1]){S.dayDiff(B.instance.registerTimestamp,Date.now())>=1&&(B.instance.fightPosUnlock[1]=!0,B.instance.onDataChange("fightPosUnlock"))}}otherAllEmpty(t){for(let e=0;e<B.instance.fightCardList.length;e++){let i=B.instance.fightCardList[e];if(e!=t&&i)return!1}return!0}static haveRed(){if(-1==B.instance.fightCardList.indexOf(null))return!1;let t=!1;for(let e=0;e<B.instance.fightCardList.length;e++)if(B.instance.fightPosUnlock[e]&&!B.instance.fightCardList[e]){t=!0;break}if(!t)return!1;let e=[...B.instance.cardList];e.sort((t,e)=>{let i=C.Instance.getMonsterData([t.monsterId,e.monsterId]);return t.monsterId>=120||e.monsterId>=120?i[0].level==i[1].level?e.monsterId-t.monsterId:i[1].level-i[0].level:t.monsterId==e.monsterId?t.curHp==e.curHp?i[1].atk-i[0].atk:e.curHp-t.curHp:e.monsterId-t.monsterId});let i=[];for(let t=0;t<3;t++)t<e.length?i.push(e[t]):i.push(null);for(let t=0;t<i.length;t++)if(i[t]){let e=!1;for(let s=0;s<B.instance.fightCardList.length;s++)if(B.instance.fightCardList[s]&&i[t].cardId==B.instance.fightCardList[s].cardId){e=!0;break}if(!e)return!0}return!1}setBtnVideoTag(){let t=1==w.Instance.videoMode,e=[this.lockBox1,this.lockBox2,this.lockBox3];for(let i=0;i<e.length;i++){e[i].getChildByName("videoTag").visible=t}}}class rt extends i.pages.handBookUI{constructor(){super(...arguments),this.curPage=0,this.maxPage=0,this.panelDownX=0,this.isUpTrigger=!1,this.require=0,this.reward=0,this.cardPageDataList=[],this.cardDataList=[],this.redFilter=new Laya.ColorFilter([1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0])}onAwake(){this.rewardTargetLabel.filters=[this.redFilter],this.monsterList.hScrollBarSkin=null,this.monsterList.scrollBar.rollRatio=0,this.monsterList.elasticEnabled=!0,this.pagePoint.x=24*this.curPage,this.leftBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.rightBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.receiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.monsterList.on(Laya.Event.MOUSE_UP,this,this.onPanelEvent),this.monsterList.on(Laya.Event.MOUSE_OUT,this,this.onPanelEvent),this.monsterList.on(Laya.Event.MOUSE_DOWN,this,this.onPanelEvent),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.initCardDataList(),this.initMonsterList(),this.pageLabel.text=`${this.curPage+1}/${this.maxPage}`,this.updateCollect(),e.on(B.UserDataChange,this,this.onUserDataChange),e.on(t.SelectCard,this,this.onSelectPageCard)}onSelectPageCard(t,e,i){t==this.monsterList&&e.type==Laya.Event.CLICK&&L.openScene("pages/handBookDetail.scene",!1,!0,null,[i.data.monsterId],!1)}onPanelEvent(t){if(t.type==Laya.Event.MOUSE_DOWN)this.panelDownX=t.stageX;else{if(t.type==Laya.Event.MOUSE_UP&&(this.isUpTrigger=!0),t.type==Laya.Event.MOUSE_OUT&&this.isUpTrigger)return void(this.isUpTrigger=!1);let e=this.panelDownX-t.stageX;if(Math.abs(e)<100){if(0==this.curPage&&-1==Math.sign(e)||this.curPage==this.maxPage-1&&1==Math.sign(e))return;return void this.tweenList(this.curPage)}this.curPage+Math.sign(e)>=0&&this.curPage+Math.sign(e)<this.maxPage&&this.tweenList(this.curPage+Math.sign(e))}}onBtnClick(i){if(i.target==this.leftBtn)this.curPage>0&&(this.curPage--,this.tweenList(this.curPage));else if(i.target==this.rightBtn)this.curPage<this.maxPage-1&&(this.curPage++,this.tweenList(this.curPage));else if(i.target==this.receiveBtn){if(B.instance.collectReceived)return;if(B.instance.collectMonsterIdList.length<this.require)return void e.event(t.PopTip,"收集足够怪");b.sendEvent(10008,{mission_type:"3",mission_id:B.instance.collectStage+101}),e.event(t.PopTip,"领取成功"),L.openScene("pages/getCard.scene",!1,!0,null,[1,this.reward,3]),B.instance.collectReceived=1,B.instance.onDataChange("collectReceived"),B.instance.collectStage<25&&(B.instance.collectReceived=0,B.instance.onDataChange("collectReceived"),B.instance.collectStage++,B.instance.onDataChange("collectStage"))}else i.target==this.closeBtn&&e.event(t.ShowHandBook,!1)}onDestroy(){e.off(B.UserDataChange,this,this.onUserDataChange),e.off(t.SelectCard,this,this.onSelectPageCard)}tweenList(t){if(-1==t)return;this.curPage=t;let e=Laya.stage.width*t;this.pageLabel.text=`${this.curPage+1}/${this.maxPage}`,0==this.curPage?Laya.Tween.to(this.leftBtn,{alpha:.5},100,Laya.Ease.sineOut):Laya.Tween.to(this.leftBtn,{alpha:1},100,Laya.Ease.sineOut),this.curPage==this.maxPage-1?Laya.Tween.to(this.rightBtn,{alpha:.5},100,Laya.Ease.sineOut):Laya.Tween.to(this.rightBtn,{alpha:1},100,Laya.Ease.sineOut),Laya.Tween.to(this.monsterList.scrollBar,{value:e},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.monsterList.scrollBar.stopScroll()}),0,!0),Laya.Tween.to(this.pagePoint,{x:24*this.curPage},200,Laya.Ease.sineOut)}updateCollect(){this.receiveLabel.text=`${B.instance.collectMonsterIdList.length}/${this.cardDataList.length}`;let t=C.Instance.collectConfig[B.instance.collectStage];this.require=t.require,this.reward=t.reward,this.rewardTargetLabel.text=t.require,this.rewardMoneyLabel.text=t.reward,this.receiveRed.visible=rt.haveRed()}initMonsterList(){this.cardPageDataList.length=0;for(let t=0;t<this.cardDataList.length;t++){let e=Math.floor(t/12);this.cardPageDataList[e]||(this.cardPageDataList[e]=[]),this.cardPageDataList[e].push(this.cardDataList[t])}this.maxPage=this.cardPageDataList.length,this.monsterList.array=this.cardPageDataList,this.monsterList.refresh(),this.updateArrow()}updateArrow(){this.maxPage<=1?(this.leftBtn.alpha=.5,this.rightBtn.alpha=.5):0==this.curPage?(this.leftBtn.alpha=.5,this.rightBtn.alpha=1):this.curPage==this.maxPage-1?(this.rightBtn.alpha=.5,this.leftBtn.alpha=1):(this.leftBtn.alpha=1,this.rightBtn.alpha=1)}onUserDataChange(t){"collectStage"==t?this.updateCollect():"collectMonsterIdList"==t&&(this.initMonsterList(),this.updateCollect())}initCardDataList(){for(const t in C.Instance.monsterData){let e=C.Instance.getOneCardData(Number(t));this.cardDataList.push(e)}}onSelect(){I.finishInnerTask("点击图鉴"),w.Instance.showBannerAd()}offSelect(){Math.random()<.5&&w.Instance.showInterstitialAd(null),I.finishInnerTask("点击关闭图鉴"),w.Instance.hideBannerAd()}static haveRed(){let t=C.Instance.collectConfig[B.instance.collectStage].require;return B.instance.collectMonsterIdList.length>=t&&0==B.instance.collectReceived}}class ht extends i.pages.handBookDetailUI{constructor(){super(...arguments),this.monsterIdMap=new Map,this.pageData=[],this.curLevel=0,this.curPageIndex=0,this.maxPageIndex=0,this.isClose=!1,this.isPullShare=!1,this.isShareOut=!1}onAwake(){this.nameLabel.filters=[x.blackColorFilter],this.atkLabel.filters=[x.blackColorFilter],this.hpLabel.filters=[x.blackColorFilter],this.appearLabel.filters=[x.blackColorFilter],this.descLabel.filters=[x.blackColorFilter],this.leftBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.rightBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.shareBtn.on(Laya.Event.CLICK,this,this.onBtnClick),Laya.Tween.to(this.middleBox,{x:0},400,Laya.Ease.sineOut),"undefined"!=typeof wx&&(wx.onShow(this.onShow.bind(this)),wx.onHide(this.onHide.bind(this))),this.shareTimeLabel.text=`(${B.instance.shareHandBookTime}/3)`}onOpened(){w.Instance.showBannerAd()}onClosed(){w.Instance.hideBannerAd()}setParam(t){let e=1;for(const t in C.Instance.monsterData)this.monsterIdMap.has(e)||this.monsterIdMap.set(e,[]),this.monsterIdMap.get(e).push(Number(t)),this.monsterIdMap.get(e).length>=12&&e++;for(const t of this.monsterIdMap)t[1].sort((t,e)=>t-e);this.initTabList(this.monsterIdMap.keys());let i=this.getLevel(t),s=this.monsterIdMap.get(i).indexOf(t);this.initPage(i,s)}initTabList(t){let e=[];for(const i of t)e.push(i);e.sort((t,e)=>t-e);let i=[];for(let t=0;t<e.length;t++)i.push({levelLabel:{text:e[t]+""}});this.tabList.repeatY=i.length,this.tabList.array=i,this.tabList.refresh();for(let t=0;t<this.tabList.length;t++){this.tabList.getCell(t).getChildByName("tabBg").on(Laya.Event.CLICK,this,this.onTabClick,[t])}}getLevel(t){for(const e of this.monsterIdMap)if(-1!=e[1].indexOf(t))return e[0]}initPage(t,e){this.curLevel!=t&&(0!=this.curLevel&&this.openCell(this.curLevel-1,!1),this.curLevel=t,this.openCell(this.curLevel-1,!0),this.maxPageIndex=this.monsterIdMap.get(this.curLevel).length,this.setPageData(e))}openCell(t,e){let i=this.tabList.getCell(t).getChildByName("tabBg");i.skin=e?"handBook/Btn_LabelSlect.png":"handBook/Btn_Label.png",e?Laya.Tween.to(i,{x:18},100,Laya.Ease.sineOut):Laya.Tween.to(i,{x:0},100,Laya.Ease.sineOut)}updateArrow(){this.maxPageIndex<=1?(this.leftBtn.alpha=.5,this.rightBtn.alpha=.5):0==this.curPageIndex?(this.leftBtn.alpha=.5,this.rightBtn.alpha=1):this.curPageIndex==this.maxPageIndex-1?(this.rightBtn.alpha=.5,this.leftBtn.alpha=1):(this.leftBtn.alpha=1,this.rightBtn.alpha=1)}setPageData(t){this.curPageIndex=t,this.monsterId=this.monsterIdMap.get(this.curLevel)[t],this.monsterImage.skin=`monster/Ui_Monster${this.monsterId}.png`,this.monsterData=C.Instance.monsterData[this.monsterId],this.nameLabel.text=this.monsterData.name,this.hpLabel.text=this.monsterData.hp+"",this.atkLabel.text=this.monsterData.atk+"",this.descLabel.text=this.monsterData.describe||"",this.appearLabel.text=this.getAppear(this.monsterId).join(","),this.updateArrow()}getAppear(t){let e=C.Instance.getOneCardData(t);if(C.Instance.isSuperEva(e))return["究极进化"];if(-1!=[126,128].indexOf(t))return["签到"];{let e=[];for(const i in C.Instance.stageConfig){let s=C.Instance.stageConfig[i];if(-1!=[...s.list,s.bossStat.id].indexOf(t)){e.push(s.name);break}}for(const i in C.Instance.creamStageConfig){let s=C.Instance.creamStageConfig[i];if(-1!=[...s.list,s.bossStat.id].indexOf(t)){e.push(s.name);break}}return e.push("合成"),e.push("扭蛋商店"),e}}onTabClick(t){this.initPage(t+1,0)}onBtnClick(t){if(t.target==this.leftBtn)this.curPageIndex>0&&(this.curPageIndex--,this.setPageData(this.curPageIndex));else if(t.target==this.rightBtn)this.curPageIndex<this.maxPageIndex-1&&(this.curPageIndex++,this.setPageData(this.curPageIndex));else if(t.target==this.closeBtn){if(this.isClose)return;this.isClose=!0,Laya.Tween.to(this.middleBox,{x:-720},400,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.close()}))}else if(t.target==this.shareBtn){if(B.instance.shareHandBookTime>=3)return;if("undefined"!=typeof wx){let t=`https://demo.xxtch.com/Pokemon/res/wx/ShareImages/Ui_MonsterHead${this.monsterId}.png`;wx.shareAppMessage({title:this.monsterData.describe,imageUrl:t}),this.isPullShare=!0}}}onDestroy(){"undefined"!=typeof wx&&(wx.offShow(this.onShow.bind(this)),wx.offHide(this.onHide.bind(this)))}onShow(){console.log("HandBookOnShow"),this.isShareOut&&(this.isShareOut=!1,this.onShareSuccess())}onHide(){console.log("HandBookOnHide"),this.isPullShare&&(this.isShareOut=!0),this.isPullShare=!1}onShareSuccess(){B.instance.shareHandBookTime++,B.instance.onDataChange("shareHandBookTime"),this.shareTimeLabel.text=`(${B.instance.shareHandBookTime}/3)`,C.Instance.receiveReward([{type:"diamond",num:5}])}}class lt extends i.pages.helpPackUI{onAwake(){this.videoGetBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick);let t=C.Instance.getSpecifyStarMonsterCard([7,7],!0);t||(t=C.Instance.getSpecifyStarMonsterCard([7,7],!1)),this.monsterCardData=t,this.monsterImage.skin=`monster/Ui_Monster${this.monsterCardData.monsterId}.png`,this.setBtnVideoTag()}onBtnClick(t){t.target==this.closeBtn?this.close():t.target==this.videoGetBtn&&w.Instance.showVideoAd("adunit-5e9bb5c9d90565eb",()=>{let t=C.Instance.monsterData;L.openScene("pages/catchResult.scene",!1,!0,null,[!0,this.monsterCardData.monsterId,t[this.monsterCardData.monsterId],!1,4,this.monsterCardData.special]),this.close()})}setParam(t){"elite"==t?this.systemImage.skin="newSystem/Btn_Elite.png":"challenge"==t?this.systemImage.skin="main/Btn_LianMeng.png":"pvp"==t?this.systemImage.skin="main/Btn_PVP.png":"star"==t&&(this.systemImage.skin="main/Btn_StarUP.png")}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class ct{static get cloud(){return this._cloud}static init(){return new Promise((t,e)=>{"undefined"==typeof wx?e("wx.cloud.init:fail"):(this._cloud=wx.cloud,this._cloud.init(),t("wx.cloud.init:ok"))})}}class dt{constructor(){}static init(){null==dt._instance&&(dt._instance=new dt,Laya.loader.load("shaderconfig.json",Laya.Handler.create(this,t=>{for(const e in t)if(t.hasOwnProperty(e)){const i=t[e];for(let t=0;t<i.length;t++){let s=i[t],a=new Laya.ShaderVariant(Laya.Shader3D.find(e),s.subShaderIndex,s.passIndex,s.defineNames);Laya.Shader3D.debugShaderVariantCollection.add(a)}}Laya.Shader3D.debugShaderVariantCollection.compile()})))}}dt._instance=null;class pt extends i.pages.loadUI{constructor(){super(...arguments),this.finish1=!1,this.finish2=!1,this.imageList=[],this.gap=88}onAwake(){this.setShareMessageToFriendCallback(),ct.init().then(()=>{f.init("cloud1-8gvhoxyo84834c09")}),this.sendInitInfo(),this.openWxShare(),this.progressBar.width=0,this.progressLabel.text="0%";for(let t=0;t<18;t++){let e=new Laya.Image("load/Ui_LoadingBg2.png");e.sizeGrid="0,0,0,0,1",e.height=80,e.y=37+88*t,(t+1)%2==0?(e.width=900,e.x=-135):(e.width=810,e.x=0),this.imageList.push(e),this.bg.addChild(e)}Laya.timer.frameLoop(1,this,this.FrameLoop),Laya.Dialog.manager.closeEffectHandler=null,dt.init(),this.loadBox.visible=!1,this.width=Laya.stage.width,this.height=Laya.stage.height,this.progressLabel.text="0%",Laya.Shader3D.debugMode=!0,this.loadSk.visible=!1,this.loadSk.x=Laya.stage.width/2,this.loadSk.y=Laya.stage.height/2,this.loadSk._complete=Laya.Handler.create(this,()=>{this.loadSk.play(0,!1),this.loadSk.on(Laya.Event.STOPPED,this,()=>{Laya.timer.once(500,this,()=>{Laya.Tween.to(this.loadSk,{alpha:0},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.loadBox.visible=!0,this.finish1=!0;p.create(["stage.json","creamStage.json","passReward.json","standardModel.json","eliteStage.json","enemy.json","collect.json","mix.json","mixCost.json","specialMix.json","gold.json","upgrade.json","tower.json","shop.json","pvp.json","pvpScore.json","goods.json","ShowScene.ls"]).then(()=>{C.Instance.init();p.create(["SceneNav1.json","ScenePoint1.json","SceneNav2.json","ScenePoint2.json","SceneNav3.json","ScenePoint3.json","SceneNav4.json","ScenePoint4.json","SceneNav5.json","ScenePoint5.json","SceneNav6.json","ScenePoint6.json","SceneNav7.json","ScenePoint7.json","SceneNav8.json","ScenePoint8.json"],this.onProgress.bind(this)).then(()=>{p.download(["main.atlas"]).then(()=>{this.initOpenDataContext(),f.get("usersinfo",{_openid:"{openid}"}).then(t=>{if(t.data.length>0){let e=t.data[0];B._id=e._id,B.instance.init(e)}else{console.log("用户记录数据0条");let t=JSON.stringify(B.instance);delete(t=JSON.parse(t)).$_GID,f.add("usersinfo",t).then(t=>{console.log(t)}).catch(t=>{console.error(t)})}w.Instance.noAd=B.instance.noAd,I.init("guideconfig.json",i.pages.guideUI).then(()=>{L.openScene("pages/main.scene",!0,!1,null,null)})}).catch(t=>{console.error(t),w.Instance.noAd=B.instance.noAd,I.init("guideconfig.json",i.pages.guideUI).then(()=>{L.openScene("pages/main.scene",!0,!1,null,null)})})})})})}))})})})}onProgress(t){this.progressBar.width=620*t.progress,this.progressLabel.text=Math.floor(100*t.progress)+"%"}FrameLoop(){for(let t=0;t<this.imageList.length;t++){let e=this.imageList[t];(t+1)%2==0?(e.x+=.45,e.x>=-45&&(e.x=-135)):(e.x-=.45,e.x<=-90&&(e.x=0))}}onDestroy(){Laya.timer.clear(this,this.FrameLoop)}openWxShare(){window.wx&&wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]})}sendInitInfo(){if("undefined"!=typeof wx){let t={wifi:0,origin:"",extra1:"",extra2:""};wx.getNetworkType({success:e=>{"wifi"==e.networkType?t.wifi=1:t.wifi=0,wx.cloud.callFunction({name:"getOpenid",success:function(e){let i=wx.getEnterOptionsSync();t.origin=i.scene+"",t.extra1=B.instance.registerTime+"",e.result&&(t.extra2=e.result.openid),b.sendEvent(10001,t)},fail:console.error})},fail:()=>{},complete:()=>{}})}}initOpenDataContext(){Laya.Browser.onMiniGame&&Laya.loader.load(["res/atlas/challengeRank.atlas","res/atlas/pvp.atlas","res/config/pvpScore.json","res/atlas/AiImage.atlas","res/atlas/share.atlas"],Laya.Handler.create(null,()=>{Laya.MiniAdpter.sendJsonDataToDataContext("res/config/pvpScore.json"),Laya.MiniAdpter.sendAtlasToOpenDataContext("res/atlas/challengeRank.atlas"),Laya.MiniAdpter.sendAtlasToOpenDataContext("res/atlas/pvp.atlas"),Laya.MiniAdpter.sendAtlasToOpenDataContext("res/atlas/AiImage.atlas"),Laya.MiniAdpter.sendAtlasToOpenDataContext("res/atlas/share.atlas")}))}setShareMessageToFriendCallback(){"undefined"!=typeof wx&&wx.onShareMessageToFriend&&wx.onShareMessageToFriend(this.shareMessageToFriendCallBack.bind(this))}shareMessageToFriendCallBack(t){console.log("wx.shareMessageToFriend",t);let e=t.success?"分享成功":"分享失败";wx.showToast({title:e,icon:"none",duration:2e3})}}class gt extends i.pages.lotteryUI{constructor(){super(...arguments),this.lotteryData=[{type:"gold",desc:"X100",value:100,per:.3},{type:"gold",desc:"X150",value:150,per:.1},{type:"superEgg",desc:"X1",value:2,per:.03},{type:"card",desc:"飞鸡",value:90,per:.3},{type:"gold",desc:"X150",value:150,per:.1},{type:"gold",desc:"X500",value:500,per:.015},{type:"gold",desc:"X800",value:800,per:.015},{type:"commonEgg",desc:"X1",value:1,per:.14}],this.lotteryIndex=0,this.curIndex=0,this.sign=1,this.mustCardTime=5}onAwake(){this.cellList=[this.cell1,this.cell2,this.cell3,this.cell4,this.cell5,this.cell6,this.cell7,this.cell8],Date.now()-B.instance.freeLotteryTimestamp>864e5&&(B.instance.freeLotteryTimeLeft=1,B.instance.onDataChange("freeLotteryTimeLeft"));for(let t=0;t<this.cellList.length;t++)this.setCellData(t);this.updateFree(),Laya.timer.frameLoop(1,this,this.onFrameLoop),this.rollBg.visible=!1,this.rollBgCenter.visible=!1,this.updateMustCardTimeLeftLabel()}onDestroy(){Laya.timer.clear(this,this.onFrameLoop)}onFrameLoop(){this.rollBg.rotation+=.8}onMouseDown(t){Laya.Tween.to(this.lotteryBtn,{scaleX:.9*this.sign,scaleY:.9},50,Laya.Ease.sineOut)}onMouseUp(t){p.playSound("click.mp3"),Laya.Tween.to(this.lotteryBtn,{scaleX:1*this.sign,scaleY:1},50,Laya.Ease.sineIn)}onMouseOut(t){Laya.Tween.to(this.lotteryBtn,{scaleX:1*this.sign,scaleY:1},50,Laya.Ease.sineIn)}onOpened(){this.lotteryBtn.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.lotteryBtn.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.lotteryBtn.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.sign=Math.sign(this.lotteryBtn.scaleX),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.lotteryBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.goShopBtn.on(Laya.Event.CLICK,this,this.onBtnClick),w.Instance.showBannerAd(),w.Instance.sendVideoData={page_id:6,button_id:6,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData)}onClosed(){w.Instance.hideBannerAd()}onBtnClick(i){i.target==this.closeBtn?this.close():i.target==this.lotteryBtn?B.instance.freeLotteryTimeLeft>0?(1==B.instance.freeLotteryTimeLeft&&(B.instance.freeLotteryTimestamp=Date.now(),B.instance.onDataChange("freeLotteryTimestamp")),B.instance.freeLotteryTimeLeft--,B.instance.onDataChange("freeLotteryTimeLeft"),this.startLottery()):gt.popGetFreeTimeWindow?(w.Instance.sendVideoData={page_id:6,button_id:6,ad_id:2,ad_type:1},w.Instance.showVideoAd("adunit-9de3143facfc2b2d",this.startLottery.bind(this))):(gt.popGetFreeTimeWindow=!0,L.openScene("pages/getLotteryTime.scene",!1,!0,Laya.Handler.create(this,i=>{"yes"==i&&(this.close(),e.event(t.JumpToPage,5))}),null)):i.target==this.goShopBtn&&(this.close(),e.event(t.JumpToPage,5))}rotate(t,e){return new Promise(i=>{let s=200-10*e;e>16&&(s=200+10*(e-32)),Laya.timer.once(s,this,()=>{e++;let s=this.cellList[this.curIndex];s.lightBg.visible=!1,s.normalBg.visible=!0,this.curIndex=++this.curIndex%8;let a=this.cellList[this.curIndex];if(a.lightBg.visible=!0,a.normalBg.visible=!1,!(e<=24||this.curIndex!=t))return i();this.rotate(t,e).then(()=>{i()})})})}startLottery(){let t=this.getMustCardTimeLeft();B.instance.lotteryTime++,B.instance.onDataChange("lotteryTime"),this.updateFree(),this.lotteryIndex=this.calculateResult(),1==t&&(this.lotteryIndex=3),this.lotteryBtn.disabled=!0;let e=this.cellList[this.curIndex];e.lightBg.visible=!0,e.normalBg.visible=!1,this.rotate(this.lotteryIndex,0).then(()=>{this.lotteryBtn.disabled=!1;let t=this.lotteryData[this.lotteryIndex];if("gold"==t.type)L.openScene("pages/getCard.scene",!1,!0,null,[1,t.value,4]);else if("card"==t.type){let e=C.Instance.getMonsterData([t.value]),i=[!0,t.value,e[0],!1,3];L.openScene("pages/catchResult.scene",!1,!0,null,i)}else L.openScene("pages/getCard.scene",!1,!0,null,[3,t.value,4]);this.updateMustCardTimeLeftLabel()})}calculateResult(){let t=0,e=Math.random();for(let i=0;i<this.lotteryData.length;i++){let s=this.lotteryData[i];if(e<(t+=s.per))return console.log(s),i}}updateFree(){this.freeLeftLabel.text=B.instance.freeLotteryTimeLeft+"",B.instance.freeLotteryTimeLeft>0?this.videoTag.visible=!1:this.setBtnVideoTag()}setCellData(t){let e=this.cellList[t],i=this.lotteryData[t];e.lightBg.visible=!1,e.normalBg.visible=!0,e.goldLabel.filters=[x.blackColorFilter],"gold"==i.type?(e.rewardImage.scaleX=e.rewardImage.scaleY=1,e.rewardImage.skin="count/Ui_TwoGold.png",e.goldLabel.text="X"+i.value):"card"==i.type?(e.rewardImage.skin=`monster/Ui_Monster${i.value}.png`,e.goldLabel.text=i.desc,e.rewardImage.scaleX=e.rewardImage.scaleY=.5):(e.rewardImage.scaleX=e.rewardImage.scaleY=1,"superEgg"==i.type?e.rewardImage.skin="main/Ui_Ball.png":e.rewardImage.skin="main/Ui_Ball2.png",e.goldLabel.text="X1")}updateMustCardTimeLeftLabel(){let t=this.getMustCardTimeLeft();this.mustCardLabel.text=t+""}getMustCardTimeLeft(){return this.mustCardTime-B.instance.lotteryTime%this.mustCardTime}static haveRed(){return B.instance.freeLotteryTimeLeft>0}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}gt.popGetFreeTimeWindow=!1;class mt extends i.pages.luckyPackUI{constructor(){super(...arguments),this.moneyNum=0}onAwake(){this.videoGetBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick);let t=B.instance.gameRank+3;t=t>7?7:t;let e=C.Instance.getSpecifyStarMonsterCard([t,t],!0);e||(e=C.Instance.getSpecifyStarMonsterCard([t,t],!1)),this.starLabel.text=e.star+"",this.hpLabel.text=e.hp+"",this.atkLabel.text=e.atk+"",this.monsterCardData=e,this.monsterImage.skin=`monster/Ui_Monster${this.monsterCardData.monsterId}.png`,this.setBtnVideoTag()}onBtnClick(t){t.target==this.closeBtn?this.close():t.target==this.videoGetBtn&&w.Instance.showVideoAd("adunit-5e9bb5c9d90565eb",()=>{C.Instance.receiveReward([{type:"gold",num:1e3}]),B.instance.luckPackLeftTime--,B.instance.onDataChange("luckPackLeftTime");let t=C.Instance.monsterData;L.openScene("pages/catchResult.scene",!1,!0,null,[!0,this.monsterCardData.monsterId,t[this.monsterCardData.monsterId],!1,4,this.monsterCardData.special]),this.close()})}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class ut{constructor(){window.StageManager=this,UIConfig.closeDialogOnSide=!1,Laya.Scene.root,Laya.Dialog.manager.name="DialogRoot",ut._GameSceneRoot=new Laya.Sprite,ut._GameSceneRoot.name="GameSceneRoot",ut._GameUIRoot=new Laya.Sprite,ut._GameUIRoot.name="GameUIRoot",ut._UpRoot=new Laya.Sprite,ut._UpRoot.name="UpRoot",ut._UpDialogRoot=new Laya.Sprite,ut._UpDialogRoot.name="UpDialogRoot",ut._UI3D=new Laya.Sprite,ut._AdRoot=new Laya.Sprite,ut._AdRoot.name="AdRoot",ut._GuideRoot=new Laya.Sprite,ut._GuideRoot.name="GuideRoot",ut._EffectRoot=new Laya.Sprite,ut._EffectRoot.name="EffectRoot";let t=[ut._GameSceneRoot,ut._GameUIRoot,Laya.Scene.root,ut._UpRoot,Laya.Dialog.manager,ut._UpDialogRoot,ut._AdRoot,ut._GuideRoot,ut._EffectRoot];for(let e=0;e<t.length;e++){let i=t[e];i.zOrder=e+1,i.width=Laya.stage.width,i.height=Laya.stage.height,i.mouseThrough=!0,i!=Laya.Scene.root&&i!=Laya.Dialog.manager&&Laya.stage.addChild(i)}Laya.stage.updateZOrder()}static init(){ut._StageManager||(ut._StageManager=new ut)}static get UI3D(){return ut._UI3D}static get GameSceneRoot(){return ut._GameSceneRoot}static get GameUIRoot(){return ut._GameUIRoot}static get UpRoot(){return ut._UpRoot}static get UpDialogRoot(){return ut._UpDialogRoot}static get GuideRoot(){return ut._GuideRoot}static get AdRoot(){return ut._AdRoot}static get EffectRoot(){return ut._EffectRoot}}class yt{constructor(){this.activeSceneMap=new Map}static get Instance(){return this._instance||(this._instance=new yt),this._instance}getScene3DLogic(t){return this.activeSceneMap.get(t)}closeScene3D(t,e=!0,i=[]){let s=this.activeSceneMap.get(t);s&&(s.onClosed&&s.onClosed(...i),s.owner.removeSelf(),e&&s.destroy(),this.activeSceneMap.delete(t))}openScene3D(t,e,i=[]){let s=p.getRes(t+".ls");ut.GameSceneRoot.addChild(s);let a=s.getComponent(e);a||(a=s.addComponent(e)),a.onOpened&&a.onOpened(...i),this.activeSceneMap.set(t,a)}}class ft extends Laya.Script3D{constructor(){super(...arguments),this.cameraUrl="MainCamera/Camera"}onAwake(){this.scene3d=this.owner,this.camera=L.findNodeByUrl(this.scene3d,this.cameraUrl),this.camera.enableHDR=!1,this.clearNode=new Laya.Sprite3D,this.clearNode.name="clearNode",this.scene3d.addChild(this.clearNode)}onDestroy(){this.clearNode.destroy(),this.scene3d.removeSelf()}convert3DTo2DPosition(t){let e=new Laya.Vector4;return this.camera.viewport.project(t,this.camera.projectionViewMatrix,e),new Laya.Vector2(e.x/Laya.stage.clientScaleX,e.y/Laya.stage.clientScaleY)}}class Lt extends Laya.AnimatorStateScript{constructor(){super()}onStateEnter(){this.stateEnterHandler&&this.stateEnterHandler.runWith(this.name)}onStateUpdate(){this.stateUpdateHandler&&this.stateUpdateHandler.runWith(this.name)}onStateExit(){this.stateExitHandler&&this.stateExitHandler.runWith(this.name)}}class vt extends Laya.Script3D{constructor(){super(...arguments),this.animator=null,this.gameObject=null,this.catchSuccessHandler=null,this.catchEndHandler=null,this.rollEffect=null}onAwake(){this.gameObject=this.owner,this.rollEffect=L.findNodeByUrl(this.gameObject,"Bone001/Effect_Around"),this.rollEffect.active=!1,this.animator=this.gameObject.getComponent(Laya.Animator);let t=this.animator.getControllerLayer(0).getAnimatorState("Attack").addScript(Lt);t.name="Attack",t.stateExitHandler=Laya.Handler.create(this,this.onStateExit,null,!1)}onStateExit(){this.catchEndHandler&&this.catchEndHandler.run()}onEnable(){this.animator.play("Stand",0,0)}Attack_Ani(){this.catchSuccessHandler&&C.Instance.isCatch&&this.catchSuccessHandler.run()}}class Ct{}Ct.none="None",Ct.stand="Stand",Ct.death="Death",Ct.damage="Damage",Ct.run="Run",Ct.attack="Attack";class It extends Laya.Script3D{Ani_Event(t,e,i){this.stateTriggerHandler&&this.stateTriggerHandler.runWith([t,e,i])}}class St extends Laya.Script3D{constructor(){super(...arguments),this.animator=null,this.physicsCollider=null,this.rigidbody3D=null,this._curState=Ct.none,this._animationId=null,this.sign=null,this.actorData=null,this.gameObject=null}onAwake(){if(this.sign=St.name,this.animator=this.owner.getComponent(Laya.Animator),this.gameObject=this.owner,this.animator||(this.animator=L.getComponentInChildren(this.owner,Laya.Animator)),this.animator){this.animator.owner.addComponent(It).stateTriggerHandler=Laya.Handler.create(this,this.onStateTrigger,null,!1),this._states=this.animator.getControllerLayer(0)._states;for(let t=0;t<this._states.length;t++){let e=this._states[t],i=e.addScript(Lt);i.name=e.name,i.stateEnterHandler=Laya.Handler.create(this,this.onStateEnter,null,!1),i.stateUpdateHandler=Laya.Handler.create(this,this.onStateUpdate,null,!1),i.stateExitHandler=Laya.Handler.create(this,this.onStateExit,null,!1)}}this.physicsCollider=this.owner.getComponent(Laya.PhysicsCollider),this.rigidbody3D=this.owner.getComponent(Laya.Rigidbody3D)}onEnable(){this.onRegisterCustomEvent()}onDisable(){this.onCancelCustomEvent()}onCollisionEnter(t){}onCollisionStay(t){}onCollisionExit(t){}onTriggerEnter(t){}onTriggerStay(t){}onTriggerExit(t){}onStateEnter(t){}onStateUpdate(t){}onStateExit(t){}onStateTrigger(t,e,i){}onRegisterCustomEvent(){}onCancelCustomEvent(){}changeActorState(t,e,i=!1){t==this._curState&&this._animationId==e||(this.onAnimationChange(t+e,i),this._curState=t,this._animationId=e)}clearActorState(){this._curState=Ct.none,this._animationId=null}onAnimationChange(t,e=!1){this.animator&&(e?this.animator.crossFade(t,.2,0,0):this.animator.play(t,0,0))}onRecovery(){this.owner.removeSelf(),Laya.Pool.recover(this.sign,this)}onInit(t){this.actorData=t}onDamage(t){0!=this.actorData.hp&&(this.actorData.hp-=t,this.actorData.hp<=0&&(this.actorData.hp=0,this.changeActorState(Ct.death,"")))}get curState(){return this._curState}get animationId(){return this._animationId}}class wt extends St{constructor(){super(...arguments),this.hp=0,this.atk=0,this.isDeath=!1,this.damageEffect=null}onAwake(){super.onAwake(),this.damageEffect=p.getResClone("Effect_GetHit.lh"),this.gameObject.addChild(this.damageEffect),this.damageEffect.transform.localPosition=new Laya.Vector3,this.damageEffect.transform.localRotationEuler=new Laya.Vector3,this.damageEffect.active=!1}onEnable(){}init(t){this.hp=t.hp,this.atk=t.atk,0==t.hp?this.isDeath=!0:this.isDeath=!1,this.changeActorState("Stand","",!0)}onHurt(t){if(this.isDeath)return 0;let e=t;return this.hp-t<0&&(e=this.hp),this.hp-=e,this.damageEffect.active=!0,Laya.timer.once(500,this,()=>{this.damageEffect.active=!1}),this.changeActorState("GetHit",""),Laya.timer.once(500,this,()=>{this.changeActorState("Stand","")}),this.hp<=0&&(this.isDeath=!0),e}}class xt extends ft{constructor(){super(...arguments),this.ball=null,this.catchEffect=null,this.catchLight=null,this.boundSphere=null,this.isClickBall=!1,this.catchCameraData={position:[0,4.46,14.93],rotation:[.192584,0,0,-.9812805]},this.ballScript=null,this.ray=new Laya.Ray(new Laya.Vector3,new Laya.Vector3),this.hitResult=new Laya.HitResult,this.progress=0,this.lastProgress=0,this.progressAdd=.01,this.progressBack=.005}onAwake(){p.playSound("success.mp3"),this.cameraUrl="MainCamera/FightCamera",super.onAwake(),this.ball=this.scene3d.getChildByName("Ball"),this.catchEffect=this.scene3d.getChildByName("Effect_Catch"),this.catchLight=this.scene3d.getChildByName("Light_Catch"),this.boundSphere=new Laya.BoundSphere(new Laya.Vector3(0,1,11),.5),this.ballScript=this.ball.getComponent(vt),this.ballScript||(this.ballScript=this.ball.addComponent(vt)),this.ballScript.catchSuccessHandler=Laya.Handler.create(this,this.onCatchSuccess),this.ballScript.catchEndHandler=Laya.Handler.create(this,this.onCatchEnd),this.ball.active=!1,this.catchEffect.active=!1,this.catchLight.active=!1,this.camera.transform.localPosition=L.createVector3FromArray(this.catchCameraData.position),this.camera.transform.localRotation=L.createQuaternionFromArray(this.catchCameraData.rotation);let t=C.Instance.catchMonsterId,e=L.createSprite3DWithScript(`Enemy${t}`,wt,this.clearNode);e.gameObject.transform.position=new Laya.Vector3,e.gameObject.transform.localRotationEuler=new Laya.Vector3,this.progress=0}onOpened(i){if(Laya.MouseManager.enabled=!1,e.on(t.BallStartCatch,this,this.onBallStartCatch),i)e.event(t.GotoCatch,[i]);else{let s=C.Instance.catchMonsterId,a=C.Instance.getMonsterCatchRate(s,C.Instance.isBoss)<100;this.isClickBall=!1,a&&(this.ball.active=!0,Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onClickScreen),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.onClickScreen),Laya.timer.frameLoop(1,this,this.onFrameLoop));let n=L.convert3DTo2DPosition(this.camera,new Laya.Vector3(0,1,11));e.event(t.GotoCatch,[i,n.y])}}onCatchEnd(){e.event(t.CatchEnd)}onCatchSuccess(){this.catchEffect.active=!0,this.catchLight.active=!0}onClickScreen(t){if(t.type==Laya.Event.MOUSE_DOWN){let e=new Laya.Vector2(t.stageX*Laya.stage.clientScaleX,t.stageY*Laya.stage.clientScaleY);this.camera.viewportPointToRay(e,this.ray),Laya.CollisionUtils.intersectsRayAndSphereRD(this.ray,this.boundSphere)>=0&&(this.isClickBall=!0,this.ballScript.rollEffect.active=!0,this.ballScript.animator.crossFade("Around",.5,0,0),p.playSound("catchRoll.mp3",0))}else t.type==Laya.Event.MOUSE_UP&&this.isClickBall&&(p.stopSound("catchRoll.mp3"),this.isClickBall=!1,this.ballScript.rollEffect.active=!1,this.ballScript.animator.crossFade("Stand",.5,0,0),this.progress>=.8&&this.ballFly())}ballFly(){p.playSound("catchFly.mp3"),this.ballScript.animator.crossFade("Attack",.2,0,0),e.event(t.StartCatch),Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onClickScreen),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.onClickScreen),Laya.timer.clear(this,this.onFrameLoop)}onBallStartCatch(){this.ball.active=!0,this.ballFly()}onFrameLoop(){this.isClickBall?(this.progress+=this.progressAdd,this.progress=this.progress<1?this.progress:1):(this.progress-=this.progressBack,this.progress=this.progress>0?this.progress:0),e.event(t.UpdateProgress,this.progress)}onDestroy(){super.onDestroy(),e.off(t.BallStartCatch,this,this.onBallStartCatch)}}class kt extends ft{constructor(){super(...arguments),this.enemyGroup=[],this.selfGroup=[],this.selfFightGroupIndexList=[],this.selfStandPoint=null,this.enemyStandPoint=null,this.enemyOutPoint=null,this.selfOutPoint=null,this.roundSide=1,this.isRoundFinish=!0,this.selfFightIndex=0,this.enemyFightIndex=0,this.isQte=!1,this.isClickBall=!1,this.fightCameraData={position:[.85,7.37,15.55],rotation:[.257019,-.2552845,-.07059698,-.9294016]}}onAwake(){C.Instance.fightType==s.Pvp||C.Instance.fightType==s.Tower?p.playMusic("fight1.mp3",0):p.playMusic("fight.mp3",0),this.cameraUrl="MainCamera/FightCamera",super.onAwake(),this.getStandPoint(),this.createSelfGroup(),this.selfFightIndex=this.getFirstLiveMonsterIndex(),this.initSelfGroupPosition(),C.Instance.fightType!=s.Normal&&C.Instance.fightType!=s.Cream||this.hideCatchModel(),e.on(t.AttackOnce,this,this.onAttackOnce),e.on(t.QteSuccess,this,this.onQteSuccess),e.on(t.ChangeQteState,this,this.onChangeQteState),e.on(t.FullHpRevive,this,this.onFullHpRevive),e.on(t.ChangeAutoFight,this,this.onChangeAutoFight)}onChangeQteState(t){3==t&&(this.isQte=!1)}onOpened(){this.initAutoFight(),this.createEnemyGroup(),e.event(t.InitFightCell),C.Instance.isGameEnd=!1,C.Instance.newMonsterIdList.length=0,this.setCameraFightPosAndRot(),C.Instance.allEmptyBlood?Laya.timer.once(500,this,()=>{C.Instance.fightType==s.Tower?e.event(t.BacktoScene,"challenge"):C.Instance.fightType==s.Pvp?e.event(t.BacktoScene,"pvp"):C.Instance.fightType!=s.Normal&&C.Instance.fightType!=s.Cream||e.event(t.BacktoScene,"search"),window.fightSendData&&(window.fightSendData.category=3,b.sendEvent(10003,window.fightSendData),window.fightSendData=null),Laya.timer.once(500,null,()=>{e.event(t.PopTip,"请去治疗")})}):(I.startOutTask("介绍战斗"),Laya.timer.once(1e3,this,()=>{this.autoFight()}))}onQteSuccess(){e.event(t.ChangeQteState,1),this.isRoundFinish=!1,this.selfAttack(!0).then(()=>this.roundCount())}selfAttack(i){return new Promise(s=>{this.selfGroup[this.selfFightIndex].changeActorState("Attack","",!0),e.event(t.EnableMustKill,!0),Laya.timer.once(250,this,()=>{let s=this.selfGroup[this.selfFightIndex].atk;this.playHitSound(i),this.enemyGroup[this.enemyFightIndex].onHurt(s);let a=this.enemyGroup[this.enemyFightIndex].gameObject.transform.position.clone();this.piaoHp(s,a,i),C.Instance.enemyMonsterCardList[this.enemyFightIndex],C.Instance.enemyMonsterCardList[this.enemyFightIndex].curHp=this.enemyGroup[this.enemyFightIndex].hp,e.event(t.UpdateFightData,["enemy",this.enemyFightIndex])}),Laya.timer.once(500,this,()=>{this.selfGroup[this.selfFightIndex].changeActorState("Stand","",!0),Laya.timer.once(500,this,()=>{s()})})})}selfChange(t){return new Promise(e=>{t==this.selfFightIndex?e():(L.tweenTo(this.selfGroup[this.selfFightIndex].gameObject,{position:this.selfOutPoint.transform.position},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.selfGroup[this.selfFightIndex].gameObject.active=!1})),this.selfGroup[t].gameObject.active=!0,L.tweenTo(this.selfGroup[t].gameObject,{position:this.selfStandPoint.transform.position},600,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.selfFightIndex=t,e()})))})}enemyAttack(){return new Promise(i=>{this.isRoundFinish=!1,this.enemyGroup[this.enemyFightIndex].changeActorState("Attack","",!0),Laya.timer.once(250,this,()=>{let i=this.enemyGroup[this.enemyFightIndex].atk;this.playHitSound(),this.selfGroup[this.selfFightIndex].onHurt(i);let s=this.selfGroup[this.selfFightIndex].gameObject.transform.position.clone();this.piaoHp(i,s,!1);let a=B.instance.fightCardList[this.selfFightGroupIndexList[this.selfFightIndex]];a.curHp=this.selfGroup[this.selfFightIndex].hp,B.instance.onDataChange("fightCardList"),this.syncHp(a),e.event(t.UpdateFightData,["self",this.selfFightIndex])}),Laya.timer.once(500,this,()=>{this.enemyGroup[this.enemyFightIndex].changeActorState("Stand","",!0),Laya.timer.once(500,this,()=>{i()})})})}playHitSound(t=!1){if(t)p.playSound("mustKill.mp3");else{let t=v.getRandom(1,3);p.playSound(`hit${t}.mp3`)}}enemyChange(t){return new Promise(e=>{t==this.enemyFightIndex?e():(L.tweenTo(this.enemyGroup[this.enemyFightIndex].gameObject,{position:this.enemyOutPoint.transform.position},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.enemyGroup[this.enemyFightIndex].gameObject.active=!1})),this.enemyGroup[t].gameObject.active=!0,L.tweenTo(this.enemyGroup[t].gameObject,{position:this.enemyStandPoint.transform.position},600,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.enemyFightIndex=t,e()})))})}onAttackOnce(i,s,a){if(C.Instance.isAutoFighting&&0==a&&(C.Instance.autoFight=!1,C.Instance.isAutoFighting=!1,e.event(t.CloseAutoFight)),C.Instance.isGameEnd)return;if(C.Instance.allEmptyBlood)return;if(1!=this.roundSide||!this.isRoundFinish)return;0!=B.instance.fightCardList[this.selfFightGroupIndexList[i]].curHp&&(this.isQte||(s?(this.isQte=!0,C.Instance.monsterAtkTimeList[i]=0,this.selfChange(i).then(()=>{e.event(t.ChangeQteState,0),e.event(t.UpdateFightData,["self",this.selfFightIndex])})):(C.Instance.monsterAtkTimeList[i]++,e.event(t.UpdateFightData,["self",this.selfFightIndex]),this.isRoundFinish=!1,this.selfChange(i).then(()=>this.selfAttack(!1)).then(()=>this.roundCount()).then(()=>this.enemyAttack()).then(()=>this.roundCount()))))}popCount(){C.Instance.isUseAutoFight&&!B.instance.freeAutoFight&&(B.instance.fightTicket-=1,B.instance.onDataChange("fightTicket")),C.Instance.isBoss?C.Instance.isGameWin?(e.event(t.ShowBlackMask),Laya.timer.once(500,this,()=>{yt.Instance.closeScene3D("FightScene2"),this.sendSuccessEvent(),this.gotoCatchScene()})):(this.sendFailEvent(),C.Instance.reviveLeftTime>0?(C.Instance.reviveLeftTime--,L.openScene("pages/neverGiveUp.scene",!1,!0,Laya.Handler.create(this,i=>{"yes"==i?e.event(t.OneCure,!0):e.event(t.ShowCount,!0)}),null)):e.event(t.ShowCount,!0)):(e.event(t.ShowBlackMask),Laya.timer.once(500,this,()=>{C.Instance.fightType==s.Normal||C.Instance.fightType==s.Cream?C.Instance.isGameWin?(this.sendSuccessEvent(),p.playSound("success.mp3"),yt.Instance.closeScene3D("FightScene2"),this.gotoCatchScene()):(this.sendFailEvent(),p.playSound("fail.mp3"),e.event(t.BacktoScene,"search"),e.event(t.ShowGiftPack)):C.Instance.fightType==s.Tower?e.event(t.ShowCount,!0):C.Instance.fightType==s.Pvp&&e.event(t.ShowPvpCount,!0)}))}onDestroy(){super.onDestroy(),Laya.timer.clearAll(this),e.off(t.AttackOnce,this,this.onAttackOnce),e.off(t.QteSuccess,this,this.onQteSuccess),e.off(t.ChangeQteState,this,this.onChangeQteState),e.off(t.FullHpRevive,this,this.onFullHpRevive),e.off(t.ChangeAutoFight,this,this.onChangeAutoFight)}createSelfGroup(){for(let t=0;t<B.instance.fightCardList.length;t++){let e=B.instance.fightCardList[t];if(e){this.selfFightGroupIndexList.push(t);let i=L.createSprite3DWithScript(`Enemy${e.monsterId}`,wt,this.clearNode);i.gameObject.transform.position=this.selfStandPoint.transform.position.clone(),i.gameObject.transform.localRotation=this.selfStandPoint.transform.localRotation.clone(),i.init({hp:e.curHp,atk:e.atk}),this.selfGroup.push(i)}}}initSelfGroupPosition(){for(let t=0;t<this.selfGroup.length;t++){let e=this.selfGroup[t];this.selfFightIndex==t?(e.gameObject.transform.position=this.selfStandPoint.transform.position.clone(),e.gameObject.active=!0):(e.gameObject.transform.position=this.selfOutPoint.transform.position.clone(),e.gameObject.active=!1)}}addSkin(t,e){t&&!t.destroyed&&e&&e()}createEnemyGroup(){for(let t=0;t<C.Instance.enemyMonsterCardList.length;t++){let e=C.Instance.enemyMonsterCardList[t],i=L.createSprite3DWithScript(`Enemy${e.monsterId}`,wt,this.clearNode);i.gameObject.transform.position=0==t?this.enemyStandPoint.transform.position.clone():this.enemyOutPoint.transform.position.clone(),i.gameObject.transform.localRotation=this.enemyStandPoint.transform.localRotation.clone(),C.Instance.isBoss?i.init({hp:C.Instance.curMapData.bossStat.hp,atk:C.Instance.curMapData.bossStat.atk}):i.init({hp:e.hp,atk:e.atk}),this.enemyGroup.push(i),1==this.enemyGroup.length?i.gameObject.active=!0:i.gameObject.active=!1}}roundCount(){return new Promise((i,s)=>{if(1==this.roundSide)if(this.enemyGroup[this.enemyFightIndex].isDeath){B.instance.finishTask(1,3,1);let i=C.Instance.enemyMonsterCardList[this.enemyFightIndex].monsterId,a=C.Instance.monsterData[i];B.instance.gold+=a.drop,B.instance.onDataChange("gold"),e.event(t.AddMoney,["gold",a.drop]),b.sendEvent(10005,{item_type:1,item_id:1,get_num:a.drop,get_type:8,last_num:B.instance.gold}),this.isQte&&e.event(t.QteEnd),this.enemyFightIndex<this.enemyGroup.length-1?this.enemyChange(this.enemyFightIndex+1).then(()=>{this.isRoundFinish=!0,this.autoFight(),e.event(t.EnableMustKill,!1),s()}):this.haveNextWave()?this.switchNextWaveEnemy().then(()=>{this.isRoundFinish=!0,this.autoFight(),e.event(t.EnableMustKill,!1),s()}):(C.Instance.isGameEnd=!0,C.Instance.isGameWin=!0,this.popCount(),this.isRoundFinish=!0,s())}else this.isQte?(e.event(t.QteNext),this.isRoundFinish=!0,s()):(this.roundSide=2,this.isRoundFinish=!0,i());else if(this.selfGroup[this.selfFightIndex].isDeath){e.event(t.FighterDeath,[1,this.selfFightIndex]);let i=this.getFirstLiveMonsterIndex();-1!=i?this.selfChange(i).then(()=>{this.roundSide=1,e.event(t.EnableMustKill,!1),this.isRoundFinish=!0,this.autoFight(),s()}):(C.Instance.isGameEnd=!0,C.Instance.isGameWin=!1,this.popCount(),this.isRoundFinish=!0,s())}else this.roundSide=1,e.event(t.EnableMustKill,!1),this.isRoundFinish=!0,this.autoFight(),s()})}syncHp(t){for(let e=0;e<B.instance.cardList.length;e++)if(B.instance.cardList[e].cardId==t.cardId){B.instance.cardList[e].curHp=t.curHp,B.instance.onDataChange("cardList");break}}piaoHp(t,e,i){e.y+=1;let s=L.convert3DTo2DPosition(this.camera,e),a=new Laya.Label("-"+t);a.font=i?"Kill":"HP",a.fontSize=80,a.anchorX=.5,a.anchorY=.5,a.x=s.x,a.y=s.y,a.scaleX=1,a.scaleY=1,ut.EffectRoot.addChild(a),Laya.Tween.to(a,{scaleX:1.6,scaleY:1.6,y:s.y-100},300,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{Laya.Tween.to(a,{scaleX:.6,scaleY:.6,y:s.y-50,alpha:0},200,Laya.Ease.sineIn,Laya.Handler.create(this,()=>{a.destroy()}))}))}onFullHpRevive(){C.Instance.isGameEnd=!1,C.Instance.isGameWin=!1,this.roundSide=1,this.clearSelfFightGroup(),this.createSelfGroup(),this.selfFightIndex=this.getFirstLiveMonsterIndex(),this.initSelfGroupPosition(),e.event(t.InitFightCell),e.event(t.EnableMustKill,!1)}gotoCatchScene(){let t=C.Instance.enemyMonsterCardList;C.Instance.catchMonsterId=t[t.length-1].monsterId,C.Instance.catchMonsterData=C.Instance.monsterData[C.Instance.catchMonsterId],C.Instance.isCatch=!1,yt.Instance.openScene3D("FightScene2",xt,[!1])}getFirstLiveMonsterIndex(){let t=-1;for(let e=0;e<this.selfGroup.length;e++)if(!this.selfGroup[e].isDeath){t=e;break}return t}hideCatchModel(){this.scene3d.getChildByName("Ball").active=!1,this.scene3d.getChildByName("Effect_Catch").active=!1,this.scene3d.getChildByName("Light_Catch").active=!1}getStandPoint(){this.selfStandPoint=this.scene3d.getChildByName("PlayerPoint"),this.enemyStandPoint=this.scene3d.getChildByName("EnemyPoint"),this.selfOutPoint=this.scene3d.getChildByName("PlayerPoint1"),this.enemyOutPoint=this.scene3d.getChildByName("EnemyPoint1")}haveNextWave(){return!1}switchNextWaveEnemy(){return new Promise(t=>{t()})}clearEnemyGroup(){for(let t=0;t<this.enemyGroup.length;t++)this.enemyGroup[t].gameObject.destroy();this.enemyGroup.length=0}setCameraFightPosAndRot(){this.camera.transform.localPosition=L.createVector3FromArray(this.fightCameraData.position),this.camera.transform.localRotation=L.createQuaternionFromArray(this.fightCameraData.rotation)}onChangeAutoFight(){C.Instance.isAutoFighting=C.Instance.autoFight,this.autoFight()}initAutoFight(){C.Instance.isUseAutoFight=!1,C.Instance.isAutoFighting=!1,B.instance.gameRank>=2&&C.Instance.autoFight&&B.instance.fightTicket>0&&(C.Instance.isUseAutoFight=!0,C.Instance.isAutoFighting=!0)}autoFight(){if(C.Instance.isAutoFighting){let i=this.getFirstLiveMonsterIndex();-1!=i&&e.event(t.AttackOnce,[i,!1,!0])}}sendSuccessEvent(){window.fightSendData&&(window.fightSendData.category=2,b.sendEvent(10003,window.fightSendData),window.fightSendData=null)}sendFailEvent(){window.fightSendData&&(window.fightSendData.category=3,b.sendEvent(10003,window.fightSendData),window.fightSendData=null)}clearSelfFightGroup(){for(let t=0;t<this.selfGroup.length;t++)this.selfGroup[t]&&this.selfGroup[t].gameObject.destroy();this.selfGroup.length=0,this.selfFightGroupIndexList.length=0}}class Bt extends kt{constructor(){super(...arguments),this.waveIndex=0}onAwake(){super.onAwake()}onOpened(){this.setMonsterIdList(),super.onOpened(),this.fightCameraData={position:[2.7,7.37,18.5],rotation:[.1435388,-.2619153,-.03942669,-.9535421]},this.setCameraFightPosAndRot()}setMonsterIdList(){let t=C.Instance.challengeMonsterIdList[this.waveIndex];C.Instance.setMonsterIdList(t,!1)}haveNextWave(){return++this.waveIndex<C.Instance.challengeMonsterIdList.length}switchNextWaveEnemy(){return new Promise(i=>{this.clearEnemyGroup(),this.setMonsterIdList(),this.enemyFightIndex=0,this.createEnemyGroup(),e.event(t.InitFightCell),i()})}}class bt{constructor(t){this.faces=[],this.vertices=[],this.addFace(t.faces),this.addVertex(t.vertices)}mergeVertices(){let t,e,i,s,a={},n=[],o=[],r=Math.pow(10,4);for(let i=0;i<this.vertices.length;i++)t=this.vertices[i],null==a[e=Math.round(t.x*r)+"_"+Math.round(t.y*r)+"_"+Math.round(t.z*r)]?(a[e]=i,n.push(t),o[i]=n.length-1):o[i]=o[a[e]];let h=[];for(let t=0;t<this.faces.length;t++){(i=this.faces[t]).a=o[i.a],i.b=o[i.b],i.c=o[i.c],s=[i.a,i.b,i.c];let e=-1;for(let i=0;i<3;i++)if(s[i]==s[(i+1)%3]){e=i,h.push(t);break}}for(let t=h.length-1;t>=0;t--){let e=h[t];this.faces.splice(e,1)}let l=this.vertices.length-n.length;return this.vertices=n,l}addVertex(t){for(let e=0;e<t.length;e+=3)this.vertices.push(new Tt(t[e],t[e+1],t[e+2]))}addFace(t){for(let e=0;e<t.length/5;e++)this.faces.push(new Dt(t[5*e+1],t[5*e+2],t[5*e+3]))}}class Tt{constructor(t=0,e=0,i=0){this.x=0,this.y=0,this.z=0,this.x=t,this.y=e,this.z=i}add(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}divideScalar(t){return this.multiplyScalar(1/t)}multiplyScalar(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}cross(t,e){if(void 0!==e)return this.crossVectors(t,e);var i=this.x,s=this.y,a=this.z;return this.x=s*t.z-a*t.y,this.y=a*t.x-i*t.z,this.z=i*t.y-s*t.x,this}crossVectors(t,e){var i=t.x,s=t.y,a=t.z,n=e.x,o=e.y,r=e.z;return this.x=s*r-a*o,this.y=a*n-i*r,this.z=i*o-s*n,this}normalize(){return this.divideScalar(this.length())}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}set(t,e,i){return this.x=t,this.y=e,this.z=i,this}sub(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}distanceToSquared(t){var e=this.x-t.x,i=this.y-t.y,s=this.z-t.z;return e*e+i*i+s*s}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}}class Mt{}class Dt{constructor(t,e,i){this.c=i,this.b=e,this.a=t}}class Pt{}class _t{}class Ut{}class Rt{constructor(t,e){this.normal=void 0!==t?t:new Tt(1,0,0),this.constant=void 0!==e?e:0}setFromCoplanarPoints(t,e,i){var s=new Tt,a=new Tt,n=s.subVectors(i,e).cross(a.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}projectPoint(t,e){return this.orthoPoint(t,e).sub(t).negate()}orthoPoint(t,e){var i=this.distanceToPoint(t);return(e||new Tt).copy(this.normal).multiplyScalar(i)}}new Tt,new Tt,new Tt,new Tt,new Tt,new Tt,new Tt,new Tt,new Tt,new Tt;class Et{constructor(t,e,i){this.a=void 0!==t?t:new Tt,this.b=void 0!==e?e:new Tt,this.c=void 0!==i?i:new Tt}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}closestPointToPoint(t,e){var i,s,a,n;void 0===i&&(i=new Rt,s=[new Ot,new Ot,new Ot],a=new Tt,n=new Tt);var o=e||new Tt,r=1/0;if(i.setFromCoplanarPoints(this.a,this.b,this.c),i.projectPoint(t,a),!0===this.containsPoint(a))o.copy(a);else{s[0].set(this.a,this.b),s[1].set(this.b,this.c),s[2].set(this.c,this.a);for(var h=0;h<s.length;h++){s[h].closestPointToPoint(a,!0,n);var l=a.distanceToSquared(n);l<r&&(r=l,o.copy(n))}}return o}containsPoint(t){return Et.containsPoint(t,this.a,this.b,this.c)}static containsPoint(t,e,i,s){var a=new Tt,n=Et.barycoordFromPoint(t,e,i,s,a);return n.x>=0&&n.y>=0&&n.x+n.y<=1}static barycoordFromPoint(t,e,i,s,a){var n=new Tt,o=new Tt,r=new Tt;n.subVectors(s,e),o.subVectors(i,e),r.subVectors(t,e);var h=n.dot(n),l=n.dot(o),c=n.dot(r),d=o.dot(o),p=o.dot(r),g=h*d-l*l,m=a||new Tt;if(0===g)return m.set(-2,-1,-1);var u=1/g,y=(d*c-l*p)*u,f=(h*p-l*c)*u;return m.set(1-y-f,f,y)}}class Ot{constructor(t,e){this.start=void 0!==t?t:new Tt,this.end=void 0!==e?e:new Tt}set(t,e){return this.start.copy(t),this.end.copy(e),this}closestPointToPoint(t,e,i){var s=this.closestPointToPointParameter(t,e),a=i||new Tt;return this.delta(a).multiplyScalar(s).add(this.start)}closestPointToPointParameter(t,e){var i=new Tt,s=new Tt;i.subVectors(t,this.start),s.subVectors(this.end,this.start);var a=s.dot(s),n=s.dot(i)/a;return e&&(n=Math.max(0,Math.min(1,n))),n}delta(t){return(t||new Tt).subVectors(this.end,this.start)}}class Ft{static roundNumber(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i}static sample(t){return t[Math.floor(Math.random()*t.length)]}static distanceToSquared(t,e){var i=t.x-e.x,s=t.y-e.y,a=t.z-e.z;return i*i+s*s+a*a}static isPointInPoly(t,e){for(var i=!1,s=-1,a=t.length,n=a-1;++s<a;n=s)(t[s].z<=e.z&&e.z<t[n].z||t[n].z<=e.z&&e.z<t[s].z)&&e.x<(t[n].x-t[s].x)*(e.z-t[s].z)/(t[n].z-t[s].z)+t[s].x&&(i=!i);return i}static isVectorInPolygon(t,e,i){var s=1e5,a=-1e5,n=[];return e.vertexIds.forEach(t=>{s=Math.min(i[t].y,s),a=Math.max(i[t].y,a),n.push(i[t])}),!!(t.y<a+.5&&t.y>s-.5&&this.isPointInPoly(n,t))}static triarea2(t,e,i){var s=e.x-t.x,a=e.z-t.z;return(i.x-t.x)*a-s*(i.z-t.z)}static vequal(t,e){return this.distanceToSquared(t,e)<1e-5}}class At{constructor(t){this.content=[],this.scoreFunction=t}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){const t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t}remove(t){const e=this.content.indexOf(t),i=this.content.pop();e!==this.content.length-1&&(this.content[e]=i,this.scoreFunction(i)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}sinkDown(t){const e=this.content[t];for(;t>0;){const i=(t+1>>1)-1,s=this.content[i];if(!(this.scoreFunction(e)<this.scoreFunction(s)))break;this.content[i]=e,this.content[t]=s,t=i}}bubbleUp(t){const e=this.content.length,i=this.content[t],s=this.scoreFunction(i);for(;;){const a=t+1<<1,n=a-1;let o,r=null;if(n<e){const t=this.content[n];(o=this.scoreFunction(t))<s&&(r=n)}if(a<e){const t=this.content[a];this.scoreFunction(t)<(null===r?s:o)&&(r=a)}if(null===r)break;this.content[t]=this.content[r],this.content[r]=i,t=r}}}class Nt{static init(t){for(let e=0;e<t.length;e++){const i=t[e];i.f=0,i.g=0,i.h=0,i.cost=1,i.visited=!1,i.closed=!1,i.parent=null}}static cleanUp(t){for(let e=0;e<t.length;e++){const i=t[e];delete i.f,delete i.g,delete i.h,delete i.cost,delete i.visited,delete i.closed,delete i.parent}}static heap(){return new At(function(t){return t.f})}static search(t,e,i){this.init(t);const s=this.heap();for(s.push(e);s.size()>0;){const e=s.pop();if(e===i){let t=e;const i=[];for(;t.parent;)i.push(t),t=t.parent;return this.cleanUp(i),i.reverse()}e.closed=!0;const a=this.neighbours(t,e);for(let t=0,n=a.length;t<n;t++){const n=a[t];if(n.closed)continue;const o=e.g+n.cost,r=n.visited;if(!r||o<n.g){if(n.visited=!0,n.parent=e,!n.centroid||!i.centroid)throw new Error("Unexpected state");n.h=n.h||this.heuristic(n.centroid,i.centroid),n.g=o,n.f=n.g+n.h,r?s.rescoreElement(n):s.push(n)}}}return[]}static heuristic(t,e){return Ft.distanceToSquared(t,e)}static neighbours(t,e){const i=[];for(let s=0;s<e.neighbours.length;s++)i.push(t[e.neighbours[s]]);return i}}class Vt{static buildZone(t){const e=this._buildNavigationMesh(t),i=new Ut;e.vertices.forEach(t=>{t.x=Ft.roundNumber(t.x,2),t.y=Ft.roundNumber(t.y,2),t.z=Ft.roundNumber(t.z,2)}),i.vertices=e.vertices;const s=this._buildPolygonGroups(e);return i.groups=new Array(s.length),s.forEach((t,e)=>{const s=new Map;t.forEach((t,e)=>{s.set(t,e)});const a=new Array(t.length);t.forEach((t,e)=>{const n=[];t.neighbours.forEach(t=>n.push(s.get(t)));const o=[];t.neighbours.forEach(e=>o.push(this._getSharedVerticesInOrder(t,e)));const r=new Tt(0,0,0);r.add(i.vertices[t.vertexIds[0]]),r.add(i.vertices[t.vertexIds[1]]),r.add(i.vertices[t.vertexIds[2]]),r.divideScalar(3),r.x=Ft.roundNumber(r.x,2),r.y=Ft.roundNumber(r.y,2),r.z=Ft.roundNumber(r.z,2),a[e]=new Mt,a[e].id=e,a[e].neighbours=n,a[e].vertexIds=t.vertexIds,a[e].centroid=r,a[e].portals=o}),i.groups[e]=a}),i}static _buildNavigationMesh(t){return t.mergeVertices(),this._buildPolygonsFromGeometry(t)}static _buildPolygonGroups(t){const e=t.polygons,i=[],s=function(t){t.neighbours.forEach(e=>{void 0===e.group&&(e.group=t.group,s(e))})};return e.forEach(t=>{void 0!==t.group?i[t.group].push(t):(t.group=i.length,s(t),i.push([t]))}),i}static _buildPolygonNeighbours(t,e){const i=new Set,s=e[t.vertexIds[0]],a=e[t.vertexIds[1]],n=e[t.vertexIds[2]];return s.forEach(e=>{e!==t&&(-1==a.indexOf(e)&&-1==n.indexOf(e)||i.add(e))}),a.forEach(e=>{e!==t&&-1!=n.indexOf(e)&&i.add(e)}),i}static _buildPolygonsFromGeometry(t){const e=[],i=t.vertices,s=new _t;s.polygons=e,s.vertices=i;const a=new Array(i.length);for(let t=0;t<i.length;t++)a[t]=[];return t.faces.forEach(t=>{const i=new Pt;i.vertexIds=[t.a,t.b,t.c],i.neighbours=null,e.push(i),a[t.a].push(i),a[t.b].push(i),a[t.c].push(i)}),e.forEach(t=>{t.neighbours=this._buildPolygonNeighbours(t,a)}),s}static _getSharedVerticesInOrder(t,e){const i=t.vertexIds,s=i[0],a=i[1],n=i[2],o=e.vertexIds,r=-1!=o.indexOf(s),h=-1!=o.indexOf(a),l=-1!=o.indexOf(n);return r&&h&&l?Array.from(i):r&&h?[s,a]:h&&l?[a,n]:r&&l?[n,s]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}class Xt{constructor(){this.portals=[]}push(t,e){void 0===e&&(e=t),this.portals.push({left:t,right:e})}stringPull(){const t=this.portals,e=[];let i,s,a,n=0,o=0,r=0;i=t[0].left,s=t[0].left,a=t[0].right,e.push(i);for(let h=1;h<t.length;h++){const l=t[h].left,c=t[h].right;if(Ft.triarea2(i,a,c)<=0){if(!(Ft.vequal(i,a)||Ft.triarea2(i,s,c)>0)){e.push(s),s=i=s,a=i,o=n=o,r=n,h=n;continue}a=c,r=h}if(Ft.triarea2(i,s,l)>=0){if(!(Ft.vequal(i,s)||Ft.triarea2(i,a,l)<0)){e.push(a),s=i=a,a=i,o=n=r,r=n,h=n;continue}s=l,o=h}}return 0!==e.length&&Ft.vequal(e[e.length-1],t[t.length-1].left)||e.push(t[t.length-1].left),this.path=e,e}}class Gt{constructor(){this.zones=new Map,this.plane=new Rt,this.point=new Tt,this.triangle=new Et,this.endPoint=new Tt,this.closestPoint=new Tt}static createZone(t){return t=new bt(t),Vt.buildZone(t)}setZoneData(t,e){this.zones.set(t,e)}getRandomNode(t,e,i,s){if(!this.zones.get(t))return new Tt;i=i||null,s=s||0;const a=[];return this.zones.get(t).groups[e].forEach(t=>{i&&s?Ft.distanceToSquared(i,t.centroid)<s*s&&a.push(t.centroid):a.push(t.centroid)}),Ft.sample(a)||new Tt}getClosestNode(t,e,i,s=!1){const a=this.zones.get(e).groups[i],n=this.zones.get(e).vertices;let o=null,r=1/0;return a.forEach(e=>{const i=Ft.distanceToSquared(e.centroid,t);i<r&&(!s||Ft.isVectorInPolygon(t,e,n))&&(o=e,r=i)}),o}findPath(t,e,i,s){const a=this.zones.get(i).groups[s],n=this.zones.get(i).vertices,o=this.getClosestNode(t,i,s,!0),r=this.getClosestNode(e,i,s,!0);if(!o||!r)return null;const h=Nt.search(a,o,r),l=function(t,e){for(var i=0;i<t.neighbours.length;i++)if(t.neighbours[i]===e.id)return t.portals[i]},c=new Xt;c.push(t,void 0);for(let t=0;t<h.length;t++){const e=h[t],i=h[t+1];if(i){const t=l(e,i);c.push(n[t[0]],n[t[1]])}}c.push(e,void 0),c.stringPull();const d=c.path.map(t=>new Tt(t.x,t.y,t.z));return d.shift(),d}getGroup(t,e,i=!1){if(!this.zones.get(t))return null;const s=this.plane;let a=null,n=Math.pow(50,2);const o=this.zones.get(t);for(let t=0;t<o.groups.length;t++){const r=o.groups[t];for(const h of r){if(i&&(s.setFromCoplanarPoints(o.vertices[h.vertexIds[0]],o.vertices[h.vertexIds[1]],o.vertices[h.vertexIds[2]]),Math.abs(s.distanceToPoint(e))<.01)){const i=[o.vertices[h.vertexIds[0]],o.vertices[h.vertexIds[1]],o.vertices[h.vertexIds[2]]];if(Ft.isPointInPoly(i,e))return t}const r=Ft.distanceToSquared(h.centroid,e);r<n&&(a=t,n=r)}}return a}clampStep(t,e,i,s,a,n){const o=this.point,r=this.plane,h=this.triangle,l=this.endPoint;let c,d;const p=this.zones.get(s).vertices,g=this.zones.get(s).groups[a],m=[i],u={};u[i.id]=0,c=void 0,this.closestPoint.set(0,0,0),d=1/0,r.setFromCoplanarPoints(p[i.vertexIds[0]],p[i.vertexIds[1]],p[i.vertexIds[2]]),r.projectPoint(e,o),l.copy(o);for(let t=m.pop();t;t=m.pop()){h.set(p[t.vertexIds[0]],p[t.vertexIds[1]],p[t.vertexIds[2]]),h.closestPointToPoint(l,o),o.distanceToSquared(l)<d&&(c=t,this.closestPoint.copy(o),d=o.distanceToSquared(l));const e=u[t.id];if(!(e>2))for(let i=0;i<t.neighbours.length;i++){const s=g[t.neighbours[i]];!s||s.id in u||(m.push(s),u[s.id]=e+1)}}return n.copy(this.closestPoint),c}init(){this.point.set(0,0,0),this.plane.constant=0,this.plane.normal.set(1,0,0),this.triangle.a.set(0,0,0),this.triangle.b.set(0,0,0),this.triangle.c.set(0,0,0),this.endPoint.set(0,0,0),this.closestPoint.set(0,0,0)}}class Ht extends St{constructor(){super(...arguments),this.endTarget=new Tt,this.tempVec3=new Tt,this.moveDir=new Laya.Vector2,this.walkDir=new Laya.Vector3,this.translation=new Laya.Vector3,this.rotation=new Laya.Vector3,this.forwardDir=new Laya.Vector3,this.targetDir=new Laya.Vector3,this.moveSpeed=4.5,this.frameTime=0,this.isMoving=!1,this.lastNode=null,this.pathfinding=null,this.zoneId="",this.rotateSpeedSection=[360,1e3],this.isTurning=!1,this.bornPoint=null,this.footDelay=0}initPathfinding(t,e){this.pathfinding=t,this.zoneId=e,L.cloneToVec3(this.gameObject.transform.position,this.tempVec3);let i=this.pathfinding.getGroup(this.zoneId,this.tempVec3,!0);this.lastNode=this.pathfinding.getClosestNode(this.tempVec3,this.zoneId,i,!0)}initPosAndRot(){this.gameObject.transform.position=L.createVector3FromArray(this.bornPoint.position),this.gameObject.transform.rotation=L.createQuaternionFromArray(this.bornPoint.rotation)}onAwake(){super.onAwake(),this.moveDir.x=0,this.moveDir.y=-1}onUpdate(){this.frameTime=Laya.timer.delta/1e3,this.isMoving&&(this.turn(),this.move(),2==C.Instance.enterMapIndex&&this.addFoot())}addFoot(){if(0==this.footDelay){this.footDelay=300;let t=L.createSprite3D("Foot",this.gameObject.parent);t.transform.position=this.gameObject.transform.position.clone(),t.transform.localRotation=this.gameObject.transform.localRotation.clone(),Laya.timer.once(2500,this,()=>{t.removeSelf(),Laya.Pool.recover("Foot",t)})}this.footDelay>0&&(this.footDelay-=Laya.timer.delta,this.footDelay<0&&(this.footDelay=0))}turn(){this.gameObject.transform.getForward(this.forwardDir),this.forwardDir.y=0,this.forwardDir.x*=-1,this.forwardDir.z*=-1,this.targetDir.x=-this.moveDir.x,this.targetDir.z=-this.moveDir.y,this.targetDir.y=0;let t=v.getRotateRad(this.forwardDir,this.targetDir)*v.rad2Deg;if(0!=t){this.isTurning=!0;let e=(this.rotateSpeedSection[0]+(this.rotateSpeedSection[1]-this.rotateSpeedSection[0])*Math.abs(t)/180)*this.frameTime*Math.sign(t);(e>0&&e>t||e<0&&e<t)&&(e=t),this.rotation.y=e,this.gameObject.transform.rotate(this.rotation,!1,!1)}else this.isTurning=!1}move(){this.moveSpeed=4.5*B.instance.speedBuff;let i=this.moveSpeed*this.frameTime;this.walkDir.x=-this.moveDir.x,this.walkDir.y=0,this.walkDir.z=-this.moveDir.y,Laya.Vector3.normalize(this.walkDir,this.walkDir),Laya.Vector3.scale(this.walkDir,i,this.translation);let s=new Laya.Vector3,a=this.gameObject.transform.position;Laya.Vector3.add(a,this.translation,s),L.cloneToVec3(s,this.tempVec3);let n=this.pathfinding.getGroup(this.zoneId,this.tempVec3,!0),o=this.pathfinding.getClosestNode(this.tempVec3,this.zoneId,n,!0);o?(this.gameObject.transform.position=s,this.lastNode!=o&&(this.lastNode=o,e.event(t.TargetNodeChange,this))):(this.pathfinding.init(),this.pathfinding.clampStep(null,this.tempVec3,this.lastNode,this.zoneId,n,this.endTarget),L.cloneToLayaVec3(this.endTarget,s),this.gameObject.transform.position=s),e.event(t.UpdateSmallMap,this.gameObject.transform.position)}}class Yt extends Laya.Script3D{constructor(){super(...arguments),this.followTransform=null,this.camera=null,this.cameraNode=null,this.offsetX=0,this.offsetY=0,this.offsetZ=0,this.moveSpeed=5,this.rotateSpeed=2,this.maxRotateSpeed=2,this.minRotateSpeed=.1,this.cameraTargetPos=new Laya.Vector3,this.translation=new Laya.Vector3,this.rotation=new Laya.Vector3,this.isSendEvent=!1,this.selfEuler=new Laya.Vector3,this.targetEuler=new Laya.Vector3,this.diff=new Laya.Vector3,this.isHitMap=!1,this.isHitWaterFace=!1,this.verticalTranslation=new Laya.Vector3(0,0,0),this.upSpeed=1,this.maxDis=2,this.curDis=0,this.closestPosition=new Laya.Vector3(0,1.68,-3.84),this.normalPosition=new Laya.Vector3(0,5.33,-10.58),this.targetZ=0,this.sensitive=1,this.forward=new Laya.Vector3,this.scale=1,this.standerNearZ=-3.84,this.standerFarZ=-10.58,this.standerFarY=-10.58,this.targetY=0,this.standerOffsetZ=0,this.lockOffsetZ=0,this.scaleOffsetZ=0,this.isLockEnemy=!1,this.rotateFollowTransform=null,this.originalLocalRotationEuler=new Laya.Vector3,this.targetLocalRotationEuler=new Laya.Vector3,this.lookNode=null,this.upVec=new Laya.Vector3(0,1,0),this.curLocalRotationX=0,this.cameraLocalTargetPos=new Laya.Vector3,this.startYawDiff=0,this.centerYawDiff=0,this.endYawDiff=0,this.updateFowardFrame=-1,this.isRecoverySensitive=!1}onAwake(){this.cameraNode=this.owner,this.camera=this.findNodeByType(this.cameraNode,Laya.Camera),this.originalLocalRotationEuler=this.camera.transform.localRotationEuler.clone(),this.lookNode=new Laya.Sprite3D,this.lookNode.transform.localRotationEuler=this.originalLocalRotationEuler.clone(),this.cameraNode.addChild(this.lookNode)}onUpdate(){this.positionFollow()}updateForward(){Laya.timer.currFrame!=this.updateFowardFrame&&(this.updateFowardFrame=Laya.timer.currFrame,this.camera.transform.getForward(this.forward))}setCameraTargetTransform(t){this.isSendEvent=!1,this.followTransform=t}findNodeByType(t,e){if(t instanceof e)return t;for(let i=0;i<t.numChildren;i++){let s=t.getChildAt(i);return this.findNodeByType(s,e)}return null}scaleDistance(t){let e=[[4.6,-10],[5.5,-12],[6.6,-14.4],[7.6,-16.6],[8.7,-19],[9.5,-20.6],[9.6,-21],[9.9,-21.6],[10.3,-22.6],[10.4,-22.8]];this.standerFarZ=e[t-1][1],this.standerOffsetZ=this.lockOffsetZ+this.scaleOffsetZ,this.targetZ=this.standerFarZ+this.standerOffsetZ,this.standerFarY=e[t-1][0],this.targetY=this.standerFarY,this.cameraLocalTargetPos.x=0,this.cameraLocalTargetPos.y=this.targetY,this.cameraLocalTargetPos.z=this.targetZ}onDestroy(){}positionFollow(){if(!this.followTransform)return;this.cameraTargetPos.x=this.followTransform.position.x+this.offsetX,this.cameraTargetPos.z=this.followTransform.position.z+this.offsetZ,this.cameraTargetPos.y=this.followTransform.position.y+this.offsetY;let t=this.cameraTargetPos.x-this.cameraNode.transform.position.x,i=this.cameraTargetPos.y-this.cameraNode.transform.position.y,s=this.cameraTargetPos.z-this.cameraNode.transform.position.z;if(0==t&&0==i&&0==s&&!this.isSendEvent)return this.isSendEvent=!0,void e.event(Yt.ReachDest);let a=this.moveSpeed*Laya.timer.delta/1e3;this.translation.x=Math.abs(t)<=.01?t:t*a,this.translation.y=Math.abs(i)<=.01?i:i*a,this.translation.z=Math.abs(s)<=.01?s:s*a,this.cameraNode.transform.translate(this.translation,!1)}rotationFollow(){if(!this.followTransform)return;this.isLockEnemy?this.normalizeRotationEuler(this.rotateFollowTransform.localRotationEuler,this.targetEuler):this.normalizeRotationEuler(this.followTransform.localRotationEuler,this.targetEuler),this.normalizeRotationEuler(this.cameraNode.transform.localRotationEuler,this.selfEuler),this.nearestRotationDiff(this.selfEuler,this.targetEuler,this.diff);let t=this.diff.x,e=this.diff.y,i=this.diff.z;if(0==t&&0==e&&0==i&&!this.isSendEvent)return void(this.isSendEvent=!0);this.rotateSpeed=100;let s=this.rotateSpeed*Laya.timer.delta/1e3,a=1-Math.abs(Math.abs(t)-90)/90,n=1-Math.abs(Math.abs(e)-90)/90,o=1-Math.abs(Math.abs(i)-90)/90;this.rotation.x=Math.abs(t)<=.01*this.sensitive?a*Math.sign(t)*this.sensitive:a*Math.sign(t)*s*this.sensitive,this.rotation.y=Math.abs(e)<=.01*this.sensitive?n*Math.sign(e)*this.sensitive:n*Math.sign(e)*s*this.sensitive,this.rotation.z=Math.abs(i)<=.01*this.sensitive?o*Math.sign(i)*this.sensitive:o*Math.sign(i)*s*this.sensitive,this.rotation.x=this.fixLocalRotationX(this.rotation.x),this.curLocalRotationX+=this.rotation.x,this.cameraNode.transform.rotate(this.rotation,!0,!1)}getRotateSpeed(t){return 0==this.centerYawDiff?this.maxRotateSpeed:t<this.centerYawDiff?this.minRotateSpeed+(this.maxRotateSpeed-this.minRotateSpeed)*(this.startYawDiff-t)/this.centerYawDiff:t==this.centerYawDiff?this.maxRotateSpeed:this.maxRotateSpeed+(this.minRotateSpeed-this.maxRotateSpeed)*((this.startYawDiff-t)/this.centerYawDiff-1)}setRotateFollowTrans(t){this.rotateFollowTransform=t,t?(this.isLockEnemy=!0,this.lockOffsetZ=-3):(this.isLockEnemy=!1,this.lockOffsetZ=0,this.normalizeRotationEuler(this.followTransform.localRotationEuler,this.targetEuler),this.normalizeRotationEuler(this.cameraNode.transform.localRotationEuler,this.selfEuler),this.startYawDiff=Math.abs(this.targetEuler.y-this.selfEuler.y),this.endYawDiff=0,this.centerYawDiff=(this.startYawDiff+this.endYawDiff)/2),this.standerOffsetZ=this.lockOffsetZ+this.scaleOffsetZ,this.targetZ=this.standerFarZ+this.standerOffsetZ,this.cameraLocalTargetPos.x=0,this.cameraLocalTargetPos.y=this.targetY,this.cameraLocalTargetPos.z=this.targetZ}lookTargetFollow(){this.rotateFollowTransform?(this.lookNode.transform.lookAt(this.rotateFollowTransform.position,this.upVec,!1),this.normalizeRotationEuler(this.lookNode.transform.localRotationEuler,this.targetEuler)):this.normalizeRotationEuler(this.originalLocalRotationEuler,this.targetEuler),this.normalizeRotationEuler(this.camera.transform.localRotationEuler,this.selfEuler),this.nearestRotationDiff(this.selfEuler,this.targetEuler,this.diff);let t=this.diff.x,e=this.diff.y,i=this.diff.z;if(0==t&&0==e&&0==i&&!this.isSendEvent)return void(this.isSendEvent=!0);let s=this.rotateSpeed*Laya.timer.delta/1e3;this.rotation.x=Math.abs(t)<=.01*this.sensitive?t*this.sensitive:t*s*this.sensitive,this.rotation.y=Math.abs(e)<=.01*this.sensitive?e*this.sensitive:e*s*this.sensitive,this.rotation.z=Math.abs(i)<=.01*this.sensitive?i*this.sensitive:i*s*this.sensitive,this.rotation.x=this.fixLocalRotationX(this.rotation.x),this.curLocalRotationX+=this.rotation.x,this.camera.transform.rotate(this.rotation,!0,!1)}fixLocalRotationX(t){let e=this.curLocalRotationX+t,i=t;return t>0?e>0&&(i=0-this.curLocalRotationX):t<0&&e<-0&&(i=-0-this.curLocalRotationX),i}cameraMoveClose(){let t=this.upSpeed*Laya.timer.delta/1e3,e=this.camera.transform.localPosition;if(this.standerOffsetZ=this.lockOffsetZ+this.scaleOffsetZ,e.z!=this.targetZ){if(this.verticalTranslation.y=0,this.isHitMap){if(this.verticalTranslation.z=-(this.targetZ-e.z)*t*5,e.z-this.verticalTranslation.z>this.standerNearZ+this.standerOffsetZ){this.verticalTranslation.z=0;let t=this.camera.transform.localPosition.clone();t.z=this.standerNearZ+this.standerOffsetZ,this.camera.transform.localPosition=t}}else if(this.verticalTranslation.z=2.5*t,e.z-this.verticalTranslation.z<this.standerFarZ+this.standerOffsetZ){this.verticalTranslation.z=0;let t=this.camera.transform.localPosition.clone();t.z=this.standerFarZ+this.standerOffsetZ,this.camera.transform.localPosition=t}this.camera.transform.translate(this.verticalTranslation,!0)}e.y!=this.targetY&&(this.verticalTranslation.z=0,Math.abs(this.targetY-e.y)>2.5*t?this.verticalTranslation.y=2.5*t*Math.sign(this.targetY-e.y):this.verticalTranslation.y=this.targetY-e.y,this.camera.transform.translate(this.verticalTranslation,!0))}cameraMoveClose1(){let t=this.upSpeed*Laya.timer.delta/1e3,e=this.camera.transform.localPosition;Laya.Vector3.subtract(this.cameraLocalTargetPos,e,this.verticalTranslation);let i=Laya.Vector3.distance(e,this.cameraLocalTargetPos);this.isHitMap&&(t=t*i*5),t>i?t=1:(t*=3,Laya.Vector3.normalize(this.verticalTranslation,this.verticalTranslation)),Laya.Vector3.scale(this.verticalTranslation,t,this.verticalTranslation);let s=new Laya.Vector3;if(Laya.Vector3.add(this.camera.transform.localPosition,this.verticalTranslation,s),this.camera.transform.localPosition=s,this.isHitWaterFace){let t=this.camera.transform.position.clone();this.camera.transform.position=t}}normalizeRotationEuler(t,e){e.x=(t.x%360+360)%360,e.y=(t.y%360+360)%360,e.z=(t.z%360+360)%360}nearestRotationDiff(t,e,i){return Laya.Vector3.subtract(t,e,i),Math.abs(i.x)>180&&(i.x>0?i.x=i.x-360:i.x=i.x+360),Math.abs(i.y)>180&&(i.y>0?i.y=i.y-360:i.y=i.y+360),Math.abs(i.z)>180&&(i.z>0?i.z=i.z-360:i.z=i.z+360),i.x*=-1,i.y*=-1,i.z*=-1,i}setHitMap(t,e){if(this.isHitMap=t,this.isHitWaterFace=e,this.standerOffsetZ=this.lockOffsetZ+this.scaleOffsetZ,this.isHitMap){let t=this.standerNearZ+this.standerOffsetZ;this.targetZ=this.camera.transform.localPosition.z+(t-this.camera.transform.localPosition.z)/5,Laya.Vector3.subtract(new Laya.Vector3(0,0,t),this.camera.transform.localPosition,this.verticalTranslation),Laya.Vector3.scale(this.verticalTranslation,.2,this.verticalTranslation),Laya.Vector3.add(this.camera.transform.localPosition,this.verticalTranslation,this.cameraLocalTargetPos)}else this.targetZ=this.standerFarZ+this.standerOffsetZ,this.targetY=this.standerFarY,this.cameraLocalTargetPos.x=0,this.cameraLocalTargetPos.y=this.targetY,this.cameraLocalTargetPos.z=this.targetZ}setCameraRotateSensitive(t){this.isRecoverySensitive=!1,1==t?this.isRecoverySensitive=!0:this.sensitive=t}recoveryCameraSensitive(){if(this.isRecoverySensitive){let t=Laya.timer.delta/1e3;this.sensitive+t>1&&(t=1-this.sensitive,this.isRecoverySensitive=!1),this.sensitive+=t}}}Yt.ReachDest="ReachDest";class zt extends Laya.Script3D{constructor(){super(...arguments),this.bornPoint=null,this.isVisible=!1,this.mesh=null,this.gameObject=null,this.animator=null,this.isOpened=!1}onAwake(){this.gameObject=this.owner,this.animator=this.gameObject.getComponent(Laya.Animator),this.mesh=this.gameObject.getChildByName("Box")}onEnable(){this.animator.play("Stand",0,0)}initPosAndRot(){this.gameObject.transform.position=L.createVector3FromArray(this.bornPoint.position),this.gameObject.transform.rotation=L.createQuaternionFromArray(this.bornPoint.rotation)}openChest(){this.isOpened=!0,this.gameObject.active=!1}}class jt extends St{constructor(){super(...arguments),this.followTarget=null,this.isVisible=!1,this.mesh=null,this.bornPoint=null,this.warnRadius=5,this.endTarget=new Tt,this.startPos=new Tt,this.endPos=new Tt,this.tempVec3=new Tt,this.lastNode=null,this.pathNode=null,this.walkDir=new Laya.Vector3,this.curTargetPoint=null,this.translation=new Laya.Vector3,this.moveSpeed=3,this.frameMoveSpeed=0,this.frameTime=0,this.pathfinding=null,this.zoneId="",this.rotateSpeedSection=[10,1e3],this.isTurning=!1,this.forwardDir=new Laya.Vector3,this.rotation=new Laya.Vector3,this.targetDir=new Laya.Vector3,this.pathBallList=[],this.isAteOriginal=!1}onAwake(){super.onAwake();let t=this.gameObject.getChildAt(0);for(let e=0;e<t.numChildren;e++){let i=t.getChildAt(e);if(i instanceof Laya.SkinnedMeshSprite3D){this.mesh=i;break}}}onEnable(){this.changeActorState("Stand","",!0)}onDestroy(){e.off(t.TargetNodeChange,this,this.onTargetNodeChange)}initPathfinding(t,e){this.pathfinding=t,this.zoneId=e,L.cloneToVec3(this.gameObject.transform.position,this.tempVec3);let i=this.pathfinding.getGroup(this.zoneId,this.tempVec3,!0);this.lastNode=this.pathfinding.getClosestNode(this.tempVec3,this.zoneId,i,!0)}onUpdate(){if(!C.Instance.isGotoFightScene&&!C.Instance.isPause&&(this.frameTime=Laya.timer.delta/1e3,this.frameMoveSpeed=this.moveSpeed*this.frameTime,this.followTarget)){if(null==this.curTargetPoint){if(this.pathNode&&this.pathNode.length>0){let t=this.pathNode.shift();this.curTargetPoint=new Laya.Vector3,L.cloneToLayaVec3(t,this.curTargetPoint)}else this.curTargetPoint=this.followTarget.gameObject.transform.position;this.updateWalkDir(),this.changeActorState("Run","",!0)}if(this.curTargetPoint){let t=0,e=0;t=this.curTargetPoint.x-this.gameObject.transform.position.x,e=this.curTargetPoint.z-this.gameObject.transform.position.z,this.targetDir.x=t,this.targetDir.z=e,this.curTargetPoint==this.followTarget.gameObject.transform.position&&this.updateWalkDir(),this.turn(),t*t+e*e>.05*.05?(Laya.Vector3.scale(this.walkDir,this.frameMoveSpeed,this.translation),this.gameObject.transform.translate(this.translation,!1),this.isAteOriginal=!1):(this.curTargetPoint=null,this.changeActorState("Stand","",!0))}}}turn(){this.gameObject.transform.getForward(this.forwardDir),this.forwardDir.y=0,this.forwardDir.x*=-1,this.forwardDir.z*=-1;let t=v.getRotateRad(this.forwardDir,this.targetDir)*v.rad2Deg;if(0!=t){this.isTurning=!0;let e=(this.rotateSpeedSection[0]+(this.rotateSpeedSection[1]-this.rotateSpeedSection[0])*Math.abs(t)/180)*this.frameTime*Math.sign(t);(e>0&&e>t||e<0&&e<t)&&(e=t),this.rotation.y=e,this.gameObject.transform.rotate(this.rotation,!1,!1)}else this.isTurning=!1}updateWalkDir(){this.walkDir.x=this.curTargetPoint.x-this.gameObject.transform.position.x,this.walkDir.y=0,this.walkDir.z=this.curTargetPoint.z-this.gameObject.transform.position.z,Laya.Vector3.normalize(this.walkDir,this.walkDir)}setVisibleByCamera(t){t!=this.isVisible&&(this.isVisible=t,t?this.gameObject.active=!0:(this.gameObject.active=!1,this.initPosAndRot()))}enterFight(){this.gameObject.active=!1,this.initPosAndRot(),this.isVisible=!0}initPosAndRot(){this.isAteOriginal||(this.isAteOriginal=!0,this.gameObject.transform.position=L.createVector3FromArray(this.bornPoint.position),this.gameObject.transform.rotation=L.createQuaternionFromArray(this.bornPoint.rotation)),this.setFollowTarget(null)}setFollowTarget(i){i?i!=this.followTarget&&(this.followTarget=i,e.on(t.TargetNodeChange,this,this.onTargetNodeChange),this.findPath()):(this.followTarget=null,e.off(t.TargetNodeChange,this,this.onTargetNodeChange))}onTargetNodeChange(t){t==this.followTarget&&this.pathfinding&&this.findPath()}findPath(){this.curTargetPoint=null,L.cloneToVec3(this.gameObject.transform.position,this.startPos);let t=this.pathfinding.getGroup(this.zoneId,this.startPos,!0);L.cloneToVec3(this.followTarget.gameObject.transform.position,this.endPos),this.pathNode=this.pathfinding.findPath(this.startPos,this.endPos,this.zoneId,t)}}class Wt extends Laya.Script3D{constructor(){super(...arguments),this.bornPoint=null,this.isVisible=!1,this.mesh=null,this.gameObject=null,this.pictureId=0}onAwake(){this.gameObject=this.owner,this.mesh=this.gameObject.getChildAt(0)}initPosAndRot(){this.gameObject.transform.position=L.createVector3FromArray(this.bornPoint.position),this.gameObject.transform.rotation=L.createQuaternionFromArray(this.bornPoint.rotation)}}class qt extends ft{constructor(){super(...arguments),this.pathfinding=null,this.player=null,this.cameraFollowScript=null,this.npcMap=new Map,this.chestMap=new Map,this.pictureMap=new Map,this.enterLastNode=null,this.openChest=null}onAwake(){this.cameraUrl="MainCamera/MainCamera",super.onAwake(),this.initNavMesh(),this.initPlayer(),this.initNpc(),this.initPicture(),this.initChest(),0==this.pictureMap.size&&this.initBoss(),e.on(t.ControlChange,this,this.onControlChange),e.on(t.OpenTreasureBoxFinish,this,this.onOpenTreasureBoxFinish),this.cameraFollowScript=this.camera.parent.getComponent(Yt),this.cameraFollowScript||(this.cameraFollowScript=this.camera.parent.addComponent(Yt)),this.cameraFollowScript.setCameraTargetTransform(this.player.gameObject.transform),window.GameSceneLogic=this}onOpened(i){C.Instance.isPause=!1,C.Instance.isGotoFightScene=!1,this.player.isMoving=!1,this.player.initPosAndRot(),this.player.clearActorState(),this.player.changeActorState("Stand",""),this.player.initPathfinding(this.pathfinding,C.Instance.zoneId),this.player.lastNode||(this.player.lastNode=this.enterLastNode),C.Instance.lastPos&&(C.Instance.lastPos.y=0,this.player.gameObject.transform.position=C.Instance.lastPos.clone(),C.Instance.lastPos=null),this.cameraFollowScript.cameraNode.transform.position=this.player.gameObject.transform.position.clone();for(const t of this.npcMap)t[1].initPosAndRot();if(i)for(const t of this.chestMap)t[1].gameObject.active||(t[1].gameObject.active=!0);e.event(t.UpdateSmallMap,this.player.gameObject.transform.position)}onClosed(){for(const t of this.npcMap)t[1].setFollowTarget(null)}initNavMesh(){C.Instance.zoneId=`level${C.Instance.enterMapIndex+1}`,this.pathfinding=new Gt;let t=C.Instance.navMeshData;this.zone=Gt.createZone(t),this.pathfinding.setZoneData(C.Instance.zoneId,this.zone),window.pathfinding=this.pathfinding}initPlayer(){let t=p.getRes("Player1.lh");this.clearNode.addChild(t),this.player=t.getComponent(Ht),this.player||(this.player=t.addComponent(Ht)),this.player.bornPoint=C.Instance.pointData.Born1}initNpc(){let t=C.Instance.pointData;for(const e in t)if(-1!=e.indexOf("Npc")){let i=Number(e.replace("Npc","")),s=C.Instance.mapMonsterIdList[i-1],a=`Enemy${s[s.length-1]}`,n=t[e],o=L.createSprite3DWithScript(a,jt,this.clearNode);o.bornPoint=n,this.npcMap.set(e,o),o.initPosAndRot(),o.initPathfinding(this.pathfinding,C.Instance.zoneId),o.changeActorState("Stand","",!0)}}initBoss(){let i=C.Instance.pointData,s=`Enemy${C.Instance.curMapData.bossStat.id}`,a=i.Boss1,n=L.createSprite3DWithScript(s,jt,this.clearNode);n.bornPoint=a,this.npcMap.set("Boss1",n),n.initPosAndRot(),e.event(t.BossOut)}initPicture(){let t=B.instance.pictureCollectList[C.Instance.enterMapIndex];C.Instance.isCream&&(t=B.instance.creamPictureCollectList[C.Instance.enterMapIndex]);for(let e=0;e<C.Instance.curMapData.piece;e++){let i=e+1;if(-1==t.indexOf(i)){let t="Picture"+i,e=C.Instance.pointData[t];if(e){let s=L.createSprite3DWithScript("Picture",Wt,this.clearNode);s.pictureId=i,s.gameObject.name=t,s.bornPoint=e,s.initPosAndRot(),this.pictureMap.set(t,s)}}}}initChest(){let t=C.Instance.pointData;for(const e in t)if(-1!=e.indexOf("Chest")){let i=t[e];if(i){let t=L.createSprite3DWithScript("Box",zt,this.clearNode);t.gameObject.name=e,t.bornPoint=i,t.initPosAndRot(),this.chestMap.set(e,t)}}}getRandomPosInZone(t,e){let i=t.groups[e],s=i[Math.floor(Math.random()*i.length)],a=this.getCloneVector3(t.vertices[s.vertexIds[0]]),n=this.getCloneVector3(t.vertices[s.vertexIds[1]]),o=this.getCloneVector3(t.vertices[s.vertexIds[2]]);return this.getRandomPointInTriangle(a,n,o)}getCloneVector3(t){let e=new Tt;return e.x=t.x,e.y=t.y,e.z=t.z,e}getRandomPointInTriangle(t,e,i){let s=new Tt;s.copy(i);let a=i.sub(t),n=e.sub(s);return n.multiplyScalar(Math.random()),a.add(n),a.multiplyScalar(Math.random()),t.add(a),t}updateVisibleByCamera(){for(const t of this.npcMap){let e=L.getVisibleByCamera(this.camera,t[1].mesh);t[1].setVisibleByCamera(e)}}updateFollowTarget(){for(const t of this.npcMap)if(t[1].gameObject.active&&-1!=t[0].indexOf("Npc")){Laya.Vector3.distance(t[1].gameObject.transform.position,this.player.gameObject.transform.position)<=t[1].warnRadius&&t[1].setFollowTarget(this.player)}}updateReachTarget(){for(const t of this.npcMap)if(t[1].gameObject.active){if(Laya.Vector3.distance(t[1].gameObject.transform.position,this.player.gameObject.transform.position)<=1){if(p.playSound("hitEnemy.mp3"),-1!=t[0].indexOf("Npc")){C.Instance.isBoss=!1;let e=Number(t[0].replace("Npc",""));C.Instance.setMonsterIdList(C.Instance.mapMonsterIdList[e-1],!1)}else{C.Instance.isBoss=!0;let t=C.Instance.getMapEnemyMonsterIdList(C.Instance.enterMapIndex,1);C.Instance.setMonsterIdList(t,!0)}t[1].enterFight(),this.gotoFight()}}}gotoFight(){C.Instance.isPause=!0,this.player.isMoving=!1,this.player.walkDir.x=0,this.player.walkDir.y=0,this.player.walkDir.z=0,C.Instance.isGotoFightScene=!0,Laya.MouseManager.enabled=!1,C.Instance.lastPos=this.player.gameObject.transform.position.clone(),this.enterLastNode=this.player.lastNode,e.event(t.GotoScene,"fight");let i=C.Instance.enemyMonsterCardList,s=i[i.length-1].monsterId;window.fightSendData={level_id:C.Instance.enterMapIndex+1,scene_id:s,category:1,extra1:0},C.Instance.isCream&&(window.fightSendData.level_id+=8),C.Instance.isBoss&&(window.fightSendData.extra1=1),b.sendEvent(10003,window.fightSendData)}onUpdate(){C.Instance.isGotoFightScene||!C.Instance.isInSearchMap||C.Instance.isPause||(this.updateVisibleByCamera(),this.updateFollowTarget(),this.updateReachTarget(),this.detectCollectPicture(),this.detectCollectChest(),this.updatePicturePointer(),this.updateBossPointer(),this.updateChestPointer())}onDestroy(){this.player.gameObject.removeSelf(),this.player.destroy(),this.cameraFollowScript.destroy(),super.onDestroy(),e.off(t.ControlChange,this,this.onControlChange),e.off(t.OpenTreasureBoxFinish,this,this.onOpenTreasureBoxFinish)}onControlChange(t,e,i){C.Instance.isPause||(!this.player.isMoving&&t?this.player.changeActorState("Run",""):this.player.isMoving&&!t&&this.player.changeActorState("Stand",""),this.player.isMoving=t,t&&(this.player.moveDir.x=e,this.player.moveDir.y=i))}detectCollectPicture(){for(const i of this.pictureMap){let s=i[1];if(Laya.Vector3.distance(s.gameObject.transform.position,this.player.gameObject.transform.position)<1)return this.pictureMap.delete(i[0]),s.gameObject.removeSelf(),Laya.Pool.recover(Wt.name,s),B.instance.finishTask(1,4,1),p.playSound("treasure.mp3"),C.Instance.isCream?(B.instance.creamPictureCollectList[C.Instance.enterMapIndex].push(s.pictureId),B.instance.onDataChange("creamPictureCollectList")):(B.instance.pictureCollectList[C.Instance.enterMapIndex].push(s.pictureId),B.instance.onDataChange("pictureCollectList")),void(0==this.pictureMap.size&&(this.initBoss(),this.showBossOutCamera(),e.event(t.ShowPicturePointer,!1)))}}detectCollectChest(){for(const t of this.chestMap){let e=t[1];if(e.gameObject.active&&Laya.Vector3.distance(e.gameObject.transform.position,this.player.gameObject.transform.position)<1)return this.player.isMoving=!1,this.player.changeActorState("Stand",""),C.Instance.isPause=!0,e.animator.play("Open",0,0),p.playSound("treasure.mp3"),void Laya.timer.once(1e3,this,()=>{this.showChestReward(e)})}}showChestReward(i){let s=2,a=Math.random();if(a<.05?s=2:a<.05?s=0:a<.3?s=3:a<.6?s=4:a<1&&(s=1),0==s||1==s||3==s||4==s)this.openChest=i,L.openScene("pages/treasureBox.scene",!1,!0,null,[s]);else{C.Instance.isBoss=!1,i.openChest(),e.event(t.ShowTreasurePointer,!1);let s=C.Instance.getMapEnemyMonsterIdList(C.Instance.enterMapIndex,2);C.Instance.setMonsterIdList(s,!1),this.gotoFight()}}updatePicturePointer(){if(this.pictureMap.size>0){let i=1/0,s=null;for(const t of this.pictureMap){let e=t[1],a=Laya.Vector3.distance(e.gameObject.transform.position,this.player.gameObject.transform.position);a<i&&(s=e,i=a)}s&&(e.event(t.ShowPicturePointer,!0),e.event(t.UpdatePicturePointer,s.gameObject.transform.position))}else e.event(t.ShowPicturePointer,!1)}updateBossPointer(){let i=this.npcMap.get("Boss1");i&&(e.event(t.ShowBossPointer,!0),e.event(t.UpdateBossPointer,i.gameObject.transform.position))}updateChestPointer(){if(this.chestMap.size>0){let i=1/0,s=null;for(const t of this.chestMap){let e=t[1];if(e.gameObject.active){let t=Laya.Vector3.distance(e.gameObject.transform.position,this.player.gameObject.transform.position);t<i&&(s=e,i=t)}}s&&s.gameObject.active&&(e.event(t.ShowTreasurePointer,!0),e.event(t.UpdateTreasurePointer,s.gameObject.transform.position))}}getPointerPosAndRot(t,e){let i=L.convert3DTo2DPosition(this.camera,e),s=i.x,a=i.y,n=L.convert3DTo2DPosition(this.camera,t),o=n.x,r=n.y,h=s<80?80:s,l=a<80?80:a;return[h=h>Laya.stage.width-80?Laya.stage.width-80:h,l=l>Laya.stage.height-80?Laya.stage.height-80:l,Math.atan2(a-r,s-o)*v.rad2Deg]}showBossOutCamera(){this.player.isMoving=!1,C.Instance.isPause=!0;let t=this.npcMap.get("Boss1");this.cameraFollowScript.setCameraTargetTransform(t.gameObject.transform),e.once(Yt.ReachDest,this,()=>{Laya.timer.once(2e3,this,()=>{C.Instance.isPause=!1,this.player.isMoving=!0,this.cameraFollowScript.setCameraTargetTransform(this.player.gameObject.transform)})})}onOpenTreasureBoxFinish(){this.openChest&&(this.openChest.openChest(),this.openChest=null),e.event(t.ShowTreasurePointer,!1),C.Instance.isPause=!1}}class Kt extends kt{onAwake(){super.onAwake()}onOpened(){C.Instance.setPvpMonsterIdList(),super.onOpened(),this.fightCameraData={position:[2.7,7.37,18.5],rotation:[.1435388,-.2619153,-.03942669,-.9535421]},this.setCameraFightPosAndRot()}}class $t extends qt{}class Qt extends i.pages.pkUI{constructor(){super(...arguments),this.rewardBoxWinTimeList=[1,3,5,7,10],this.rewardBoxStateList=[0,0,0,0,0],this.rewardList=[{type:"gold",num:100},{type:"chip",num:100},{type:"gold",num:100},{type:"chip",num:100},{type:"gold",num:20}],this.curTabIndex=-1}onAwake(){this.matchBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.goShopBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.rankBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.divisionBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.winTimeLabel.filters=[x.blackColorFilter],this.setRewardBoxPos(),this._list.vScrollBarSkin=null,this.wxOpenDataViewer.visible=!1,this.rankRewardList.vScrollBarSkin=null}static haveRed(){return!1}onDestroy(){}onSelect(){this.curTabIndex=-1,this.setCurTabIndex(0),this.visible=!0,C.Instance.isPause=!0,e.event(t.PlayerStopMove),e.event(t.ShowGoldMoneyUi,!1)}offSelect(){this.hideRankList(),this.visible=!1,C.Instance.isPause=!1,e.event(t.PlayerStopMove),e.event(t.ShowGoldMoneyUi,!0)}onBtnClick(i){i.target==this.matchBtn?(C.Instance.pvpEnemyData=this._list.array[v.getRandom(0,this._list.array.length-1)],L.openScene("pages/pvpMatch.scene",!1,!0,null,null,!1)):i.target==this.goShopBtn?e.event(t.JumpToPage,5):i.target==this.rankBtn?this.setCurTabIndex(0):i.target==this.divisionBtn&&this.setCurTabIndex(1)}setRewardBoxPos(){let t=[this.box1,this.box2,this.box3,this.box4,this.box5],e=this.rewardBoxWinTimeList[this.rewardBoxWinTimeList.length-1];for(let i=0;i<this.rewardBoxWinTimeList.length;i++){let s=this.rewardBoxWinTimeList[i]/e,a=t[i];a.x=500*s,a.boxIndexLabel.text=i+1+"",a.on(Laya.Event.CLICK,this,this.onRewardBoxClick,[i])}}updateRewardBoxState(){let t=[this.box1,this.box2,this.box3,this.box4,this.box5];for(let e=0;e<t.length;e++){let i=t[e],s=0;0>=this.rewardBoxWinTimeList[e]&&(s=1==B.instance.pvpRewardBoxReceiveList[e]?2:1),this.rewardBoxStateList[e]=s,this.setRewardBoxState(i,s)}}updateDayWinCountProgress(){let t=B.instance.dayWinCount,e=this.rewardBoxWinTimeList[this.rewardBoxWinTimeList.length-1];t=t>e?e:t,this.dayWinprogress.width=t/e*500}setRewardBoxState(t,e){t.redPoint.visible=0!=e&&2!=e}showRankList(){}hideRankList(){}showFakeRankList(){let t=[],e={index:0,avatarIP:"",UserName:"我",RankValue:B.instance.winCount,isMe:!0};t.push(e),this.addAiData(t),t.sort((t,e)=>e.RankValue-t.RankValue);for(let e=0;e<t.length;e++)t[e].index=e+1;this._list.array=t,this._list.refresh()}setCurTabIndex(t){t!=this.curTabIndex&&(this.curTabIndex=t,this.setTabBtnState(),this.rewardBox.visible=1==this.curTabIndex,this.rankBox.visible=0==this.curTabIndex,this.pvpBg.skin=0==this.curTabIndex?"pvp/Ui_FrameFight2.png":"pvp/Ui_FrameFight.png",0==t?(this.updateRewardBoxState(),this.updateDayWinCountProgress(),this.showFakeRankList()):(this.updateDivision(),this.showRankRewardList()))}setTabBtnState(){this.rankBtn.skin=0==this.curTabIndex?"pvp/Btn_FightRank2.png":"pvp/Btn_FightRank1.png",this.divisionBtn.skin=1==this.curTabIndex?"pvp/Btn_Fightgift2.png":"pvp/Btn_Fightgift1.png"}onRewardBoxClick(t){1==this.rewardBoxStateList[t]&&(B.instance.pvpRewardBoxReceiveList[t]=1,C.Instance.receiveReward([this.rewardList[t]]),this.updateRewardBoxState())}showRankRewardList(){let t=[];for(let e=0;e<C.Instance.pvpScoreConfig.length;e++){let i=C.Instance.pvpScoreConfig[e];if(i.levelReward){let s={index:e,level:i.level,star:i.star,levelReward:i.levelReward,levelExtraReward:i.levelExtraReward};t.push(s)}}this.rankRewardList.array=t,this.rankRewardList.refresh()}updateDivision(){let t=C.Instance.pvpScoreDataList,e=C.Instance.getPvpDivisionDataByScore(B.instance.winCount);this.curDivisionIcon.setDivision(e[0]),this.curDivisionIcon.setStarNum(e[1]);let i=[...e];i[1]+1>=t[i[0]-1].length?i[0]+1<t.length&&(i[0]++,i[1]=0):i[1]++,this.nextDivisionIcon.setDivision(i[0]),this.nextDivisionIcon.setStarNum(i[1]);let s=t[i[0]-1][i[1]-1].totalUpgradeScore;this.winTimeLabel.text=`${B.instance.winCount}/${s}`;let a=B.instance.winCount/s;a=a>1?1:a,this.divisionProgress.width=250*a}addAiData(t){let e=C.Instance.pvpScoreDataList,i=e[e.length-1][2].totalUpgradeScore;for(let e=0;e<C.Instance.aiConfig.length;e++){let s=C.Instance.aiConfig[e],a={index:0,avatarIP:s.icon,UserName:s.name,RankValue:v.getRandom(0,i),isMe:!1};t.push(a)}}}class Zt extends i.pages.spriteShopUI{constructor(){super(...arguments),this.curTabIndex=-1}onAwake(){this.itemList.vScrollBarSkin=null,this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.tabList.mouseHandler=Laya.Handler.create(this,this.onTabListMouseHandler,null,!1),this.itemList.mouseHandler=Laya.Handler.create(this,this.onItemListMouseHandler,null,!1),this.initTabList(0),this.initMoneyPoint(),e.on(B.UserDataChange,this,this.onUserDataChange)}onDestroy(){e.off(B.UserDataChange,this,this.onUserDataChange)}initTabList(t){if(t==this.curTabIndex)return;let e=[];for(let i=0;i<4;i++)t!=i?e.push({tabBg:{skin:"spriteShop/Btn_Shop1.png"},tabLabel:{skin:`pay/Btn_Shopword${2*(i+1)-1}.png`}}):e.push({tabBg:{skin:"spriteShop/Btn_Shop2.png"},tabLabel:{skin:`pay/Btn_Shopword${2*(i+1)}.png`}});this.tabList.array=e,this.tabList.refresh(),this.curTabIndex=t,this.initItemList(this.curTabIndex)}initItemList(t){this.diamondByTips.visible=0==t;this.itemDataList=C.Instance.goodsItem[["diamondShop","superExchange","ticketExchange","monsterExchange"][t]],this.itemList.array=this.itemDataList,this.itemList.refresh()}onTabListMouseHandler(t,e){t.type==Laya.Event.CLICK&&this.initTabList(e)}onItemListMouseHandler(i,s){if(i.type!=Laya.Event.CLICK)return;let a=this.itemList.getCell(s);if(!a.itemMask.visible)if("rmb"==a.data.costType)0==a.data.costNum||"undefined"==typeof wx?(this.receiveShopItem(a.data),this.addLotteryTime(a.data.costNum)):st.buyItem(a.data).then(()=>{this.receiveShopItem(a.data),this.addLotteryTime(a.data.costNum)});else if("diamond"==a.data.costType||"badge"==a.data.costType){if("badge"==a.data.costType){if(!(B.instance.badge>=a.data.costNum))return;B.instance.badge-=a.data.costNum,B.instance.onDataChange("badge"),e.event(t.UseMoney,"badge")}else if("diamond"==a.data.costType){if(!(B.instance.diamond>=a.data.costNum))return;B.instance.diamond-=a.data.costNum,B.instance.onDataChange("diamond"),e.event(t.UseMoney,"diamond")}this.receiveShopItem(a.data)}}receiveShopItem(t){if("monster"==t.goods[0].type){let e=C.Instance.getOneCardData(t.goods[0].num),i=C.Instance.monsterData;L.openScene("pages/catchResult.scene",!1,!0,null,[!0,e.monsterId,i[e.monsterId],!1,6,!1])}else{let e=1,i=t.goods[0].num;"chip"==t.goods[0].type?e=4:"fightTicket"==t.goods[0].type?e=5:"diamond"==t.goods[0].type&&(e=6,C.Instance.haveExtra(t)&&(i+=t.extra)),L.openScene("pages/getCard.scene",!1,!0,null,[e,i])}B.instance.shopBuyRecord[t.productId]||(B.instance.shopBuyRecord[t.productId]=0),B.instance.shopBuyRecord[t.productId]++,B.instance.onDataChange("shopBuyRecord")}onBtnClick(i){i.target==this.closeBtn&&e.event(t.ShowSpriteShop,!1)}onUserDataChange(t){"shopBuyRecord"==t&&this.itemList.refresh()}initMoneyPoint(){let t=this.badgeMoneyUi;t.setMoneyType("badge",!0),t.enableEffect=!1,t.moneyIcon.localToGlobal(t.moneyPoint,!1,this);let e=this.diamondMoneyUi;e.setMoneyType("diamond",!1),e.enableEffect=!1,e.moneyIcon.localToGlobal(e.moneyPoint,!1,this)}onSelect(){w.Instance.showBannerAd()}offSelect(){w.Instance.hideBannerAd()}addLotteryTime(t){let e=3*t;B.instance.freeLotteryTimeLeft+=e,B.instance.onDataChange("freeLotteryTimeLeft")}static haveRed(){return 0==C.Instance.getShopItemBuyTime(1)}}class Jt extends i.pages.starUI{constructor(){super(...arguments),this.selectCard=null,this.cloneCard=null,this.posType=0,this.selectFrom=0,this.stopClick=!1,this.isMove=!1,this.downPoint=new Laya.Point,this.selectCardDataList=[null,null,null,null],this.goldCost=0,this.fragmentCost=0,this.upgradeParam=[],this.expNeed=0,this.expAdd=0,this.cardStateList=[],this.upgradeCondition=0,this.expOverFlow=0}onAwake(){e.on(t.SelectCard,this,this.onSelectPageCard),this.cardBag.isShowStoreEgg=!1,this.cardBag.exceptFunc=this.exceptFunc.bind(this),this.cardBag.canSelectFunc=this.canSelectFunc.bind(this),this.cardBag.initMonsterList(),this.on(Laya.Event.MOUSE_MOVE,this,this.onStarPageEvent),this.on(Laya.Event.MOUSE_UP,this,this.onStarPageEvent),this.quickSelectBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.upBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.cardBag.monsterList.on(Laya.Event.MOUSE_OUT,this,this.onCardBagEvent),this.cardBag.monsterList.on(Laya.Event.MOUSE_OVER,this,this.onCardBagEvent);let i=[this.cardMainBox,this.cardBox1,this.cardBox2,this.cardBox3];for(let t=0;t<i.length;t++){let e=i[t];e.on(Laya.Event.MOUSE_OUT,this,this.onCardBoxEvent),e.on(Laya.Event.MOUSE_OVER,this,this.onCardBoxEvent),e.on(Laya.Event.CLICK,this,this.onCardBoxEvent),e.on(Laya.Event.MOUSE_DOWN,this,this.onCardBoxEvent)}this.cloneCard=new P,this.addChild(this.cloneCard),this.cloneCard.visible=!1,this.refreshSelectCardList(),this.initCardStateList(),this.setBtnVideoTag(),this.setUpStarCard(this.selectCardDataList[0]),this.cardBag.monsterList.name="starMonsterList",window.starRuntime=this,this.initChipPoint()}getFirstEmptyIndex(){for(let t=0;t<this.selectCardDataList.length;t++)if(null==this.selectCardDataList[t])return t;return-1}setUpStarCard(t){t&&t.star<13?(this.updateUpConfigData(),this.showUpStarBtn(!0),this.clearUpCondition(),this.updateUpCondition(),this.updateExpProgressData(),this.updateUpgradeMaterialList(),this.showStarTip(!0),this.showCardInfo(!0),this.updateUpgradeCost(),this.updateCardHaveStateList(),this.enableMaterialSelectBox(!0)):(this.showUpStarBtn(!1),this.clearUpCondition(),this.clearUpgradeMaterialList(),this.showCardInfo(!1),this.clearUpConfigData(),this.clearExpProgressData(),this.updateUpgradeCost(),this.enableMaterialSelectBox(!1),this.showStarTip(!1))}enableMaterialSelectBox(t){this.cardBox1.visible=t,this.cardBox2.visible=t,this.cardBox3.visible=t}updateUpConfigData(){let t=this.selectCardDataList[0].star;this.upgrageConfigData=C.Instance.upgradeConfig[t]}clearUpConfigData(){this.upgrageConfigData=null}clearUpCondition(){this.upgradeCondition=0,this.upgradeParam.length=0}updateUpCondition(){this.upgradeCondition=this.upgrageConfigData.upgradeCondition;let t=this.upgrageConfigData.upgradeParam.split(",");for(let e=0;e<t.length;e++)this.upgradeParam.push(Number(t[e]))}updateUpgradeMaterialList(){this.selectCardDataList[0].exp>=this.expNeed?1==this.upgradeCondition?(this.stateList.visible=!1,this.quickSelectBtn.visible=!0):(this.stateList.visible=!0,this.quickSelectBtn.visible=!1):(this.stateList.visible=!1,this.quickSelectBtn.visible=!0),this.selectCardDataList[0].exp>=this.expNeed&&2==this.upgradeCondition&&this.selectAppointMonsterIdCard(),this.updateCanSelectLevelList()}clearUpgradeMaterialList(){this.clearSelectList(),this.selectCardDataList[0]&&13==this.selectCardDataList[0].star?this.canSelectList=[]:this.canSelectList=null,this.stateList.visible=!1,this.quickSelectBtn.visible=!1}clearSelectList(){for(let t=0;t<3;t++)this.selectCardDataList[t+1]=null}updateExpProgressData(){this.expNeed=this.upgrageConfigData.expNeed,this.expAdd=0,this.setProgress(this.progressBar1,297,this.selectCardDataList[0].exp/this.expNeed,!1),this.setProgress(this.progressBar2,297,(this.selectCardDataList[0].exp+this.expAdd)/this.expNeed,!1)}clearExpProgressData(){this.expNeed=0,this.expAdd=0,this.expOverFlow=0,this.setProgress(this.progressBar1,297,0,!1),this.setProgress(this.progressBar2,297,0,!1)}selectAppointMonsterIdCard(){let t=[...this.upgradeParam],e=0;for(let i=0;i<B.instance.cardList.length;i++){let s=B.instance.cardList[i],a=t.indexOf(s.monsterId);if(-1!=a&&(t[a]=-1,this.selectCardDataList[a+1]=s,++e==this.upgradeParam.length))break}for(let t=0;t<this.upgradeParam.length;t++)if(!this.selectCardDataList[t+1]){let e=this.upgradeParam[t],i=C.Instance.getOneCardData(e);this.selectCardDataList[t+1]=i}}showCardInfo(t){this.infoBox.visible=t,t?(this.nextData=C.Instance.getNextMonsterData(this.selectCardDataList[0]),this.updateBeforeAfterInfo()):this.nextData=null}showUpStarBtn(t){this.upBtn.visible=t}updateUpgradeCost(){this.goldCost=0,this.fragmentCost=0;for(let t=0;t<3;t++){let e=this.selectCardDataList[t+1];e&&(this.goldCost+=C.Instance.upgradeConfig[e.star-1].goldCost,this.fragmentCost+=C.Instance.upgradeConfig[e.star-1].fragmentCost)}this.moneyCostLabel.text=this.goldCost+"",this.chipCostLabel.text=this.fragmentCost+""}takeOffUpStarCostMoney(){this.goldCost>0&&(B.instance.gold-=this.goldCost,B.instance.onDataChange("gold"),e.event(t.UseMoney,"gold")),this.fragmentCost>0&&(B.instance.chip-=this.fragmentCost,B.instance.onDataChange("chip"),e.event(t.UseMoney,"chip"))}removeUpStarCostCard(){for(let t=0;t<3;t++){let e=this.selectCardDataList[t+1];if(1==this.upgradeCondition&&e&&e.cardId>0||2==this.upgradeCondition&&e){let t=B.instance.cardList.indexOf(e);-1!=t&&B.instance.cardList.splice(t,1)}}}initCardStateList(){for(let t=0;t<3;t++)this.cardStateList.push({missTag:{visible:!1},getBtn:{visible:!1}});this.stateList.array=this.cardStateList,this.stateList.refresh();for(let t=0;t<this.stateList.length;t++){this.stateList.getCell(t).getChildByName("getBtn").on(Laya.Event.CLICK,this,this.onStateListMouseHandler,[t])}}onStateListMouseHandler(t,e){if(e.type==Laya.Event.CLICK){let e=C.Instance.getMonsterData([this.selectCardDataList[t+1].monsterId])[0];L.openScene("pages/catchResult.scene",!1,!0,Laya.Handler.create(this,()=>{this.selectAppointMonsterIdCard(),this.updateCardHaveStateList(),this.refreshSelectCardList(),this.updateCanSelectLevelList(),this.cardBag.initMonsterList(this.compareFn.bind(this))}),[!0,this.selectCardDataList[t+1].monsterId,e,!1,3])}}updateCardHaveStateList(){let t=[0,0,0];for(let e=0;e<3;e++){let i=this.selectCardDataList[e+1];i&&(0==i.cardId?t[e]=1:t[e]=2)}for(let e=0;e<t.length;e++){let i=this.cardStateList[e];2==t[e]||0==t[e]?(i.missTag.visible=!1,i.getBtn.visible=!1):(i.missTag.visible=!0,i.getBtn.visible=!0)}this.stateList.array=this.cardStateList,this.stateList.refresh()}checkCardCondition(){let t={result:!0,reason:""},e=0;for(let t=0;t<3;t++){let i=this.selectCardDataList[t+1];this.selectCardDataList[0].exp>=this.expNeed&&2==this.upgradeCondition?i&&i.cardId>0&&e++:i&&e++}return this.selectCardDataList[0].exp>=this.expNeed&&e<this.upgradeParam.length?(t.result=!1,t.reason="card not enough"):0==e&&(t.result=!1,t.reason="card not enough"),t}checkMoneyCondition(){let t={result:!0,reason:""};return B.instance.gold<this.goldCost?(t.result=!1,t.reason="gold not enough"):B.instance.chip<this.fragmentCost&&(t.result=!1,t.reason="chip not enough"),t}onBtnClick(i){if(i.target==this.quickSelectBtn)this.quickSelectCard();else if(i.target==this.upBtn){let i=this.checkCardCondition(),s=this.checkMoneyCondition();i.result&&(s.result?this.upCardStar():"gold not enough"==s.reason?(e.event(t.PopTip,"金币不足"),e.event(t.ShowGiftPack)):"chip not enough"==s.reason&&e.event(t.PopTip,"碎片不足"))}}onStarPageEvent(t){if(this.selectCard)if(t.type==Laya.Event.MOUSE_MOVE)this.selectCard.visible&&(this.cloneCard.visible=!0,this.selectCard.visible=!1,this.cardBag.monsterList.scrollBar.stopScroll()),this.cloneCard.visible&&(this.cloneCard.x=t.stageX-this.cloneCard.width/2,this.cloneCard.y=t.stageY-this.cloneCard.height/2),this.isMove=!0;else if(t.type==Laya.Event.MOUSE_UP){if(0==this.posType||this.posType==this.selectFrom||!this.allowOperate()||!this.allowSelect(this.posType-2)||this.selectFull()&&!this.isMaterialPosOperate()||this.posType-2>0&&!this.isAllowAsUpStarCostCard(this.selectCard.data))this.isMove&&this.posType==this.selectFrom&&this.posType>=2&&this.posType<=5&&(this.stopClick=!0,Laya.timer.frameOnce(2,this,()=>{this.stopClick=!1})),this.clearSelect(!0);else{let t=this.selectFrom-2,e=this.posType-2;if(1==this.posType)this.changeSelectList([this.selectCard.data],!1,t),this.onChangeSelectCardList(0==t,!0);else if(1==this.selectFrom)this.changeSelectList([this.selectCard.data],!0,e),this.onChangeSelectCardList(0==e,!0);else{let i=this.selectCardDataList[e];this.selectCardDataList[e]=this.selectCardDataList[t],this.selectCardDataList[t]=i,this.changeSelectList([...this.selectCardDataList],!0,-1),this.onChangeSelectCardList(0==e||0==t,!0)}}this.isMove=!1}}isMaterialPosOperate(){let t=this.selectFrom-2,e=this.posType-2;return t>=1&&t<=3&&e>=1&&e<=3}onCardBagEvent(t){t.type==Laya.Event.MOUSE_OUT?this.posType=0:t.type==Laya.Event.MOUSE_OVER&&(this.posType=1)}onCardBoxEvent(t){if(2==this.upgradeCondition&&(t.target==this.cardBox1||t.target==this.cardBox2||t.target==this.cardBox3))return;let e=[this.cardMainBox,this.cardBox1,this.cardBox2,this.cardBox3],i=[this.cardMain,this.card1,this.card2,this.card3],s=[2,3,4,5],a=e.indexOf(t.target);if(t.type==Laya.Event.MOUSE_OUT)this.posType=0;else if(t.type==Laya.Event.MOUSE_OVER)this.posType=s[a];else if(t.type==Laya.Event.MOUSE_DOWN){let e=i[a];if(!e.visible)return;this.selectCard=e,this.selectFrom=s[a],this.downPoint.x=t.stageX,this.downPoint.y=t.stageY,this.cloneCard.dataSource=this.selectCard.data}else if(t.type==Laya.Event.CLICK){let t=i[a];if(this.stopClick||!t.visible)return;this.changeSelectList([t.data],!1,a),this.onChangeSelectCardList(0==a,!1)}}static haveRed(){return!1}onSelectPageCard(i,s,a){if(i==this.cardBag.monsterList)if(a.cardBg.disabled)e.event(t.PopTip,"请选择正确的怪");else if(s.type==Laya.Event.MOUSE_DOWN)this.selectFrom=1,this.selectCard=a,this.downPoint.x=s.stageX,this.downPoint.y=s.stageY,this.cloneCard.dataSource=a.data;else if(s.type==Laya.Event.CLICK){let t=this.getFirstEmptyIndex();if(-1==t)return;if(!this.allowSelect(t)||this.selectFull())return;if(t>0&&!this.isAllowAsUpStarCostCard(a.data))return;this.changeSelectList([a.data],!0,t),this.onChangeSelectCardList(0==t,!1)}}exceptFunc(t){let e=[...this.selectCardDataList];for(let i=0;i<e.length;i++){let s=e[i];if(s&&t.cardId==s.cardId)return!1}return!0}changeSelectList(t,e,i){for(let s=0;s<t.length;s++)if(e)-1!=i?this.selectCardDataList[i]=t[s]:this.selectCardDataList[s]=t[s];else if(-1!=i)this.selectCardDataList[i]=null;else for(let e=0;e<this.selectCardDataList.length;e++)if(t[s].cardId==this.selectCardDataList[e].cardId){this.selectCardDataList[e]=null;break}}upCardStar(){if(this.takeOffUpStarCostMoney(),this.removeUpStarCostCard(),this.clearSelectList(),this.selectCardDataList[0].exp>=this.expNeed)this.selectCardDataList[0].hp=this.nextData.hp,this.selectCardDataList[0].curHp=this.nextData.hp,this.selectCardDataList[0].atk=this.nextData.atk,this.selectCardDataList[0].star+=1,this.selectCardDataList[0].exp=0,this.setUpStarCard(this.selectCardDataList[0]),this.selectCardDataList[0].star<13?this.cardBag.initMonsterList(this.compareFn.bind(this)):this.cardBag.initMonsterList(),B.instance.onDataChange("cardList"),this.refreshSelectCardList();else{e.event(t.PopTip,"获得经验"),this.setProgress(this.progressBar2,297,0,!1);let i=this.getExpAdd();Laya.MouseManager.enabled=!1,this.updateProgressBar(this.progressBar1,i,Laya.Handler.create(this,()=>{Laya.MouseManager.enabled=!0,this.selectCardDataList[0].exp+=i,this.selectCardDataList[0].exp>=this.expNeed&&(this.selectCardDataList[0].hp=this.nextData.hp,this.selectCardDataList[0].curHp=this.nextData.hp,this.selectCardDataList[0].atk=this.nextData.atk,this.selectCardDataList[0].star+=1,this.selectCardDataList[0].exp=0,e.event(t.PopTip,["升星成功",this.selectCardDataList[0].star])),this.setUpStarCard(this.selectCardDataList[0]),this.selectCardDataList[0].star<13?this.cardBag.initMonsterList(this.compareFn.bind(this)):this.cardBag.initMonsterList(),B.instance.onDataChange("cardList"),this.refreshSelectCardList()}))}}quickSelectCard(){if(this.cardBag.monsterList.array.length>0){this.clearSelectList(),this.refreshSelectCardList(),this.updateCanSelectLevelList(),this.cardBag.initMonsterList(this.compareFn.bind(this));let t=0;for(let e=0;e<this.cardBag.monsterList.array.length;e++)for(let i=0;i<this.cardBag.monsterList.array[e].length;i++){let s=this.cardBag.monsterList.array[e][i];if(!s.canSelect)return void this.onChangeSelectCardList(!1,!1);if(this.canSelectFunc(s)&&(this.changeSelectList([s],s,t+1),this.updateCanSelectLevelList(),3==(t+=1)))return void this.onChangeSelectCardList(!1,!1)}this.onChangeSelectCardList(!1,!1)}}refreshSelectCardList(){let t=[this.cardMain,this.card1,this.card2,this.card3];for(let e=0;e<this.selectCardDataList.length;e++){let i=this.selectCardDataList[e];i?(t[e].visible=!0,t[e].dataSource=i):t[e].visible=!1}}clearSelect(t){this.cloneCard.visible=!1,t&&(this.selectCard.visible=!0),this.selectCard=null,this.selectFrom=0,this.posType=0,this.downPoint.x=0,this.downPoint.y=0}updateBeforeAfterInfo(){let t=this.selectCardDataList[0],e=t.hp,i=t.atk;this.beforeHpLabel.text=e+"",this.beforeAtkLabel.text=i+"",this.afterHpLabel.text=this.nextData.hp+"",this.afterAtkLabel.text=this.nextData.atk+"",this.setStarInfo(t.star,this.beforeStarImage,this.beforeStarLabel),this.setStarInfo(t.star+1,this.afterStarImage,this.afterStarLabel)}setStarInfo(t,e,i){t<=10?(i.text=t+"",e.skin="newSystem/Ui_StarYellow.png"):(i.text=t-10+"",e.skin="newSystem/Ui_StarPurple.png")}setProgress(t,e,i,s=!1,a=null){let n=this.progressMask1;t==this.progressBar2&&(n=this.progressMask2),s?Laya.Tween.to(n,{x:(i-1)*e},200,Laya.Ease.sineOut,a,0,!0):n.x=(i-1)*e}allowOperate(){if(1==this.selectFrom)return!this.selectCardDataList[0]||2!=this.posType;{let t=this.selectFrom-2,e=this.posType-2;return!(0==e&&t>=1&&t<=3||0==t&&e>=1&&e<=3)}}compareFn(t,e){let i=t.star,s=e.star;return this.selectCardDataList[0].exp>=this.expNeed&&2==this.upgradeCondition&&(i=t.monsterId,s=e.monsterId),-1!=this.canSelectList.indexOf(i)&&-1==this.canSelectList.indexOf(s)?-1:-1==this.canSelectList.indexOf(i)&&-1!=this.canSelectList.indexOf(s)?1:0}canSelectFunc(t){if(this.canSelectList){let e=t.star;return this.selectCardDataList[0].exp>=this.expNeed&&2==this.upgradeCondition&&(e=t.monsterId),!(!this.isAllowAsUpStarCostCard(t)||-1==this.canSelectList.indexOf(e))}return!0}updateCanSelectLevelList(){if(this.initCanSelectLevelList(),this.selectCardDataList[0].exp>=this.expNeed)for(let t=0;t<this.selectCardDataList.length;t++){let e=this.selectCardDataList[t+1];if(1==this.upgradeCondition){if(e){let t=this.canSelectList.indexOf(e.star);-1!=t&&this.canSelectList.splice(t,1)}}else if(e&&e.cardId>0){let t=this.canSelectList.indexOf(e.monsterId);-1!=t&&this.canSelectList.splice(t,1)}}}initCanSelectLevelList(){if(this.selectCardDataList[0].exp>=this.expNeed)this.canSelectList=[...this.upgradeParam];else{this.canSelectList=[];let t=1;t=t>1?t:1;let e=this.selectCardDataList[0].star;for(let i=t;i<=e;i++)this.canSelectList.push(i)}}selectFull(){return!(!this.canSelectList||0!=this.canSelectList.length)}allowSelect(t){return!(t>0&&this.selectCardDataList[0].exp>=this.expNeed&&2==this.upgradeCondition)}updateProgressBar(t,e,i=null){if(!this.selectCardDataList[0])return;let s=(this.selectCardDataList[0].exp+e)/this.expNeed;return this.setProgress(t,297,s,!0,i),s}updateExpAdd(){if(this.expAdd=0,this.selectCardDataList[0]&&this.selectCardDataList[0].exp<this.expNeed)for(let t=0;t<3;t++){let e=this.selectCardDataList[t+1];if(e){let t=C.Instance.upgradeConfig[e.star-1].expGain;this.expAdd+=t}}}getExpAdd(){let t=this.selectCardDataList[0].exp+this.expAdd;return(t=t>this.expNeed?this.expNeed:t)-this.selectCardDataList[0].exp}onChangeSelectCardList(t,e){if(t&&this.setUpStarCard(this.selectCardDataList[0]),e&&this.clearSelect(!1),this.refreshSelectCardList(),this.selectCardDataList[0]){if(this.updateCanSelectLevelList(),this.cardBag.initMonsterList(this.compareFn.bind(this)),this.selectCardDataList[0].exp<this.expNeed){this.updateExpAdd();let t=this.getExpAdd();this.expOverFlow=this.selectCardDataList[0].exp+this.expAdd-this.expNeed,this.updateProgressBar(this.progressBar2,t)}}else this.cardBag.initMonsterList();this.updateUpgradeCost()}addStarCard(t,e){for(const i in C.Instance.monsterData)if(!C.Instance.isMaterial(i)&&C.Instance.monsterData[i].level==t){for(let t=0;t<e;t++)B.instance.addCard(Number(i),!1,1);return}}onSelect(){this.visible=!0,C.Instance.isPause=!0,e.event(t.PlayerStopMove)}offSelect(){this.selectCardDataList[0]&&(this.changeSelectList([this.selectCardDataList[0]],!1,0),this.onChangeSelectCardList(!0,!1)),this.visible=!1,C.Instance.isPause=!1}showStarTip(t){t?this.selectCardDataList[0].exp>=this.expNeed?this.starTip.visible=!1:this.starTip.visible=!0:this.starTip.visible=!1}isAllowAsUpStarCostCard(t){return!C.Instance.isSuperEva(t)&&!C.Instance.isTryCard(t)}initChipPoint(){this.chipUi.visible=!0;let t=this.chipUi;t.setMoneyType("chip",!1),t.moneyIcon.localToGlobal(t.moneyPoint,!1,this)}setBtnVideoTag(){let t=1==w.Instance.videoMode;for(let e=0;e<this.stateList.length;e++){this.stateList.getCell(e).getChildByName("videoTag").visible=t}}}class te extends i.pages.mainUI{constructor(){super(...arguments),this.choosePage=null,this.blackMask=null,this.moneyPoint={gold:new Laya.Point,sun:new Laya.Point},this.isLoadSpineComplete=!1,this.btnBoxScaleConfig={3:1,4:.77,5:.62}}onAwake(){e.on(B.UserDataChange,this,this.onUserDataChange),e.on(t.StartGame,this,this.onStartGame),e.on(W.OnSelectPage,this,this.onSelectPage),e.on(t.GotoScene,this,this.gotoScene),e.on(t.BacktoScene,this,this.backtoScene),e.on(t.PopTip,this,this.popTip),e.on(t.ClickMainBtn,this,this.onClickMainBtn),e.on(t.ChooseOneFinish,this,this.onChooseOneFinish),e.on(t.ShowCount,this,this.onShowCount),e.on(t.ShowBlackMask,this,this.onShowBlackMask),e.on(t.UpdateBg,this,this.onUpdateBg),e.on(t.ShowComposeEffect,this,this.onShowComposeEffect),e.on(t.UpdateComposeRed,this,this.onUpdateComposeRed),e.on(t.ShowHandBook,this,this.onShowHandBookPage),e.on(t.ShowSpriteShop,this,this.onShowSpriteShopPage),e.on(t.GotoCatch,this,this.onGotoCatch),e.on(t.ShowCustomAd,this,this.onShowCustomAd),e.on(t.VideoAdClosed,this,this.onVideoAdClose),e.on(t.JumpToPage,this,this.onJumpToPage),e.on(I.InnerTaskStart,this,this.onInnerTaskStart),e.on(I.OutTaskFinish,this,this.onOutTaskFinish),e.on(I.OutTaskStart,this,this.onOutTaskStart),e.on(t.ShowPvpCount,this,this.onShowPvpCount),e.on(t.ShowGoldMoneyUi,this,this.onShowGoldMoneyUi),e.on(t.ShowGiftPack,this,this.onShowGiftPack),P.mask.skin="main/Ui_FrameMonster3.png",p.playMusic("bgm.mp3",0),this.pageBox.mouseThrough=!0,this.catchPage.visible=!1,this.fightRuntime.setVisible(!1),this.searchMapRuntime.setVisible(!1),this.createHandBookPage(),this.createSpriteShopPage(),this.initMoveBg(),this.initPages(),this.updateUnlockSystem(),this.judgeUnlockTower(),this.judgeUnlockUpStar(),this.checkFirstSelect(),this.initBlackMask(),this.initLoadSpine(),this.initComposeSpine(),this.registerOnShow(),this.initMoneyPoint(),this.initFightTicketPoint(),window.MainView=this,I.enable=!0,I.startOutTask("选择初始怪"),I.startOutTask("了解队伍组建"),Laya.timer.once(5e3,this,()=>{this.receiveInvite(),this.receiveShareReward()}),e.event(t.ShowGiftPack),this.setMoneyUiPos()}initBlackMask(){this.blackMask=new Laya.Sprite,this.blackMask.graphics.drawRect(0,0,Laya.stage.width,Laya.stage.height,"#000000"),this.blackMask.alpha=0,this.blackMask.visible=!1,this.blackMaskBox.addChild(this.blackMask)}onChooseOneFinish(){this.downBtnBox.visible=!0,this.pageBox.visible=!0,this.choosePage.destroy(),I.startOutTask("了解队伍组建")}checkFirstSelect(){B.instance.isFirstSelect||(this.choosePage=new G,this.addChild(this.choosePage),this.downBtnBox.visible=!1,this.pageBox.visible=!1)}onClickMainBtn(){this.setIsShowMain(!0),1==B.instance.gameRank&&I.startOutTask("介绍图鉴"),C.Instance.isInSearchMap=!1,this.searchMapRuntime.setVisible(!1),e.event(t.ShowCustomAd,!1)}backtoScene(t){if("search"==t){p.playMusic("search.mp3",0),yt.Instance.closeScene3D("FightScene2");let t=C.Instance.curMapData;C.Instance.isCream?(yt.Instance.openScene3D(`Scene${t.mapIndex+1}_1`,$t,[!1]),this.onEnterOrOutFight(s.Cream,!1)):(yt.Instance.openScene3D(`Scene${t.mapIndex+1}`,qt,[!1]),this.onEnterOrOutFight(s.Normal,!1)),this.popRemind()}else"challenge"!=t&&"pvp"!=t||(yt.Instance.closeScene3D("FightScene"),"challenge"==t?this.onEnterOrOutFight(s.Tower,!1):"pvp"==t&&this.onEnterOrOutFight(s.Pvp,!1),this.bg1.visible=!0,this.popRemind())}popRemind(){let t=0,e=0,i=!1;for(let i=0;i<B.instance.fightCardList.length;i++){let s=B.instance.fightCardList[i];if(s){let i=C.Instance.monsterData[s.monsterId].hp;s.special&&(i+=Math.round(Math.max(5,.1*i))),t+=s.curHp,e+=i}}t<e&&(i=!0),t<.7*e&&L.openScene("pages/videoAddBlood.scene",!1,!0,null,null),i&&I.startOutTask("介绍治疗")}gotoScene(t){"search"==t?(this.showLoadSpine(),C.Instance.updateMapMonsterList(C.Instance.enterMapIndex,C.Instance.isCream),this.loadSceneRes(t).then(()=>{this.setIsShowMain(!1),w.Instance.hideCustomAd("adunit-239e866b6ff05e2f"),C.Instance.isInSearchMap=!0,this.searchMapRuntime.setVisible(!0),p.playMusic("search.mp3",0);let t=C.Instance.lastEnterMapIndex==C.Instance.enterMapIndex,e=C.Instance.lastEnterMapIsCream==C.Instance.isCream;if(!(-1==C.Instance.lastEnterMapIndex||t&&e))if(C.Instance.lastEnterMapIsCream){let t=C.Instance.creamStageConfig[C.Instance.lastEnterMapIndex],e=p.getRes(`Scene${t.mapIndex+1}_1.ls`).getComponent($t);e&&e.destroy()}else{let t=C.Instance.stageConfig[C.Instance.lastEnterMapIndex],e=p.getRes(`Scene${t.mapIndex+1}.ls`).getComponent(qt);e&&e.destroy()}C.Instance.escapeTimeLeft=2,C.Instance.lastEnterMapIndex=C.Instance.enterMapIndex,C.Instance.lastEnterMapIsCream=C.Instance.isCream,C.Instance.isCream?yt.Instance.openScene3D(`Scene${C.Instance.curMapData.mapIndex+1}_1`,$t,[!0]):yt.Instance.openScene3D(`Scene${C.Instance.curMapData.mapIndex+1}`,qt,[!0])})):"fight"==t?(this.judgeAllEmptyBlood(),C.Instance.fightTime++,C.Instance.initMonsterAtkTimeList(),this.blackMask.visible=!0,this.blackMask.alpha=0,Laya.Tween.to(this.blackMask,{alpha:1},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.showLoadSpine(),this.loadSceneRes(t).then(()=>{Laya.Tween.to(this.blackMask,{alpha:0},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.blackMask.visible=!1})),C.Instance.isCream?yt.Instance.closeScene3D(`Scene${C.Instance.enterMapIndex+1}_1`,!1):yt.Instance.closeScene3D(`Scene${C.Instance.enterMapIndex+1}`,!1),C.Instance.isCream?this.onEnterOrOutFight(s.Cream,!0):this.onEnterOrOutFight(s.Normal,!0),yt.Instance.openScene3D("FightScene2",kt),Laya.MouseManager.enabled=!0})}))):"compose"==t?this.downPanel.onBtnClick(0):"eggshop"==t?L.openScene("pages/eggShop.scene",!0,!0,null,null):"challenge"!=t&&"pvp"!=t||(this.judgeAllEmptyBlood(),C.Instance.initMonsterAtkTimeList(),this.blackMask.visible=!0,this.blackMask.alpha=0,Laya.Tween.to(this.blackMask,{alpha:1},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.showLoadSpine(),"challenge"==t&&C.Instance.initChallengeMonsterIdList(),this.loadSceneRes(t).then(()=>{Laya.Tween.to(this.blackMask,{alpha:0},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.blackMask.visible=!1})),"challenge"==t?(this.onEnterOrOutFight(s.Tower,!0),yt.Instance.openScene3D("FightScene",Bt)):"pvp"==t&&(this.onEnterOrOutFight(s.Pvp,!0),yt.Instance.openScene3D("FightScene",Kt)),this.bg1.visible=!1,Laya.MouseManager.enabled=!0})})))}onGotoCatch(t,e){t?(this.showBossCatch(!0),this.catchPage.closeHandler=Laya.Handler.create(this,()=>{this.downPanel.mainPage.stopBossTimeRun(!1),yt.Instance.closeScene3D("FightScene2"),this.showBossCatch(!1)})):(this.fightRuntime.setVisible(!1),this.catchPage.catchProgressBg.y=e),this.catchPage.visible=!0,this.catchPage.initCatchData(t),this.catchPage.setProgress(0),Laya.MouseManager.enabled=!0,I.startOutTask("介绍捕捉")}judgeAllEmptyBlood(){C.Instance.allEmptyBlood=!0;for(let t=0;t<B.instance.fightCardList.length;t++){let e=B.instance.fightCardList[t];if(e&&e.curHp>0){C.Instance.allEmptyBlood=!1;break}}}initLoadSpine(){this.loadSpine.x=Laya.stage.width/2,this.loadSpine.y=Laya.stage.height/2,this.loadSpine.visible=!1,this.loadSpine._complete=Laya.Handler.create(this,()=>{this.loadSpine.stop(),this.isLoadSpineComplete=!0})}initComposeSpine(){this.composeSpine.x=Laya.stage.width/2,this.composeSpine.y=Laya.stage.height/2,this.composeSpine.visible=!1,this.composeSpine._complete=Laya.Handler.create(this,()=>{this.composeSpine.stop(),this.composeSpine.on(Laya.Event.STOPPED,this,this.onComposeFinish)})}onComposeFinish(){this.composeSpine.visible=!1,e.event(t.ComposeEnd),Laya.Tween.to(this.blackMask,{alpha:0},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.blackMask.visible=!1}))}onShowComposeEffect(){this.composeSpine.visible=!0,this.composeSpine.play(0,!1,!0,0),p.playSound("compose.mp3"),this.blackMask.visible=!0,this.blackMask.alpha=0,Laya.Tween.to(this.blackMask,{alpha:1},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{}))}showLoadSpine(){this.isLoadSpineComplete&&(this.loadSpine.visible=!0,this.loadSpine.play(0,!0,!0,0))}loadSceneRes(t){return Laya.MouseManager.enabled=!1,new Promise(e=>{let i;"search"==t?i=te.getGameSceneResList():"fight"==t?i=te.getFightSceneResList():"challenge"==t?i=te.getChallengeSceneResList():"pvp"==t&&(i=te.getPvpSceneResList()),p.create(i).then(()=>{Laya.MouseManager.enabled=!0,this.loadSpine&&(this.loadSpine.stop(),this.loadSpine.visible=!1),e(null)})})}onEnterOrOutFight(t,e){t!=s.Tower&&t!=s.Pvp||e||(C.Instance.isInSearchMap?p.playMusic("search.mp3",0):p.playMusic("bgm.mp3",0)),C.Instance.fightType=e?t:s.None,this.downBtnBox.visible=!e,this.goldMoneyUi.visible=!e,this.diamondMoneyUi.visible=!e,this.fightRuntime.setVisible(e),this.pageBox.visible=!e,t!=s.Normal&&t!=s.Cream||this.searchMapRuntime.setVisible(!e)}onStartGame(){this.gotoScene("search")}onUserDataChange(t){"gold"==t||("fightCardList"==t?this.groupBtn.redPoint.visible=ot.haveRed():"gameRank"==t&&(this.judgeUnlockTower(),this.judgeUnlockUpStar()))}onDestroy(){Laya.timer.clear(this,this.onFrameLoop),e.off(B.UserDataChange,this,this.onUserDataChange),e.off(t.StartGame,this,this.onStartGame),e.off(W.OnSelectPage,this,this.onSelectPage),e.off(t.GotoScene,this,this.gotoScene),e.off(t.BacktoScene,this,this.backtoScene),e.off(t.PopTip,this,this.popTip),e.off(t.ClickMainBtn,this,this.onClickMainBtn),e.off(t.ChooseOneFinish,this,this.onChooseOneFinish),e.off(t.ShowCount,this,this.onShowCount),e.off(t.ShowBlackMask,this,this.onShowBlackMask),e.off(t.UpdateBg,this,this.onUpdateBg),e.off(t.ShowComposeEffect,this,this.onShowComposeEffect),e.off(t.UpdateComposeRed,this,this.onUpdateComposeRed),e.off(t.GotoCatch,this,this.onGotoCatch),e.off(I.InnerTaskStart,this,this.onInnerTaskStart),e.off(I.OutTaskFinish,this,this.onOutTaskFinish),e.off(t.ShowHandBook,this,this.onShowHandBookPage),e.off(t.ShowSpriteShop,this,this.onShowSpriteShopPage),e.off(t.JumpToPage,this,this.onJumpToPage),e.off(t.ShowCustomAd,this,this.onShowCustomAd),e.off(t.VideoAdClosed,this,this.onVideoAdClose),e.off(I.OutTaskStart,this,this.onOutTaskStart),e.off(t.ShowPvpCount,this,this.onShowPvpCount),e.off(t.ShowGoldMoneyUi,this,this.onShowGoldMoneyUi),e.off(t.ShowGiftPack,this,this.onShowGiftPack)}onUpdateComposeRed(t){this.composeBtn.redPoint.visible=t}onUpdateBg(t,e){let i=`mapBg/Ui_Bg${2*t+1}.png`,s=`mapBg/Ui_Bg${2*t+2}.png`;e&&(i="mapBg/Ui_Bg17.png",s="mapBg/Ui_Bg18.png"),this.bg1.skin=i,this.bg1Texture.skin=s}onShowBlackMask(){this.blackMask.visible=!0,this.blackMask.alpha=0,Laya.Tween.to(this.blackMask,{alpha:1},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{Laya.Tween.to(this.blackMask,{alpha:0},500,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.blackMask.visible=!1}))}))}onShowCount(t){t&&(this.fightRuntime.setVisible(!1),L.openScene("pages/count.scene",!1,!0,Laya.Handler.create(this,()=>{this.downBtnBox.visible=!0,this.goldMoneyUi.visible=!0,this.diamondMoneyUi.visible=!0,this.pageBox.visible=!0,C.Instance.fightType==s.Normal||C.Instance.fightType==s.Cream?(yt.Instance.closeScene3D("FightScene2"),this.onClickMainBtn(),C.Instance.lastPos=null,C.Instance.isGotoFightScene=!1):C.Instance.fightType==s.Tower&&(yt.Instance.closeScene3D("FightScene"),this.setIsShowMain(!0))}),null,!1))}onSelectPage(t){C.Instance.isInSearchMap&&(t==this.startPage?(this.bg1.visible=!1,this.searchMapRuntime.setVisible(!0)):(this.bg1.visible=!0,this.searchMapRuntime.setVisible(!1)))}initMoveBg(){Laya.timer.frameLoop(1,this,this.onFrameLoop)}onFrameLoop(){this.bg1.visible&&(this.bg1Texture.x-=1,this.bg1Texture.y-=1,this.bg1Texture.x<=-118&&(this.bg1Texture.x=0,this.bg1Texture.y=0))}initPages(){let t=[{iconSkin:"main/Btn_Compose.png",btn:this.composeBtn,pageClass:H},{iconSkin:"main/Btn_StarUP.png",btn:this.starBtn,pageClass:Jt},{iconSkin:"main/Btn_Team.png",btn:this.groupBtn,pageClass:ot},{iconSkin:"main/Btn_LianMeng.png",btn:this.challengeBtn,pageClass:F},{iconSkin:"main/Btn_PVP.png",btn:this.pkBtn,pageClass:Qt}];this.downPanel.setMainPage(null,this.startPage),this.downPanel.initBtnArr(t),this.downPanel.setBtnScale();for(let e=0;e<t.length;e++){let i=new t[e].pageClass;i.width=Laya.stage.width,i.height=Laya.stage.height,this.pageBox.addChild(i),i.visible=!1,this.downPanel.setPage(e,i),this.downPanel.showBtnRedPoint(e,!1)}this.composeBtn.redPoint.visible=H.haveRed(),this.starBtn.redPoint.visible=Jt.haveRed(),this.groupBtn.redPoint.visible=ot.haveRed(),this.challengeBtn.redPoint.visible=F.haveRed(),this.pkBtn.redPoint.visible=Qt.haveRed(),this.downPanel.pageBox=this.pageBox}updateUnlockSystem(){let t=[],e=[],i=-1,s=["compose","star","group","challenge","pk"];for(let a=0;a<s.length;a++){const n=s[a];let o=this.composeBtn;"star"==n?o=this.starBtn:"group"==n?o=this.groupBtn:"challenge"==n?o=this.challengeBtn:"pk"==n&&(o=this.pkBtn),i++,B.instance.unlockSystem[n]?(o.visible=!0,t.push(o),e.push(i)):o.visible=!1}this.downPanel.unlockBtnList=t;for(let i=0;i<t.length;i++){let t=e[i];this.downPanel.getPage(t).x=Laya.stage.width+Laya.stage.width*i}this.downBtnBox.scaleX=this.downBtnBox.scaleY=this.btnBoxScaleConfig[t.length]}popTip(t,e){let i=new Laya.Image;if(i.anchorX=i.anchorY=.5,"至少上阵一只怪物"==t)i.skin="main/Ui_TeamTips.png";else if("合成不足"==t)i.skin="main/Ui_TeamTips2.png";else if("条件不满足"==t)i.skin="main/Ui_TeamTips3.png";else if("合成成功"==t)i.skin="main/Ui_TeamTips4.png";else if("上阵成功"==t)i.skin="main/Ui_TeamTips5.png";else if("体力恢复"==t)i.skin="main/Ui_WordSuccessCure.png";else if("领取成功"==t)i.skin="main/Ui_TeamTips7.png";else if("收集足够怪"==t)i.skin="main/Ui_TeamTips6.png";else if("通关上一关"==t)i.skin="main/Ui_LockWord.png";else if("请去治疗"==t)i.skin="main/Ui_BloodWord.png";else if("扭蛋冷却中"==t)i.skin="main/Ui_WordCD.png";else if("合成等级超过"==t)i.skin="changeAdd1/Ui_WordComposeFail.png";else if("先通关当前道馆"==t)i.skin="main/Ui_TipsDaoGuan.png";else if("先通关当前精英关卡"==t)i.skin="main/Ui_EliteWord.png";else if("获得经验"==t)i.skin="main/Ui_StarChipword.png";else if("金币不足"==t)i.skin="main/Ui_NoMoney.png";else if("碎片不足"==t)i.skin="main/Ui_NoSuiPian.png";else if("请选择正确的怪"==t)i.skin="main/Ui_SelectMonster.png";else if("究极进化上一级"==t)i.skin="main/Ui_TipsEvolution.png";else if("购买前置礼包"==t)i.skin="main/Ui_TipsFirst.png";else if("升星成功"==t){i.skin="main/Ui_SuccessLvUp.png";let t=new Laya.Label(e+"");t.fontSize=60,t.font="Num1",t.centerX=113,t.centerY=-8,i.addChild(t)}i.width=720,i.height=80,i.x=Laya.stage.width/2,i.y=Laya.stage.height/2,ut.UpDialogRoot.addChild(i),Laya.timer.once(800,this,()=>{Laya.Tween.to(i,{y:Laya.stage.height/2-100,alpha:0},500,Laya.Ease.expoIn,Laya.Handler.create(this,()=>{i.destroy()}))})}static getGameSceneResList(){let t=C.Instance.curMapData,e=["Player1.lh","Picture.lh","Box.lh"];2==t.mapIndex&&e.push("Foot.lh"),C.Instance.isCream?e.push(`Scene${t.mapIndex+1}_1.ls`):e.push(`Scene${t.mapIndex+1}.ls`),e.push(`ScenePoint${t.mapIndex+1}.json`),e.push(`SceneNav${t.mapIndex+1}.json`);for(let t=0;t<C.Instance.mapMonsterIdList.length;t++){let i=C.Instance.mapMonsterIdList[t],s=`Enemy${i[i.length-1]}.lh`;-1==e.indexOf(s)&&e.push(s)}let i=`Enemy${t.bossStat.id}.lh`;e.indexOf(i)&&e.push(i);return e.indexOf("Enemy10.lh")&&e.push("Enemy10.lh"),e}static getFightSceneResList(){let t=["FightScene2.ls","Effect_GetHit.lh"];for(let e=0;e<B.instance.fightCardList.length;e++){let i=B.instance.fightCardList[e];i&&t.push(`Enemy${i.monsterId}.lh`)}for(let e=0;e<C.Instance.enemyMonsterCardList.length;e++){let i=C.Instance.enemyMonsterCardList[e];if(i){let e=`Enemy${i.monsterId}.lh`;-1==t.indexOf(e)&&t.push(e)}}return t}static getChallengeSceneResList(){let t=["FightScene.ls","Effect_GetHit.lh"];for(let e=0;e<B.instance.fightCardList.length;e++){let i=B.instance.fightCardList[e];i&&t.push(`Enemy${i.monsterId}.lh`)}for(let e=0;e<C.Instance.challengeMonsterCardList.length;e++)for(let i=0;i<C.Instance.challengeMonsterCardList[e].length;i++){let s=C.Instance.challengeMonsterCardList[e][i];if(s){let e=`Enemy${s.monsterId}.lh`;-1==t.indexOf(e)&&t.push(e)}}return t}static getPvpSceneResList(){let t=["FightScene.ls","Effect_GetHit.lh"];for(let e=0;e<B.instance.fightCardList.length;e++){let i=B.instance.fightCardList[e];i&&t.push(`Enemy${i.monsterId}.lh`)}for(let e=0;e<C.Instance.pvpMonsterCardList.length;e++){let i=C.Instance.pvpMonsterCardList[e];if(i){let e=`Enemy${i.monsterId}.lh`;-1==t.indexOf(e)&&t.push(e)}}return t}registerOnShow(){"undefined"!=typeof wx&&wx.onShow(()=>{p.playMusic(p.musicName)})}showBossCatch(t){this.downBtnBox.visible=!t,this.goldMoneyUi.visible=!t,this.diamondMoneyUi.visible=!t,this.bg1.visible=!t,this.pageBox.visible=!t}onInnerTaskStart(t){"欢迎语"==t?I.startInnerTask(t):"选择初始怪"==t?I.startInnerTask(t):"点击选择初始怪按钮"==t?(I.hideMask(),I.startInnerTask(t,[{node:this.choosePage.randomBtn,isHandNode:!1},{node:this.choosePage.allBtn,isHandNode:!1}])):"点击队伍组建"==t?I.startInnerTask(t,[{node:this.downPanel.getBtn(2),isHandNode:!0}]):"属性介绍"==t?Laya.timer.once(500,this,()=>{I.startInnerTask(t,[{node:this.downPanel.getPage(2).groupBg,isHandNode:!1}])}):"探险捕获其他"==t?I.startInnerTask(t):"关闭队伍组建"==t?I.startInnerTask(t):"点击关闭队伍组建"==t?I.startInnerTask(t,[{node:this.downPanel.getBtn(2),isHandNode:!0}]):"点击开始挑战按钮"==t?Laya.timer.once(500,this,()=>{I.startInnerTask(t,[{node:this.downPanel.getPage(-1).startBtn,isHandNode:!0}])}):"点击头像战斗"==t?I.startInnerTask(t,[{node:this.fightRuntime.fightCell.monsterList.getCell(0),isHandNode:!0}]):"战胜可捕捉"==t?I.startInnerTask(t):"必杀技使用"==t?I.startInnerTask(t):"捕捉操作"==t?I.startInnerTask(t):"失败鼓励"==t?I.startInnerTask(t):"点击一键上阵"==t?Laya.timer.once(500,this,()=>{I.startInnerTask(t,[{node:this.downPanel.getPage(2).quickUpBtn,isHandNode:!0}])}):"逐个上阵提示"==t?I.startInnerTask(t):"进行高级进化"==t?I.startInnerTask(t):"点击究极进化"==t?Laya.timer.once(500,this,()=>{I.startInnerTask(t,[{node:this.startPage.superEveBtn,isHandNode:!0}])}):"合成超强怪"==t?Laya.timer.once(300,this,()=>{I.startInnerTask(t)}):"通关恭喜"==t?I.startInnerTask(t):"查看图鉴"==t?I.startInnerTask(t):"点击图鉴"==t?I.startInnerTask(t,[{node:this.startPage.handBookBtn,isHandNode:!0}]):"点击关闭图鉴"==t?I.startInnerTask(t,[{node:this.handBookPage.closeBtn,isHandNode:!0}]):"图鉴收集奖励"==t?I.startInnerTask(t):"怪物足够合成"==t?I.startInnerTask(t):"点击怪物合成"==t?I.startInnerTask(t,[{node:this.downPanel.getBtn(0),isHandNode:!0}]):"选择第一只怪"==t?Laya.timer.once(500,this,()=>{let e=this.pickLowestCardCell();I.startInnerTask(t,[{node:e,isHandNode:!0}])}):"选择第二只怪"==t?Laya.timer.once(100,this,()=>{let e=this.pickLowestCardCell();I.startInnerTask(t,[{node:e,isHandNode:!0}])}):"点击合成"==t?I.startInnerTask(t,[{node:this.downPanel.getPage(0).composeBtn,isHandNode:!0}]):"点击关闭合成"==t?I.startInnerTask(t,[{node:this.downPanel.getBtn(0),isHandNode:!0}]):"合成了更强的怪"==t?I.startInnerTask(t):"高级冒险世界获得高级怪"==t?I.startInnerTask(t):"点击扭蛋商店"==t?I.startInnerTask(t,[{node:this.searchMapRuntime.shopBtn,isHandNode:!0}]):"点击免费扭蛋"==t?Laya.timer.once(300,this,()=>{I.startInnerTask(t)}):"Boss提示"==t?I.startInnerTask(t):"去队伍组建"==t&&I.startInnerTask(t)}onOutTaskFinish(i){"介绍图鉴"==i?I.startOutTask("介绍究极进化"):"介绍究极进化"==i?I.startOutTask("介绍一键上阵"):"介绍合成"==i&&e.once(t.ComposeEnd,this,()=>{Laya.timer.once(300,this,()=>{R.isRunNiuDanGuide=!0,I.startOutTask("介绍合成结果")})})}createHandBookPage(){this.handBookPage=new rt,this.handBookPage.width=Laya.stage.width,this.handBookPage.height=Laya.stage.height,this.handBookPage.x=0,this.handBookPage.y=-Laya.stage.height,this.handBookPage.visible=!1,this.addChild(this.handBookPage)}createSpriteShopPage(){this.spriteShopPage=new Zt,this.spriteShopPage.width=Laya.stage.width,this.spriteShopPage.height=Laya.stage.height,this.spriteShopPage.x=0,this.spriteShopPage.y=Laya.stage.height,this.spriteShopPage.visible=!1,this.addChild(this.spriteShopPage)}onShowHandBookPage(t){t?(this.handBookPage.onSelect(),Laya.Tween.to(this.mainBox,{y:Laya.stage.height},200,Laya.Ease.sineOut),this.handBookPage.visible=!0,Laya.Tween.to(this.handBookPage,{y:0},200,Laya.Ease.sineOut)):(this.handBookPage.offSelect(),Laya.Tween.to(this.mainBox,{y:0},200,Laya.Ease.sineOut),Laya.Tween.to(this.handBookPage,{y:-Laya.stage.height},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.handBookPage.visible=!1})))}setIsShowMain(i){this.bg1.visible=i,this.startPage.visible=i,this.downPanel.isShowMain=i,i&&(p.playMusic("bgm.mp3",0),e.event(t.ShowGiftPack))}initMoneyPoint(){let t=this.goldMoneyUi;t.setMoneyType("gold",!0),t.moneyIcon.localToGlobal(t.moneyPoint,!1,this);let e=this.diamondMoneyUi;e.setMoneyType("diamond",!0),e.moneyIcon.localToGlobal(e.moneyPoint,!1,this)}onShowSpriteShopPage(t){t?(this.spriteShopPage.onSelect(),Laya.Tween.to(this.mainBox,{y:-Laya.stage.height},200,Laya.Ease.sineOut),this.spriteShopPage.visible=!0,Laya.Tween.to(this.spriteShopPage,{y:0},200,Laya.Ease.sineOut)):(this.spriteShopPage.offSelect(),Laya.Tween.to(this.mainBox,{y:0},200,Laya.Ease.sineOut),Laya.Tween.to(this.spriteShopPage,{y:Laya.stage.height},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.spriteShopPage.visible=!1})))}onJumpToPage(t){5==t?this.onShowSpriteShopPage(!0):(this.downPanel.onBtnClick(t),3==t&&this.onShowSpriteShopPage(!1))}showCustomAd(t){if("undefined"!=typeof wx)if(t){let t=wx.getSystemInfoSync(),e={left:0,top:0,fixed:!0};e.left=0*t.screenWidth,e.top=(Laya.stage.height/2-200)/1280*t.screenHeight,w.Instance.initSingleCustomAd("adunit-239e866b6ff05e2f",e),w.Instance.showCustomAd("adunit-239e866b6ff05e2f")}else w.Instance.hideCustomAd("adunit-239e866b6ff05e2f")}judgeUnlockTower(){S.dayDiff(B.instance.registerTimestamp,Date.now())>=1&&B.instance.gameRank>=3&&0==B.instance.unlockSystem.challenge&&(B.instance.unlockSystem.challenge=!0,B.instance.onDataChange("unlockSystem"),this.updateUnlockSystem(),L.openScene("pages/helpPack.scene",!1,!0,null,["challenge"]))}judgeUnlockPvp(){S.dayDiff(B.instance.registerTimestamp,Date.now())>=3&&B.instance.gameRank>=5&&0==B.instance.unlockSystem.pk&&(B.instance.unlockSystem.pk=!0,B.instance.onDataChange("unlockSystem"),this.updateUnlockSystem(),L.openScene("pages/helpPack.scene",!1,!0,null,["pvp"]))}initFightTicketPoint(){this.fightTicketUi.visible=!1;let t=this.fightTicketUi;t.setMoneyType("fightTicket",!1),t.moneyIcon.localToGlobal(t.moneyPoint,!1,this)}judgeUnlockUpStar(){B.instance.gameRank>=4?(this.downPanel.setBtnLockState(1,!1),0==B.instance.unlockSystem1.star&&(B.instance.unlockSystem1.star=!0,B.instance.onDataChange("unlockSystem1"),L.openScene("pages/helpPack.scene",!1,!0,null,["star"]))):this.downPanel.setBtnLockState(1,!0)}onShowCustomAd(t){this.showCustomAd(t)}onVideoAdClose(){p.lastMusicName&&p.musicOpen&&p.playMusic(p.lastMusicName)}pickLowestCardCell(){let t=this.downPanel.getPage(0).cardBag,e=1e8,i=-1,s=-1;for(let a=0;a<t.monsterList.array.length;a++)for(let n=0;n<t.monsterList.array[a].length;n++){let o=t.monsterList.array[a][n],r=o.hp+o.atk;r<e&&(i=a,s=n,e=r)}return-1==i&&(i=0),-1==s&&(s=0),t.monsterList.getCell(i).cardList.getCell(s)}onOutTaskStart(t){"介绍合成"==t&&(B.instance.addCard(0,!1,14),B.instance.addCard(1,!1,14))}onShowPvpCount(t){t&&(this.fightRuntime.setVisible(!1),L.openScene("pages/pvpCount.scene",!1,!0,Laya.Handler.create(this,t=>{this.downBtnBox.visible=!0,this.goldMoneyUi.visible=!0,this.diamondMoneyUi.visible=!0,this.pageBox.visible=!0,yt.Instance.closeScene3D("FightScene"),this.setIsShowMain(!0),"yes"==t&&L.openScene("pages/pvpMatch.scene",!1,!0,null,null,!1)}),null,!1))}onShowGoldMoneyUi(t){this.goldMoneyUi.visible=t,this.diamondMoneyUi.visible=t}receiveInvite(){if("undefined"!=typeof wx){let t=wx.getEnterOptionsSync();if(console.log("onShow options",t),t){let e=t.query.shareMessageToFriendScene;if(-1!=this.getShareMonsterSceneList().indexOf(e)){wx.getOpenDataContext().postMessage({type:"reciveInvite",shareMessageToFriendScene:e}),console.log("接受邀请成功")}}}}getShareMonsterSceneList(){let t=[];for(let e=0;e<50;e++)t.push(e+1+"");return t}receiveShareReward(){if("undefined"==typeof wx)return;let t=this.getShareMonsterSceneList();wx.getUserInteractiveStorage({keyList:t,success:t=>{wx.cloud.callFunction({name:"getUserInteractiveStorage",data:{userInteractive:wx.cloud.CloudID(t.cloudID)}}).then(t=>{if(console.log("cloud getUserInteractiveStorage",t),t.result.event.userInteractive.data){let e=t.result.event.userInteractive.data.kv_list,i=this.convertKVListToObj(e),s=this.getShareRewardMonsterId(i,B.instance.shareRewardObj);if(B.instance.shareRewardObj=i,B.instance.onDataChange("shareRewardObj"),-1!=s)if(B.instance.receiveShareRewardTime>=2);else{let t=C.Instance.getOneCardData(s),e=C.Instance.monsterData;L.openScene("pages/catchResult.scene",!1,!0,null,[!0,t.monsterId,e[t.monsterId],!1,3,!1]),B.instance.receiveShareRewardTime++,B.instance.onDataChange("receiveShareRewardTime")}}})}})}convertKVListToObj(t){let e={};if(!t)return e;for(let i=0;i<t.length;i++)e[t[i].key]=Number(t[i].value);return e}getShareRewardMonsterId(t,e){let i=-1;for(const i in t){let s=Number(t[i]),a=0;if(i in e&&(a=Number(e[i])),s>a)return Number(i)-1}return C.Instance.askForCardList[i]||-1}onShowGiftPack(){let t=!1,e=[...C.Instance.goodsItem.newGiftPack];if(0==S.DateDiff(B.instance.registerTimestamp,Date.now()))for(let i=0;i<3;i++){let s=e[i];if(0==C.Instance.getGiftPackBuyTime(s.productId)){t=!0;break}}else{let i=!1;for(let t=0;t<e.length;t++){let s=e[t];if(C.Instance.getGiftPackBuyTime(s.productId)>0){i=!0;break}}i||(t=!0)}t&&0==I.isOpen&&L.openScene("pages/giftPackPage.scene",!1,!0,null,null)}setMoneyUiPos(){let t=0;if("undefined"!=typeof wx){t=wx.getSystemInfoSync().safeArea.top}else t=37;this.diamondMoneyUi.y=t+20,this.goldMoneyUi.y=t+20}}class ee extends i.pages.signUI{constructor(){super(...arguments),this.signconfig=[{reward:"金币",num:100},{reward:"卡片",num:128},{reward:"金币",num:300},{reward:"金币",num:400},{reward:"金币",num:500},{reward:"金币",num:600},{reward:"卡片",num:126}]}onAwake(){this.cellList=[this.cell1,this.cell2,this.cell3,this.cell4,this.cell5,this.cell6,this.cell7];for(let t=0;t<this.cellList.length;t++)this.cellList[t].on(Laya.Event.CLICK,this,this.onBtnClick);this.updateSignReward(),this.updateSignCellState(),this.setBtnVideoTag()}onBtnClick(t){if(t.target==this.closeBtn)this.close();else if(t.target==this.videoReceiveBtn){let t=B.instance.signDay;1==B.instance.signRec[t]||w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{this.receiveReward(t,!0)})}else{let e=this.cellList.indexOf(t.target);e<B.instance.signDay||(e==B.instance.signDay?1==B.instance.signRec[e]||this.receiveReward(e,!1):B.instance.signDay)}}onOpened(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.videoReceiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),w.Instance.showBannerAd()}onClosed(){w.Instance.hideBannerAd()}updateSignCellState(){for(let t=0;t<7;t++)t<B.instance.signDay?this.setDayState(t,2):t==B.instance.signDay?1==B.instance.signRec[t]?this.setDayState(t,2):this.setDayState(t,1):t>B.instance.signDay&&this.setDayState(t,0);let t=B.instance.signDay;1==B.instance.signRec[t]?this.videoReceiveBtn.visible=!1:this.videoReceiveBtn.visible=!0}updateSignReward(){for(let t=0;t<7;t++)this.setDayReward(t)}setDayState(t,e){let i=this.cellList[t];2==e?(i.maskImage.visible=!0,i.redPoint.visible=!1):1==e?(i.maskImage.visible=!1,i.redPoint.visible=!0,i.ani1.play(0,!0)):0==e&&(i.maskImage.visible=!1,i.redPoint.visible=!1)}setDayReward(t){let e=this.cellList[t],i=this.signconfig[t];if(e.dayImage.skin=`sign/Ui_Day${t+1}.png`,"金币"==i.reward)e.rewardImage.skin="count/Ui_TwoGold.png",e.rewardImage.scaleX=e.rewardImage.scaleY=1,e.goldLabel.text="X"+i.num,e.monsterInfoBg.visible=!1;else if("卡片"==i.reward){e.starNumLabel.filters=[x.blackColorFilter],e.hpLabel.filters=[x.blackColorFilter],e.atkLabel.filters=[x.blackColorFilter],e.goldLabel.text="X1",e.rewardImage.scaleX=e.rewardImage.scaleY=.5,e.rewardImage.skin=`monster/Ui_Monster${i.num}.png`,e.monsterInfoBg.visible=!0;let t=C.Instance.getOneCardData(i.num);e.starNumLabel.text=t.star+"",e.hpLabel.text=t.hp+"",e.atkLabel.text=t.atk+""}}static haveRed(){return 0==B.instance.signRec[B.instance.signDay]}receiveReward(t,e){let i=this.signconfig[t];if("金币"==i.reward)e&&(i.num*=2),L.openScene("pages/getCard.scene",!1,!0,null,[1,i.num,5]);else if("卡片"==i.reward){let t=C.Instance.getMonsterData([i.num]),s=[!0,i.num,t[0],!1,3];L.openScene("pages/catchResult.scene",!1,!0,Laya.Handler.create(this,()=>{e&&L.openScene("pages/catchResult.scene",!1,!0,null,s)}),s)}B.instance.signRec[B.instance.signDay]=1,B.instance.signTimestamp=Date.now(),B.instance.onDataChange("signRec"),B.instance.onDataChange("signTimestamp"),this.updateSignCellState()}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class ie extends i.pages.taskUI{constructor(){super(...arguments),this.taskType=0}onAwake(){this.taskList.vScrollBarSkin=null,this.showTask(0),this.dayRed.visible=ie.dayHaveRed(),this.achieveRed.visible=ie.achieveHaveRed(),e.on(t.UpdateTask,this,this.onUpdateTask)}onDestroy(){e.off(t.UpdateTask,this,this.onUpdateTask)}onUpdateTask(){this.showTask(this.taskType),this.dayRed.visible=ie.dayHaveRed(),this.achieveRed.visible=ie.achieveHaveRed()}onOpened(){this.achieveTaskBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.dayTaskBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),w.Instance.showBannerAd()}onClosed(){w.Instance.hideBannerAd()}onBtnClick(t){t.target==this.closeBtn?this.close():this.achieveTaskBtn==t.target?this.showTask(1):this.dayTaskBtn==t.target&&this.showTask(0)}showTask(t){this.taskType=t,this.dayIcon.skin=0==t?"sign/Btn_Task4.png":"sign/Btn_Task3.png",this.acheiveIcon.skin=1==t?"sign/Btn_Task6.png":"sign/Btn_Task5.png";let e=[];if(0==t)for(let t=0;t<ie.taskConfig1.length;t++){let i=ie.taskConfig1[t],s={rewardNum:i.reward,taskDesc:i.desc.replace("*",i.num+""),taskType:0,index:t,num:i.num};e.push(s)}else if(1==t)for(let t=0;t<ie.taskConfig2.length;t++){let i=ie.taskConfig2[t],s=B.instance.achieveTaskStage[t],a=i.reward[s],n=i.num[s],o={rewardNum:a,taskDesc:i.desc.replace("*",n+""),taskType:1,index:t,num:n};e.push(o)}this.taskList.array=e,this.taskList.refresh()}static dayHaveRed(){for(let t=0;t<ie.taskConfig1.length;t++){let e=ie.taskConfig1[t];if(B.instance.dayTaskCountRec[t]>=e.num){if(!B.instance.dayTaskReceiveRec[t])return!0}}return!1}static achieveHaveRed(){for(let t=0;t<ie.taskConfig2.length;t++){let e=ie.taskConfig2[t],i=B.instance.achieveTaskStage[t],s=(e.reward[i],e.num[i]);if(B.instance.achieveTaskCountRec[t]>=s){if(!B.instance.achieveTaskReceiveRec[t])return!0}}return!1}static haveRed(){return this.dayHaveRed()||this.achieveHaveRed()}}ie.taskConfig1=[{id:1,desc:"收集*只妖怪",num:10,reward:150},{id:2,desc:"通过*个世界关卡",num:2,reward:150},{id:3,desc:"合成*次",num:5,reward:150}],ie.taskConfig2=[{id:4,desc:"集齐*只怪物",num:[20,40,60,100,126],reward:[100,200,300,400,500]},{id:5,desc:"通过*局战斗",num:[5,10,20,50,100],reward:[200,240,340,460,500]},{id:6,desc:"治疗*次",num:[10,50,100,150,200],reward:[200,240,340,460,500]},{id:7,desc:"消灭*只怪物",num:[10,50,100,150,200],reward:[200,240,340,460,500]},{id:8,desc:"获得*拼图",num:[100,300,500,1e3,2e3],reward:[200,240,340,460,500]}];class se extends i.pages.startUI{constructor(){super(...arguments),this.curMapIndex=0,this.curCreamMapIndex=0,this.maxMap=0,this.isUpTrigger=!1,this.panelDownX=0,this.mapConfigData=null,this.niuDanTimeLimit=0,this.catchBossTimeLimit=0,this.catchBossActivityTime=120,this.curTabIndex=-1,this.curCreamTabIndex=-1,this.selectCardDataList=[null,null,null],this.selectCard=null,this.cloneCard=null,this.posType=0,this.selectFrom=0,this.stopClick=!1,this.isMove=!1,this.downPoint=new Laya.Point,this.isShowMapBox=!0,this.lightPosList=[{x:111,y:136},{x:67,y:218},{x:152,y:218}]}onAwake(){this.judgeShowSuperEvaBtn(),this.width=Laya.stage.width,this.height=Laya.stage.height,this.mapList.hScrollBarSkin=null,this.mapList.scrollBar.rollRatio=0,this.mapMonsterList.hScrollBarSkin=null,this.mapMonsterList.elasticEnabled=!0,this.mapMonsterList.mouseHandler=Laya.Handler.create(this,this.onMapMonsterListMouseEvent,null,!1),this.mapList.on(Laya.Event.MOUSE_UP,this,this.onPanelEvent),this.mapList.on(Laya.Event.MOUSE_OUT,this,this.onPanelEvent),this.mapList.on(Laya.Event.MOUSE_DOWN,this,this.onPanelEvent),this.settingBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.leftBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.rightBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.superEveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.startBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.shopBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.signBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.lotteryBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.tryGameBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.taskBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.catchBossBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.handBookBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.spriteShopBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.sendBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.switchEliteBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.switchNormalBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.quickSelectBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.giftPackBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.mapTabBtn.on(Laya.Event.CLICK,this,this.onCreamTabClick,[0]),this.wipeBtn.on(Laya.Event.CLICK,this,this.onCreamTabClick,[1]),this.initMapList(),this.curMapIndex=this.getLastMapIndex(!1),this.curCreamMapIndex=this.getLastMapIndex(!0),this.tweenList(this.curMapIndex,!1),this.initRed(),this.updateNiuDanTimeStamp(),this.updateExpeditionLeftTime(),this.updateCatchBossTimeStamp(),e.on(t.SelectCard,this,this.onSelectPageCard),this.cardBag.visible=!1,this.cardBag.isShowStoreEgg=!1,this.cardBag.exceptFunc=this.exceptFunc.bind(this),this.cardBag.initMonsterList(),this.on(Laya.Event.MOUSE_MOVE,this,this.onStartPageEvent),this.on(Laya.Event.MOUSE_UP,this,this.onStartPageEvent),this.cardBag.monsterList.on(Laya.Event.MOUSE_OUT,this,this.onCardBagEvent),this.cardBag.monsterList.on(Laya.Event.MOUSE_OVER,this,this.onCardBagEvent);let i=[this.cardBox1,this.cardBox2,this.cardBox3];for(let t=0;t<i.length;t++){let e=i[t];e.on(Laya.Event.MOUSE_OUT,this,this.onCardBoxEvent),e.on(Laya.Event.MOUSE_OVER,this,this.onCardBoxEvent),e.on(Laya.Event.CLICK,this,this.onCardBoxEvent),e.on(Laya.Event.MOUSE_DOWN,this,this.onCardBoxEvent)}this.cloneCard=new P,this.addChild(this.cloneCard),this.cloneCard.visible=!1,this.refreshSelectCardList(),this.cardBag.monsterList.name="startMonsterList",this.judgeUnlockSpriteShop(),e.on(B.UserDataChange,this,this.onUserDataChange),e.on(t.UpdateSuperRed,this,this.onUpdateSuperRed),this.forcePopSign()}judgeShowSuperEvaBtn(){B.instance.gameRank>=C.Instance.openSuperEvaRank?this.superEveBtn.visible=!0:this.superEveBtn.visible=!1}updateCatchBossTimeStamp(){Laya.timer.clear(this,this.onCatchBossTimeLoop),this.catchBossTimeLimit=1e3*this.catchBossActivityTime-(Date.now()-B.instance.catchBossRec.timestamp),this.catchBossTimeLimit>0?(this.catchBossBtnShake.play(0,!0),this.catchBossBtn.visible=!0,this.catchBossTimeLabel.text=S.dateFormat("MM:SS",new Date(this.catchBossTimeLimit)),Laya.timer.loop(1e3,this,this.onCatchBossTimeLoop)):(this.catchBossBtn.visible=!1,this.catchBossBtnShake.stop())}onCatchBossTimeLoop(){this.catchBossTimeLimit-=1e3,this.catchBossTimeLimit<=0&&(this.catchBossTimeLimit=0,this.catchBossBtn.visible=!1,this.catchBossBtnShake.stop(),Laya.timer.clear(this,this.onCatchBossTimeLoop)),this.catchBossTimeLabel.text=S.dateFormat("MM:SS",new Date(this.catchBossTimeLimit))}updateNiuDanTimeStamp(){if(Laya.timer.clear(this,this.onNiuDanTimeLoop),B.instance.niuDanLeftTime>0){let t=600;2==B.instance.niuDanLeftTime?t=300:3==B.instance.niuDanLeftTime?t=180:4==B.instance.niuDanLeftTime&&(t=0),this.niuDanTimeLimit=1e3*t-(Date.now()-B.instance.niuDanTimestamp),this.niuDanTimeLimit=this.niuDanTimeLimit>0?this.niuDanTimeLimit:0,this.niuDanTimeLimit>0?(this.shopRed.visible=!1,this.timeLabel.visible=!0,this.timeLabel.text=S.dateFormat("MM:SS",new Date(this.niuDanTimeLimit)),Laya.timer.loop(1e3,this,this.onNiuDanTimeLoop)):(this.timeLabel.visible=!1,this.shopRed.visible=!0)}else this.shopRed.visible=!1,this.timeLabel.visible=!1}onNiuDanTimeLoop(){this.niuDanTimeLimit-=1e3,this.niuDanTimeLimit<=0&&(this.niuDanTimeLimit=0,this.timeLabel.visible=!1,B.instance.niuDanLeftTime>0?this.shopRed.visible=!0:this.shopRed.visible=!1,Laya.timer.clear(this,this.onNiuDanTimeLoop)),this.timeLabel.text=S.dateFormat("MM:SS",new Date(this.niuDanTimeLimit))}initRed(){this.signRed.visible=ee.haveRed(),this.lotteryRed.visible=gt.haveRed(),this.taskRed.visible=ie.haveRed(),this.superEveRed.visible=k.haveRed(),this.handBookRed.visible=rt.haveRed(),this.shopBtnRed.visible=Zt.haveRed()}onDestroy(){e.off(B.UserDataChange,this,this.onUserDataChange),e.off(t.UpdateSuperRed,this,this.onUpdateSuperRed),e.off(t.SelectCard,this,this.onSelectPageCard)}onBtnClick(i){if(i.target==this.settingBtn)L.openScene("pages/setting.scene",!0,!0,null,null);else if(i.target==this.leftBtn)this.changeMapIndex(-1,1==this.curTabIndex);else if(i.target==this.rightBtn)this.changeMapIndex(1,1==this.curTabIndex);else if(i.target==this.superEveBtn)I.finishInnerTask("点击究极进化"),L.openScene("pages/superEva.scene",!1,!0,null,null);else if(i.target==this.startBtn)this.startGame();else if(i.target==this.shopBtn)L.openScene("pages/eggShop.scene",!1,!0,null,null);else if(i.target==this.signBtn)L.openScene("pages/sign.scene",!0,!0,null,null);else if(i.target==this.lotteryBtn)L.openScene("pages/lottery.scene",!0,!0,null,null);else if(i.target==this.taskBtn)L.openScene("pages/task.scene",!0,!0,null,null);else if(i.target==this.catchBossBtn)this.gotoCatchScene();else if(i.target==this.handBookBtn)e.event(t.ShowHandBook,!0);else if(i.target==this.spriteShopBtn)e.event(t.ShowSpriteShop,!0);else if(i.target==this.giftPackBtn)L.openScene("pages/giftPackPage.scene",!1,!0,null,null);else if(i.target==this.sendBtn){if(0==B.instance.expeditionTimeLeftList[this.curCreamMapIndex])return;B.instance.expeditionTimeLeftList[this.curCreamMapIndex]-=1,B.instance.onDataChange("expeditionTimeLeftList");let t=[];for(let e=0;e<this.selectCardDataList.length;e++){let i=this.selectCardDataList[e];i&&t.push(i)}if(0==t.length)return;w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{this.startExpedition(t)})}else if(i.target==this.switchEliteBtn){let t=this.getLastMapIndex(!0);this.curCreamMapIndex>t&&(this.curCreamMapIndex=t),this.tweenList(this.curCreamMapIndex,!0)}else if(i.target==this.switchNormalBtn){let t=this.getLastMapIndex(!1);this.curMapIndex>t&&(this.curMapIndex=t),this.tweenList(this.curMapIndex,!1)}else i.target==this.quickSelectBtn?(this.showMapBox(!1),this.quickSelect()):i.target==this.tryGameBtn&&L.openScene("pages/tryGamePage.scene",!0,!0,null,null)}startGame(){let i=0;for(let t=0;t<B.instance.fightCardList.length;t++)B.instance.fightCardList[t]&&i++;if(0==i)e.event(t.PopTip,"至少上阵一只怪物");else{(se.isElite?this.curCreamMapIndex:this.curMapIndex)<=(se.isElite?B.instance.eliteGameRank:B.instance.gameRank)?(I.finishInnerTask("点击开始挑战按钮"),Laya.MouseManager.enabled=!1,e.event(t.StartGame)):e.event(t.PopTip,"通关上一关")}}setMapHardLevel(t){let e=[];for(let i=0;i<t;i++)e.push({hardIcon:{skin:`main/Ui_GuanLv${i+1}.png`}});this.hardIconList.array=e,this.hardIconList.refresh()}initMapList(){let t=[],e=0;for(const i in C.Instance.stageConfig){let s=C.Instance.stageConfig[i];t.push({level:s.level,index:s.mapIndex,listIndex:e}),e++}this.maxMap=t.length,this.mapList.array=t,this.mapList.refresh()}onPanelEvent(t){if(t.type==Laya.Event.MOUSE_DOWN)this.panelDownX=t.stageX;else{if(t.type==Laya.Event.MOUSE_UP&&(this.isUpTrigger=!0),t.type==Laya.Event.MOUSE_OUT&&this.isUpTrigger)return void(this.isUpTrigger=!1);let e=this.panelDownX-t.stageX;if(Math.abs(e)<200)0!=Math.abs(e)&&(se.isElite?this.tweenList(this.curCreamMapIndex,!0):this.tweenList(this.curMapIndex,!1));else if(se.isElite){let t=this.curCreamMapIndex+Math.sign(e);t>=0&&t<this.mapList.length&&this.tweenList(t,!0)}else{let t=this.curMapIndex+Math.sign(e);t>=0&&t<this.mapList.length&&this.tweenList(t,!1)}}}tweenList(t,e){if(-1==t)return;e?(this.curCreamMapIndex=t,this.updateArrow(this.curCreamMapIndex)):(this.curMapIndex=t,this.updateArrow(this.curMapIndex)),this.setMapData(e);let i=720*t;Laya.Tween.to(this.mapList.scrollBar,{value:i},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.mapList.scrollBar.stopScroll()}),0,!0)}setMapData(t){let e=t?this.curCreamMapIndex:this.curMapIndex;this.mapIndexLabel.text=e+1+"",this.mapConfigData=t?C.Instance.creamStageConfig[e]:C.Instance.stageConfig[e],C.Instance.enterMapIndex=e,this.mapName.skin=`main/Ui_GuanTittle${this.mapConfigData.mapIndex+1}.png`,this.setMapHardLevel(this.mapConfigData.level),this.setMonsterList(),this.curTabIndex=-1,this.curCreamTabIndex=-1,this.enableElite(t),this.updateSwitchBtnState(t)}setMonsterList(){let t,e=[];(t=[...this.mapConfigData.list]).push(this.mapConfigData.bossStat.id);for(let i=0;i<t.length;i++){let s=t[i];if("number"==typeof s&&s>=0){let t=C.Instance.getOneCardData(s);e.push(t)}}e.sort((t,e)=>t.monsterId-e.monsterId),this.mapMonsterList.array=e,this.mapMonsterList.refresh();let i=0;for(let t=0;t<e.length;t++)-1!=B.instance.collectMonsterIdList.indexOf(e[t].monsterId)&&i++;this.collectLabel.text=`${i}/${e.length}`}onUserDataChange(t){if("collectMonsterIdList"==t)this.setMonsterList();else if("gameRank"==t){if(this.judgeShowSuperEvaBtn(),this.judgeUnlockElite(),this.judgeUnlockSpriteShop(),!se.isElite){let t=this.getLastMapIndex(!1);this.tweenList(t,!1)}}else if("signRec"==t)this.signRed.visible=ee.haveRed();else if("freeLotteryTimeLeft"==t)this.lotteryRed.visible=gt.haveRed();else if("achieveTaskReceiveRec"==t||"achieveTaskCountRec"==t||"achieveTaskStage"==t||"achieveTaskReceiveRec"==t||"dayTaskReceiveRec"==t||"dayTaskCountRec"==t)this.taskRed.visible=ie.haveRed();else if("niuDanTimestamp"==t)this.updateNiuDanTimeStamp();else if("catchBossRec"==t)this.updateCatchBossTimeStamp();else if("cardList"==t)this.superEveRed.visible=k.haveRed();else if("collectReceived"==t||"collectStage"==t||"collectMonsterIdList"==t)this.handBookRed.visible=rt.haveRed();else if("eliteRank"==t){if(se.isElite){let t=this.getLastMapIndex(!0);this.tweenList(t,!0)}}else"shopBuyRecord"==t&&(this.shopBtnRed.visible=Zt.haveRed())}updateArrow(t){this.maxMap<=1?(this.leftBtn.alpha=.5,this.rightBtn.alpha=.5):0==t?(this.leftBtn.alpha=.5,this.rightBtn.alpha=1):t==this.maxMap-1?(this.rightBtn.alpha=.5,this.leftBtn.alpha=1):(this.leftBtn.alpha=1,this.rightBtn.alpha=1)}onUpdateSuperRed(){this.superEveRed.visible=k.haveRed()}gotoCatchScene(){this.stopBossTimeRun(!0),C.Instance.catchMonsterId=B.instance.catchBossRec.bossId,C.Instance.catchMonsterData=C.Instance.monsterData[C.Instance.catchMonsterId],C.Instance.isCatch=!1,yt.Instance.openScene3D("FightScene2",xt,[!0])}stopBossTimeRun(t){0!=this.catchBossTimeLimit&&(t?Laya.timer.clear(this,this.onCatchBossTimeLoop):Laya.timer.loop(1e3,this,this.onCatchBossTimeLoop))}onTabClick(i,s){i!=this.curTabIndex&&(this.curTabIndex=i,0==i?(this.mapInfoBg.skin="main/Ui_FrameGuan.png",this.infoBox1.visible=!0,this.hardBox.visible=!0,this.infoBox2.visible=!1,this.expeditionTimeLeftLabel.visible=!1,this.wipeBtn.visible=!1,this.showMapBox(!0),this.setMonsterList(),this.setMapHardLevel(this.mapConfigData.level),this.rewardBg.visible=!0,this.setRewardList(!1),this.clearSelectExpeditionCardList(),C.Instance.initGameSceneConfig(!1),Laya.timer.frameOnce(1,this,()=>{e.event(t.UpdateBg,[this.mapConfigData.mapIndex,!1])})):1==i&&(this.wipeBtn.visible=!0,this.curCreamTabIndex=-1,this.onCreamTabClick(0,null),C.Instance.initGameSceneConfig(!0),Laya.timer.frameOnce(1,this,()=>{e.event(t.UpdateBg,[this.mapConfigData.mapIndex,!0])})))}onCreamTabClick(i,s){if(1==i&&(B.instance.eliteGameRank<C.Instance.creamStageMaxIndex&&B.instance.eliteGameRank<=this.curCreamMapIndex||B.instance.eliteGameRank==C.Instance.creamStageMaxIndex&&B.instance.eliteGameRank==this.curCreamMapIndex&&!B.instance.eliteGameAllPass))e.event(t.PopTip,"先通关当前精英关卡");else if(1==this.curTabIndex&&i!=this.curCreamTabIndex)if(this.curCreamTabIndex=i,0==this.curCreamTabIndex)this.mapInfoBg.skin="newSystem/Ui_FrameGuan6.png",this.infoBox1.visible=!0,this.hardBox.visible=!0,this.infoBox2.visible=!1,this.expeditionTimeLeftLabel.visible=!1,this.setMonsterList(),this.setMapHardLevel(this.mapConfigData.level),this.rewardBg.visible=!0,this.setRewardList(!0),this.showMapBox(!0);else if(1==this.curCreamTabIndex){B.instance.refreshExpeditionData(),this.receiveExpeditionReward(),this.infoBox1.visible=!1,B.instance.expedition[this.curCreamMapIndex]>0?(this.hardBox.visible=!1,this.mapInfoBg.skin="newSystem/Ui_SaoDangPic.png",this.infoBox2.visible=!1,this.expeditionTimeLeftLabel.visible=!0):(this.hardBox.visible=!0,this.mapInfoBg.skin="newSystem/Ui_FrameGuan2.png",this.infoBox2.visible=!0,this.expeditionTimeLeftLabel.visible=!1,this.refreshExpeditionTimeLeft(),this.selectCardDataList=B.instance.expeditionCardList[this.curCreamMapIndex],this.refreshSelectCardList(),this.showLight()),this.rewardBg.visible=!1}}refreshSelectCardList(){let t=[this.card1,this.card2,this.card3];for(let e=0;e<this.selectCardDataList.length;e++){let i=this.selectCardDataList[e];i?(t[e].visible=!0,t[e].dataSource=i):t[e].visible=!1}}onCardBagEvent(t){t.type==Laya.Event.MOUSE_OUT?this.posType=0:t.type==Laya.Event.MOUSE_OVER&&(this.posType=1)}onStartPageEvent(t){if(this.selectCard)if(t.type==Laya.Event.MOUSE_MOVE)this.selectCard.visible&&(this.cloneCard.visible=!0,this.selectCard.visible=!1,this.cardBag.monsterList.scrollBar.stopScroll()),this.cloneCard.visible&&(this.cloneCard.x=t.stageX-this.cloneCard.width/2,this.cloneCard.y=t.stageY-this.cloneCard.height/2),this.isMove=!0;else if(t.type==Laya.Event.MOUSE_UP){if(0==this.posType||this.posType==this.selectFrom||C.Instance.isInFightList(this.selectCard.data))this.isMove&&this.posType==this.selectFrom&&this.posType>=2&&this.posType<=4&&(this.stopClick=!0,Laya.timer.frameOnce(2,this,()=>{this.stopClick=!1})),this.clearSelect(!0);else{let t=this.selectFrom-2,e=this.posType-2;if(1==this.posType)this.changeSelectList([this.selectCard.data],!1,t),this.showLight(),this.clearSelect(!1);else if(1==this.selectFrom)this.changeSelectList([this.selectCard.data],!0,e),this.showLight(),this.clearSelect(!1);else{let i=this.selectCardDataList[e];this.selectCardDataList[e]=this.selectCardDataList[t],this.selectCardDataList[t]=i,this.changeSelectList([...this.selectCardDataList],!0,-1),this.showLight(),this.clearSelect(!1)}}this.isMove=!1}}onSelectPageCard(t,e,i){if(t==this.cardBag.monsterList&&!i.cardBg.disabled)if(e.type==Laya.Event.MOUSE_DOWN)this.selectFrom=1,this.selectCard=i,this.downPoint.x=e.stageX,this.downPoint.y=e.stageY,this.cloneCard.dataSource=i.data;else if(e.type==Laya.Event.CLICK){let t=this.getFirstEmptyIndex();-1==t||C.Instance.isInFightList(i.data)||(this.changeSelectList([i.data],!0,t),this.showLight())}}onCardBoxEvent(t){let e=[this.cardBox1,this.cardBox2,this.cardBox3],i=[this.card1,this.card2,this.card3],s=[2,3,4],a=e.indexOf(t.target);if(t.type==Laya.Event.MOUSE_OUT)this.posType=0;else if(t.type==Laya.Event.MOUSE_OVER)this.posType=s[a];else if(t.type==Laya.Event.MOUSE_DOWN){let e=i[a];if(!e.visible)return;this.selectCard=e,this.selectFrom=s[a],this.downPoint.x=t.stageX,this.downPoint.y=t.stageY,this.cloneCard.dataSource=this.selectCard.data}else if(t.type==Laya.Event.CLICK){this.showMapBox(!1);let t=i[a];if(this.stopClick||!t.visible)return;this.changeSelectList([t.data],!1,a),this.showLight()}}clearSelect(t){this.cloneCard.visible=!1,t&&(this.selectCard.visible=!0),this.selectCard=null,this.selectFrom=0,this.posType=0,this.downPoint.x=0,this.downPoint.y=0}getFirstEmptyIndex(){for(let t=0;t<this.selectCardDataList.length;t++)if(null==this.selectCardDataList[t])return t;return-1}exceptFunc(t){for(let e=0;e<this.selectCardDataList.length;e++){let i=this.selectCardDataList[e];if(i&&t.cardId==i.cardId)return!1}return!0}changeSelectList(t,e,i){for(let s=0;s<t.length;s++)if(e)-1!=i?this.selectCardDataList[i]=t[s]:this.selectCardDataList[s]=t[s];else if(-1!=i)this.selectCardDataList[i]=null;else for(let e=0;e<this.selectCardDataList.length;e++)if(t[s].cardId==this.selectCardDataList[e].cardId){this.selectCardDataList[e]=null;break}this.refreshSelectCardList(),this.cardBag.initMonsterList()}showMapBox(t){t!=this.isShowMapBox&&(this.isShowMapBox=t,t?(this.topBox.visible=!0,this.middleBox.visible=!0,Laya.Tween.to(this.topBox,{alpha:1},200,Laya.Ease.sineOut),Laya.Tween.to(this.middleBox,{alpha:1},200,Laya.Ease.sineOut),Laya.Tween.to(this.cardBag,{alpha:0},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.cardBag.visible=!1}))):(Laya.Tween.to(this.topBox,{alpha:0},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.topBox.visible=!1})),Laya.Tween.to(this.middleBox,{alpha:0},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.middleBox.visible=!1})),this.cardBag.visible=!0,Laya.Tween.to(this.cardBag,{alpha:1},200,Laya.Ease.sineOut)))}updateExpeditionLeftTime(){Laya.timer.clear(this,this.onExpeditionTimeLoop),this.setExpeditionTimeLeftLabel(),Laya.timer.loop(1e3,this,this.onExpeditionTimeLoop)}setExpeditionTimeLeftLabel(){let t=this.curCreamMapIndex,e=B.instance.expedition[t];if(e>0){let i=3600*C.Instance.eliteStageConfig[t].expeditionTime*1e3-(Date.now()-e);i=i>0?i:0,this.expeditionTimeLeftLabel.text=S.convertTimeFormat(i)}else this.expeditionTimeLeftLabel.text="00:00"}onExpeditionTimeLoop(){for(let t=0;t<B.instance.expedition.length;t++){let e=t,i=B.instance.expedition[e];if(i>0){let t=3600*C.Instance.eliteStageConfig[e].expeditionTime*1e3-(Date.now()-i);(t=t>0?t:0)>0&&(t=(t-=1e3)>0?t:0),0==t&&(1==this.curTabIndex&&1==this.curCreamTabIndex&&this.curCreamMapIndex==e?(this.curCreamTabIndex=-1,this.onCreamTabClick(1,null)):B.instance.refreshExpeditionData()),1==this.curTabIndex&&1==this.curCreamTabIndex&&this.curCreamMapIndex==e&&(this.expeditionTimeLeftLabel.text=S.convertTimeFormat(t))}}}enableElite(t){se.isElite=t,this.mapList.refresh(),t?this.onTabClick(1,null):this.onTabClick(0,null)}setRewardList(t){let e;if(this.rewardBg.skin=t?"newSystem/Ui_FrameGuan8.png":"newSystem/Ui_FrameGuan7.png",t){let t=C.Instance.eliteStageConfig[this.curMapIndex].passReward,i=C.Instance.parseRewardData(t);e=C.Instance.countRewardList(i,s.Cream)}else{let t=C.Instance.passRewardConfig[this.curMapIndex].passReward,i=C.Instance.parseRewardData(t);e=C.Instance.countRewardList(i,s.Normal)}let i=[];for(let t=0;t<e.length;t++){let s={label:{text:"",visible:!0},icon:{skin:""}};s.label.text="X"+e[t].num,"gold"==e[t].type?s.icon.skin="main/Ui_Money.png":"badge"==e[t].type?s.icon.skin="newSystem/Ui_Badge.png":"monster"==e[t].type?(s.icon.skin="newSystem/Ui_MonsterBlack.png",s.label.visible=!1):"chip"==e[t].type?s.icon.skin="newSystem/Ui_Chip.png":"fightTicket"==e[t].type&&(s.icon.skin="newSystem/Ui_Badgebig.png"),i.push(s)}this.rewardList.array=i,this.rewardList.refresh();for(let t=0;t<this.rewardList.length;t++){this.rewardList.getCell(t).getChildByName("label").filters=[x.blackColorFilter]}}showLight(){let t=this.getFirstEmptyIndex();-1==t?(this.light.visible=!1,this.lightBreath.stop(),this.lightBreath.scaleX=this.lightBreath.scaleY=1):(this.light.visible=!0,this.light.x=this.lightPosList[t].x,this.light.y=this.lightPosList[t].y,this.lightBreath.isPlaying||(this.lightBreath.wrapMode=Laya.Animation.WRAP_PINGPONG,this.lightBreath.play(0,!0)))}quickSelect(){let t=[];for(let e=0;e<B.instance.cardList.length;e++){let i=B.instance.cardList[e];i.monsterId<1003&&!C.Instance.isInFightList(i)&&t.push(i)}t.sort((t,e)=>e.star-t.star);for(let e=0;e<this.selectCardDataList.length;e++)t[e]?this.selectCardDataList[e]=t[e]:this.selectCardDataList[e]=null;this.refreshSelectCardList(),this.cardBag.initMonsterList(),this.showLight()}clearSelectExpeditionCardList(){for(let t=0;t<this.selectCardDataList.length;t++)this.selectCardDataList[t]=null;this.refreshSelectCardList()}receiveExpeditionReward(){if(1==this.curTabIndex&&1==this.curCreamTabIndex){let t=B.instance.expeditionReward[this.curCreamMapIndex];if(t>0){let e=C.Instance.eliteStageConfig[this.curCreamMapIndex].expeditionReward,i=C.Instance.parseRewardData(e);if(2==t){let t=C.Instance.eliteStageConfig[this.curCreamMapIndex].expeditionExtraReward,e=C.Instance.parseRewardData(t);i.push(...e)}let a=C.Instance.countRewardList(i,s.Cream);C.Instance.receiveReward(a),B.instance.expeditionReward[this.curCreamMapIndex]=0,B.instance.onDataChange("expeditionReward")}}}refreshExpeditionTimeLeft(){let t=B.instance.expeditionTimeLeftList[this.curCreamMapIndex];this.expeditionLeftTimeLabel.text=t+""}judgeUnlockSpriteShop(){if(0==B.instance.unlockSystem.pk){this.spriteShopBtn.visible=!1,S.dayDiff(B.instance.registerTimestamp,Date.now())>=1&&B.instance.gameRank>=3&&(this.spriteShopBtn.visible=!0)}else this.spriteShopBtn.visible=!0}judgeUnlockElite(){B.instance.gameRank>=3&&0==B.instance.unlockSystem1.elite&&(B.instance.unlockSystem1.elite=!0,B.instance.onDataChange("unlockSystem1"),L.openScene("pages/helpPack.scene",!1,!0,null,["elite"]))}startExpedition(t){B.instance.expeditionCardList[this.curCreamMapIndex]=t,B.instance.expedition[this.curCreamMapIndex]=Date.now(),B.instance.onDataChange("expedition"),B.instance.onDataChange("expeditionCardList"),this.curCreamTabIndex=-1,this.onCreamTabClick(1,null),this.updateExpeditionLeftTime()}forcePopSign(){0==S.DateDiff(B.instance.registerTimestamp,Date.now())?2==B.instance.dayLoginTime&&L.openScene("pages/sign.scene",!1,!0,null,null):1==B.instance.dayLoginTime&&L.openScene("pages/sign.scene",!1,!0,null,null)}changeMapIndex(t,e){let i=this.curMapIndex+t;e&&(i=this.curCreamMapIndex+t),(Math.sign(t)>0&&i<this.mapList.length||Math.sign(t)<0&&i>=0)&&this.tweenList(i,e)}getLastMapIndex(t){let e=B.instance.gameRank;return t&&(e=B.instance.eliteGameRank),e=e>=this.mapList.length?this.mapList.length-1:e}updateSwitchBtnState(t){B.instance.gameRank<3?(this.switchEliteBtn.visible=!1,this.switchNormalBtn.visible=!1):(this.switchEliteBtn.visible=!t,this.switchNormalBtn.visible=t)}onMapMonsterListMouseEvent(t,e){if(t.type==Laya.Event.CLICK){let t=this.mapMonsterList.array[e];-1==B.instance.collectMonsterIdList.indexOf(t.monsterId)&&L.openScene("pages/askForCard.scene",!1,!0,null,[t])}}}se.mapColorFiter=new Laya.ColorFilter([.5,0,0,0,0,0,.5,0,0,0,0,0,.5,0,0,0,0,0,1,0]),se.isElite=!1;class ae extends i.pages.searchMapUI{constructor(){super(...arguments),this.totalCost=0,this.fingerDownPoint=new Laya.Vector2,this.fingerMovePoint=new Laya.Vector2,this.triggerMoveThreshold=0,this.joyMoveMax=90,this.fingerMoveDir=new Laya.Vector2,this.bloodEffect=null,this.niuDanTimeLimit=0,this.smallMapConfig=[{originX:214,originY:253.8,imageWidth:700,imageHeight:700,realWidth:311.2,realHeight:311.2},{originX:62.78,originY:119.78,imageWidth:678,imageHeight:678,realWidth:171.56,realHeight:171.56},{originX:77.32,originY:141.92,imageWidth:693,imageHeight:693,realWidth:208.84,realHeight:208.84},{originX:149.32,originY:133.32,imageWidth:701,imageHeight:701,realWidth:208.84,realHeight:208.84},{originX:161.71,originY:182.03,imageWidth:642,imageHeight:642,realWidth:241.02,realHeight:241.02},{originX:194.32,originY:227.92,imageWidth:655,imageHeight:655,realWidth:266.84,realHeight:266.84},{originX:312.08,originY:310.88,imageWidth:736,imageHeight:736,realWidth:387.16,realHeight:387.16},{originX:148.46,originY:239.46,imageWidth:701,imageHeight:701,realWidth:268.52,realHeight:268.52}],this.smallMapData=null,this.playerMapPos=null}onAwake(){e.on(t.OpenSmall,this,this.onOpenSmall),e.on(t.ShowPicturePointer,this,this.onShowPicturePointer),e.on(t.UpdatePicturePointer,this,this.onUpdatePicturePointer),e.on(t.ShowBossPointer,this,this.onShowBossPointer),e.on(t.UpdateBossPointer,this,this.onUpdateBossPointer),e.on(t.ShowTreasurePointer,this,this.onShowTreasurePointer),e.on(t.UpdateTreasurePointer,this,this.onUpdateTreasurePointer),e.on(B.UserDataChange,this,this.onUserDataChange),e.on(t.CureMonster,this,this.onCureMonster),e.on(t.UpdateSmallMap,this,this.onUpdateSmallMap),e.on(t.PlayerStopMove,this,this.onPlayerStopMove),e.on(t.BossOut,this,this.onBossOut),this.width=Laya.stage.width,this.height=Laya.stage.height,this.on(Laya.Event.MOUSE_DOWN,this,this.onStageEvent),this.on(Laya.Event.MOUSE_MOVE,this,this.onStageEvent),this.on(Laya.Event.MOUSE_UP,this,this.onStageEvent),this.backBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.shopBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.taskBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.initJoyStick(),this.bossPointerBg.visible=!1,this.pointerBg.visible=!1,this.cureCell.initBigCellData(),this.initSmallCardList(),this.initSmallCellData(),this.loadBloodPart(),this.initRed(),this.updateNiuDanTimeStamp(),e.on(B.UserDataChange,this,this.onUserDataChange),this.setBtnVideoTag()}initRed(){this.taskRed.visible=ie.haveRed()}onPlayerStopMove(){this.controllerUp()}initSmallMap(){let t=C.Instance.curMapData;this.smallMapData=this.smallMapConfig[t.mapIndex],C.Instance.isCream?this.smallMap.skin=`smallMap/Map${t.mapIndex+1}_2.png`:this.smallMap.skin=`smallMap/Map${t.mapIndex+1}.png`}onUpdateSmallMap(t){this.playerMapPos=this.getSmallMapPos(t);let e=111-this.playerMapPos.x,i=70-this.playerMapPos.y,s=0,a=0;e>0?(s=0-e,e=0):e<222-this.smallMapData.imageWidth&&(s=222-this.smallMapData.imageWidth-e,e=222-this.smallMapData.imageWidth),i>0?(a=0-i,i=0):i<140-this.smallMapData.imageHeight&&(a=140-this.smallMapData.imageHeight-i,i=140-this.smallMapData.imageHeight),this.rolePointer.x=111+s,this.rolePointer.y=70+a,this.smallMap.x=e,this.smallMap.y=i}getSmallMapPos(t){let e=Math.abs(t.x-this.smallMapData.originX),i=Math.abs(t.z-this.smallMapData.originY),s=e/this.smallMapData.realWidth,a=i/this.smallMapData.realHeight;return{x:this.smallMapData.imageWidth*s,y:this.smallMapData.imageHeight*a}}onUserDataChange(t){"fightCardList"==t?(this.cureCell.initBigCellData(),this.initSmallCellData()):"pictureCollectList"==t||"creamPictureCollectList"==t?this.setPictureLabel():"achieveTaskReceiveRec"==t||"achieveTaskCountRec"==t||"achieveTaskStage"==t||"achieveTaskReceiveRec"==t||"dayTaskReceiveRec"==t||"dayTaskCountRec"==t?this.taskRed.visible=ie.haveRed():"niuDanTimestamp"==t&&this.updateNiuDanTimeStamp()}loadBloodPart(){Laya.loader.load("pages/addHp.part",Laya.Handler.create(this,this.onAssetsLoaded),null,Laya.Loader.JSON)}onAssetsLoaded(t){const e=Laya.Particle2D;this.bloodEffect=new e(t),this.addChild(this.bloodEffect),window.bloodEffect=this.bloodEffect,this.bloodEffect.emitter.start(),this.bloodEffect.stop()}onOpenSmall(i){i?(this.smallBg.visible=!0,Laya.Tween.to(this.smallBg,{alpha:1},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.openBtn.visible=!0}),0,!0)):(this.openBtn.visible=!1,Laya.Tween.to(this.smallBg,{alpha:0},200,Laya.Ease.sineOut,Laya.Handler.create(this,()=>{this.smallBg.visible=!1}),0,!0),e.event(t.OpenBig,!0))}initSmallCellData(){let t=[];for(let e=0;e<B.instance.fightCardList.length;e++){let i=B.instance.fightCardList[e];i&&t.push({monsterHead:{skin:`monster/Ui_MonsterHead${i.monsterId}.png`,mask:z.mask}})}this.smallCardList.array=t,this.smallCardList.refresh(),this.totalCost=0;for(let t=0;t<3;t++){let e=B.instance.fightCardList[t];if(e){let t=C.Instance.monsterData[e.monsterId].hp;e.special&&(t+=Math.round(Math.max(5,.1*t)));let i=2*(t-e.curHp);this.totalCost+=i}}this.totalCost>0?(this.oneCureBtn.visible=!0,this.videoOneCureBtn.visible=!0,this.oneCureCostLabel.text=this.totalCost+""):(this.oneCureBtn.visible=!1,this.videoOneCureBtn.visible=!1)}initSmallCardList(){this.openBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.oneCureBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.videoOneCureBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.openBtn.visible=!1,this.smallBg.alpha=0,this.smallBg.visible=!1}onBtnClick(i){if(i.target==this.openBtn)this.onOpenSmall(!1);else if(i.target==this.oneCureBtn){if(I.isOpen)return I.finishInnerTask("点击治疗"),void e.event(t.OneCure,!1);B.instance.gold>=this.totalCost||B.instance.freeCure?(B.instance.freeCure||(B.instance.gold-=this.totalCost,e.event(t.UseMoney,"gold"),B.instance.onDataChange("gold")),b.sendEvent(10005,{item_type:1,item_id:1,get_num:-1*this.totalCost,get_type:12,last_num:B.instance.gold}),e.event(t.OneCure)):(L.openScene("pages/addMoney.scene",!1,!0,null,[2,200]),e.event(t.ShowGiftPack))}else i.target==this.backBtn?(C.Instance.isPause=!0,L.openScene("pages/pause.scene",!1,!0,Laya.Handler.create(this,()=>{C.Instance.isPause=!1}),null)):i.target==this.shopBtn?(I.finishInnerTask("点击扭蛋商店"),L.openScene("pages/eggShop.scene",!1,!0,null,null)):i.target==this.taskBtn?L.openScene("pages/task.scene",!0,!0,null,null):i.target==this.videoOneCureBtn&&w.Instance.showVideoAd("adunit-344c07eccef75220",()=>{e.event(t.OneCure)})}onUpdateBossPointer(t){if(this.bossPointerBg.visible){let e=this.getSmallMapPos(t),i=222,s=140,a=25,n=e.x-Math.abs(this.smallMap.x),o=e.y-Math.abs(this.smallMap.y),r=!1;if(n<0+a?(n=0+a,r=!0):n>i-a&&(n=i-a,r=!0),o<0+a?(o=0+a,r=!0):o>s-a&&(o=s-a,r=!0),this.bossPointerBg.x=n,this.bossPointerBg.y=o,this.bossPointer.visible=r,this.bossPointer.visible){let t=Math.atan2(e.y-this.playerMapPos.y,e.x-this.playerMapPos.x)*v.rad2Deg;this.bossPointer.rotation=t}}}onShowBossPointer(t){this.bossPointerBg.visible=t}onUpdatePicturePointer(t){if(this.pointerBg.visible){let e=this.getSmallMapPos(t),i=222,s=140,a=25,n=e.x-Math.abs(this.smallMap.x),o=e.y-Math.abs(this.smallMap.y),r=!1;if(n<0+a?(n=0+a,r=!0):n>i-a&&(n=i-a,r=!0),o<0+a?(o=0+a,r=!0):o>s-a&&(o=s-a,r=!0),this.pointerBg.x=n,this.pointerBg.y=o,this.pointer.visible=r,this.pointer.visible){let t=Math.atan2(e.y-this.playerMapPos.y,e.x-this.playerMapPos.x)*v.rad2Deg;this.pointer.rotation=t}}}onShowTreasurePointer(t){this.treasurePointerBg.visible=t}onUpdateTreasurePointer(t){if(this.treasurePointerBg.visible){let e=this.getSmallMapPos(t),i=222,s=140,a=25,n=e.x-Math.abs(this.smallMap.x),o=e.y-Math.abs(this.smallMap.y),r=!1;if(n<0+a?(n=0+a,r=!0):n>i-a&&(n=i-a,r=!0),o<0+a?(o=0+a,r=!0):o>s-a&&(o=s-a,r=!0),this.treasurePointerBg.x=n,this.treasurePointerBg.y=o,this.treasurePointer.visible=r,this.treasurePointer.visible){let t=Math.atan2(e.y-this.playerMapPos.y,e.x-this.playerMapPos.x)*v.rad2Deg;this.treasurePointer.rotation=t}}}onShowPicturePointer(t){this.pointerBg.visible=t}onStageEvent(i){if(i.type==Laya.Event.MOUSE_DOWN)this.fingerDownPoint.x=i.stageX,this.fingerDownPoint.y=i.stageY,this.joyStick.visible=!0,this.joyStickInner.visible=!0,this.joyStick.x=i.stageX,this.joyStick.y=i.stageY,this.joyStickInner.x=i.stageX,this.joyStickInner.y=i.stageY;else if(i.type==Laya.Event.MOUSE_MOVE){this.cureCell.isBigOpen&&this.cureCell.onOpenBig(!1),this.fingerMovePoint.x=i.stageX,this.fingerMovePoint.y=i.stageY,this.fingerMoveDir.x=this.fingerMovePoint.x-this.fingerDownPoint.x,this.fingerMoveDir.y=this.fingerMovePoint.y-this.fingerDownPoint.y;let s=Math.sqrt(this.fingerMoveDir.x*this.fingerMoveDir.x+this.fingerMoveDir.y*this.fingerMoveDir.y);if(s>=this.triggerMoveThreshold){if(s>this.joyMoveMax){let t=Math.atan2(this.fingerMoveDir.y,this.fingerMoveDir.x);this.joyStickInner.x=this.fingerDownPoint.x+this.joyMoveMax*Math.cos(t),this.joyStickInner.y=this.fingerDownPoint.y+this.joyMoveMax*Math.sin(t)}else this.joyStickInner.x=i.stageX,this.joyStickInner.y=i.stageY;e.event(t.ControlChange,[!0,(this.joyStickInner.x-this.fingerDownPoint.x)/this.joyMoveMax,(this.joyStickInner.y-this.fingerDownPoint.y)/this.joyMoveMax])}}else i.type==Laya.Event.MOUSE_UP&&this.controllerUp()}controllerUp(){this.fingerDownPoint.x=0,this.fingerDownPoint.y=0,this.fingerMovePoint.x=0,this.fingerMovePoint.y=0,this.joyStick.visible=!1,this.joyStickInner.visible=!1,e.event(t.ControlChange,[!1,0,0])}setVisible(i){this.visible=i,i?(e.event(t.ShowCustomAd,!0),this.setPictureLabel(),this.initSmallMap(),this.pointerBg.visible=!1,this.treasurePointerBg.visible=!1,this.bossPointerBg.visible=!1,w.Instance.sendVideoData={page_id:5,button_id:5,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData),this.initJoyStick(),e.on(I.InnerTaskStart,this,this.onInnerTaskStart),I.startOutTask("介绍地图里面的重要信息"),B.instance.cardList.length>3&&I.startOutTask("介绍合成")):e.off(I.InnerTaskStart,this,this.onInnerTaskStart)}setPictureLabel(){let t=B.instance.pictureCollectList[C.Instance.enterMapIndex].length,e=C.Instance.curMapData.piece;C.Instance.isCream&&(t=B.instance.creamPictureCollectList[C.Instance.enterMapIndex].length),this.pictureLabel.text=`${t}/${e}`}onCureMonster(t){if(p.playSound("cure.mp3"),this.bloodEffect){let e=new Laya.Point;if(-1!=t){let i=this.cureCell.cardList.getCell(t);e.x=i.width/2,e.y=i.height/2,i.localToGlobal(e,!1)}else e.x=0,e.y=this.smallBg.height,this.smallBg.localToGlobal(e,!1);this.bloodEffect.x=e.x-100,this.bloodEffect.y=e.y,this.bloodEffect.play(),Laya.timer.once(500,this,this.stopBloodEffect,null,!0)}}stopBloodEffect(){this.bloodEffect.stop()}onBossOut(){this.bossWarn.play(0,!1),Laya.timer.once(2e3,this,()=>{I.startOutTask("Boss出现")})}onDestroy(){e.off(t.ShowPicturePointer,this,this.onShowPicturePointer),e.off(t.UpdatePicturePointer,this,this.onUpdatePicturePointer),e.off(t.UpdateBossPointer,this,this.onUpdateBossPointer),e.off(t.ShowBossPointer,this,this.onShowBossPointer),e.off(t.OpenSmall,this,this.onOpenSmall),e.off(B.UserDataChange,this,this.onUserDataChange),e.off(t.CureMonster,this,this.onCureMonster),e.off(t.UpdateSmallMap,this,this.onUpdateSmallMap),e.off(t.ShowTreasurePointer,this,this.onShowTreasurePointer),e.off(t.UpdateTreasurePointer,this,this.onUpdateTreasurePointer),e.off(t.PlayerStopMove,this,this.onPlayerStopMove),e.off(t.BossOut,this,this.onBossOut)}initJoyStick(){this.joyStick.visible=!1,this.joyStickInner.visible=!1,this.joyStick.x=this.joyStickInner.x=360,this.joyStick.y=this.joyStickInner.y=1073}updateNiuDanTimeStamp(){if(Laya.timer.clear(this,this.onNiuDanTimeLoop),B.instance.niuDanLeftTime>0){let t=600;2==B.instance.niuDanLeftTime?t=300:3==B.instance.niuDanLeftTime?t=180:4==B.instance.niuDanLeftTime&&(t=0),this.niuDanTimeLimit=1e3*t-(Date.now()-B.instance.niuDanTimestamp),this.niuDanTimeLimit=this.niuDanTimeLimit>0?this.niuDanTimeLimit:0,this.niuDanTimeLimit>0?(this.shopRed.visible=!1,this.timeLabel.visible=!0,this.timeLabel.text=S.dateFormat("MM:SS",new Date(this.niuDanTimeLimit)),Laya.timer.loop(1e3,this,this.onNiuDanTimeLoop)):(this.timeLabel.visible=!1,this.shopRed.visible=!0)}else this.shopRed.visible=!1,this.timeLabel.visible=!1}onNiuDanTimeLoop(){this.niuDanTimeLimit-=1e3,this.niuDanTimeLimit<=0&&(this.niuDanTimeLimit=0,this.timeLabel.visible=!1,B.instance.niuDanLeftTime>0?this.shopRed.visible=!0:this.shopRed.visible=!1,Laya.timer.clear(this,this.onNiuDanTimeLoop)),this.timeLabel.text=S.dateFormat("MM:SS",new Date(this.niuDanTimeLimit))}onInnerTaskStart(t){"介绍上阵队伍"==t?I.startInnerTask(t,[{node:this.cureCell,isHandNode:!1}]):"介绍小地图"==t?I.startInnerTask(t,[{node:this.smallMapBox,isHandNode:!1}]):"介绍拼图"==t?I.startInnerTask(t,[{node:this.pictureBg,isHandNode:!1}]):"点击治疗"==t?(this.onOpenSmall(!0),Laya.timer.once(500,this,()=>{I.startInnerTask(t,[{node:this.oneCureBtn,isHandNode:!0}])})):"继续探索"==t?I.startInnerTask(t):"Boss提示"==t&&I.startInnerTask(t)}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class ne extends i.pages.mapUI{constructor(){super(...arguments),this.data=null}set dataSource(t){if(!t)return;this.data=t,this.mapImg.skin=`mapImage/Ui_Guan${t.index+1}.png`;let e=se.isElite?B.instance.eliteGameRank:B.instance.gameRank,i=se.isElite?C.Instance.creamStageMaxIndex:C.Instance.stageMaxIndex,s=se.isElite?B.instance.eliteGameAllPass:B.instance.gameAllPass;t.listIndex<=e?(this.lockImage.visible=!1,this.mapImg.filters=null):(this.lockImage.visible=!0,this.mapImg.filters=[se.mapColorFiter]),t.listIndex<i?t.listIndex<e?this.passImage.visible=!0:this.passImage.visible=!1:this.passImage.visible=s,this.setElite(se.isElite)}setElite(t){this.eliteFrog.visible=t,this.mapImg.skin=t?`mapImage/Ui_GuanElite${this.data.index+1}.png`:`mapImage/Ui_Guan${this.data.index+1}.png`}}class oe extends i.pages.neverGiveUpUI{onAwake(){this.continueFightBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.setBtnVideoTag()}onBtnClick(i){i.target==this.continueFightBtn?w.Instance.showVideoAd("adunit-670d87306dc1c259",()=>{L.openScene("pages/superEggMachine.scene",!1,!0,null,[!1,!0]),e.once(t.CatchResultClose,this,this.onCatchResultClose)}):i.target==this.closeBtn&&this.close("no")}onCatchResultClose(t){this.changeFightMonsterList(t),this.close("yes")}changeFightMonsterList(t){for(let e=0;e<B.instance.fightCardList.length;e++){let i=B.instance.fightPosUnlock[e],s=B.instance.fightCardList[e];if(i&&!s)return B.instance.fightCardList[e]=t,B.instance.onDataChange("fightCardList"),void C.Instance.monsterAtkTimeList.push(0)}let e=t.atk+t.hp,i=-1,s=-1,a=-1;for(let t=0;t<B.instance.fightCardList.length;t++){let n=B.instance.fightPosUnlock[t],o=B.instance.fightCardList[t];if(n&&o){s++;let n=o.atk+o.hp;n<e&&(a=s,i=t,e=n)}}-1!=i&&(B.instance.fightCardList[i]=t,B.instance.onDataChange("fightCardList")),a>=0&&a<C.Instance.monsterAtkTimeList.length&&(C.Instance.monsterAtkTimeList[a]=0)}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class re extends i.pages.pauseUI{onAwake(){}onOpened(){this.continueBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.backBtn.on(Laya.Event.CLICK,this,this.onBtnClick),w.Instance.showBannerAd()}onClosed(){w.Instance.hideBannerAd()}onBtnClick(i){i.target==this.continueBtn?this.close():i.target==this.backBtn&&(e.event(t.ClickMainBtn),this.close())}}class he extends i.pages.PvpRankRewardCellUI{onAwake(){this.receiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.extraReceiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.divisionIcon.setShowType(!0,!0),this.setBtnVideoTag()}onBtnClick(t){t.target==this.receiveBtn?(C.Instance.receiveReward(this.rewardDataList),B.instance.divisionRewardState[this.data.index][0]=1,B.instance.onDataChange("divisionRewardState"),this.dataSource=this.data):t.target==this.extraReceiveBtn&&w.Instance.showVideoAd("adunit-9de3143facfc2b2d",()=>{C.Instance.receiveReward(this.rewardDataExtraList),B.instance.divisionRewardState[this.data.index][1]=1,B.instance.onDataChange("divisionRewardState"),this.dataSource=this.data})}set dataSource(t){if(this.data=t,!this.data)return;this.divisionIcon.setDivision(this.data.level),this.divisionIcon.setStarNum(this.data.star);let e=C.Instance.parseRewardData(this.data.levelReward);this.rewardDataList=C.Instance.countRewardList(e,s.Pvp);let i=C.Instance.getRewardUiDataList(this.rewardDataList),a=C.Instance.parseRewardData(this.data.levelExtraReward);this.rewardDataExtraList=C.Instance.countRewardList(a,s.Pvp);let n=C.Instance.getRewardUiDataList(this.rewardDataExtraList);this.rewardList.array=i,this.rewardList.refresh(),this.extraRewardList.array=n,this.extraRewardList.refresh(),this.setRewardState()}setRewardState(){let t=C.Instance.getPvpDivisionDataByScore(B.instance.winCount),e=[this.data.level,this.data.star],i=C.Instance.compareDivision(t,e);if(0==i||1==i){let t=B.instance.divisionRewardState[this.data.index];0==t[0]?this.receiveBtn.visible=!0:this.receiveBtn.visible=!1,0==t[1]?this.extraReceiveBtn.visible=!0:this.extraReceiveBtn.visible=!1}else this.receiveBtn.visible=!1,this.extraReceiveBtn.visible=!1}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class le extends i.pages.pvpRankCellUI{onAwake(){}set dataSource(t){if(this.data=t,!t)return;this.setRankBg(t.index,t.isMe);let e=L.getSpecifyCharLengthStr(t.UserName,10,"...");this.setRankData(t.index,t.isMe,t.RankValue,e),this.divisionIcon.setShowType(!1,!0)}setRankBg(t,e){this.bg.skin=t<=3?`pvp/Ui_FrameRank${t}.png`:e?"pvp/Ui_FrameRankMe.png":"pvp/Ui_FrameRank.png",this.meTag.visible=e}setRankData(t,e,i,s){t<=3?this.rankNumLabel.visible=!1:(this.rankNumLabel.text=t+"",this.rankNumLabel.visible=!0),this.selfNameLabel.visible=e,this.otherNameLabel.visible=!e,e||(this.otherNameLabel.text=s),this.winTimeLabel.text=i+"";let a=C.Instance.getPvpDivisionDataByScore(i);this.divisionIcon.setDivision(a[0]),this.divisionIcon.setStarNum(a[1])}}class ce extends i.pages.pvpCountUI{onAwake(){this.backBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.againBtn.on(Laya.Event.CLICK,this,this.onBtnClick),C.Instance.isGameWin&&(B.instance.winCount++,B.instance.onDataChange("winCount"),this.uploadPvpRankScore()),this.setCountCell(!0,this.selfCell,C.Instance.isGameWin),this.setCountCell(!1,this.enemyCell,!C.Instance.isGameWin)}onBtnClick(t){t.target==this.backBtn?this.close("no"):t.target==this.againBtn&&this.close("yes")}setCountCell(t,e,i){e.resultImage.skin=i?"pvp/Ui_RankWin.png":"pvp/Ui_RankLose.png",e.sideImage.skin=t?"pvp/Ui_RankMe.png":"pvp/Ui_RankEnemy.png",this.updateFightMonsterImage(C.Instance.pvpMonsterCardList,this.enemyCell);let s=[];for(let t=0;t<B.instance.fightCardList.length;t++){let e=B.instance.fightCardList[t];e&&s.push(e)}this.updateFightMonsterImage(s,this.selfCell),e.curDivisionIcon.visible=i,e.nextDivisionIcon.visible=i,e.divisionProgressBg.visible=i,e.divisionIcon.visible=!i;let a=t?B.instance.winCount:C.Instance.pvpEnemyData.RankValue+1,n=C.Instance.getPvpDivisionDataByScore(a);i?this.updateDivision(e):(e.divisionIcon.setDivision(n[0]),e.divisionIcon.setStarNum(n[1]))}updateFightMonsterImage(t,e){let i=[e.monsterImage1,e.monsterImage2,e.monsterImage3];for(let e=0;e<3;e++){let s=t[e],a=i[e];s?(a.visible=!0,a.skin=`monster/Ui_Monster${s.monsterId}.png`):a.visible=!1}}uploadPvpRankScore(){if("undefined"!=typeof wx){let t=B.instance.winCount;wx.getOpenDataContext().postMessage({type:"uploadpvp",score:t})}}updateDivision(t){let e=C.Instance.pvpScoreDataList,i=C.Instance.getPvpDivisionDataByScore(B.instance.winCount);t.curDivisionIcon.setDivision(i[0]),t.curDivisionIcon.setStarNum(i[1]);let s=[...i];s[1]+1>=e[s[0]-1].length?s[0]+1<e.length&&(s[0]++,s[1]=0):s[1]++,t.nextDivisionIcon.setDivision(s[0]),t.nextDivisionIcon.setStarNum(s[1]);let a=e[s[0]-1][s[1]-1].totalUpgradeScore;t.winTimeLabel.text=`${B.instance.winCount}/${a}`;let n=B.instance.winCount/a;n=n>1?1:n,t.divisionProgress.width=250*n}}class de extends i.pages.pvpMatchUI{onAwake(){let i=C.Instance.getPvpDivisionDataByScore(B.instance.winCount);C.Instance.initPvpMonsterCardList(i);let s=[];for(let t=0;t<B.instance.fightCardList.length;t++){let e=B.instance.fightCardList[t];e&&s.push(e)}this.selfCardList.width=139*s.length,this.selfCardList.array=s,this.selfCardList.refresh(),this.enemyCardList.width=139*C.Instance.pvpMonsterCardList.length,this.enemyCardList.array=C.Instance.pvpMonsterCardList,this.enemyCardList.refresh(),this.ani1.on(Laya.Event.COMPLETE,this,()=>{this.close(),Laya.MouseManager.enabled=!1,e.event(t.GotoScene,"pvp")})}}class pe extends i.pages.selectShareFriendUI{onAwake(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick)}setParam(t){if(this.monsterIdIndex=t,"undefined"!=typeof wx){let e=this.monsterIdIndex+1;t=t>50?50:t,wx.setMessageToFriendQuery({shareMessageToFriendScene:e})?console.log("设置定向分享query成功",e):console.log("设置定向分享query失败",e),this.wxOpenDataViewer.postMsg({type:"showshare",monsterIdIndex:e-1})}}onDestroy(){"undefined"!=typeof wx&&this.wxOpenDataViewer.postMsg({type:"hideshare"})}onBtnClick(t){t.target==this.closeBtn&&this.close()}}class ge extends i.pages.settingUI{onAwake(){this.changeBtnState(this.musicBtn,!1),this.changeBtnState(this.soundBtn,!1),this.changeBtnState(this.vibrateBtn,!1)}onOpened(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.musicBtnBg.on(Laya.Event.CLICK,this,this.onBtnClick),this.soundBtnBg.on(Laya.Event.CLICK,this,this.onBtnClick),this.vibrateBtnBg.on(Laya.Event.CLICK,this,this.onBtnClick),w.Instance.showBannerAd()}onClosed(){w.Instance.hideBannerAd()}onBtnClick(t){t.target==this.closeBtn?this.close():t.target==this.musicBtnBg?this.changeBtnState(this.musicBtn,!0):t.target==this.soundBtnBg?this.changeBtnState(this.soundBtn,!0):t.target==this.vibrateBtnBg&&this.changeBtnState(this.vibrateBtn,!0)}changeBtnState(t,e){let i=!1;t==this.musicBtn?(e&&(p.musicOpen=!p.musicOpen,p.musicOpen?p.musicName&&p.playMusic(p.musicName):p.stopMusic()),i=p.musicOpen):t==this.soundBtn?(e&&(p.soundOpen=!p.soundOpen),i=p.soundOpen):t==this.vibrateBtn&&(e&&(p.vibrateOpen=!p.vibrateOpen),i=p.vibrateOpen),t.skin=i?"main/Ui_FrameSet3.png":"main/Ui_FrameSet4.png",i?Laya.Tween.to(t,{x:243},100,Laya.Ease.sineOut):Laya.Tween.to(t,{x:202},100,Laya.Ease.sineOut)}}class me extends i.pages.shopCellUI{constructor(){super(...arguments),this.data=null}set dataSource(t){this.data=t,t&&(this.setItemState(),this.setItemInfo(this.data.goods[0]),this.setItemMoney(this.data),this.setItemExtra(this.data),this.setItemName(this.data))}setItemState(){let t=C.Instance.getShopItemBuyTime(this.data.productId);this.data.limit>0&&t>=this.data.limit?this.itemMask.visible=!0:this.itemMask.visible=!1,this.data.limit>0?(this.limitLabel.visible=!0,this.limitLabel.text=`每日限购：${t}/${this.data.limit}`):this.limitLabel.visible=!1}setItemInfo(t){"gold"==t.type?this.itemImage.skin="count/Ui_TwoGold.png":"chip"==t.type?this.itemImage.skin="newSystem/Ui_MonsterHeadChip.png":"fightTicket"==t.type?this.itemImage.skin="spriteShop/Ui_TwoQuan.png":"monster"==t.type?this.itemImage.skin=`monster/Ui_Monster${t.num}.png`:"diamond"==t.type&&(this.itemImage.skin="pay/Ui_Diamonds.png"),"monster"==t.type?(this.starBg.visible=!0,this.starLabel.text=C.Instance.monsterData[t.num].level,this.itemImage.scaleX=this.itemImage.scaleY=.5):(this.starBg.visible=!1,this.itemImage.scaleX=this.itemImage.scaleY=1)}setItemName(t){if("monster"==t.goods[0].type)this.itemNameLabel.text=C.Instance.monsterData[t.goods[0].num].name;else{let e=["gold","diamond","chip","badge","fightTicket"],i=["金币","钻石","碎片","徽章","战斗券"],s=C.Instance.haveExtra(t)?t.goods[0].num+t.extra:t.goods[0].num;this.itemNameLabel.text=i[e.indexOf(t.goods[0].type)]+"X"+s}}setItemMoney(t){"rmb"==t.costType?(this.itemMoneyIcon.visible=!1,0==t.costNum?(this.itemMoneyNum.visible=!1,this.freeTag.visible=!0):(this.itemMoneyNum.visible=!0,this.freeTag.visible=!1,this.itemMoneyNum.value="￥"+t.costNum)):(this.itemMoneyNum.visible=!0,this.freeTag.visible=!1,this.itemMoneyIcon.visible=!0,this.itemMoneyNum.value=t.costNum,"diamond"==t.costType?this.itemMoneyIcon.skin="pay/Ui_Diamond.png":"badge"==t.costType&&(this.itemMoneyIcon.skin="newSystem/Ui_Badge.png"))}setItemExtra(t){C.Instance.haveExtra(t)?(this.extraTag.visible=!0,this.extraValue.value=Math.floor(t.extra/t.goods[0].num*100)+"%"):this.extraTag.visible=!1}}class ue extends i.pages.succeedUI{onAwake(){this.levelLabel.text=`${B.instance.highestChallengeLevel[0]}-${B.instance.highestChallengeLevel[1]}`,this.levelLabel.filters=[x.blackColorFilter],this.yesBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.setBtnVideoTag()}onBtnClick(t){t.target==this.yesBtn?w.Instance.showVideoAd("adunit-eb988867c0754d81",()=>{this.close("yes")}):t.target==this.closeBtn&&this.close("no")}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class ye extends i.pages.superEggMachineUI{constructor(){super(...arguments),this.isPlaying=!1,this.mustMonster=!1}onAwake(){this.superSpine.x=Laya.stage.width/2,this.superSpine.y=Laya.stage.height/2-140}onSuperBtnClick(){this.isPlaying||(this.isPlaying=!0,this.superSpine.play(0,!1,!0,0),this.playNiuDanSound())}onSuperFinish(){this.isPlaying=!1,q.superEggReward(!1,this.mustMonster),this.close()}playNiuDanSound(){p.playSound("niuDanBtn.mp3"),Laya.timer.once(1300,this,()=>{p.playSound("niuDaning.mp3")})}setParam(t,e){this.mustMonster=e,this.superSpine._complete=Laya.Handler.create(this,()=>{t?this.superSpine.stop():this.onSuperBtnClick(),this.superSpine.on(Laya.Event.STOPPED,this,this.onSuperFinish)}),this.closeBtn.visible=t,this.superBtn.visible=t,t&&(this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.superBtn.on(Laya.Event.CLICK,this,this.onBtnClick))}onBtnClick(t){t.target==this.closeBtn?this.close():t.target==this.superBtn&&this.onSuperBtnClick()}}class fe extends Laya.Sprite{constructor(){super(),this.originalX=0,this.originalY=0}onAwake(){this.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.originalX=this.x,this.originalY=this.y}onMouseDown(t){Laya.Tween.to(this,{y:this.originalY-10},50,Laya.Ease.sineOut)}onMouseUp(t){p.playSound("click.mp3"),Laya.Tween.to(this,{y:this.originalY},50,Laya.Ease.sineIn)}onMouseOut(t){Laya.Tween.to(this,{y:this.originalY},50,Laya.Ease.sineIn)}}class Le extends i.pages.taskCellUI{constructor(){super(...arguments),this.taskType=0,this.taskState=0,this._dataSource=null}onAwake(){this.descLabel.filters=[Le.brownFilter],this.receiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.goldLabel.filters=[x.blackColorFilter]}set dataSource(t){if(t)if(t.nativeAd);else if(this._dataSource=t,this.goldLabel.text="X"+t.rewardNum,this.descLabel.text=t.taskDesc,this.taskType=t.taskType,0==this.taskType){let e=B.instance.dayTaskCountRec[t.index];if(e>=t.num){B.instance.dayTaskReceiveRec[t.index]?this.setState(1):this.setState(2)}else this.setState(0);this.progressLabel.text=`(${e}/${t.num})`}else{let e=B.instance.achieveTaskCountRec[t.index];if(e>=t.num){B.instance.achieveTaskReceiveRec[t.index]?this.setState(1):this.setState(2)}else this.setState(0);this.progressLabel.text=`(${e}/${t.num})`}}setState(t){this.taskState=t,0==t?(this.running.visible=!0,this.completeTag.visible=!1,this.receiveBtn.visible=!1,this.taskBg.skin="sign/Ui_FrameTask1.png"):2==t?(this.running.visible=!1,this.completeTag.visible=!1,this.receiveBtn.visible=!0,this.taskBg.skin="sign/Ui_FrameTask1.png"):1==t&&(this.running.visible=!1,this.receiveBtn.visible=!1,this.completeTag.visible=!0,this.taskBg.skin="sign/Ui_FrameTask3.png")}onBtnClick(){if(0==this._dataSource.taskType){B.instance.dayTaskReceiveRec[this._dataSource.index]=1,B.instance.onDataChange("dayTaskReceiveRec");let t=ie.taskConfig1[this._dataSource.index],e=t.reward;L.openScene("pages/getCard.scene",!1,!0,null,[1,e,6]),b.sendEvent(10008,{mission_type:"1",mission_id:t.id})}else{let t=B.instance.achieveTaskStage[this._dataSource.index],e=ie.taskConfig2[this._dataSource.index],i=e.num,s=e.reward[t];L.openScene("pages/getCard.scene",!1,!0,null,[1,s,6]),b.sendEvent(10008,{mission_type:"2",mission_id:e.id}),t<i.length-1?(B.instance.achieveTaskStage[this._dataSource.index]++,B.instance.onDataChange("achieveTaskStage"),B.instance.achieveTaskReceiveRec[this._dataSource.index]=0):B.instance.achieveTaskReceiveRec[this._dataSource.index]=1,B.instance.onDataChange("achieveTaskReceiveRec")}e.event(t.UpdateTask),e.event(t.UpdateRed)}}Le.brownFilter=new Laya.ColorFilter([164/255,0,0,0,0,0,100/255,0,0,0,0,0,38/255,0,0,0,0,0,1,0]);class ve{constructor(){this.saveTime=0,this.level=0}}class Ce extends i.pages.treasureBoxUI{constructor(){super(...arguments),this.goldNum=200,this.levelAdd=3,this.rewardType=0}onAwake(){this.eggLabel.filters=[x.blackColorFilter],this.goldLabel.filters=[x.blackColorFilter],this.setBtnVideoTag()}onOpened(){this.receiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.vidoeReceiveBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.openBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.storeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),w.Instance.showBannerAd()}onClosed(){w.Instance.hideBannerAd()}setParam(t){if(0==t||3==t||4==t){let e=C.Instance.enterMapIndex+1;C.Instance.isCream&&(e+=1),0==t?(this.rewardType=1,this.goldNum=150*e,this.goldBg.skin="count/Ui_TwoGold.png"):3==t?(this.rewardType=5,this.goldNum=1*e,this.goldBg.skin="spriteShop/Ui_TwoQuan.png"):4==t&&(this.rewardType=4,this.goldNum=10*e,this.goldBg.skin="newSystem/Ui_MonsterHeadChip.png"),this.goldLabel.text="X"+this.goldNum,this.goldBg.visible=!0,this.egg.visible=!1,this.receiveBtn.visible=!0,this.vidoeReceiveBtn.visible=!0,this.openBtn.visible=!1,this.storeBtn.visible=!1,this.eggTip.visible=!1,w.Instance.sendVideoData={page_id:8,button_id:8,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData)}else this.levelAdd=3,B.instance.niuDanSuperBag.length>=1&&100*Math.random()<80&&(this.levelAdd=2),this.eggTip.visible=!0,this.goldBg.visible=!1,this.egg.visible=!0,this.receiveBtn.visible=!1,this.vidoeReceiveBtn.visible=!1,this.openBtn.visible=!0,this.storeBtn.visible=!0,this.storeBtn.visible=!1,Laya.timer.once(w.Instance.delayTime,this,()=>{this.storeBtn.visible=!0}),w.Instance.sendVideoData={page_id:8,button_id:9,ad_id:1,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData)}onBtnClick(i){let s=Laya.Handler.create(this,()=>{e.event(t.OpenTreasureBoxFinish)});if(i.target==this.receiveBtn)L.openScene("pages/getCard.scene",!1,!0,s,[this.rewardType,this.goldNum,7]),this.close();else if(i.target==this.vidoeReceiveBtn)w.Instance.sendVideoData={page_id:8,button_id:8,ad_id:2,ad_type:1},w.Instance.showVideoAd("adunit-92987caa2fa84b4e",()=>{L.openScene("pages/getCard.scene",!1,!0,s,[this.rewardType,2*this.goldNum,7]),this.close()});else if(i.target==this.openBtn)w.Instance.sendVideoData={page_id:8,button_id:9,ad_id:2,ad_type:1},b.sendEvent(10002,w.Instance.sendVideoData),w.Instance.showVideoAd("adunit-ad045e709bd7ac27",()=>{L.openScene("pages/superEggMachine.scene",!1,!0,s,[!1,!1]),this.close()});else if(i.target==this.storeBtn){if(B.instance.niuDanSuperBag.length<2){let t=new ve;t.level=this.levelAdd,t.saveTime=Date.now(),B.instance.niuDanSuperBag.push(t),B.instance.onDataChange("niuDanSuperBag")}s.run(),this.close()}}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class Ie extends i.pages.tryGamePageUI{constructor(){super(...arguments),this.isTry=!1,this.jumpSuccess=!1}onAwake(){this.gameList.vScrollBarSkin=null,this.gameList.array=w.Instance.appDataList,this.gameList.refresh(),this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),"undefined"!=typeof wx&&(wx.onShow(this.onShow.bind(this)),wx.onHide(this.onHide.bind(this))),e.on(t.ClickGameCell,this,this.onClickGameCell)}onDestroy(){"undefined"!=typeof wx&&(wx.offShow(this.onShow.bind(this)),wx.offHide(this.onHide.bind(this))),e.off(t.ClickGameCell,this,this.onClickGameCell)}onBtnClick(t){t.target==this.closeBtn&&this.close()}onClickGameCell(t,e){if("try"==t){if("undefined"!=typeof wx){let t=Date.now();wx.navigateToMiniProgram({appId:e.appId,success:i=>{this.isTry=!0;let s=localStorage.getItem("tryPlayObj");(s=s?JSON.parse(s):{})[e.appId]=t,localStorage.setItem("tryPlayObj",JSON.stringify(s)),console.log(i)},fail:t=>{console.error(t)}})}}else"receive"==t&&L.openScene("pages/getCard.scene",!1,!0,Laya.Handler.create(this,()=>{this.gameList.refresh()}),[1,500,5])}onShow(){this.isTry&&(this.isTry=!1,this.jumpSuccess=!1,this.gameList.refresh(),this.tryAppData=null,Laya.timer.frameOnce(1,this,()=>{localStorage.removeItem("tryPlayObj")}))}onHide(){this.isTry&&(this.jumpSuccess=!0)}static tryOutTime(t){let e=localStorage.getItem("tryPlayObj");return e&&(e=JSON.parse(e))[t]||0}}class Se extends i.pages.tryGameCellUI{set dataSource(t){if(!t)return;this.data=t,this.gameIcon.skin=t.appIcon,this.gameName.text=t.appName,this.operateBtn.skin="pay/Btn_PlayGet2.png";let e=Ie.tryOutTime(this.data.appId);if(e>0){let t=Date.now()-e;console.log(Date.now(),e,t),Laya.timer.frameOnce(2,this,()=>{console.log("延迟时间",(new Date).toString())}),t>=6e4&&(this.operateBtn.skin="pay/Btn_PlayGet.png")}}onAwake(){this.operateBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.moneyLabel.filters=[x.blackColorFilter]}onBtnClick(i){if(i.target==this.operateBtn){let i="pay/Btn_PlayGet2.png"==this.operateBtn.skin?"try":"receive";e.event(t.ClickGameCell,[i,this.data])}}}class we extends i.pages.videoAddBloodUI{onAwake(){this.setBtnVideoTag()}onOpened(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.recoverBtn.on(Laya.Event.CLICK,this,this.onBtnClick)}onBtnClick(i){this.closeBtn==i.target?this.close():this.recoverBtn==i.target&&(w.Instance.sendVideoData={page_id:5,button_id:5,ad_id:2,ad_type:1},w.Instance.showVideoAd("adunit-344c07eccef75220",()=>{e.event(t.OneCure,!1),this.close()}))}setBtnVideoTag(){let t=1==w.Instance.videoMode;this.videoTag.visible=t}}class xe extends i.pages.videoConfirmUI{constructor(){super(...arguments),this.diamondCost=10}onAwake(){this.closeBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.watchVideoBtn.on(Laya.Event.CLICK,this,this.onBtnClick),this.diamondBtn.on(Laya.Event.CLICK,this,this.onBtnClick)}onBtnClick(i){i.target==this.closeBtn?this.close():i.target==this.watchVideoBtn?(this.videoClickFunc&&this.videoClickFunc(),this.close()):i.target==this.diamondBtn&&B.instance.diamond>=this.diamondCost&&(B.instance.diamond-=this.diamondCost,B.instance.onDataChange("diamond"),e.event(t.UseMoney,"diamond"),this.videoSuccessFunc&&this.videoSuccessFunc(),this.close())}setParam(t,e){this.videoClickFunc=t,this.videoSuccessFunc=e}}class ke{constructor(){}static init(){var t=Laya.ClassUtils.regClass;t("uilogic/AddBadgeRuntime.ts",c),t("gframe-work/effect/ButtonScale.ts",m),t("uilogic/AddMoneyRuntime.ts",T),t("uilogic/AskForCardRuntime.ts",M),t("uilogic/CardRuntime.ts",P),t("uilogic/CardBagRuntime.ts",D),t("uilogic/CardPageRuntime.ts",_),t("uilogic/CatchRuntime.ts",x),t("uilogic/CatchResultRuntime.ts",R),t("uilogic/ChallengeRuntime.ts",F),t("uilogic/MoneyUiRuntime.ts",A),t("uilogic/ChallengeRankRuntime.ts",N),t("uilogic/ChallengeRankRewardCellRuntime.ts",V),t("uilogic/ChallengeRankCellRuntime.ts",X),t("uilogic/ChooseOneRuntime.ts",G),t("uilogic/ComposeRuntime.ts",H),t("uilogic/CountRuntime.ts",Y),t("uilogic/CureCellRuntime.ts",z),t("uilogic/DivisionIconRuntime.ts",j),t("uilogic/DownPanelRuntime.ts",W),t("uilogic/EggShopRuntime.ts",q),t("uilogic/EscapeRuntime.ts",K),t("uilogic/FightRuntime.ts",$),t("uilogic/FightCellRuntime.ts",Q),t("uilogic/QteRuntime.ts",Z),t("uilogic/FightDotRuntime.ts",J),t("uilogic/GetCardRuntime.ts",et),t("uilogic/GetLotteryTimeRuntime.ts",it),t("uilogic/GiftPackRuntime.ts",at),t("uilogic/GiftPackPageRuntime.ts",nt),t("uilogic/GroupRuntime.ts",ot),t("uilogic/HandBookRuntime.ts",rt),t("uilogic/HandBookDetailRuntime.ts",ht),t("uilogic/HelpPackRuntime.ts",lt),t("uilogic/LevelCellRuntime.ts",E),t("uilogic/LoadViewRuntime.ts",pt),t("uilogic/LotteryRuntime.ts",gt),t("uilogic/LuckyPackRuntime.ts",mt),t("uilogic/MainViewRuntime.ts",te),t("uilogic/StartRuntime.ts",se),t("uilogic/SearchMapRuntime.ts",ae),t("uilogic/MapRuntime.ts",ne),t("uilogic/MapCellRuntime.ts",O),t("uilogic/NeverGiveUpRuntime.ts",oe),t("uilogic/PauseDialogRuntime.ts",re),t("uilogic/PkRuntime.ts",Qt),t("uilogic/PvpRankRewardCellRuntime.ts",he),t("uilogic/PvpRankCellRuntime.ts",le),t("uilogic/PvpCountRuntime.ts",ce),t("uilogic/PvpMatchRuntime.ts",de),t("uilogic/QuickClickTreasureRuntime.ts",U),t("uilogic/SelectShareFriendRuntime.ts",pe),t("uilogic/SettingDialogRuntime.ts",ge),t("uilogic/ShopCellRuntime.ts",me),t("uilogic/SignRuntime.ts",ee),t("uilogic/SpriteShopRuntime.ts",Zt),t("uilogic/StarRuntime.ts",Jt),t("uilogic/SucceedDialogRuntime.ts",ue),t("uilogic/SuperEggMachineRuntime.ts",ye),t("uilogic/SuperEvaRuntime.ts",k),t("uilogic/TaskRuntime.ts",ie),t("gframe-work/effect/ButtonUpDown.ts",fe),t("uilogic/TaskCellRuntime.ts",Le),t("uilogic/TreasureBoxRuntime.ts",Ce),t("uilogic/TryGameCellRuntime.ts",Se),t("uilogic/TryGamePageRuntime.ts",Ie),t("uilogic/VideoAddBloodRuntime.ts",we),t("uilogic/VideoConfirmRuntime.ts",xe)}}ke.width=720,ke.height=1280,ke.scaleMode="fixedwidth",ke.screenMode="none",ke.alignV="top",ke.alignH="left",ke.startScene="pages/load.scene",ke.sceneRoot="",ke.debug=!1,ke.stat=!1,ke.physicsDebug=!1,ke.exportSceneToJson=!0,ke.init();class Be{constructor(){Be._uiMap=new Map}static init(){Be._UIManager||(Be._UIManager=new Be)}static open(t,e=!0){let i=Be._uiMap.get(t.name);return null==i&&(i=new t,Be._uiMap.set(t.name,i)),e&&Be.closeAll(i),i.open(e),console.log(Be._uiMap),i}static close(t){let e=Be._uiMap.get(t.name);e&&(e.close(),e.autoDestroyAtClosed&&Be._uiMap.set(t.name,null)),console.log(Be._uiMap)}static closeAll(t){Be._uiMap.forEach((e,i)=>{!(e&&t instanceof Laya.Dialog&&e instanceof Laya.Dialog&&t!=e)&&(!e||t instanceof Laya.Dialog||e instanceof Laya.Dialog||t==e)||(e.close(),e.autoDestroyAtClosed&&Be._uiMap.set(i,null))})}}class be{constructor(){}static init(){return new Promise(t=>{UIConfig.closeDialogOnSide=!1,Laya.MouseManager.multiTouchEnabled=!0,UIConfig.popupBgAlpha=.8,e.init(),ut.init(),Be.init(),d.init(),w.Instance.init(),p.init().then(()=>{t()})})}}new class{constructor(){let t=new Config3D;t.enableMultiLight=!1,window.Laya3D?Laya3D.init(ke.width,ke.height,t):Laya.init(ke.width,ke.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=ke.scaleMode,Laya.stage.screenMode=ke.screenMode,Laya.stage.alignV=ke.alignV,Laya.stage.alignH=ke.alignH,Laya.URL.exportSceneToJson=ke.exportSceneToJson,(ke.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),ke.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),ke.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){be.init().then(()=>{u.init(),b.init(),p.loadFonts(["Num1.fnt","HP.fnt","Kill.fnt"]).then(()=>{ke.startScene&&Laya.Scene.open(ke.startScene)})})}}}();